/* Generated by Cython 0.29.34 */

/* BEGIN: Cython Metadata
{
    "distutils": {
        "name": "pyg4ometry.pycsg.core",
        "sources": [
            "src/pyg4ometry/pycsg/core.pyx"
        ]
    },
    "module_name": "pyg4ometry.pycsg.core"
}
END: Cython Metadata */

#ifndef PY_SSIZE_T_CLEAN
#define PY_SSIZE_T_CLEAN
#endif /* PY_SSIZE_T_CLEAN */
#include "Python.h"
#ifndef Py_PYTHON_H
#error Python headers needed to compile C extensions, please install development version of Python.
#elif PY_VERSION_HEX < 0x02060000 ||                                           \
    (0x03000000 <= PY_VERSION_HEX && PY_VERSION_HEX < 0x03030000)
#error Cython requires Python 2.6+ or Python 3.3+.
#else
#define CYTHON_ABI "0_29_34"
#define CYTHON_HEX_VERSION 0x001D22F0
#define CYTHON_FUTURE_DIVISION 1
#include <stddef.h>
#ifndef offsetof
#define offsetof(type, member) ((size_t) & ((type *)0)->member)
#endif
#if !defined(WIN32) && !defined(MS_WINDOWS)
#ifndef __stdcall
#define __stdcall
#endif
#ifndef __cdecl
#define __cdecl
#endif
#ifndef __fastcall
#define __fastcall
#endif
#endif
#ifndef DL_IMPORT
#define DL_IMPORT(t) t
#endif
#ifndef DL_EXPORT
#define DL_EXPORT(t) t
#endif
#define __PYX_COMMA ,
#ifndef HAVE_LONG_LONG
#if PY_VERSION_HEX >= 0x02070000
#define HAVE_LONG_LONG
#endif
#endif
#ifndef PY_LONG_LONG
#define PY_LONG_LONG LONG_LONG
#endif
#ifndef Py_HUGE_VAL
#define Py_HUGE_VAL HUGE_VAL
#endif
#ifdef PYPY_VERSION
#define CYTHON_COMPILING_IN_PYPY 1
#define CYTHON_COMPILING_IN_PYSTON 0
#define CYTHON_COMPILING_IN_CPYTHON 0
#define CYTHON_COMPILING_IN_NOGIL 0
#undef CYTHON_USE_TYPE_SLOTS
#define CYTHON_USE_TYPE_SLOTS 0
#undef CYTHON_USE_PYTYPE_LOOKUP
#define CYTHON_USE_PYTYPE_LOOKUP 0
#if PY_VERSION_HEX < 0x03050000
#undef CYTHON_USE_ASYNC_SLOTS
#define CYTHON_USE_ASYNC_SLOTS 0
#elif !defined(CYTHON_USE_ASYNC_SLOTS)
#define CYTHON_USE_ASYNC_SLOTS 1
#endif
#undef CYTHON_USE_PYLIST_INTERNALS
#define CYTHON_USE_PYLIST_INTERNALS 0
#undef CYTHON_USE_UNICODE_INTERNALS
#define CYTHON_USE_UNICODE_INTERNALS 0
#undef CYTHON_USE_UNICODE_WRITER
#define CYTHON_USE_UNICODE_WRITER 0
#undef CYTHON_USE_PYLONG_INTERNALS
#define CYTHON_USE_PYLONG_INTERNALS 0
#undef CYTHON_AVOID_BORROWED_REFS
#define CYTHON_AVOID_BORROWED_REFS 1
#undef CYTHON_ASSUME_SAFE_MACROS
#define CYTHON_ASSUME_SAFE_MACROS 0
#undef CYTHON_UNPACK_METHODS
#define CYTHON_UNPACK_METHODS 0
#undef CYTHON_FAST_THREAD_STATE
#define CYTHON_FAST_THREAD_STATE 0
#undef CYTHON_FAST_PYCALL
#define CYTHON_FAST_PYCALL 0
#undef CYTHON_PEP489_MULTI_PHASE_INIT
#define CYTHON_PEP489_MULTI_PHASE_INIT 0
#undef CYTHON_USE_TP_FINALIZE
#define CYTHON_USE_TP_FINALIZE 0
#undef CYTHON_USE_DICT_VERSIONS
#define CYTHON_USE_DICT_VERSIONS 0
#undef CYTHON_USE_EXC_INFO_STACK
#define CYTHON_USE_EXC_INFO_STACK 0
#ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
#define CYTHON_UPDATE_DESCRIPTOR_DOC 0
#endif
#elif defined(PYSTON_VERSION)
#define CYTHON_COMPILING_IN_PYPY 0
#define CYTHON_COMPILING_IN_PYSTON 1
#define CYTHON_COMPILING_IN_CPYTHON 0
#define CYTHON_COMPILING_IN_NOGIL 0
#ifndef CYTHON_USE_TYPE_SLOTS
#define CYTHON_USE_TYPE_SLOTS 1
#endif
#undef CYTHON_USE_PYTYPE_LOOKUP
#define CYTHON_USE_PYTYPE_LOOKUP 0
#undef CYTHON_USE_ASYNC_SLOTS
#define CYTHON_USE_ASYNC_SLOTS 0
#undef CYTHON_USE_PYLIST_INTERNALS
#define CYTHON_USE_PYLIST_INTERNALS 0
#ifndef CYTHON_USE_UNICODE_INTERNALS
#define CYTHON_USE_UNICODE_INTERNALS 1
#endif
#undef CYTHON_USE_UNICODE_WRITER
#define CYTHON_USE_UNICODE_WRITER 0
#undef CYTHON_USE_PYLONG_INTERNALS
#define CYTHON_USE_PYLONG_INTERNALS 0
#ifndef CYTHON_AVOID_BORROWED_REFS
#define CYTHON_AVOID_BORROWED_REFS 0
#endif
#ifndef CYTHON_ASSUME_SAFE_MACROS
#define CYTHON_ASSUME_SAFE_MACROS 1
#endif
#ifndef CYTHON_UNPACK_METHODS
#define CYTHON_UNPACK_METHODS 1
#endif
#undef CYTHON_FAST_THREAD_STATE
#define CYTHON_FAST_THREAD_STATE 0
#undef CYTHON_FAST_PYCALL
#define CYTHON_FAST_PYCALL 0
#undef CYTHON_PEP489_MULTI_PHASE_INIT
#define CYTHON_PEP489_MULTI_PHASE_INIT 0
#undef CYTHON_USE_TP_FINALIZE
#define CYTHON_USE_TP_FINALIZE 0
#undef CYTHON_USE_DICT_VERSIONS
#define CYTHON_USE_DICT_VERSIONS 0
#undef CYTHON_USE_EXC_INFO_STACK
#define CYTHON_USE_EXC_INFO_STACK 0
#ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
#define CYTHON_UPDATE_DESCRIPTOR_DOC 0
#endif
#elif defined(PY_NOGIL)
#define CYTHON_COMPILING_IN_PYPY 0
#define CYTHON_COMPILING_IN_PYSTON 0
#define CYTHON_COMPILING_IN_CPYTHON 0
#define CYTHON_COMPILING_IN_NOGIL 1
#ifndef CYTHON_USE_TYPE_SLOTS
#define CYTHON_USE_TYPE_SLOTS 1
#endif
#undef CYTHON_USE_PYTYPE_LOOKUP
#define CYTHON_USE_PYTYPE_LOOKUP 0
#ifndef CYTHON_USE_ASYNC_SLOTS
#define CYTHON_USE_ASYNC_SLOTS 1
#endif
#undef CYTHON_USE_PYLIST_INTERNALS
#define CYTHON_USE_PYLIST_INTERNALS 0
#ifndef CYTHON_USE_UNICODE_INTERNALS
#define CYTHON_USE_UNICODE_INTERNALS 1
#endif
#undef CYTHON_USE_UNICODE_WRITER
#define CYTHON_USE_UNICODE_WRITER 0
#undef CYTHON_USE_PYLONG_INTERNALS
#define CYTHON_USE_PYLONG_INTERNALS 0
#ifndef CYTHON_AVOID_BORROWED_REFS
#define CYTHON_AVOID_BORROWED_REFS 0
#endif
#ifndef CYTHON_ASSUME_SAFE_MACROS
#define CYTHON_ASSUME_SAFE_MACROS 1
#endif
#ifndef CYTHON_UNPACK_METHODS
#define CYTHON_UNPACK_METHODS 1
#endif
#undef CYTHON_FAST_THREAD_STATE
#define CYTHON_FAST_THREAD_STATE 0
#undef CYTHON_FAST_PYCALL
#define CYTHON_FAST_PYCALL 0
#ifndef CYTHON_PEP489_MULTI_PHASE_INIT
#define CYTHON_PEP489_MULTI_PHASE_INIT 1
#endif
#ifndef CYTHON_USE_TP_FINALIZE
#define CYTHON_USE_TP_FINALIZE 1
#endif
#undef CYTHON_USE_DICT_VERSIONS
#define CYTHON_USE_DICT_VERSIONS 0
#undef CYTHON_USE_EXC_INFO_STACK
#define CYTHON_USE_EXC_INFO_STACK 0
#else
#define CYTHON_COMPILING_IN_PYPY 0
#define CYTHON_COMPILING_IN_PYSTON 0
#define CYTHON_COMPILING_IN_CPYTHON 1
#define CYTHON_COMPILING_IN_NOGIL 0
#ifndef CYTHON_USE_TYPE_SLOTS
#define CYTHON_USE_TYPE_SLOTS 1
#endif
#if PY_VERSION_HEX < 0x02070000
#undef CYTHON_USE_PYTYPE_LOOKUP
#define CYTHON_USE_PYTYPE_LOOKUP 0
#elif !defined(CYTHON_USE_PYTYPE_LOOKUP)
#define CYTHON_USE_PYTYPE_LOOKUP 1
#endif
#if PY_MAJOR_VERSION < 3
#undef CYTHON_USE_ASYNC_SLOTS
#define CYTHON_USE_ASYNC_SLOTS 0
#elif !defined(CYTHON_USE_ASYNC_SLOTS)
#define CYTHON_USE_ASYNC_SLOTS 1
#endif
#if PY_VERSION_HEX < 0x02070000
#undef CYTHON_USE_PYLONG_INTERNALS
#define CYTHON_USE_PYLONG_INTERNALS 0
#elif !defined(CYTHON_USE_PYLONG_INTERNALS)
#define CYTHON_USE_PYLONG_INTERNALS (PY_VERSION_HEX < 0x030C00A5)
#endif
#ifndef CYTHON_USE_PYLIST_INTERNALS
#define CYTHON_USE_PYLIST_INTERNALS 1
#endif
#ifndef CYTHON_USE_UNICODE_INTERNALS
#define CYTHON_USE_UNICODE_INTERNALS 1
#endif
#if PY_VERSION_HEX < 0x030300F0 || PY_VERSION_HEX >= 0x030B00A2
#undef CYTHON_USE_UNICODE_WRITER
#define CYTHON_USE_UNICODE_WRITER 0
#elif !defined(CYTHON_USE_UNICODE_WRITER)
#define CYTHON_USE_UNICODE_WRITER 1
#endif
#ifndef CYTHON_AVOID_BORROWED_REFS
#define CYTHON_AVOID_BORROWED_REFS 0
#endif
#ifndef CYTHON_ASSUME_SAFE_MACROS
#define CYTHON_ASSUME_SAFE_MACROS 1
#endif
#ifndef CYTHON_UNPACK_METHODS
#define CYTHON_UNPACK_METHODS 1
#endif
#if PY_VERSION_HEX >= 0x030B00A4
#undef CYTHON_FAST_THREAD_STATE
#define CYTHON_FAST_THREAD_STATE 0
#elif !defined(CYTHON_FAST_THREAD_STATE)
#define CYTHON_FAST_THREAD_STATE 1
#endif
#ifndef CYTHON_FAST_PYCALL
#define CYTHON_FAST_PYCALL (PY_VERSION_HEX < 0x030A0000)
#endif
#ifndef CYTHON_PEP489_MULTI_PHASE_INIT
#define CYTHON_PEP489_MULTI_PHASE_INIT (PY_VERSION_HEX >= 0x03050000)
#endif
#ifndef CYTHON_USE_TP_FINALIZE
#define CYTHON_USE_TP_FINALIZE (PY_VERSION_HEX >= 0x030400a1)
#endif
#ifndef CYTHON_USE_DICT_VERSIONS
#define CYTHON_USE_DICT_VERSIONS                                               \
  ((PY_VERSION_HEX >= 0x030600B1) && (PY_VERSION_HEX < 0x030C00A5))
#endif
#if PY_VERSION_HEX >= 0x030B00A4
#undef CYTHON_USE_EXC_INFO_STACK
#define CYTHON_USE_EXC_INFO_STACK 0
#elif !defined(CYTHON_USE_EXC_INFO_STACK)
#define CYTHON_USE_EXC_INFO_STACK (PY_VERSION_HEX >= 0x030700A3)
#endif
#ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
#define CYTHON_UPDATE_DESCRIPTOR_DOC 1
#endif
#endif
#if !defined(CYTHON_FAST_PYCCALL)
#define CYTHON_FAST_PYCCALL (CYTHON_FAST_PYCALL && PY_VERSION_HEX >= 0x030600B1)
#endif
#if CYTHON_USE_PYLONG_INTERNALS
#if PY_MAJOR_VERSION < 3
#include "longintrepr.h"
#endif
#undef SHIFT
#undef BASE
#undef MASK
#ifdef SIZEOF_VOID_P
enum { __pyx_check_sizeof_voidp = 1 / (int)(SIZEOF_VOID_P == sizeof(void *)) };
#endif
#endif
#ifndef __has_attribute
#define __has_attribute(x) 0
#endif
#ifndef __has_cpp_attribute
#define __has_cpp_attribute(x) 0
#endif
#ifndef CYTHON_RESTRICT
#if defined(__GNUC__)
#define CYTHON_RESTRICT __restrict__
#elif defined(_MSC_VER) && _MSC_VER >= 1400
#define CYTHON_RESTRICT __restrict
#elif defined(__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
#define CYTHON_RESTRICT restrict
#else
#define CYTHON_RESTRICT
#endif
#endif
#ifndef CYTHON_UNUSED
#if defined(__GNUC__)
#if !(defined(__cplusplus)) ||                                                 \
    (__GNUC__ > 3 || (__GNUC__ == 3 && __GNUC_MINOR__ >= 4))
#define CYTHON_UNUSED __attribute__((__unused__))
#else
#define CYTHON_UNUSED
#endif
#elif defined(__ICC) || (defined(__INTEL_COMPILER) && !defined(_MSC_VER))
#define CYTHON_UNUSED __attribute__((__unused__))
#else
#define CYTHON_UNUSED
#endif
#endif
#ifndef CYTHON_MAYBE_UNUSED_VAR
#if defined(__cplusplus)
template <class T> void CYTHON_MAYBE_UNUSED_VAR(const T &) {}
#else
#define CYTHON_MAYBE_UNUSED_VAR(x) (void)(x)
#endif
#endif
#ifndef CYTHON_NCP_UNUSED
#if CYTHON_COMPILING_IN_CPYTHON
#define CYTHON_NCP_UNUSED
#else
#define CYTHON_NCP_UNUSED CYTHON_UNUSED
#endif
#endif
#define __Pyx_void_to_None(void_result)                                        \
  ((void)(void_result), Py_INCREF(Py_None), Py_None)
#ifdef _MSC_VER
#ifndef _MSC_STDINT_H_
#if _MSC_VER < 1300
typedef unsigned char uint8_t;
typedef unsigned int uint32_t;
#else
typedef unsigned __int8 uint8_t;
typedef unsigned __int32 uint32_t;
#endif
#endif
#else
#include <stdint.h>
#endif
#ifndef CYTHON_FALLTHROUGH
#if defined(__cplusplus) && __cplusplus >= 201103L
#if __has_cpp_attribute(fallthrough)
#define CYTHON_FALLTHROUGH [[fallthrough]]
#elif __has_cpp_attribute(clang::fallthrough)
#define CYTHON_FALLTHROUGH [[clang::fallthrough]]
#elif __has_cpp_attribute(gnu::fallthrough)
#define CYTHON_FALLTHROUGH [[gnu::fallthrough]]
#endif
#endif
#ifndef CYTHON_FALLTHROUGH
#if __has_attribute(fallthrough)
#define CYTHON_FALLTHROUGH __attribute__((fallthrough))
#else
#define CYTHON_FALLTHROUGH
#endif
#endif
#if defined(__clang__) && defined(__apple_build_version__)
#if __apple_build_version__ < 7000000
#undef CYTHON_FALLTHROUGH
#define CYTHON_FALLTHROUGH
#endif
#endif
#endif

#ifndef CYTHON_INLINE
#if defined(__clang__)
#define CYTHON_INLINE __inline__ __attribute__((__unused__))
#elif defined(__GNUC__)
#define CYTHON_INLINE __inline__
#elif defined(_MSC_VER)
#define CYTHON_INLINE __inline
#elif defined(__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
#define CYTHON_INLINE inline
#else
#define CYTHON_INLINE
#endif
#endif

#if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX < 0x02070600 &&                 \
    !defined(Py_OptimizeFlag)
#define Py_OptimizeFlag 0
#endif
#define __PYX_BUILD_PY_SSIZE_T "n"
#define CYTHON_FORMAT_SSIZE_T "z"
#if PY_MAJOR_VERSION < 3
#define __Pyx_BUILTIN_MODULE_NAME "__builtin__"
#define __Pyx_PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name,     \
                         fline, lnos)                                          \
  PyCode_New(a + k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)
#define __Pyx_DefaultClassType PyClass_Type
#else
#define __Pyx_BUILTIN_MODULE_NAME "builtins"
#define __Pyx_DefaultClassType PyType_Type
#if PY_VERSION_HEX >= 0x030B00A1
static CYTHON_INLINE PyCodeObject *
__Pyx_PyCode_New(int a, int k, int l, int s, int f, PyObject *code, PyObject *c,
                 PyObject *n, PyObject *v, PyObject *fv, PyObject *cell,
                 PyObject *fn, PyObject *name, int fline, PyObject *lnos) {
  PyObject *kwds = NULL, *argcount = NULL, *posonlyargcount = NULL,
           *kwonlyargcount = NULL;
  PyObject *nlocals = NULL, *stacksize = NULL, *flags = NULL, *replace = NULL,
           *call_result = NULL, *empty = NULL;
  const char *fn_cstr = NULL;
  const char *name_cstr = NULL;
  PyCodeObject *co = NULL;
  PyObject *type, *value, *traceback;
  PyErr_Fetch(&type, &value, &traceback);
  if (!(kwds = PyDict_New()))
    goto end;
  if (!(argcount = PyLong_FromLong(a)))
    goto end;
  if (PyDict_SetItemString(kwds, "co_argcount", argcount) != 0)
    goto end;
  if (!(posonlyargcount = PyLong_FromLong(0)))
    goto end;
  if (PyDict_SetItemString(kwds, "co_posonlyargcount", posonlyargcount) != 0)
    goto end;
  if (!(kwonlyargcount = PyLong_FromLong(k)))
    goto end;
  if (PyDict_SetItemString(kwds, "co_kwonlyargcount", kwonlyargcount) != 0)
    goto end;
  if (!(nlocals = PyLong_FromLong(l)))
    goto end;
  if (PyDict_SetItemString(kwds, "co_nlocals", nlocals) != 0)
    goto end;
  if (!(stacksize = PyLong_FromLong(s)))
    goto end;
  if (PyDict_SetItemString(kwds, "co_stacksize", stacksize) != 0)
    goto end;
  if (!(flags = PyLong_FromLong(f)))
    goto end;
  if (PyDict_SetItemString(kwds, "co_flags", flags) != 0)
    goto end;
  if (PyDict_SetItemString(kwds, "co_code", code) != 0)
    goto end;
  if (PyDict_SetItemString(kwds, "co_consts", c) != 0)
    goto end;
  if (PyDict_SetItemString(kwds, "co_names", n) != 0)
    goto end;
  if (PyDict_SetItemString(kwds, "co_varnames", v) != 0)
    goto end;
  if (PyDict_SetItemString(kwds, "co_freevars", fv) != 0)
    goto end;
  if (PyDict_SetItemString(kwds, "co_cellvars", cell) != 0)
    goto end;
  if (PyDict_SetItemString(kwds, "co_linetable", lnos) != 0)
    goto end;
  if (!(fn_cstr = PyUnicode_AsUTF8AndSize(fn, NULL)))
    goto end;
  if (!(name_cstr = PyUnicode_AsUTF8AndSize(name, NULL)))
    goto end;
  if (!(co = PyCode_NewEmpty(fn_cstr, name_cstr, fline)))
    goto end;
  if (!(replace = PyObject_GetAttrString((PyObject *)co, "replace")))
    goto cleanup_code_too;
  if (!(empty = PyTuple_New(0)))
    goto cleanup_code_too; // unfortunately __pyx_empty_tuple isn't available
                           // here
  if (!(call_result = PyObject_Call(replace, empty, kwds)))
    goto cleanup_code_too;
  Py_XDECREF((PyObject *)co);
  co = (PyCodeObject *)call_result;
  call_result = NULL;
  if (0) {
  cleanup_code_too:
    Py_XDECREF((PyObject *)co);
    co = NULL;
  }
end:
  Py_XDECREF(kwds);
  Py_XDECREF(argcount);
  Py_XDECREF(posonlyargcount);
  Py_XDECREF(kwonlyargcount);
  Py_XDECREF(nlocals);
  Py_XDECREF(stacksize);
  Py_XDECREF(replace);
  Py_XDECREF(call_result);
  Py_XDECREF(empty);
  if (type) {
    PyErr_Restore(type, value, traceback);
  }
  return co;
}
#else
#define __Pyx_PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name,     \
                         fline, lnos)                                          \
  PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)
#endif
#define __Pyx_DefaultClassType PyType_Type
#endif
#ifndef Py_TPFLAGS_CHECKTYPES
#define Py_TPFLAGS_CHECKTYPES 0
#endif
#ifndef Py_TPFLAGS_HAVE_INDEX
#define Py_TPFLAGS_HAVE_INDEX 0
#endif
#ifndef Py_TPFLAGS_HAVE_NEWBUFFER
#define Py_TPFLAGS_HAVE_NEWBUFFER 0
#endif
#ifndef Py_TPFLAGS_HAVE_FINALIZE
#define Py_TPFLAGS_HAVE_FINALIZE 0
#endif
#ifndef METH_STACKLESS
#define METH_STACKLESS 0
#endif
#if PY_VERSION_HEX <= 0x030700A3 || !defined(METH_FASTCALL)
#ifndef METH_FASTCALL
#define METH_FASTCALL 0x80
#endif
typedef PyObject *(*__Pyx_PyCFunctionFast)(PyObject *self,
                                           PyObject *const *args,
                                           Py_ssize_t nargs);
typedef PyObject *(*__Pyx_PyCFunctionFastWithKeywords)(PyObject *self,
                                                       PyObject *const *args,
                                                       Py_ssize_t nargs,
                                                       PyObject *kwnames);
#else
#define __Pyx_PyCFunctionFast _PyCFunctionFast
#define __Pyx_PyCFunctionFastWithKeywords _PyCFunctionFastWithKeywords
#endif
#if CYTHON_FAST_PYCCALL
#define __Pyx_PyFastCFunction_Check(func)                                      \
  ((PyCFunction_Check(func) &&                                                 \
    (METH_FASTCALL == (PyCFunction_GET_FLAGS(func) &                           \
                       ~(METH_CLASS | METH_STATIC | METH_COEXIST |             \
                         METH_KEYWORDS | METH_STACKLESS)))))
#else
#define __Pyx_PyFastCFunction_Check(func) 0
#endif
#if CYTHON_COMPILING_IN_PYPY && !defined(PyObject_Malloc)
#define PyObject_Malloc(s) PyMem_Malloc(s)
#define PyObject_Free(p) PyMem_Free(p)
#define PyObject_Realloc(p) PyMem_Realloc(p)
#endif
#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX < 0x030400A1
#define PyMem_RawMalloc(n) PyMem_Malloc(n)
#define PyMem_RawRealloc(p, n) PyMem_Realloc(p, n)
#define PyMem_RawFree(p) PyMem_Free(p)
#endif
#if CYTHON_COMPILING_IN_PYSTON
#define __Pyx_PyCode_HasFreeVars(co) PyCode_HasFreeVars(co)
#define __Pyx_PyFrame_SetLineNumber(frame, lineno)                             \
  PyFrame_SetLineNumber(frame, lineno)
#else
#define __Pyx_PyCode_HasFreeVars(co) (PyCode_GetNumFree(co) > 0)
#define __Pyx_PyFrame_SetLineNumber(frame, lineno) (frame)->f_lineno = (lineno)
#endif
#if !CYTHON_FAST_THREAD_STATE || PY_VERSION_HEX < 0x02070000
#define __Pyx_PyThreadState_Current PyThreadState_GET()
#elif PY_VERSION_HEX >= 0x03060000
#define __Pyx_PyThreadState_Current _PyThreadState_UncheckedGet()
#elif PY_VERSION_HEX >= 0x03000000
#define __Pyx_PyThreadState_Current PyThreadState_GET()
#else
#define __Pyx_PyThreadState_Current _PyThreadState_Current
#endif
#if PY_VERSION_HEX < 0x030700A2 && !defined(PyThread_tss_create) &&            \
    !defined(Py_tss_NEEDS_INIT)
#include "pythread.h"
#define Py_tss_NEEDS_INIT 0
typedef int Py_tss_t;
static CYTHON_INLINE int PyThread_tss_create(Py_tss_t *key) {
  *key = PyThread_create_key();
  return 0;
}
static CYTHON_INLINE Py_tss_t *PyThread_tss_alloc(void) {
  Py_tss_t *key = (Py_tss_t *)PyObject_Malloc(sizeof(Py_tss_t));
  *key = Py_tss_NEEDS_INIT;
  return key;
}
static CYTHON_INLINE void PyThread_tss_free(Py_tss_t *key) {
  PyObject_Free(key);
}
static CYTHON_INLINE int PyThread_tss_is_created(Py_tss_t *key) {
  return *key != Py_tss_NEEDS_INIT;
}
static CYTHON_INLINE void PyThread_tss_delete(Py_tss_t *key) {
  PyThread_delete_key(*key);
  *key = Py_tss_NEEDS_INIT;
}
static CYTHON_INLINE int PyThread_tss_set(Py_tss_t *key, void *value) {
  return PyThread_set_key_value(*key, value);
}
static CYTHON_INLINE void *PyThread_tss_get(Py_tss_t *key) {
  return PyThread_get_key_value(*key);
}
#endif
#if CYTHON_COMPILING_IN_CPYTHON || defined(_PyDict_NewPresized)
#define __Pyx_PyDict_NewPresized(n)                                            \
  ((n <= 8) ? PyDict_New() : _PyDict_NewPresized(n))
#else
#define __Pyx_PyDict_NewPresized(n) PyDict_New()
#endif
#if PY_MAJOR_VERSION >= 3 || CYTHON_FUTURE_DIVISION
#define __Pyx_PyNumber_Divide(x, y) PyNumber_TrueDivide(x, y)
#define __Pyx_PyNumber_InPlaceDivide(x, y) PyNumber_InPlaceTrueDivide(x, y)
#else
#define __Pyx_PyNumber_Divide(x, y) PyNumber_Divide(x, y)
#define __Pyx_PyNumber_InPlaceDivide(x, y) PyNumber_InPlaceDivide(x, y)
#endif
#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x030500A1 &&             \
    CYTHON_USE_UNICODE_INTERNALS
#define __Pyx_PyDict_GetItemStr(dict, name)                                    \
  _PyDict_GetItem_KnownHash(dict, name, ((PyASCIIObject *)name)->hash)
#else
#define __Pyx_PyDict_GetItemStr(dict, name) PyDict_GetItem(dict, name)
#endif
#if PY_VERSION_HEX > 0x03030000 && defined(PyUnicode_KIND)
#define CYTHON_PEP393_ENABLED 1
#if PY_VERSION_HEX >= 0x030C0000
#define __Pyx_PyUnicode_READY(op) (0)
#else
#define __Pyx_PyUnicode_READY(op)                                              \
  (likely(PyUnicode_IS_READY(op)) ? 0 : _PyUnicode_Ready((PyObject *)(op)))
#endif
#define __Pyx_PyUnicode_GET_LENGTH(u) PyUnicode_GET_LENGTH(u)
#define __Pyx_PyUnicode_READ_CHAR(u, i) PyUnicode_READ_CHAR(u, i)
#define __Pyx_PyUnicode_MAX_CHAR_VALUE(u) PyUnicode_MAX_CHAR_VALUE(u)
#define __Pyx_PyUnicode_KIND(u) PyUnicode_KIND(u)
#define __Pyx_PyUnicode_DATA(u) PyUnicode_DATA(u)
#define __Pyx_PyUnicode_READ(k, d, i) PyUnicode_READ(k, d, i)
#define __Pyx_PyUnicode_WRITE(k, d, i, ch) PyUnicode_WRITE(k, d, i, ch)
#if PY_VERSION_HEX >= 0x030C0000
#define __Pyx_PyUnicode_IS_TRUE(u) (0 != PyUnicode_GET_LENGTH(u))
#else
#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x03090000
#define __Pyx_PyUnicode_IS_TRUE(u)                                             \
  (0 != (likely(PyUnicode_IS_READY(u))                                         \
             ? PyUnicode_GET_LENGTH(u)                                         \
             : ((PyCompactUnicodeObject *)(u))->wstr_length))
#else
#define __Pyx_PyUnicode_IS_TRUE(u)                                             \
  (0 != (likely(PyUnicode_IS_READY(u)) ? PyUnicode_GET_LENGTH(u)               \
                                       : PyUnicode_GET_SIZE(u)))
#endif
#endif
#else
#define CYTHON_PEP393_ENABLED 0
#define PyUnicode_1BYTE_KIND 1
#define PyUnicode_2BYTE_KIND 2
#define PyUnicode_4BYTE_KIND 4
#define __Pyx_PyUnicode_READY(op) (0)
#define __Pyx_PyUnicode_GET_LENGTH(u) PyUnicode_GET_SIZE(u)
#define __Pyx_PyUnicode_READ_CHAR(u, i) ((Py_UCS4)(PyUnicode_AS_UNICODE(u)[i]))
#define __Pyx_PyUnicode_MAX_CHAR_VALUE(u)                                      \
  ((sizeof(Py_UNICODE) == 2) ? 65535 : 1114111)
#define __Pyx_PyUnicode_KIND(u) (sizeof(Py_UNICODE))
#define __Pyx_PyUnicode_DATA(u) ((void *)PyUnicode_AS_UNICODE(u))
#define __Pyx_PyUnicode_READ(k, d, i)                                          \
  ((void)(k), (Py_UCS4)(((Py_UNICODE *)d)[i]))
#define __Pyx_PyUnicode_WRITE(k, d, i, ch)                                     \
  (((void)(k)), ((Py_UNICODE *)d)[i] = ch)
#define __Pyx_PyUnicode_IS_TRUE(u) (0 != PyUnicode_GET_SIZE(u))
#endif
#if CYTHON_COMPILING_IN_PYPY
#define __Pyx_PyUnicode_Concat(a, b) PyNumber_Add(a, b)
#define __Pyx_PyUnicode_ConcatSafe(a, b) PyNumber_Add(a, b)
#else
#define __Pyx_PyUnicode_Concat(a, b) PyUnicode_Concat(a, b)
#define __Pyx_PyUnicode_ConcatSafe(a, b)                                       \
  ((unlikely((a) == Py_None) || unlikely((b) == Py_None))                      \
       ? PyNumber_Add(a, b)                                                    \
       : __Pyx_PyUnicode_Concat(a, b))
#endif
#if CYTHON_COMPILING_IN_PYPY && !defined(PyUnicode_Contains)
#define PyUnicode_Contains(u, s) PySequence_Contains(u, s)
#endif
#if CYTHON_COMPILING_IN_PYPY && !defined(PyByteArray_Check)
#define PyByteArray_Check(obj) PyObject_TypeCheck(obj, &PyByteArray_Type)
#endif
#if CYTHON_COMPILING_IN_PYPY && !defined(PyObject_Format)
#define PyObject_Format(obj, fmt)                                              \
  PyObject_CallMethod(obj, "__format__", "O", fmt)
#endif
#define __Pyx_PyString_FormatSafe(a, b)                                        \
  ((unlikely((a) == Py_None ||                                                 \
             (PyString_Check(b) && !PyString_CheckExact(b))))                  \
       ? PyNumber_Remainder(a, b)                                              \
       : __Pyx_PyString_Format(a, b))
#define __Pyx_PyUnicode_FormatSafe(a, b)                                       \
  ((unlikely((a) == Py_None ||                                                 \
             (PyUnicode_Check(b) && !PyUnicode_CheckExact(b))))                \
       ? PyNumber_Remainder(a, b)                                              \
       : PyUnicode_Format(a, b))
#if PY_MAJOR_VERSION >= 3
#define __Pyx_PyString_Format(a, b) PyUnicode_Format(a, b)
#else
#define __Pyx_PyString_Format(a, b) PyString_Format(a, b)
#endif
#if PY_MAJOR_VERSION < 3 && !defined(PyObject_ASCII)
#define PyObject_ASCII(o) PyObject_Repr(o)
#endif
#if PY_MAJOR_VERSION >= 3
#define PyBaseString_Type PyUnicode_Type
#define PyStringObject PyUnicodeObject
#define PyString_Type PyUnicode_Type
#define PyString_Check PyUnicode_Check
#define PyString_CheckExact PyUnicode_CheckExact
#ifndef PyObject_Unicode
#define PyObject_Unicode PyObject_Str
#endif
#endif
#if PY_MAJOR_VERSION >= 3
#define __Pyx_PyBaseString_Check(obj) PyUnicode_Check(obj)
#define __Pyx_PyBaseString_CheckExact(obj) PyUnicode_CheckExact(obj)
#else
#define __Pyx_PyBaseString_Check(obj)                                          \
  (PyString_Check(obj) || PyUnicode_Check(obj))
#define __Pyx_PyBaseString_CheckExact(obj)                                     \
  (PyString_CheckExact(obj) || PyUnicode_CheckExact(obj))
#endif
#ifndef PySet_CheckExact
#define PySet_CheckExact(obj) (Py_TYPE(obj) == &PySet_Type)
#endif
#if PY_VERSION_HEX >= 0x030900A4
#define __Pyx_SET_REFCNT(obj, refcnt) Py_SET_REFCNT(obj, refcnt)
#define __Pyx_SET_SIZE(obj, size) Py_SET_SIZE(obj, size)
#else
#define __Pyx_SET_REFCNT(obj, refcnt) Py_REFCNT(obj) = (refcnt)
#define __Pyx_SET_SIZE(obj, size) Py_SIZE(obj) = (size)
#endif
#if CYTHON_ASSUME_SAFE_MACROS
#define __Pyx_PySequence_SIZE(seq) Py_SIZE(seq)
#else
#define __Pyx_PySequence_SIZE(seq) PySequence_Size(seq)
#endif
#if PY_MAJOR_VERSION >= 3
#define PyIntObject PyLongObject
#define PyInt_Type PyLong_Type
#define PyInt_Check(op) PyLong_Check(op)
#define PyInt_CheckExact(op) PyLong_CheckExact(op)
#define PyInt_FromString PyLong_FromString
#define PyInt_FromUnicode PyLong_FromUnicode
#define PyInt_FromLong PyLong_FromLong
#define PyInt_FromSize_t PyLong_FromSize_t
#define PyInt_FromSsize_t PyLong_FromSsize_t
#define PyInt_AsLong PyLong_AsLong
#define PyInt_AS_LONG PyLong_AS_LONG
#define PyInt_AsSsize_t PyLong_AsSsize_t
#define PyInt_AsUnsignedLongMask PyLong_AsUnsignedLongMask
#define PyInt_AsUnsignedLongLongMask PyLong_AsUnsignedLongLongMask
#define PyNumber_Int PyNumber_Long
#endif
#if PY_MAJOR_VERSION >= 3
#define PyBoolObject PyLongObject
#endif
#if PY_MAJOR_VERSION >= 3 && CYTHON_COMPILING_IN_PYPY
#ifndef PyUnicode_InternFromString
#define PyUnicode_InternFromString(s) PyUnicode_FromString(s)
#endif
#endif
#if PY_VERSION_HEX < 0x030200A4
typedef long Py_hash_t;
#define __Pyx_PyInt_FromHash_t PyInt_FromLong
#define __Pyx_PyInt_AsHash_t __Pyx_PyIndex_AsHash_t
#else
#define __Pyx_PyInt_FromHash_t PyInt_FromSsize_t
#define __Pyx_PyInt_AsHash_t __Pyx_PyIndex_AsSsize_t
#endif
#if PY_MAJOR_VERSION >= 3
#define __Pyx_PyMethod_New(func, self, klass)                                  \
  ((self) ? ((void)(klass), PyMethod_New(func, self)) : __Pyx_NewRef(func))
#else
#define __Pyx_PyMethod_New(func, self, klass) PyMethod_New(func, self, klass)
#endif
#if CYTHON_USE_ASYNC_SLOTS
#if PY_VERSION_HEX >= 0x030500B1
#define __Pyx_PyAsyncMethodsStruct PyAsyncMethods
#define __Pyx_PyType_AsAsync(obj) (Py_TYPE(obj)->tp_as_async)
#else
#define __Pyx_PyType_AsAsync(obj)                                              \
  ((__Pyx_PyAsyncMethodsStruct *)(Py_TYPE(obj)->tp_reserved))
#endif
#else
#define __Pyx_PyType_AsAsync(obj) NULL
#endif
#ifndef __Pyx_PyAsyncMethodsStruct
typedef struct {
  unaryfunc am_await;
  unaryfunc am_aiter;
  unaryfunc am_anext;
} __Pyx_PyAsyncMethodsStruct;
#endif

#if defined(_WIN32) || defined(WIN32) || defined(MS_WINDOWS)
#if !defined(_USE_MATH_DEFINES)
#define _USE_MATH_DEFINES
#endif
#endif
#include <math.h>
#ifdef NAN
#define __PYX_NAN() ((float)NAN)
#else
static CYTHON_INLINE float __PYX_NAN() {
  float value;
  memset(&value, 0xFF, sizeof(value));
  return value;
}
#endif
#if defined(__CYGWIN__) && defined(_LDBL_EQ_DBL)
#define __Pyx_truncl trunc
#else
#define __Pyx_truncl truncl
#endif

#define __PYX_MARK_ERR_POS(f_index, lineno)                                    \
  {                                                                            \
    __pyx_filename = __pyx_f[f_index];                                         \
    (void)__pyx_filename;                                                      \
    __pyx_lineno = lineno;                                                     \
    (void)__pyx_lineno;                                                        \
    __pyx_clineno = __LINE__;                                                  \
    (void)__pyx_clineno;                                                       \
  }
#define __PYX_ERR(f_index, lineno, Ln_error)                                   \
  { __PYX_MARK_ERR_POS(f_index, lineno) goto Ln_error; }

#ifndef __PYX_EXTERN_C
#ifdef __cplusplus
#define __PYX_EXTERN_C extern "C"
#else
#define __PYX_EXTERN_C extern
#endif
#endif

#define __PYX_HAVE__pyg4ometry__pycsg__core
#define __PYX_HAVE_API__pyg4ometry__pycsg__core
/* Early includes */
#ifdef _OPENMP
#include <omp.h>
#endif /* _OPENMP */

#if defined(PYREX_WITHOUT_ASSERTIONS) && !defined(CYTHON_WITHOUT_ASSERTIONS)
#define CYTHON_WITHOUT_ASSERTIONS
#endif

typedef struct {
  PyObject **p;
  const char *s;
  const Py_ssize_t n;
  const char *encoding;
  const char is_unicode;
  const char is_str;
  const char intern;
} __Pyx_StringTabEntry;

#define __PYX_DEFAULT_STRING_ENCODING_IS_ASCII 0
#define __PYX_DEFAULT_STRING_ENCODING_IS_UTF8 0
#define __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT                               \
  (PY_MAJOR_VERSION >= 3 && __PYX_DEFAULT_STRING_ENCODING_IS_UTF8)
#define __PYX_DEFAULT_STRING_ENCODING ""
#define __Pyx_PyObject_FromString __Pyx_PyBytes_FromString
#define __Pyx_PyObject_FromStringAndSize __Pyx_PyBytes_FromStringAndSize
#define __Pyx_uchar_cast(c) ((unsigned char)c)
#define __Pyx_long_cast(x) ((long)x)
#define __Pyx_fits_Py_ssize_t(v, type, is_signed)                              \
  ((sizeof(type) < sizeof(Py_ssize_t)) ||                                      \
   (sizeof(type) > sizeof(Py_ssize_t) &&                                       \
    likely(v < (type)PY_SSIZE_T_MAX || v == (type)PY_SSIZE_T_MAX) &&           \
    (!is_signed ||                                                             \
     likely(v > (type)PY_SSIZE_T_MIN || v == (type)PY_SSIZE_T_MIN))) ||        \
   (sizeof(type) == sizeof(Py_ssize_t) &&                                      \
    (is_signed ||                                                              \
     likely(v < (type)PY_SSIZE_T_MAX || v == (type)PY_SSIZE_T_MAX))))
static CYTHON_INLINE int __Pyx_is_valid_index(Py_ssize_t i, Py_ssize_t limit) {
  return (size_t)i < (size_t)limit;
}
#if defined(__cplusplus) && __cplusplus >= 201103L
#include <cstdlib>
#define __Pyx_sst_abs(value) std::abs(value)
#elif SIZEOF_INT >= SIZEOF_SIZE_T
#define __Pyx_sst_abs(value) abs(value)
#elif SIZEOF_LONG >= SIZEOF_SIZE_T
#define __Pyx_sst_abs(value) labs(value)
#elif defined(_MSC_VER)
#define __Pyx_sst_abs(value) ((Py_ssize_t)_abs64(value))
#elif defined(__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
#define __Pyx_sst_abs(value) llabs(value)
#elif defined(__GNUC__)
#define __Pyx_sst_abs(value) __builtin_llabs(value)
#else
#define __Pyx_sst_abs(value) ((value < 0) ? -value : value)
#endif
static CYTHON_INLINE const char *__Pyx_PyObject_AsString(PyObject *);
static CYTHON_INLINE const char *
__Pyx_PyObject_AsStringAndSize(PyObject *, Py_ssize_t *length);
#define __Pyx_PyByteArray_FromString(s)                                        \
  PyByteArray_FromStringAndSize((const char *)s, strlen((const char *)s))
#define __Pyx_PyByteArray_FromStringAndSize(s, l)                              \
  PyByteArray_FromStringAndSize((const char *)s, l)
#define __Pyx_PyBytes_FromString PyBytes_FromString
#define __Pyx_PyBytes_FromStringAndSize PyBytes_FromStringAndSize
static CYTHON_INLINE PyObject *__Pyx_PyUnicode_FromString(const char *);
#if PY_MAJOR_VERSION < 3
#define __Pyx_PyStr_FromString __Pyx_PyBytes_FromString
#define __Pyx_PyStr_FromStringAndSize __Pyx_PyBytes_FromStringAndSize
#else
#define __Pyx_PyStr_FromString __Pyx_PyUnicode_FromString
#define __Pyx_PyStr_FromStringAndSize __Pyx_PyUnicode_FromStringAndSize
#endif
#define __Pyx_PyBytes_AsWritableString(s) ((char *)PyBytes_AS_STRING(s))
#define __Pyx_PyBytes_AsWritableSString(s) ((signed char *)PyBytes_AS_STRING(s))
#define __Pyx_PyBytes_AsWritableUString(s)                                     \
  ((unsigned char *)PyBytes_AS_STRING(s))
#define __Pyx_PyBytes_AsString(s) ((const char *)PyBytes_AS_STRING(s))
#define __Pyx_PyBytes_AsSString(s) ((const signed char *)PyBytes_AS_STRING(s))
#define __Pyx_PyBytes_AsUString(s) ((const unsigned char *)PyBytes_AS_STRING(s))
#define __Pyx_PyObject_AsWritableString(s) ((char *)__Pyx_PyObject_AsString(s))
#define __Pyx_PyObject_AsWritableSString(s)                                    \
  ((signed char *)__Pyx_PyObject_AsString(s))
#define __Pyx_PyObject_AsWritableUString(s)                                    \
  ((unsigned char *)__Pyx_PyObject_AsString(s))
#define __Pyx_PyObject_AsSString(s)                                            \
  ((const signed char *)__Pyx_PyObject_AsString(s))
#define __Pyx_PyObject_AsUString(s)                                            \
  ((const unsigned char *)__Pyx_PyObject_AsString(s))
#define __Pyx_PyObject_FromCString(s) __Pyx_PyObject_FromString((const char *)s)
#define __Pyx_PyBytes_FromCString(s) __Pyx_PyBytes_FromString((const char *)s)
#define __Pyx_PyByteArray_FromCString(s)                                       \
  __Pyx_PyByteArray_FromString((const char *)s)
#define __Pyx_PyStr_FromCString(s) __Pyx_PyStr_FromString((const char *)s)
#define __Pyx_PyUnicode_FromCString(s)                                         \
  __Pyx_PyUnicode_FromString((const char *)s)
static CYTHON_INLINE size_t __Pyx_Py_UNICODE_strlen(const Py_UNICODE *u) {
  const Py_UNICODE *u_end = u;
  while (*u_end++)
    ;
  return (size_t)(u_end - u - 1);
}
#define __Pyx_PyUnicode_FromUnicode(u)                                         \
  PyUnicode_FromUnicode(u, __Pyx_Py_UNICODE_strlen(u))
#define __Pyx_PyUnicode_FromUnicodeAndLength PyUnicode_FromUnicode
#define __Pyx_PyUnicode_AsUnicode PyUnicode_AsUnicode
#define __Pyx_NewRef(obj) (Py_INCREF(obj), obj)
#define __Pyx_Owned_Py_None(b) __Pyx_NewRef(Py_None)
static CYTHON_INLINE PyObject *__Pyx_PyBool_FromLong(long b);
static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject *);
static CYTHON_INLINE int __Pyx_PyObject_IsTrueAndDecref(PyObject *);
static CYTHON_INLINE PyObject *__Pyx_PyNumber_IntOrLong(PyObject *x);
#define __Pyx_PySequence_Tuple(obj)                                            \
  (likely(PyTuple_CheckExact(obj)) ? __Pyx_NewRef(obj) : PySequence_Tuple(obj))
static CYTHON_INLINE Py_ssize_t __Pyx_PyIndex_AsSsize_t(PyObject *);
static CYTHON_INLINE PyObject *__Pyx_PyInt_FromSize_t(size_t);
static CYTHON_INLINE Py_hash_t __Pyx_PyIndex_AsHash_t(PyObject *);
#if CYTHON_ASSUME_SAFE_MACROS
#define __pyx_PyFloat_AsDouble(x)                                              \
  (PyFloat_CheckExact(x) ? PyFloat_AS_DOUBLE(x) : PyFloat_AsDouble(x))
#else
#define __pyx_PyFloat_AsDouble(x) PyFloat_AsDouble(x)
#endif
#define __pyx_PyFloat_AsFloat(x) ((float)__pyx_PyFloat_AsDouble(x))
#if PY_MAJOR_VERSION >= 3
#define __Pyx_PyNumber_Int(x)                                                  \
  (PyLong_CheckExact(x) ? __Pyx_NewRef(x) : PyNumber_Long(x))
#else
#define __Pyx_PyNumber_Int(x)                                                  \
  (PyInt_CheckExact(x) ? __Pyx_NewRef(x) : PyNumber_Int(x))
#endif
#define __Pyx_PyNumber_Float(x)                                                \
  (PyFloat_CheckExact(x) ? __Pyx_NewRef(x) : PyNumber_Float(x))
#if PY_MAJOR_VERSION < 3 && __PYX_DEFAULT_STRING_ENCODING_IS_ASCII
static int __Pyx_sys_getdefaultencoding_not_ascii;
static int __Pyx_init_sys_getdefaultencoding_params(void) {
  PyObject *sys;
  PyObject *default_encoding = NULL;
  PyObject *ascii_chars_u = NULL;
  PyObject *ascii_chars_b = NULL;
  const char *default_encoding_c;
  sys = PyImport_ImportModule("sys");
  if (!sys)
    goto bad;
  default_encoding =
      PyObject_CallMethod(sys, (char *)"getdefaultencoding", NULL);
  Py_DECREF(sys);
  if (!default_encoding)
    goto bad;
  default_encoding_c = PyBytes_AsString(default_encoding);
  if (!default_encoding_c)
    goto bad;
  if (strcmp(default_encoding_c, "ascii") == 0) {
    __Pyx_sys_getdefaultencoding_not_ascii = 0;
  } else {
    char ascii_chars[128];
    int c;
    for (c = 0; c < 128; c++) {
      ascii_chars[c] = c;
    }
    __Pyx_sys_getdefaultencoding_not_ascii = 1;
    ascii_chars_u = PyUnicode_DecodeASCII(ascii_chars, 128, NULL);
    if (!ascii_chars_u)
      goto bad;
    ascii_chars_b =
        PyUnicode_AsEncodedString(ascii_chars_u, default_encoding_c, NULL);
    if (!ascii_chars_b || !PyBytes_Check(ascii_chars_b) ||
        memcmp(ascii_chars, PyBytes_AS_STRING(ascii_chars_b), 128) != 0) {
      PyErr_Format(PyExc_ValueError,
                   "This module compiled with c_string_encoding=ascii, but "
                   "default encoding '%.200s' is not a superset of ascii.",
                   default_encoding_c);
      goto bad;
    }
    Py_DECREF(ascii_chars_u);
    Py_DECREF(ascii_chars_b);
  }
  Py_DECREF(default_encoding);
  return 0;
bad:
  Py_XDECREF(default_encoding);
  Py_XDECREF(ascii_chars_u);
  Py_XDECREF(ascii_chars_b);
  return -1;
}
#endif
#if __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT && PY_MAJOR_VERSION >= 3
#define __Pyx_PyUnicode_FromStringAndSize(c_str, size)                         \
  PyUnicode_DecodeUTF8(c_str, size, NULL)
#else
#define __Pyx_PyUnicode_FromStringAndSize(c_str, size)                         \
  PyUnicode_Decode(c_str, size, __PYX_DEFAULT_STRING_ENCODING, NULL)
#if __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT
static char *__PYX_DEFAULT_STRING_ENCODING;
static int __Pyx_init_sys_getdefaultencoding_params(void) {
  PyObject *sys;
  PyObject *default_encoding = NULL;
  char *default_encoding_c;
  sys = PyImport_ImportModule("sys");
  if (!sys)
    goto bad;
  default_encoding = PyObject_CallMethod(
      sys, (char *)(const char *)"getdefaultencoding", NULL);
  Py_DECREF(sys);
  if (!default_encoding)
    goto bad;
  default_encoding_c = PyBytes_AsString(default_encoding);
  if (!default_encoding_c)
    goto bad;
  __PYX_DEFAULT_STRING_ENCODING =
      (char *)malloc(strlen(default_encoding_c) + 1);
  if (!__PYX_DEFAULT_STRING_ENCODING)
    goto bad;
  strcpy(__PYX_DEFAULT_STRING_ENCODING, default_encoding_c);
  Py_DECREF(default_encoding);
  return 0;
bad:
  Py_XDECREF(default_encoding);
  return -1;
}
#endif
#endif

/* Test for GCC > 2.95 */
#if defined(__GNUC__) &&                                                       \
    (__GNUC__ > 2 || (__GNUC__ == 2 && (__GNUC_MINOR__ > 95)))
#define likely(x) __builtin_expect(!!(x), 1)
#define unlikely(x) __builtin_expect(!!(x), 0)
#else /* !__GNUC__ or GCC < 2.95 */
#define likely(x) (x)
#define unlikely(x) (x)
#endif /* __GNUC__ */
static CYTHON_INLINE void __Pyx_pretend_to_initialize(void *ptr) { (void)ptr; }

static PyObject *__pyx_m = NULL;
static PyObject *__pyx_d;
static PyObject *__pyx_b;
static PyObject *__pyx_cython_runtime = NULL;
static PyObject *__pyx_empty_tuple;
static PyObject *__pyx_empty_bytes;
static PyObject *__pyx_empty_unicode;
static int __pyx_lineno;
static int __pyx_clineno = 0;
static const char *__pyx_cfilenm = __FILE__;
static const char *__pyx_filename;

static const char *__pyx_f[] = {
    "src/pyg4ometry/pycsg/core.pyx",
};

/*--- Type declarations ---*/
struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate;
struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere;
struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder;
struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone;
struct __pyx_defaults;
typedef struct __pyx_defaults __pyx_defaults;
struct __pyx_defaults {
  PyObject *__pyx_arg_center;
  PyObject *__pyx_arg_radius;
};

/* "pyg4ometry/pycsg/core.pyx":164
 *                 # no change to the normals
 *
 *     def rotate(self, axis, angleDeg):             # <<<<<<<<<<<<<<
 *         """
 *         Rotate geometry.
 */
struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate {
  PyObject_HEAD PyObject *__pyx_v_ax;
  PyObject *__pyx_v_cosAngle;
  PyObject *__pyx_v_sinAngle;
};

/* "pyg4ometry/pycsg/core.pyx":660
 *
 *     @classmethod
 *     def sphere(cls, **kwargs):             # <<<<<<<<<<<<<<
 *         """ Returns a sphere.
 *
 */
struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere {
  PyObject_HEAD PyObject *__pyx_v_c;
  PyObject *__pyx_v_r;
};

/* "pyg4ometry/pycsg/core.pyx":755
 *
 *     @classmethod
 *     def cylinder(cls, **kwargs):             # <<<<<<<<<<<<<<
 *         """ Returns a cylinder.
 *
 */
struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder {
  PyObject_HEAD PyObject *__pyx_v_axisX;
  PyObject *__pyx_v_axisY;
  PyObject *__pyx_v_axisZ;
  PyObject *__pyx_v_r;
  PyObject *__pyx_v_ray;
  PyObject *__pyx_v_s;
};

/* "pyg4ometry/pycsg/core.pyx":812
 *
 *     @classmethod
 *     def cone(cls, **kwargs):             # <<<<<<<<<<<<<<
 *         """ Returns a cone.
 *
 */
struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone {
  PyObject_HEAD PyObject *__pyx_v_axisX;
  PyObject *__pyx_v_axisY;
  PyObject *__pyx_v_axisZ;
  PyObject *__pyx_v_cosTaperAngle;
  PyObject *__pyx_v_r;
  PyObject *__pyx_v_s;
  PyObject *__pyx_v_sinTaperAngle;
};

/* --- Runtime support code (head) --- */
/* Refnanny.proto */
#ifndef CYTHON_REFNANNY
#define CYTHON_REFNANNY 0
#endif
#if CYTHON_REFNANNY
typedef struct {
  void (*INCREF)(void *, PyObject *, int);
  void (*DECREF)(void *, PyObject *, int);
  void (*GOTREF)(void *, PyObject *, int);
  void (*GIVEREF)(void *, PyObject *, int);
  void *(*SetupContext)(const char *, int, const char *);
  void (*FinishContext)(void **);
} __Pyx_RefNannyAPIStruct;
static __Pyx_RefNannyAPIStruct *__Pyx_RefNanny = NULL;
static __Pyx_RefNannyAPIStruct *__Pyx_RefNannyImportAPI(const char *modname);
#define __Pyx_RefNannyDeclarations void *__pyx_refnanny = NULL;
#ifdef WITH_THREAD
#define __Pyx_RefNannySetupContext(name, acquire_gil)                          \
  if (acquire_gil) {                                                           \
    PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();                \
    __pyx_refnanny = __Pyx_RefNanny->SetupContext((name), __LINE__, __FILE__); \
    PyGILState_Release(__pyx_gilstate_save);                                   \
  } else {                                                                     \
    __pyx_refnanny = __Pyx_RefNanny->SetupContext((name), __LINE__, __FILE__); \
  }
#else
#define __Pyx_RefNannySetupContext(name, acquire_gil)                          \
  __pyx_refnanny = __Pyx_RefNanny->SetupContext((name), __LINE__, __FILE__)
#endif
#define __Pyx_RefNannyFinishContext()                                          \
  __Pyx_RefNanny->FinishContext(&__pyx_refnanny)
#define __Pyx_INCREF(r)                                                        \
  __Pyx_RefNanny->INCREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
#define __Pyx_DECREF(r)                                                        \
  __Pyx_RefNanny->DECREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
#define __Pyx_GOTREF(r)                                                        \
  __Pyx_RefNanny->GOTREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
#define __Pyx_GIVEREF(r)                                                       \
  __Pyx_RefNanny->GIVEREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
#define __Pyx_XINCREF(r)                                                       \
  do {                                                                         \
    if ((r) != NULL) {                                                         \
      __Pyx_INCREF(r);                                                         \
    }                                                                          \
  } while (0)
#define __Pyx_XDECREF(r)                                                       \
  do {                                                                         \
    if ((r) != NULL) {                                                         \
      __Pyx_DECREF(r);                                                         \
    }                                                                          \
  } while (0)
#define __Pyx_XGOTREF(r)                                                       \
  do {                                                                         \
    if ((r) != NULL) {                                                         \
      __Pyx_GOTREF(r);                                                         \
    }                                                                          \
  } while (0)
#define __Pyx_XGIVEREF(r)                                                      \
  do {                                                                         \
    if ((r) != NULL) {                                                         \
      __Pyx_GIVEREF(r);                                                        \
    }                                                                          \
  } while (0)
#else
#define __Pyx_RefNannyDeclarations
#define __Pyx_RefNannySetupContext(name, acquire_gil)
#define __Pyx_RefNannyFinishContext()
#define __Pyx_INCREF(r) Py_INCREF(r)
#define __Pyx_DECREF(r) Py_DECREF(r)
#define __Pyx_GOTREF(r)
#define __Pyx_GIVEREF(r)
#define __Pyx_XINCREF(r) Py_XINCREF(r)
#define __Pyx_XDECREF(r) Py_XDECREF(r)
#define __Pyx_XGOTREF(r)
#define __Pyx_XGIVEREF(r)
#endif
#define __Pyx_XDECREF_SET(r, v)                                                \
  do {                                                                         \
    PyObject *tmp = (PyObject *)r;                                             \
    r = v;                                                                     \
    __Pyx_XDECREF(tmp);                                                        \
  } while (0)
#define __Pyx_DECREF_SET(r, v)                                                 \
  do {                                                                         \
    PyObject *tmp = (PyObject *)r;                                             \
    r = v;                                                                     \
    __Pyx_DECREF(tmp);                                                         \
  } while (0)
#define __Pyx_CLEAR(r)                                                         \
  do {                                                                         \
    PyObject *tmp = ((PyObject *)(r));                                         \
    r = NULL;                                                                  \
    __Pyx_DECREF(tmp);                                                         \
  } while (0)
#define __Pyx_XCLEAR(r)                                                        \
  do {                                                                         \
    if ((r) != NULL) {                                                         \
      PyObject *tmp = ((PyObject *)(r));                                       \
      r = NULL;                                                                \
      __Pyx_DECREF(tmp);                                                       \
    }                                                                          \
  } while (0)

/* PyObjectGetAttrStr.proto */
#if CYTHON_USE_TYPE_SLOTS
static CYTHON_INLINE PyObject *__Pyx_PyObject_GetAttrStr(PyObject *obj,
                                                         PyObject *attr_name);
#else
#define __Pyx_PyObject_GetAttrStr(o, n) PyObject_GetAttr(o, n)
#endif

/* GetBuiltinName.proto */
static PyObject *__Pyx_GetBuiltinName(PyObject *name);

/* PyObjectSetAttrStr.proto */
#if CYTHON_USE_TYPE_SLOTS
#define __Pyx_PyObject_DelAttrStr(o, n) __Pyx_PyObject_SetAttrStr(o, n, NULL)
static CYTHON_INLINE int
__Pyx_PyObject_SetAttrStr(PyObject *obj, PyObject *attr_name, PyObject *value);
#else
#define __Pyx_PyObject_DelAttrStr(o, n) PyObject_DelAttr(o, n)
#define __Pyx_PyObject_SetAttrStr(o, n, v) PyObject_SetAttr(o, n, v)
#endif

/* PyDictVersioning.proto */
#if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_TYPE_SLOTS
#define __PYX_DICT_VERSION_INIT ((PY_UINT64_T)-1)
#define __PYX_GET_DICT_VERSION(dict) (((PyDictObject *)(dict))->ma_version_tag)
#define __PYX_UPDATE_DICT_CACHE(dict, value, cache_var, version_var)           \
  (version_var) = __PYX_GET_DICT_VERSION(dict);                                \
  (cache_var) = (value);
#define __PYX_PY_DICT_LOOKUP_IF_MODIFIED(VAR, DICT, LOOKUP)                    \
  {                                                                            \
    static PY_UINT64_T __pyx_dict_version = 0;                                 \
    static PyObject *__pyx_dict_cached_value = NULL;                           \
    if (likely(__PYX_GET_DICT_VERSION(DICT) == __pyx_dict_version)) {          \
      (VAR) = __pyx_dict_cached_value;                                         \
    } else {                                                                   \
      (VAR) = __pyx_dict_cached_value = (LOOKUP);                              \
      __pyx_dict_version = __PYX_GET_DICT_VERSION(DICT);                       \
    }                                                                          \
  }
static CYTHON_INLINE PY_UINT64_T __Pyx_get_tp_dict_version(PyObject *obj);
static CYTHON_INLINE PY_UINT64_T __Pyx_get_object_dict_version(PyObject *obj);
static CYTHON_INLINE int
__Pyx_object_dict_version_matches(PyObject *obj, PY_UINT64_T tp_dict_version,
                                  PY_UINT64_T obj_dict_version);
#else
#define __PYX_GET_DICT_VERSION(dict) (0)
#define __PYX_UPDATE_DICT_CACHE(dict, value, cache_var, version_var)
#define __PYX_PY_DICT_LOOKUP_IF_MODIFIED(VAR, DICT, LOOKUP) (VAR) = (LOOKUP);
#endif

/* GetModuleGlobalName.proto */
#if CYTHON_USE_DICT_VERSIONS
#define __Pyx_GetModuleGlobalName(var, name)                                   \
  do {                                                                         \
    static PY_UINT64_T __pyx_dict_version = 0;                                 \
    static PyObject *__pyx_dict_cached_value = NULL;                           \
    (var) = (likely(__pyx_dict_version == __PYX_GET_DICT_VERSION(__pyx_d)))    \
                ? (likely(__pyx_dict_cached_value)                             \
                       ? __Pyx_NewRef(__pyx_dict_cached_value)                 \
                       : __Pyx_GetBuiltinName(name))                           \
                : __Pyx__GetModuleGlobalName(name, &__pyx_dict_version,        \
                                             &__pyx_dict_cached_value);        \
  } while (0)
#define __Pyx_GetModuleGlobalNameUncached(var, name)                           \
  do {                                                                         \
    PY_UINT64_T __pyx_dict_version;                                            \
    PyObject *__pyx_dict_cached_value;                                         \
    (var) = __Pyx__GetModuleGlobalName(name, &__pyx_dict_version,              \
                                       &__pyx_dict_cached_value);              \
  } while (0)
static PyObject *__Pyx__GetModuleGlobalName(PyObject *name,
                                            PY_UINT64_T *dict_version,
                                            PyObject **dict_cached_value);
#else
#define __Pyx_GetModuleGlobalName(var, name)                                   \
  (var) = __Pyx__GetModuleGlobalName(name)
#define __Pyx_GetModuleGlobalNameUncached(var, name)                           \
  (var) = __Pyx__GetModuleGlobalName(name)
static CYTHON_INLINE PyObject *__Pyx__GetModuleGlobalName(PyObject *name);
#endif

/* PyFunctionFastCall.proto */
#if CYTHON_FAST_PYCALL
#define __Pyx_PyFunction_FastCall(func, args, nargs)                           \
  __Pyx_PyFunction_FastCallDict((func), (args), (nargs), NULL)
#if 1 || PY_VERSION_HEX < 0x030600B1
static PyObject *__Pyx_PyFunction_FastCallDict(PyObject *func, PyObject **args,
                                               Py_ssize_t nargs,
                                               PyObject *kwargs);
#else
#define __Pyx_PyFunction_FastCallDict(func, args, nargs, kwargs)               \
  _PyFunction_FastCallDict(func, args, nargs, kwargs)
#endif
#define __Pyx_BUILD_ASSERT_EXPR(cond) (sizeof(char[1 - 2 * !(cond)]) - 1)
#ifndef Py_MEMBER_SIZE
#define Py_MEMBER_SIZE(type, member) sizeof(((type *)0)->member)
#endif
#if CYTHON_FAST_PYCALL
static size_t __pyx_pyframe_localsplus_offset = 0;
#include "frameobject.h"
#if PY_VERSION_HEX >= 0x030b00a6
#ifndef Py_BUILD_CORE
#define Py_BUILD_CORE 1
#endif
#include "internal/pycore_frame.h"
#endif
#define __Pxy_PyFrame_Initialize_Offsets()                                     \
  ((void)__Pyx_BUILD_ASSERT_EXPR(                                              \
       sizeof(PyFrameObject) ==                                                \
       offsetof(PyFrameObject, f_localsplus) +                                 \
           Py_MEMBER_SIZE(PyFrameObject, f_localsplus)),                       \
   (void)(__pyx_pyframe_localsplus_offset =                                    \
              ((size_t)PyFrame_Type.tp_basicsize) -                            \
              Py_MEMBER_SIZE(PyFrameObject, f_localsplus)))
#define __Pyx_PyFrame_GetLocalsplus(frame)                                     \
  (assert(__pyx_pyframe_localsplus_offset),                                    \
   (PyObject **)(((char *)(frame)) + __pyx_pyframe_localsplus_offset))
#endif // CYTHON_FAST_PYCALL
#endif

/* PyObjectCall.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject *__Pyx_PyObject_Call(PyObject *func,
                                                   PyObject *arg, PyObject *kw);
#else
#define __Pyx_PyObject_Call(func, arg, kw) PyObject_Call(func, arg, kw)
#endif

/* PyObjectCallMethO.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject *__Pyx_PyObject_CallMethO(PyObject *func,
                                                        PyObject *arg);
#endif

/* PyObjectCallNoArg.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject *__Pyx_PyObject_CallNoArg(PyObject *func);
#else
#define __Pyx_PyObject_CallNoArg(func)                                         \
  __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL)
#endif

/* PyCFunctionFastCall.proto */
#if CYTHON_FAST_PYCCALL
static CYTHON_INLINE PyObject *
__Pyx_PyCFunction_FastCall(PyObject *func, PyObject **args, Py_ssize_t nargs);
#else
#define __Pyx_PyCFunction_FastCall(func, args, nargs) (assert(0), NULL)
#endif

/* PyObjectCallOneArg.proto */
static CYTHON_INLINE PyObject *__Pyx_PyObject_CallOneArg(PyObject *func,
                                                         PyObject *arg);

/* GetItemInt.proto */
#define __Pyx_GetItemInt(o, i, type, is_signed, to_py_func, is_list,           \
                         wraparound, boundscheck)                              \
  (__Pyx_fits_Py_ssize_t(i, type, is_signed)                                   \
       ? __Pyx_GetItemInt_Fast(o, (Py_ssize_t)i, is_list, wraparound,          \
                               boundscheck)                                    \
       : (is_list                                                              \
              ? (PyErr_SetString(PyExc_IndexError, "list index out of range"), \
                 (PyObject *)NULL)                                             \
              : __Pyx_GetItemInt_Generic(o, to_py_func(i))))
#define __Pyx_GetItemInt_List(o, i, type, is_signed, to_py_func, is_list,      \
                              wraparound, boundscheck)                         \
  (__Pyx_fits_Py_ssize_t(i, type, is_signed)                                   \
       ? __Pyx_GetItemInt_List_Fast(o, (Py_ssize_t)i, wraparound, boundscheck) \
       : (PyErr_SetString(PyExc_IndexError, "list index out of range"),        \
          (PyObject *)NULL))
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o,
                                                          Py_ssize_t i,
                                                          int wraparound,
                                                          int boundscheck);
#define __Pyx_GetItemInt_Tuple(o, i, type, is_signed, to_py_func, is_list,     \
                               wraparound, boundscheck)                        \
  (__Pyx_fits_Py_ssize_t(i, type, is_signed)                                   \
       ? __Pyx_GetItemInt_Tuple_Fast(o, (Py_ssize_t)i, wraparound,             \
                                     boundscheck)                              \
       : (PyErr_SetString(PyExc_IndexError, "tuple index out of range"),       \
          (PyObject *)NULL))
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o,
                                                           Py_ssize_t i,
                                                           int wraparound,
                                                           int boundscheck);
static PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject *j);
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i,
                                                     int is_list,
                                                     int wraparound,
                                                     int boundscheck);

/* PyObjectCall2Args.proto */
static CYTHON_UNUSED PyObject *
__Pyx_PyObject_Call2Args(PyObject *function, PyObject *arg1, PyObject *arg2);

/* RaiseArgTupleInvalid.proto */
static void __Pyx_RaiseArgtupleInvalid(const char *func_name, int exact,
                                       Py_ssize_t num_min, Py_ssize_t num_max,
                                       Py_ssize_t num_found);

/* RaiseDoubleKeywords.proto */
static void __Pyx_RaiseDoubleKeywordsError(const char *func_name,
                                           PyObject *kw_name);

/* ParseKeywords.proto */
static int __Pyx_ParseOptionalKeywords(PyObject *kwds, PyObject **argnames[],
                                       PyObject *kwds2, PyObject *values[],
                                       Py_ssize_t num_pos_args,
                                       const char *function_name);

/* ListCompAppend.proto */
#if CYTHON_USE_PYLIST_INTERNALS && CYTHON_ASSUME_SAFE_MACROS
static CYTHON_INLINE int __Pyx_ListComp_Append(PyObject *list, PyObject *x) {
  PyListObject *L = (PyListObject *)list;
  Py_ssize_t len = Py_SIZE(list);
  if (likely(L->allocated > len)) {
    Py_INCREF(x);
    PyList_SET_ITEM(list, len, x);
    __Pyx_SET_SIZE(list, len + 1);
    return 0;
  }
  return PyList_Append(list, x);
}
#else
#define __Pyx_ListComp_Append(L, x) PyList_Append(L, x)
#endif

/* PyIntCompare.proto */
static CYTHON_INLINE PyObject *__Pyx_PyInt_EqObjC(PyObject *op1, PyObject *op2,
                                                  long intval, long inplace);

/* ObjectGetItem.proto */
#if CYTHON_USE_TYPE_SLOTS
static CYTHON_INLINE PyObject *__Pyx_PyObject_GetItem(PyObject *obj,
                                                      PyObject *key);
#else
#define __Pyx_PyObject_GetItem(obj, key) PyObject_GetItem(obj, key)
#endif

/* PyIntBinop.proto */
#if !CYTHON_COMPILING_IN_PYPY
static PyObject *__Pyx_PyInt_AddObjC(PyObject *op1, PyObject *op2, long intval,
                                     int inplace, int zerodivision_check);
#else
#define __Pyx_PyInt_AddObjC(op1, op2, intval, inplace, zerodivision_check)     \
  (inplace ? PyNumber_InPlaceAdd(op1, op2) : PyNumber_Add(op1, op2))
#endif

/* PyIntBinop.proto */
#if !CYTHON_COMPILING_IN_PYPY
static PyObject *__Pyx_PyInt_SubtractObjC(PyObject *op1, PyObject *op2,
                                          long intval, int inplace,
                                          int zerodivision_check);
#else
#define __Pyx_PyInt_SubtractObjC(op1, op2, intval, inplace,                    \
                                 zerodivision_check)                           \
  (inplace ? PyNumber_InPlaceSubtract(op1, op2) : PyNumber_Subtract(op1, op2))
#endif

/* ListAppend.proto */
#if CYTHON_USE_PYLIST_INTERNALS && CYTHON_ASSUME_SAFE_MACROS
static CYTHON_INLINE int __Pyx_PyList_Append(PyObject *list, PyObject *x) {
  PyListObject *L = (PyListObject *)list;
  Py_ssize_t len = Py_SIZE(list);
  if (likely(L->allocated > len) & likely(len > (L->allocated >> 1))) {
    Py_INCREF(x);
    PyList_SET_ITEM(list, len, x);
    __Pyx_SET_SIZE(list, len + 1);
    return 0;
  }
  return PyList_Append(list, x);
}
#else
#define __Pyx_PyList_Append(L, x) PyList_Append(L, x)
#endif

/* PyObjectGetMethod.proto */
static int __Pyx_PyObject_GetMethod(PyObject *obj, PyObject *name,
                                    PyObject **method);

/* PyObjectCallMethod1.proto */
static PyObject *
__Pyx_PyObject_CallMethod1(PyObject *obj, PyObject *method_name, PyObject *arg);

/* append.proto */
static CYTHON_INLINE int __Pyx_PyObject_Append(PyObject *L, PyObject *x);

/* None.proto */
static CYTHON_INLINE void __Pyx_RaiseClosureNameError(const char *varname);

/* PyFloatBinop.proto */
#if !CYTHON_COMPILING_IN_PYPY
static PyObject *__Pyx_PyFloat_TrueDivideObjC(PyObject *op1, PyObject *op2,
                                              double floatval, int inplace,
                                              int zerodivision_check);
#else
#define __Pyx_PyFloat_TrueDivideObjC(op1, op2, floatval, inplace,              \
                                     zerodivision_check)                       \
  (inplace ? PyNumber_InPlaceTrueDivide(op1, op2)                              \
           : PyNumber_TrueDivide(op1, op2))
#endif

/* FetchCommonType.proto */
static PyTypeObject *__Pyx_FetchCommonType(PyTypeObject *type);

/* CythonFunctionShared.proto */
#define __Pyx_CyFunction_USED 1
#define __Pyx_CYFUNCTION_STATICMETHOD 0x01
#define __Pyx_CYFUNCTION_CLASSMETHOD 0x02
#define __Pyx_CYFUNCTION_CCLASS 0x04
#define __Pyx_CyFunction_GetClosure(f)                                         \
  (((__pyx_CyFunctionObject *)(f))->func_closure)
#define __Pyx_CyFunction_GetClassObj(f)                                        \
  (((__pyx_CyFunctionObject *)(f))->func_classobj)
#define __Pyx_CyFunction_Defaults(type, f)                                     \
  ((type *)(((__pyx_CyFunctionObject *)(f))->defaults))
#define __Pyx_CyFunction_SetDefaultsGetter(f, g)                               \
  ((__pyx_CyFunctionObject *)(f))->defaults_getter = (g)
typedef struct {
  PyCFunctionObject func;
#if PY_VERSION_HEX < 0x030500A0
  PyObject *func_weakreflist;
#endif
  PyObject *func_dict;
  PyObject *func_name;
  PyObject *func_qualname;
  PyObject *func_doc;
  PyObject *func_globals;
  PyObject *func_code;
  PyObject *func_closure;
  PyObject *func_classobj;
  void *defaults;
  int defaults_pyobjects;
  size_t defaults_size; // used by FusedFunction for copying defaults
  int flags;
  PyObject *defaults_tuple;
  PyObject *defaults_kwdict;
  PyObject *(*defaults_getter)(PyObject *);
  PyObject *func_annotations;
} __pyx_CyFunctionObject;
static PyTypeObject *__pyx_CyFunctionType = 0;
#define __Pyx_CyFunction_Check(obj) (__Pyx_TypeCheck(obj, __pyx_CyFunctionType))
static PyObject *__Pyx_CyFunction_Init(__pyx_CyFunctionObject *op,
                                       PyMethodDef *ml, int flags,
                                       PyObject *qualname, PyObject *self,
                                       PyObject *module, PyObject *globals,
                                       PyObject *code);
static CYTHON_INLINE void *
__Pyx_CyFunction_InitDefaults(PyObject *m, size_t size, int pyobjects);
static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsTuple(PyObject *m,
                                                            PyObject *tuple);
static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsKwDict(PyObject *m,
                                                             PyObject *dict);
static CYTHON_INLINE void __Pyx_CyFunction_SetAnnotationsDict(PyObject *m,
                                                              PyObject *dict);
static int __pyx_CyFunction_init(void);

/* CythonFunction.proto */
static PyObject *__Pyx_CyFunction_New(PyMethodDef *ml, int flags,
                                      PyObject *qualname, PyObject *closure,
                                      PyObject *module, PyObject *globals,
                                      PyObject *code);

/* PyDictContains.proto */
static CYTHON_INLINE int __Pyx_PyDict_ContainsTF(PyObject *item, PyObject *dict,
                                                 int eq) {
  int result = PyDict_Contains(dict, item);
  return unlikely(result < 0) ? result : (result == (eq == Py_EQ));
}

/* DictGetItem.proto */
#if PY_MAJOR_VERSION >= 3 && !CYTHON_COMPILING_IN_PYPY
static PyObject *__Pyx_PyDict_GetItem(PyObject *d, PyObject *key);
#define __Pyx_PyObject_Dict_GetItem(obj, name)                                 \
  (likely(PyDict_CheckExact(obj)) ? __Pyx_PyDict_GetItem(obj, name)            \
                                  : PyObject_GetItem(obj, name))
#else
#define __Pyx_PyDict_GetItem(d, key) PyObject_GetItem(d, key)
#define __Pyx_PyObject_Dict_GetItem(obj, name) PyObject_GetItem(obj, name)
#endif

/* py_dict_items.proto */
static CYTHON_INLINE PyObject *__Pyx_PyDict_Items(PyObject *d);

/* UnpackUnboundCMethod.proto */
typedef struct {
  PyObject *type;
  PyObject **method_name;
  PyCFunction func;
  PyObject *method;
  int flag;
} __Pyx_CachedCFunction;

/* CallUnboundCMethod0.proto */
static PyObject *__Pyx__CallUnboundCMethod0(__Pyx_CachedCFunction *cfunc,
                                            PyObject *self);
#if CYTHON_COMPILING_IN_CPYTHON
#define __Pyx_CallUnboundCMethod0(cfunc, self)                                                 \
  (likely((cfunc)->func)                                                                       \
       ? (likely((cfunc)->flag == METH_NOARGS)                                                 \
              ? (*((cfunc)->func))(self, NULL)                                                 \
              : (PY_VERSION_HEX >= 0x030600B1 &&                                               \
                         likely((cfunc)->flag == METH_FASTCALL)                                \
                     ? (PY_VERSION_HEX >= 0x030700A0                                           \
                            ? (*(__Pyx_PyCFunctionFast)(void                                   \
                                                            *)(PyCFunction)(cfunc)             \
                                    ->func)(self, &__pyx_empty_tuple, 0)                       \
                            : (*(__Pyx_PyCFunctionFastWithKeywords)(void                       \
                                                                        *)(PyCFunction)(cfunc) \
                                    ->func)(self, &__pyx_empty_tuple, 0,                       \
                                            NULL))                                             \
                     : (PY_VERSION_HEX >= 0x030700A0 &&                                        \
                                (cfunc)->flag ==                                               \
                                    (METH_FASTCALL | METH_KEYWORDS)                            \
                            ? (*(__Pyx_PyCFunctionFastWithKeywords)(void                       \
                                                                        *)(PyCFunction)(cfunc) \
                                    ->func)(self, &__pyx_empty_tuple, 0, NULL)                 \
                            : (likely((cfunc)->flag ==                                         \
                                      (METH_VARARGS | METH_KEYWORDS))                          \
                                   ? ((*(PyCFunctionWithKeywords)(void                         \
                                                                      *)(PyCFunction)(cfunc)   \
                                            ->func)(self, __pyx_empty_tuple,                   \
                                                    NULL))                                     \
                                   : ((cfunc)->flag == METH_VARARGS                            \
                                          ? (*((cfunc)->func))(                                \
                                                self, __pyx_empty_tuple)                       \
                                          : __Pyx__CallUnboundCMethod0(                        \
                                                cfunc, self))))))                              \
       : __Pyx__CallUnboundCMethod0(cfunc, self))
#else
#define __Pyx_CallUnboundCMethod0(cfunc, self)                                 \
  __Pyx__CallUnboundCMethod0(cfunc, self)
#endif

/* RaiseTooManyValuesToUnpack.proto */
static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected);

/* RaiseNeedMoreValuesToUnpack.proto */
static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index);

/* IterFinish.proto */
static CYTHON_INLINE int __Pyx_IterFinish(void);

/* UnpackItemEndCheck.proto */
static int __Pyx_IternextUnpackEndCheck(PyObject *retval, Py_ssize_t expected);

/* pyobject_as_double.proto */
static double __Pyx__PyObject_AsDouble(PyObject *obj);
#if CYTHON_COMPILING_IN_PYPY
#define __Pyx_PyObject_AsDouble(obj)                                           \
  (likely(PyFloat_CheckExact(obj)) ? PyFloat_AS_DOUBLE(obj)                    \
   : likely(PyInt_CheckExact(obj)) ? PyFloat_AsDouble(obj)                     \
                                   : __Pyx__PyObject_AsDouble(obj))
#else
#define __Pyx_PyObject_AsDouble(obj)                                           \
  ((likely(PyFloat_CheckExact(obj))) ? PyFloat_AS_DOUBLE(obj)                  \
                                     : __Pyx__PyObject_AsDouble(obj))
#endif

/* PyObjectLookupSpecial.proto */
#if CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
static CYTHON_INLINE PyObject *
__Pyx_PyObject_LookupSpecial(PyObject *obj, PyObject *attr_name) {
  PyObject *res;
  PyTypeObject *tp = Py_TYPE(obj);
#if PY_MAJOR_VERSION < 3
  if (unlikely(PyInstance_Check(obj)))
    return __Pyx_PyObject_GetAttrStr(obj, attr_name);
#endif
  res = _PyType_Lookup(tp, attr_name);
  if (likely(res)) {
    descrgetfunc f = Py_TYPE(res)->tp_descr_get;
    if (!f) {
      Py_INCREF(res);
    } else {
      res = f(res, obj, (PyObject *)tp);
    }
  } else {
    PyErr_SetObject(PyExc_AttributeError, attr_name);
  }
  return res;
}
#else
#define __Pyx_PyObject_LookupSpecial(o, n) __Pyx_PyObject_GetAttrStr(o, n)
#endif

/* GetTopmostException.proto */
#if CYTHON_USE_EXC_INFO_STACK
static _PyErr_StackItem *__Pyx_PyErr_GetTopmostException(PyThreadState *tstate);
#endif

/* PyThreadStateGet.proto */
#if CYTHON_FAST_THREAD_STATE
#define __Pyx_PyThreadState_declare PyThreadState *__pyx_tstate;
#define __Pyx_PyThreadState_assign __pyx_tstate = __Pyx_PyThreadState_Current;
#define __Pyx_PyErr_Occurred() __pyx_tstate->curexc_type
#else
#define __Pyx_PyThreadState_declare
#define __Pyx_PyThreadState_assign
#define __Pyx_PyErr_Occurred() PyErr_Occurred()
#endif

/* SaveResetException.proto */
#if CYTHON_FAST_THREAD_STATE
#define __Pyx_ExceptionSave(type, value, tb)                                   \
  __Pyx__ExceptionSave(__pyx_tstate, type, value, tb)
static CYTHON_INLINE void __Pyx__ExceptionSave(PyThreadState *tstate,
                                               PyObject **type,
                                               PyObject **value, PyObject **tb);
#define __Pyx_ExceptionReset(type, value, tb)                                  \
  __Pyx__ExceptionReset(__pyx_tstate, type, value, tb)
static CYTHON_INLINE void __Pyx__ExceptionReset(PyThreadState *tstate,
                                                PyObject *type, PyObject *value,
                                                PyObject *tb);
#else
#define __Pyx_ExceptionSave(type, value, tb) PyErr_GetExcInfo(type, value, tb)
#define __Pyx_ExceptionReset(type, value, tb) PyErr_SetExcInfo(type, value, tb)
#endif

/* GetException.proto */
#if CYTHON_FAST_THREAD_STATE
#define __Pyx_GetException(type, value, tb)                                    \
  __Pyx__GetException(__pyx_tstate, type, value, tb)
static int __Pyx__GetException(PyThreadState *tstate, PyObject **type,
                               PyObject **value, PyObject **tb);
#else
static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb);
#endif

/* PyErrFetchRestore.proto */
#if CYTHON_FAST_THREAD_STATE
#define __Pyx_PyErr_Clear() __Pyx_ErrRestore(NULL, NULL, NULL)
#define __Pyx_ErrRestoreWithState(type, value, tb)                             \
  __Pyx_ErrRestoreInState(PyThreadState_GET(), type, value, tb)
#define __Pyx_ErrFetchWithState(type, value, tb)                               \
  __Pyx_ErrFetchInState(PyThreadState_GET(), type, value, tb)
#define __Pyx_ErrRestore(type, value, tb)                                      \
  __Pyx_ErrRestoreInState(__pyx_tstate, type, value, tb)
#define __Pyx_ErrFetch(type, value, tb)                                        \
  __Pyx_ErrFetchInState(__pyx_tstate, type, value, tb)
static CYTHON_INLINE void __Pyx_ErrRestoreInState(PyThreadState *tstate,
                                                  PyObject *type,
                                                  PyObject *value,
                                                  PyObject *tb);
static CYTHON_INLINE void __Pyx_ErrFetchInState(PyThreadState *tstate,
                                                PyObject **type,
                                                PyObject **value,
                                                PyObject **tb);
#if CYTHON_COMPILING_IN_CPYTHON
#define __Pyx_PyErr_SetNone(exc)                                               \
  (Py_INCREF(exc), __Pyx_ErrRestore((exc), NULL, NULL))
#else
#define __Pyx_PyErr_SetNone(exc) PyErr_SetNone(exc)
#endif
#else
#define __Pyx_PyErr_Clear() PyErr_Clear()
#define __Pyx_PyErr_SetNone(exc) PyErr_SetNone(exc)
#define __Pyx_ErrRestoreWithState(type, value, tb)                             \
  PyErr_Restore(type, value, tb)
#define __Pyx_ErrFetchWithState(type, value, tb) PyErr_Fetch(type, value, tb)
#define __Pyx_ErrRestoreInState(tstate, type, value, tb)                       \
  PyErr_Restore(type, value, tb)
#define __Pyx_ErrFetchInState(tstate, type, value, tb)                         \
  PyErr_Fetch(type, value, tb)
#define __Pyx_ErrRestore(type, value, tb) PyErr_Restore(type, value, tb)
#define __Pyx_ErrFetch(type, value, tb) PyErr_Fetch(type, value, tb)
#endif

/* py_abs.proto */
#if CYTHON_USE_PYLONG_INTERNALS
static PyObject *__Pyx_PyLong_AbsNeg(PyObject *num);
#define __Pyx_PyNumber_Absolute(x)                                             \
  ((likely(PyLong_CheckExact(x)))                                              \
       ? (likely(Py_SIZE(x) >= 0) ? (Py_INCREF(x), (x))                        \
                                  : __Pyx_PyLong_AbsNeg(x))                    \
       : PyNumber_Absolute(x))
#else
#define __Pyx_PyNumber_Absolute(x) PyNumber_Absolute(x)
#endif

/* PyIntCompare.proto */
static CYTHON_INLINE PyObject *__Pyx_PyInt_NeObjC(PyObject *op1, PyObject *op2,
                                                  long intval, long inplace);

/* PyErrExceptionMatches.proto */
#if CYTHON_FAST_THREAD_STATE
#define __Pyx_PyErr_ExceptionMatches(err)                                      \
  __Pyx_PyErr_ExceptionMatchesInState(__pyx_tstate, err)
static CYTHON_INLINE int
__Pyx_PyErr_ExceptionMatchesInState(PyThreadState *tstate, PyObject *err);
#else
#define __Pyx_PyErr_ExceptionMatches(err) PyErr_ExceptionMatches(err)
#endif

/* ListExtend.proto */
static CYTHON_INLINE int __Pyx_PyList_Extend(PyObject *L, PyObject *v) {
#if CYTHON_COMPILING_IN_CPYTHON
  PyObject *none = _PyList_Extend((PyListObject *)L, v);
  if (unlikely(!none))
    return -1;
  Py_DECREF(none);
  return 0;
#else
  return PyList_SetSlice(L, PY_SSIZE_T_MAX, PY_SSIZE_T_MAX, v);
#endif
}

/* PyIntBinop.proto */
#if !CYTHON_COMPILING_IN_PYPY
static PyObject *__Pyx_PyInt_AndObjC(PyObject *op1, PyObject *op2, long intval,
                                     int inplace, int zerodivision_check);
#else
#define __Pyx_PyInt_AndObjC(op1, op2, intval, inplace, zerodivision_check)     \
  (inplace ? PyNumber_InPlaceAnd(op1, op2) : PyNumber_And(op1, op2))
#endif

/* dict_getitem_default.proto */
static PyObject *__Pyx_PyDict_GetItemDefault(PyObject *d, PyObject *key,
                                             PyObject *default_value);

/* CallUnboundCMethod1.proto */
static PyObject *__Pyx__CallUnboundCMethod1(__Pyx_CachedCFunction *cfunc,
                                            PyObject *self, PyObject *arg);
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject *
__Pyx_CallUnboundCMethod1(__Pyx_CachedCFunction *cfunc, PyObject *self,
                          PyObject *arg);
#else
#define __Pyx_CallUnboundCMethod1(cfunc, self, arg)                            \
  __Pyx__CallUnboundCMethod1(cfunc, self, arg)
#endif

/* CallUnboundCMethod2.proto */
static PyObject *__Pyx__CallUnboundCMethod2(__Pyx_CachedCFunction *cfunc,
                                            PyObject *self, PyObject *arg1,
                                            PyObject *arg2);
#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x030600B1
static CYTHON_INLINE PyObject *
__Pyx_CallUnboundCMethod2(__Pyx_CachedCFunction *cfunc, PyObject *self,
                          PyObject *arg1, PyObject *arg2);
#else
#define __Pyx_CallUnboundCMethod2(cfunc, self, arg1, arg2)                     \
  __Pyx__CallUnboundCMethod2(cfunc, self, arg1, arg2)
#endif

/* PyFloatBinop.proto */
#if !CYTHON_COMPILING_IN_PYPY
static PyObject *__Pyx_PyFloat_AddObjC(PyObject *op1, PyObject *op2,
                                       double floatval, int inplace,
                                       int zerodivision_check);
#else
#define __Pyx_PyFloat_AddObjC(op1, op2, floatval, inplace, zerodivision_check) \
  (inplace ? PyNumber_InPlaceAdd(op1, op2) : PyNumber_Add(op1, op2))
#endif

/* PyFloatBinop.proto */
#if !CYTHON_COMPILING_IN_PYPY
static PyObject *__Pyx_PyFloat_SubtractCObj(PyObject *op1, PyObject *op2,
                                            double floatval, int inplace,
                                            int zerodivision_check);
#else
#define __Pyx_PyFloat_SubtractCObj(op1, op2, floatval, inplace,                \
                                   zerodivision_check)                         \
  (inplace ? PyNumber_InPlaceSubtract(op1, op2) : PyNumber_Subtract(op1, op2))
#endif

/* IncludeStringH.proto */
#include <string.h>

/* PyObject_GenericGetAttrNoDict.proto */
#if CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP &&                       \
    PY_VERSION_HEX < 0x03070000
static CYTHON_INLINE PyObject *
__Pyx_PyObject_GenericGetAttrNoDict(PyObject *obj, PyObject *attr_name);
#else
#define __Pyx_PyObject_GenericGetAttrNoDict PyObject_GenericGetAttr
#endif

/* Import.proto */
static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level);

/* ImportFrom.proto */
static PyObject *__Pyx_ImportFrom(PyObject *module, PyObject *name);

/* CalculateMetaclass.proto */
static PyObject *__Pyx_CalculateMetaclass(PyTypeObject *metaclass,
                                          PyObject *bases);

/* SetNameInClass.proto */
#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x030500A1
#define __Pyx_SetNameInClass(ns, name, value)                                  \
  (likely(PyDict_CheckExact(ns))                                               \
       ? _PyDict_SetItem_KnownHash(ns, name, value,                            \
                                   ((PyASCIIObject *)name)->hash)              \
       : PyObject_SetItem(ns, name, value))
#elif CYTHON_COMPILING_IN_CPYTHON
#define __Pyx_SetNameInClass(ns, name, value)                                  \
  (likely(PyDict_CheckExact(ns)) ? PyDict_SetItem(ns, name, value)             \
                                 : PyObject_SetItem(ns, name, value))
#else
#define __Pyx_SetNameInClass(ns, name, value) PyObject_SetItem(ns, name, value)
#endif

/* ClassMethod.proto */
#include "descrobject.h"
static CYTHON_UNUSED PyObject *__Pyx_Method_ClassMethod(PyObject *method);

/* Py3ClassCreate.proto */
static PyObject *__Pyx_Py3MetaclassPrepare(PyObject *metaclass, PyObject *bases,
                                           PyObject *name, PyObject *qualname,
                                           PyObject *mkw, PyObject *modname,
                                           PyObject *doc);
static PyObject *__Pyx_Py3ClassCreate(PyObject *metaclass, PyObject *name,
                                      PyObject *bases, PyObject *dict,
                                      PyObject *mkw, int calculate_metaclass,
                                      int allow_py2_metaclass);

/* CLineInTraceback.proto */
#ifdef CYTHON_CLINE_IN_TRACEBACK
#define __Pyx_CLineForTraceback(tstate, c_line)                                \
  (((CYTHON_CLINE_IN_TRACEBACK)) ? c_line : 0)
#else
static int __Pyx_CLineForTraceback(PyThreadState *tstate, int c_line);
#endif

/* CodeObjectCache.proto */
typedef struct {
  PyCodeObject *code_object;
  int code_line;
} __Pyx_CodeObjectCacheEntry;
struct __Pyx_CodeObjectCache {
  int count;
  int max_count;
  __Pyx_CodeObjectCacheEntry *entries;
};
static struct __Pyx_CodeObjectCache __pyx_code_cache = {0, 0, NULL};
static int __pyx_bisect_code_objects(__Pyx_CodeObjectCacheEntry *entries,
                                     int count, int code_line);
static PyCodeObject *__pyx_find_code_object(int code_line);
static void __pyx_insert_code_object(int code_line, PyCodeObject *code_object);

/* AddTraceback.proto */
static void __Pyx_AddTraceback(const char *funcname, int c_line, int py_line,
                               const char *filename);

/* GCCDiagnostics.proto */
#if defined(__GNUC__) &&                                                       \
    (__GNUC__ > 4 || (__GNUC__ == 4 && __GNUC_MINOR__ >= 6))
#define __Pyx_HAS_GCC_DIAGNOSTIC
#endif

/* CIntToPy.proto */
static CYTHON_INLINE PyObject *__Pyx_PyInt_From_long(long value);

/* CIntFromPy.proto */
static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *);

/* CIntFromPy.proto */
static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *);

/* FastTypeChecks.proto */
#if CYTHON_COMPILING_IN_CPYTHON
#define __Pyx_TypeCheck(obj, type)                                             \
  __Pyx_IsSubtype(Py_TYPE(obj), (PyTypeObject *)type)
static CYTHON_INLINE int __Pyx_IsSubtype(PyTypeObject *a, PyTypeObject *b);
static CYTHON_INLINE int __Pyx_PyErr_GivenExceptionMatches(PyObject *err,
                                                           PyObject *type);
static CYTHON_INLINE int __Pyx_PyErr_GivenExceptionMatches2(PyObject *err,
                                                            PyObject *type1,
                                                            PyObject *type2);
#else
#define __Pyx_TypeCheck(obj, type) PyObject_TypeCheck(obj, (PyTypeObject *)type)
#define __Pyx_PyErr_GivenExceptionMatches(err, type)                           \
  PyErr_GivenExceptionMatches(err, type)
#define __Pyx_PyErr_GivenExceptionMatches2(err, type1, type2)                  \
  (PyErr_GivenExceptionMatches(err, type1) ||                                  \
   PyErr_GivenExceptionMatches(err, type2))
#endif
#define __Pyx_PyException_Check(obj) __Pyx_TypeCheck(obj, PyExc_Exception)

/* CStringEquals.proto */
static CYTHON_INLINE int __Pyx_StrEq(const char *, const char *);

/* CheckBinaryVersion.proto */
static int __Pyx_check_binary_version(void);

/* InitStrings.proto */
static int __Pyx_InitStrings(__Pyx_StringTabEntry *t);

/* Module declarations from 'pyg4ometry.pycsg.core' */
static PyTypeObject
    *__pyx_ptype_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate = 0;
static PyTypeObject
    *__pyx_ptype_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere = 0;
static PyTypeObject
    *__pyx_ptype_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder = 0;
static PyTypeObject
    *__pyx_ptype_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone = 0;
#define __Pyx_MODULE_NAME "pyg4ometry.pycsg.core"
extern int __pyx_module_is_main_pyg4ometry__pycsg__core;
int __pyx_module_is_main_pyg4ometry__pycsg__core = 0;

/* Implementation of 'pyg4ometry.pycsg.core' */
static PyObject *__pyx_builtin_object;
static PyObject *__pyx_builtin_range;
static PyObject *__pyx_builtin_sorted;
static PyObject *__pyx_builtin_open;
static PyObject *__pyx_builtin_ZeroDivisionError;
static PyObject *__pyx_builtin_map;
static const char __pyx_k_0[] = "{0} ";
static const char __pyx_k_a[] = "a";
static const char __pyx_k_b[] = "b";
static const char __pyx_k_c[] = "c";
static const char __pyx_k_d[] = "d";
static const char __pyx_k_e[] = "e";
static const char __pyx_k_f[] = "f";
static const char __pyx_k_i[] = "i";
static const char __pyx_k_j[] = "j";
static const char __pyx_k_p[] = "p";
static const char __pyx_k_r[] = "r";
static const char __pyx_k_s[] = "s";
static const char __pyx_k_t[] = "t";
static const char __pyx_k_v[] = "v";
static const char __pyx_k_w[] = "w";
static const char __pyx_k_x[] = "x";
static const char __pyx_k_y[] = "y";
static const char __pyx_k_z[] = "z";
static const char __pyx_k__3[] = ",";
static const char __pyx_k__4[] = "\n";
static const char __pyx_k_a0[] = "a0";
static const char __pyx_k_av[] = "av";
static const char __pyx_k_ax[] = "ax";
static const char __pyx_k_b0[] = "b0";
static const char __pyx_k_bv[] = "bv";
static const char __pyx_k_dt[] = "dt";
static const char __pyx_k_i0[] = "i0";
static const char __pyx_k_i1[] = "i1";
static const char __pyx_k_i2[] = "i2";
static const char __pyx_k_j0[] = "j0";
static const char __pyx_k_j1[] = "j1";
static const char __pyx_k_j2[] = "j2";
static const char __pyx_k_n0[] = "n0";
static const char __pyx_k_n1[] = "n1";
static const char __pyx_k_np[] = "_np";
static const char __pyx_k_p0[] = "p0";
static const char __pyx_k_p1[] = "p1";
static const char __pyx_k_p2[] = "p2";
static const char __pyx_k_pi[] = "pi";
static const char __pyx_k_t0[] = "t0";
static const char __pyx_k_t1[] = "t1";
static const char __pyx_k_u1[] = "u1";
static const char __pyx_k_u2[] = "u2";
static const char __pyx_k_vA[] = "vA";
static const char __pyx_k_vs[] = "vs";
static const char __pyx_k_CSG[] = "CSG";
static const char __pyx_k__23[] = "*";
static const char __pyx_k_add[] = "add";
static const char __pyx_k_cls[] = "cls";
static const char __pyx_k_cos[] = "cos";
static const char __pyx_k_csg[] = "csg";
static const char __pyx_k_doc[] = "__doc__";
static const char __pyx_k_dot[] = "dot";
static const char __pyx_k_end[] = "end";
static const char __pyx_k_get[] = "get";
static const char __pyx_k_isY[] = "isY";
static const char __pyx_k_key[] = "key";
static const char __pyx_k_loc[] = "loc";
static const char __pyx_k_map[] = "map";
static const char __pyx_k_md5[] = "_md5";
static const char __pyx_k_mul[] = "__mul__";
static const char __pyx_k_out[] = "out";
static const char __pyx_k_phi[] = "phi";
static const char __pyx_k_pos[] = "pos";
static const char __pyx_k_ray[] = "ray";
static const char __pyx_k_sin[] = "sin";
static const char __pyx_k_sub[] = "__sub__";
static const char __pyx_k_BACK[] = "BACK";
static const char __pyx_k_aAdd[] = "aAdd";
static const char __pyx_k_absp[] = "absp";
static const char __pyx_k_axis[] = "axis";
static const char __pyx_k_bbsp[] = "bbsp";
static const char __pyx_k_cell[] = "cell";
static const char __pyx_k_cone[] = "cone";
static const char __pyx_k_copl[] = "copl";
static const char __pyx_k_cube[] = "cube";
static const char __pyx_k_dPhi[] = "dPhi";
static const char __pyx_k_disp[] = "disp";
static const char __pyx_k_exit[] = "__exit__";
static const char __pyx_k_fabs[] = "fabs";
static const char __pyx_k_flip[] = "flip";
static const char __pyx_k_geom[] = "geom";
static const char __pyx_k_hash[] = "__hash__";
static const char __pyx_k_hull[] = "hull";
static const char __pyx_k_init[] = "__init__";
static const char __pyx_k_main[] = "__main__";
static const char __pyx_k_nAvg[] = "nAvg";
static const char __pyx_k_name[] = "__name__";
static const char __pyx_k_open[] = "open";
static const char __pyx_k_ploc[] = "ploc";
static const char __pyx_k_plus[] = "plus";
static const char __pyx_k_poly[] = "poly";
static const char __pyx_k_self[] = "self";
static const char __pyx_k_soln[] = "soln";
static const char __pyx_k_test[] = "__test__";
static const char __pyx_k_unit[] = "unit";
static const char __pyx_k_vKey[] = "vKey";
static const char __pyx_k_vert[] = "vert";
static const char __pyx_k_0_1_2[] = "{0} {1} {2}\n";
static const char __pyx_k_ASCII[] = "ASCII\n";
static const char __pyx_k_FRONT[] = "FRONT";
static const char __pyx_k_add_2[] = "__add__";
static const char __pyx_k_adist[] = "adist";
static const char __pyx_k_angle[] = "angle";
static const char __pyx_k_apoly[] = "apoly";
static const char __pyx_k_array[] = "array";
static const char __pyx_k_atan2[] = "atan2";
static const char __pyx_k_axisX[] = "axisX";
static const char __pyx_k_axisY[] = "axisY";
static const char __pyx_k_axisZ[] = "axisZ";
static const char __pyx_k_bdist[] = "bdist";
static const char __pyx_k_bpOnA[] = "bpOnA";
static const char __pyx_k_bpoly[] = "bpoly";
static const char __pyx_k_build[] = "build";
static const char __pyx_k_bvOnA[] = "bvOnA";
static const char __pyx_k_cells[] = "cells";
static const char __pyx_k_clone[] = "clone";
static const char __pyx_k_count[] = "count";
static const char __pyx_k_cross[] = "cross";
static const char __pyx_k_denom[] = "denom";
static const char __pyx_k_enter[] = "__enter__";
static const char __pyx_k_first[] = "first";
static const char __pyx_k_index[] = "index";
static const char __pyx_k_inter[] = "inter";
static const char __pyx_k_items[] = "items";
static const char __pyx_k_md5_2[] = "md5";
static const char __pyx_k_minus[] = "minus";
static const char __pyx_k_nhull[] = "nhull";
static const char __pyx_k_numpy[] = "numpy";
static const char __pyx_k_plane[] = "plane";
static const char __pyx_k_point[] = "point";
static const char __pyx_k_polys[] = "polys";
static const char __pyx_k_q_now[] = "q_now";
static const char __pyx_k_range[] = "range";
static const char __pyx_k_scale[] = "scale";
static const char __pyx_k_split[] = "split";
static const char __pyx_k_stack[] = "stack";
static const char __pyx_k_start[] = "start";
static const char __pyx_k_theta[] = "theta";
static const char __pyx_k_times[] = "times";
static const char __pyx_k_union[] = "union";
static const char __pyx_k_vCosA[] = "vCosA";
static const char __pyx_k_vPerp[] = "vPerp";
static const char __pyx_k_vSinA[] = "vSinA";
static const char __pyx_k_verts[] = "verts";
static const char __pyx_k_write[] = "write";
static const char __pyx_k_Vector[] = "Vector";
static const char __pyx_k_Vertex[] = "Vertex";
static const char __pyx_k_andist[] = "andist";
static const char __pyx_k_aplane[] = "aplane";
static const char __pyx_k_append[] = "append";
static const char __pyx_k_avunit[] = "avunit";
static const char __pyx_k_bplane[] = "bplane";
static const char __pyx_k_bvunit[] = "bvunit";
static const char __pyx_k_center[] = "center";
static const char __pyx_k_clipTo[] = "clipTo";
static const char __pyx_k_dTheta[] = "dTheta";
static const char __pyx_k_encode[] = "encode";
static const char __pyx_k_format[] = "format";
static const char __pyx_k_import[] = "__import__";
static const char __pyx_k_invert[] = "invert";
static const char __pyx_k_isNull[] = "isNull";
static const char __pyx_k_kwargs[] = "kwargs";
static const char __pyx_k_length[] = "length";
static const char __pyx_k_midPos[] = "midPos";
static const char __pyx_k_module[] = "__module__";
static const char __pyx_k_newCSG[] = "newCSG";
static const char __pyx_k_normal[] = "normal";
static const char __pyx_k_object[] = "object";
static const char __pyx_k_offset[] = "offset";
static const char __pyx_k_points[] = "points";
static const char __pyx_k_q_next[] = "q_next";
static const char __pyx_k_radius[] = "radius";
static const char __pyx_k_reduce[] = "reduce";
static const char __pyx_k_refine[] = "refine";
static const char __pyx_k_rotate[] = "rotate";
static const char __pyx_k_second[] = "second";
static const char __pyx_k_shared[] = "shared";
static const char __pyx_k_slices[] = "slices";
static const char __pyx_k_sorted[] = "sorted";
static const char __pyx_k_sphere[] = "sphere";
static const char __pyx_k_stacks[] = "stacks";
static const char __pyx_k_vCount[] = "vCount";
static const char __pyx_k_BSPNode[] = "BSPNode";
static const char __pyx_k_Polygon[] = "Polygon";
static const char __pyx_k_aInterB[] = "aInterB";
static const char __pyx_k_anormal[] = "anormal";
static const char __pyx_k_hashlib[] = "hashlib";
static const char __pyx_k_inverse[] = "inverse";
static const char __pyx_k_midVert[] = "midVert";
static const char __pyx_k_negated[] = "negated";
static const char __pyx_k_newPoly[] = "newPoly";
static const char __pyx_k_polygon[] = "polygon";
static const char __pyx_k_prepare[] = "__prepare__";
static const char __pyx_k_saveVTK[] = "saveVTK";
static const char __pyx_k_COPLANAR[] = "COPLANAR";
static const char __pyx_k_CSG_cone[] = "CSG.cone";
static const char __pyx_k_CSG_cube[] = "CSG.cube";
static const char __pyx_k_Vector_2[] = "_Vector";
static const char __pyx_k_Vertex_2[] = "_Vertex";
static const char __pyx_k_aInsideB[] = "aInsideB";
static const char __pyx_k_angleDeg[] = "angleDeg";
static const char __pyx_k_bInsideA[] = "bInsideA";
static const char __pyx_k_checksum[] = "checksum";
static const char __pyx_k_coplanar[] = "coplanar";
static const char __pyx_k_cosAngle[] = "cosAngle";
static const char __pyx_k_cylinder[] = "cylinder";
static const char __pyx_k_filename[] = "filename";
static const char __pyx_k_newVerts[] = "newVerts";
static const char __pyx_k_numCells[] = "numCells";
static const char __pyx_k_numVerts[] = "numVerts";
static const char __pyx_k_operator[] = "operator";
static const char __pyx_k_polySide[] = "polySide";
static const char __pyx_k_polygons[] = "polygons";
static const char __pyx_k_qualname[] = "__qualname__";
static const char __pyx_k_sinAngle[] = "sinAngle";
static const char __pyx_k_subtract[] = "subtract";
static const char __pyx_k_testGeom[] = "testGeom";
static const char __pyx_k_vPerpLen[] = "vPerpLen";
static const char __pyx_k_vertices[] = "vertices";
static const char __pyx_k_CSG___add[] = "CSG.__add__";
static const char __pyx_k_CSG___mul[] = "CSG.__mul__";
static const char __pyx_k_CSG___sub[] = "CSG.__sub__";
static const char __pyx_k_CSG_clone[] = "CSG.clone";
static const char __pyx_k_CSG_scale[] = "CSG.scale";
static const char __pyx_k_CSG_union[] = "CSG.union";
static const char __pyx_k_apolygons[] = "apolygons";
static const char __pyx_k_as_string[] = "as_string";
static const char __pyx_k_bpolygons[] = "bpolygons";
static const char __pyx_k_functools[] = "functools";
static const char __pyx_k_hexdigest[] = "hexdigest";
static const char __pyx_k_intersect[] = "intersect";
static const char __pyx_k_metaclass[] = "__metaclass__";
static const char __pyx_k_midNormal[] = "midNormal";
static const char __pyx_k_newVector[] = "newVector";
static const char __pyx_k_polyStart[] = "polyStart";
static const char __pyx_k_positions[] = "positions";
static const char __pyx_k_translate[] = "translate";
static const char __pyx_k_verticesE[] = "verticesE";
static const char __pyx_k_verticesN[] = "verticesN";
static const char __pyx_k_verticesS[] = "verticesS";
static const char __pyx_k_verticesW[] = "verticesW";
static const char __pyx_k_CSG___hash[] = "CSG.__hash__";
static const char __pyx_k_CSG___init[] = "CSG.__init__";
static const char __pyx_k_CSG_isNull[] = "CSG.isNull";
static const char __pyx_k_CSG_refine[] = "CSG.refine";
static const char __pyx_k_CSG_rotate[] = "CSG.rotate";
static const char __pyx_k_CSG_sphere[] = "CSG.sphere";
static const char __pyx_k_convexHull[] = "convexHull";
static const char __pyx_k_itemgetter[] = "itemgetter";
static const char __pyx_k_taperAngle[] = "taperAngle";
static const char __pyx_k_toPolygons[] = "toPolygons";
static const char __pyx_k_vertsInter[] = "vertsInter";
static const char __pyx_k_10e_10e_10e[] = "%.10e,%.10e,%.10e";
static const char __pyx_k_CSG_inverse[] = "CSG.inverse";
static const char __pyx_k_CSG_saveVTK[] = "CSG.saveVTK";
static const char __pyx_k_allPolygons[] = "allPolygons";
static const char __pyx_k_interpolate[] = "interpolate";
static const char __pyx_k_normalBlend[] = "normalBlend";
static const char __pyx_k_polygonType[] = "polygonType";
static const char __pyx_k_startNormal[] = "startNormal";
static const char __pyx_k_vertexCount[] = "vertexCount";
static const char __pyx_k_vertsInside[] = "vertsInside";
static const char __pyx_k_CSG_coplanar[] = "CSG.coplanar";
static const char __pyx_k_CSG_cylinder[] = "CSG.cylinder";
static const char __pyx_k_CSG_subtract[] = "CSG.subtract";
static const char __pyx_k_POLYGONS_0_1[] = "POLYGONS {0} {1}\n";
static const char __pyx_k_aPlaneNormal[] = "aPlaneNormal";
static const char __pyx_k_appendVertex[] = "appendVertex";
static const char __pyx_k_array2string[] = "array2string";
static const char __pyx_k_do_intersect[] = "do_intersect";
static const char __pyx_k_fromPolygons[] = "fromPolygons";
static const char __pyx_k_polygonCount[] = "polygonCount";
static const char __pyx_k_pycsg_output[] = "pycsg output\n";
static const char __pyx_k_CSG_intersect[] = "CSG.intersect";
static const char __pyx_k_CSG_translate[] = "CSG.translate";
static const char __pyx_k_coplanarPolys[] = "coplanarPolys";
static const char __pyx_k_cosTaperAngle[] = "cosTaperAngle";
static const char __pyx_k_sinTaperAngle[] = "sinTaperAngle";
static const char __pyx_k_CSG_toPolygons[] = "CSG.toPolygons";
static const char __pyx_k_POINTS_0_float[] = "POINTS {0} float\n";
static const char __pyx_k_getNumberPolys[] = "getNumberPolys";
static const char __pyx_k_vertexIndexMap[] = "vertexIndexMap";
static const char __pyx_k_CSG_vertexCount[] = "CSG.vertexCount";
static const char __pyx_k_polyVertsInside[] = "polyVertsInside";
static const char __pyx_k_CSG_fromPolygons[] = "CSG.fromPolygons";
static const char __pyx_k_CSG_polygonCount[] = "CSG.polygonCount";
static const char __pyx_k_DATASET_POLYDATA[] = "DATASET POLYDATA\n";
static const char __pyx_k_ZeroDivisionError[] = "ZeroDivisionError";
static const char __pyx_k_sortedVertexIndex[] = "sortedVertexIndex";
static const char __pyx_k_CSG_getNumberPolys[] = "CSG.getNumberPolys";
static const char __pyx_k_cline_in_traceback[] = "cline_in_traceback";
static const char __pyx_k_coplanarIntersection[] = "coplanarIntersection";
static const char __pyx_k_polyEdgeIntersection[] = "polyEdgeIntersection";
static const char __pyx_k_CSG_cone_locals_point[] = "CSG.cone.<locals>.point";
static const char __pyx_k_pyg4ometry_pycsg_core[] = "pyg4ometry.pycsg.core";
static const char __pyx_k_toVerticesAndPolygons[] = "toVerticesAndPolygons";
static const char __pyx_k_CSG_coplanarIntersection[] =
    "CSG.coplanarIntersection";
static const char __pyx_k_vtk_DataFile_Version_3_0[] =
    "# vtk DataFile Version 3.0\n";
static const char __pyx_k_CSG_cylinder_locals_point[] =
    "CSG.cylinder.<locals>.point";
static const char __pyx_k_CSG_inverse_locals_lambda[] =
    "CSG.inverse.<locals>.<lambda>";
static const char __pyx_k_CSG_toVerticesAndPolygons[] =
    "CSG.toVerticesAndPolygons";
static const char __pyx_k_CSG_rotate_locals_newVector[] =
    "CSG.rotate.<locals>.newVector";
static const char __pyx_k_src_pyg4ometry_pycsg_core_pyx[] =
    "src/pyg4ometry/pycsg/core.pyx";
static const char __pyx_k_CSG_sphere_locals_appendVertex[] =
    "CSG.sphere.<locals>.appendVertex";
static const char __pyx_k_CSG_coplanarIntersection_locals[] =
    "CSG.coplanarIntersection.<locals>.coplanarPolys";
static const char __pyx_k_Constructive_Solid_Geometry_CSG[] =
    "\n    Constructive Solid Geometry (CSG) is a modeling technique that uses "
    "Boolean\n    operations like union and intersection to combine 3D solids. "
    "This library\n    implements CSG operations on meshes elegantly and "
    "concisely using BSP trees,\n    and is meant to serve as an easily "
    "understandable implementation of the\n    algorithm. All edge cases "
    "involving overlapping coplanar polygons in both\n    solids are correctly "
    "handled.\n    \n    Example usage::\n    \n        from csg.core import "
    "CSG\n        \n        cube = CSG.cube();\n        sphere = "
    "CSG.sphere({'radius': 1.3});\n        polygons = "
    "cube.subtract(sphere).toPolygons();\n    \n    ## Implementation "
    "Details\n    \n    All CSG operations are implemented in terms of two "
    "functions, `clipTo()` and\n    `invert()`, which remove parts of a BSP "
    "tree inside another BSP tree and swap\n    solid and empty space, "
    "respectively. To find the union of `a` and `b`, we\n    want to remove "
    "everything in `a` inside `b` and everything in `b` inside `a`,\n    then "
    "combine polygons from `a` and `b` into one solid::\n    \n        "
    "a.clipTo(b);\n        b.clipTo(a);\n        a.build(b.allPolygons());\n   "
    " \n    The only tricky part is handling overlapping coplanar polygons in "
    "both trees.\n    The code above keeps both copies, but we need to keep "
    "them in one tree and\n    remove them in the other tree. To remove them "
    "from `b` we can clip the\n    inverse of `b` against `a`. The code for "
    "union now looks like this::\n    \n        a.clipTo(b);\n        "
    "b.clipTo(a);\n        b.invert();\n        b.clipTo(a);\n        "
    "b.invert();\n        a.build(b.allPolygons());\n    \n    Subtraction and "
    "intersection naturally follow from set operations. If\n    union is `A | "
    "B`, subtraction is `A - B = ~(~A | B)` and intersection is\n    `A & B = "
    "~(~A | ~B)` where `~` is the complement operator.\n    \n    ## License\n "
    "   \n    Copyright (c) 2011 Evan Wallace (http://madebyevan.com/), under "
    "the MIT license.\n    \n    Python port Copyright (c) "
    "2012 Tim Knip (http://www.floorplanner.com), under the MIT license.\n    "
    "Additions by Alex Pletzer (Pennsylvania State University)\n    ";
static const char __pyx_k_CSG_coplanarIntersection_locals_2[] =
    "CSG.coplanarIntersection.<locals>.polyVertsInside";
static const char __pyx_k_CSG_coplanarIntersection_locals_3[] =
    "CSG.coplanarIntersection.<locals>.polyEdgeIntersection";
static const char __pyx_k_CSG_coplanarIntersection_locals_4[] =
    "CSG.coplanarIntersection.<locals>.convexHull";
static PyObject *__pyx_kp_u_0;
static PyObject *__pyx_kp_u_0_1_2;
static PyObject *__pyx_kp_u_10e_10e_10e;
static PyObject *__pyx_n_u_ASCII;
static PyObject *__pyx_n_s_BACK;
static PyObject *__pyx_n_s_BSPNode;
static PyObject *__pyx_n_s_COPLANAR;
static PyObject *__pyx_n_s_CSG;
static PyObject *__pyx_n_s_CSG___add;
static PyObject *__pyx_n_s_CSG___hash;
static PyObject *__pyx_n_s_CSG___init;
static PyObject *__pyx_n_s_CSG___mul;
static PyObject *__pyx_n_s_CSG___sub;
static PyObject *__pyx_n_s_CSG_clone;
static PyObject *__pyx_n_s_CSG_cone;
static PyObject *__pyx_n_s_CSG_cone_locals_point;
static PyObject *__pyx_n_s_CSG_coplanar;
static PyObject *__pyx_n_s_CSG_coplanarIntersection;
static PyObject *__pyx_n_s_CSG_coplanarIntersection_locals;
static PyObject *__pyx_n_s_CSG_coplanarIntersection_locals_2;
static PyObject *__pyx_n_s_CSG_coplanarIntersection_locals_3;
static PyObject *__pyx_n_s_CSG_coplanarIntersection_locals_4;
static PyObject *__pyx_n_s_CSG_cube;
static PyObject *__pyx_n_s_CSG_cylinder;
static PyObject *__pyx_n_s_CSG_cylinder_locals_point;
static PyObject *__pyx_n_s_CSG_fromPolygons;
static PyObject *__pyx_n_s_CSG_getNumberPolys;
static PyObject *__pyx_n_s_CSG_intersect;
static PyObject *__pyx_n_s_CSG_inverse;
static PyObject *__pyx_n_s_CSG_inverse_locals_lambda;
static PyObject *__pyx_n_s_CSG_isNull;
static PyObject *__pyx_n_s_CSG_polygonCount;
static PyObject *__pyx_n_s_CSG_refine;
static PyObject *__pyx_n_s_CSG_rotate;
static PyObject *__pyx_n_s_CSG_rotate_locals_newVector;
static PyObject *__pyx_n_s_CSG_saveVTK;
static PyObject *__pyx_n_s_CSG_scale;
static PyObject *__pyx_n_s_CSG_sphere;
static PyObject *__pyx_n_s_CSG_sphere_locals_appendVertex;
static PyObject *__pyx_n_s_CSG_subtract;
static PyObject *__pyx_n_s_CSG_toPolygons;
static PyObject *__pyx_n_s_CSG_toVerticesAndPolygons;
static PyObject *__pyx_n_s_CSG_translate;
static PyObject *__pyx_n_s_CSG_union;
static PyObject *__pyx_n_s_CSG_vertexCount;
static PyObject *__pyx_kp_s_Constructive_Solid_Geometry_CSG;
static PyObject *__pyx_kp_u_DATASET_POLYDATA;
static PyObject *__pyx_n_s_FRONT;
static PyObject *__pyx_kp_u_POINTS_0_float;
static PyObject *__pyx_kp_u_POLYGONS_0_1;
static PyObject *__pyx_n_s_Polygon;
static PyObject *__pyx_n_s_Vector;
static PyObject *__pyx_n_s_Vector_2;
static PyObject *__pyx_n_s_Vertex;
static PyObject *__pyx_n_s_Vertex_2;
static PyObject *__pyx_n_s_ZeroDivisionError;
static PyObject *__pyx_n_s__23;
static PyObject *__pyx_kp_u__3;
static PyObject *__pyx_kp_u__4;
static PyObject *__pyx_n_s_a;
static PyObject *__pyx_n_s_a0;
static PyObject *__pyx_n_s_aAdd;
static PyObject *__pyx_n_s_aInsideB;
static PyObject *__pyx_n_s_aInterB;
static PyObject *__pyx_n_s_aPlaneNormal;
static PyObject *__pyx_n_s_absp;
static PyObject *__pyx_n_s_add;
static PyObject *__pyx_n_s_add_2;
static PyObject *__pyx_n_s_adist;
static PyObject *__pyx_n_s_allPolygons;
static PyObject *__pyx_n_s_andist;
static PyObject *__pyx_n_s_angle;
static PyObject *__pyx_n_s_angleDeg;
static PyObject *__pyx_n_s_anormal;
static PyObject *__pyx_n_s_aplane;
static PyObject *__pyx_n_s_apoly;
static PyObject *__pyx_n_s_apolygons;
static PyObject *__pyx_n_s_append;
static PyObject *__pyx_n_s_appendVertex;
static PyObject *__pyx_n_s_array;
static PyObject *__pyx_n_s_array2string;
static PyObject *__pyx_n_s_as_string;
static PyObject *__pyx_n_s_atan2;
static PyObject *__pyx_n_s_av;
static PyObject *__pyx_n_s_avunit;
static PyObject *__pyx_n_s_ax;
static PyObject *__pyx_n_s_axis;
static PyObject *__pyx_n_s_axisX;
static PyObject *__pyx_n_s_axisY;
static PyObject *__pyx_n_s_axisZ;
static PyObject *__pyx_n_s_b;
static PyObject *__pyx_n_s_b0;
static PyObject *__pyx_n_s_bInsideA;
static PyObject *__pyx_n_s_bbsp;
static PyObject *__pyx_n_s_bdist;
static PyObject *__pyx_n_s_bpOnA;
static PyObject *__pyx_n_s_bplane;
static PyObject *__pyx_n_s_bpoly;
static PyObject *__pyx_n_s_bpolygons;
static PyObject *__pyx_n_s_build;
static PyObject *__pyx_n_s_bv;
static PyObject *__pyx_n_s_bvOnA;
static PyObject *__pyx_n_s_bvunit;
static PyObject *__pyx_n_s_c;
static PyObject *__pyx_n_s_cell;
static PyObject *__pyx_n_s_cells;
static PyObject *__pyx_n_s_center;
static PyObject *__pyx_n_u_center;
static PyObject *__pyx_n_s_checksum;
static PyObject *__pyx_n_s_cline_in_traceback;
static PyObject *__pyx_n_s_clipTo;
static PyObject *__pyx_n_s_clone;
static PyObject *__pyx_n_s_cls;
static PyObject *__pyx_n_s_cone;
static PyObject *__pyx_n_s_convexHull;
static PyObject *__pyx_n_s_copl;
static PyObject *__pyx_n_s_coplanar;
static PyObject *__pyx_n_s_coplanarIntersection;
static PyObject *__pyx_n_s_coplanarPolys;
static PyObject *__pyx_n_s_cos;
static PyObject *__pyx_n_s_cosAngle;
static PyObject *__pyx_n_s_cosTaperAngle;
static PyObject *__pyx_n_s_count;
static PyObject *__pyx_n_s_cross;
static PyObject *__pyx_n_s_csg;
static PyObject *__pyx_n_s_cube;
static PyObject *__pyx_n_s_cylinder;
static PyObject *__pyx_n_s_d;
static PyObject *__pyx_n_s_dPhi;
static PyObject *__pyx_n_s_dTheta;
static PyObject *__pyx_n_s_denom;
static PyObject *__pyx_n_s_disp;
static PyObject *__pyx_n_s_do_intersect;
static PyObject *__pyx_n_s_doc;
static PyObject *__pyx_n_s_dot;
static PyObject *__pyx_n_s_dt;
static PyObject *__pyx_n_s_e;
static PyObject *__pyx_n_s_encode;
static PyObject *__pyx_n_s_end;
static PyObject *__pyx_n_u_end;
static PyObject *__pyx_n_s_enter;
static PyObject *__pyx_n_s_exit;
static PyObject *__pyx_n_s_f;
static PyObject *__pyx_n_s_fabs;
static PyObject *__pyx_n_s_filename;
static PyObject *__pyx_n_s_first;
static PyObject *__pyx_n_s_flip;
static PyObject *__pyx_n_s_format;
static PyObject *__pyx_n_s_fromPolygons;
static PyObject *__pyx_n_s_functools;
static PyObject *__pyx_n_s_geom;
static PyObject *__pyx_n_s_get;
static PyObject *__pyx_n_s_getNumberPolys;
static PyObject *__pyx_n_s_hash;
static PyObject *__pyx_n_s_hashlib;
static PyObject *__pyx_n_s_hexdigest;
static PyObject *__pyx_n_s_hull;
static PyObject *__pyx_n_s_i;
static PyObject *__pyx_n_s_i0;
static PyObject *__pyx_n_s_i1;
static PyObject *__pyx_n_s_i2;
static PyObject *__pyx_n_s_import;
static PyObject *__pyx_n_s_index;
static PyObject *__pyx_n_s_init;
static PyObject *__pyx_n_s_inter;
static PyObject *__pyx_n_s_interpolate;
static PyObject *__pyx_n_s_intersect;
static PyObject *__pyx_n_s_inverse;
static PyObject *__pyx_n_s_invert;
static PyObject *__pyx_n_s_isNull;
static PyObject *__pyx_n_s_isY;
static PyObject *__pyx_n_s_itemgetter;
static PyObject *__pyx_n_s_items;
static PyObject *__pyx_n_s_j;
static PyObject *__pyx_n_s_j0;
static PyObject *__pyx_n_s_j1;
static PyObject *__pyx_n_s_j2;
static PyObject *__pyx_n_s_key;
static PyObject *__pyx_n_s_kwargs;
static PyObject *__pyx_n_s_length;
static PyObject *__pyx_n_s_loc;
static PyObject *__pyx_n_s_main;
static PyObject *__pyx_n_s_map;
static PyObject *__pyx_n_s_md5;
static PyObject *__pyx_n_s_md5_2;
static PyObject *__pyx_n_s_metaclass;
static PyObject *__pyx_n_s_midNormal;
static PyObject *__pyx_n_s_midPos;
static PyObject *__pyx_n_s_midVert;
static PyObject *__pyx_n_s_minus;
static PyObject *__pyx_n_s_module;
static PyObject *__pyx_n_s_mul;
static PyObject *__pyx_n_s_n0;
static PyObject *__pyx_n_s_n1;
static PyObject *__pyx_n_s_nAvg;
static PyObject *__pyx_n_s_name;
static PyObject *__pyx_n_s_negated;
static PyObject *__pyx_n_s_newCSG;
static PyObject *__pyx_n_s_newPoly;
static PyObject *__pyx_n_s_newVector;
static PyObject *__pyx_n_s_newVerts;
static PyObject *__pyx_n_s_nhull;
static PyObject *__pyx_n_s_normal;
static PyObject *__pyx_n_s_normalBlend;
static PyObject *__pyx_n_s_np;
static PyObject *__pyx_n_s_numCells;
static PyObject *__pyx_n_s_numVerts;
static PyObject *__pyx_n_s_numpy;
static PyObject *__pyx_n_s_object;
static PyObject *__pyx_n_s_offset;
static PyObject *__pyx_n_s_open;
static PyObject *__pyx_n_s_operator;
static PyObject *__pyx_n_s_out;
static PyObject *__pyx_n_s_p;
static PyObject *__pyx_n_s_p0;
static PyObject *__pyx_n_s_p1;
static PyObject *__pyx_n_s_p2;
static PyObject *__pyx_n_s_phi;
static PyObject *__pyx_n_s_pi;
static PyObject *__pyx_n_s_plane;
static PyObject *__pyx_n_s_ploc;
static PyObject *__pyx_n_s_plus;
static PyObject *__pyx_n_s_point;
static PyObject *__pyx_n_s_points;
static PyObject *__pyx_n_s_poly;
static PyObject *__pyx_n_s_polyEdgeIntersection;
static PyObject *__pyx_n_s_polySide;
static PyObject *__pyx_n_s_polyStart;
static PyObject *__pyx_n_s_polyVertsInside;
static PyObject *__pyx_n_s_polygon;
static PyObject *__pyx_n_s_polygonCount;
static PyObject *__pyx_n_s_polygonType;
static PyObject *__pyx_n_s_polygons;
static PyObject *__pyx_n_s_polys;
static PyObject *__pyx_n_s_pos;
static PyObject *__pyx_n_s_positions;
static PyObject *__pyx_n_s_prepare;
static PyObject *__pyx_kp_u_pycsg_output;
static PyObject *__pyx_n_s_pyg4ometry_pycsg_core;
static PyObject *__pyx_n_s_q_next;
static PyObject *__pyx_n_s_q_now;
static PyObject *__pyx_n_s_qualname;
static PyObject *__pyx_n_s_r;
static PyObject *__pyx_n_s_radius;
static PyObject *__pyx_n_u_radius;
static PyObject *__pyx_n_s_range;
static PyObject *__pyx_n_s_ray;
static PyObject *__pyx_n_s_reduce;
static PyObject *__pyx_n_s_refine;
static PyObject *__pyx_n_s_rotate;
static PyObject *__pyx_n_s_s;
static PyObject *__pyx_n_s_saveVTK;
static PyObject *__pyx_n_s_scale;
static PyObject *__pyx_n_s_second;
static PyObject *__pyx_n_s_self;
static PyObject *__pyx_n_s_shared;
static PyObject *__pyx_n_s_sin;
static PyObject *__pyx_n_s_sinAngle;
static PyObject *__pyx_n_s_sinTaperAngle;
static PyObject *__pyx_n_s_slices;
static PyObject *__pyx_n_u_slices;
static PyObject *__pyx_n_s_soln;
static PyObject *__pyx_n_s_sorted;
static PyObject *__pyx_n_s_sortedVertexIndex;
static PyObject *__pyx_n_s_sphere;
static PyObject *__pyx_n_s_split;
static PyObject *__pyx_kp_s_src_pyg4ometry_pycsg_core_pyx;
static PyObject *__pyx_n_s_stack;
static PyObject *__pyx_n_s_stacks;
static PyObject *__pyx_n_u_stacks;
static PyObject *__pyx_n_s_start;
static PyObject *__pyx_n_u_start;
static PyObject *__pyx_n_s_startNormal;
static PyObject *__pyx_n_s_sub;
static PyObject *__pyx_n_s_subtract;
static PyObject *__pyx_n_s_t;
static PyObject *__pyx_n_s_t0;
static PyObject *__pyx_n_s_t1;
static PyObject *__pyx_n_s_taperAngle;
static PyObject *__pyx_n_s_test;
static PyObject *__pyx_n_s_testGeom;
static PyObject *__pyx_n_s_theta;
static PyObject *__pyx_n_s_times;
static PyObject *__pyx_n_s_toPolygons;
static PyObject *__pyx_n_s_toVerticesAndPolygons;
static PyObject *__pyx_n_s_translate;
static PyObject *__pyx_n_s_u1;
static PyObject *__pyx_n_s_u2;
static PyObject *__pyx_n_s_union;
static PyObject *__pyx_n_s_unit;
static PyObject *__pyx_n_s_v;
static PyObject *__pyx_n_s_vA;
static PyObject *__pyx_n_s_vCosA;
static PyObject *__pyx_n_s_vCount;
static PyObject *__pyx_n_s_vKey;
static PyObject *__pyx_n_s_vPerp;
static PyObject *__pyx_n_s_vPerpLen;
static PyObject *__pyx_n_s_vSinA;
static PyObject *__pyx_n_s_vert;
static PyObject *__pyx_n_s_vertexCount;
static PyObject *__pyx_n_s_vertexIndexMap;
static PyObject *__pyx_n_s_vertices;
static PyObject *__pyx_n_s_verticesE;
static PyObject *__pyx_n_s_verticesN;
static PyObject *__pyx_n_s_verticesS;
static PyObject *__pyx_n_s_verticesW;
static PyObject *__pyx_n_s_verts;
static PyObject *__pyx_n_s_vertsInside;
static PyObject *__pyx_n_s_vertsInter;
static PyObject *__pyx_n_s_vs;
static PyObject *__pyx_kp_u_vtk_DataFile_Version_3_0;
static PyObject *__pyx_n_s_w;
static PyObject *__pyx_n_u_w;
static PyObject *__pyx_n_s_write;
static PyObject *__pyx_n_s_x;
static PyObject *__pyx_n_s_y;
static PyObject *__pyx_n_s_z;
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG___init__(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_2__hash__(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_4fromPolygons(
    CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_cls,
    PyObject *__pyx_v_polygons,
    CYTHON_UNUSED PyObject *__pyx_v_testGeom); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6clone(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_8toPolygons(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_10isNull(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_12polygonCount(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_14vertexCount(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_16refine(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_18translate(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self,
    PyObject *__pyx_v_disp); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_20scale(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self,
    PyObject *__pyx_v_scale); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6rotate_newVector(
    PyObject *__pyx_self, PyObject *__pyx_v_v); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_22rotate(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self,
    PyObject *__pyx_v_axis, PyObject *__pyx_v_angleDeg); /* proto */
static PyObject *
__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_24toVerticesAndPolygons(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_26saveVTK(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self,
    PyObject *__pyx_v_filename); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_28union(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self,
    PyObject *__pyx_v_csg); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_30__add__(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self,
    PyObject *__pyx_v_csg); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_32subtract(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self,
    PyObject *__pyx_v_csg); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_34__sub__(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self,
    PyObject *__pyx_v_csg); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_36intersect(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self,
    PyObject *__pyx_v_csg); /* proto */
static PyObject *
__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_coplanarPolys(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_apoly,
    PyObject *__pyx_v_bpoly); /* proto */
static PyObject *
__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_2polyVertsInside(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_apoly,
    PyObject *__pyx_v_bpoly); /* proto */
static PyObject *
__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_4polyEdgeIntersection(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_apoly,
    PyObject *__pyx_v_bpoly); /* proto */
static PyObject *
__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_6convexHull(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_positions,
    PyObject *__pyx_v_normal); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_38coplanarIntersection(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self,
    PyObject *__pyx_v_csg); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_40coplanar(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self,
    PyObject *__pyx_v_csg); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_42__mul__(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self,
    PyObject *__pyx_v_csg); /* proto */
static PyObject *__pyx_lambda_funcdef_lambda(CYTHON_UNUSED PyObject *__pyx_self,
                                             PyObject *__pyx_v_p); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_44inverse(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_46getNumberPolys(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_2__defaults__(
    CYTHON_UNUSED PyObject *__pyx_self); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_48cube(
    CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_cls,
    PyObject *__pyx_v_center, PyObject *__pyx_v_radius); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6sphere_appendVertex(
    PyObject *__pyx_self, PyObject *__pyx_v_vertices, PyObject *__pyx_v_theta,
    PyObject *__pyx_v_phi); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_50sphere(
    CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_cls,
    PyObject *__pyx_v_kwargs); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_8cylinder_point(
    PyObject *__pyx_self, PyObject *__pyx_v_stack, PyObject *__pyx_v_angle,
    PyObject *__pyx_v_normalBlend); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_52cylinder(
    CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_cls,
    PyObject *__pyx_v_kwargs); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_4cone_point(
    PyObject *__pyx_self, PyObject *__pyx_v_angle); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_54cone(
    CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_cls,
    PyObject *__pyx_v_kwargs); /* proto */
static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_do_intersect(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_first,
    PyObject *__pyx_v_second); /* proto */
static PyObject *
__pyx_tp_new_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate(
    PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
static PyObject *
__pyx_tp_new_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere(
    PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
static PyObject *
__pyx_tp_new_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder(
    PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
static PyObject *
__pyx_tp_new_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone(
    PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
static __Pyx_CachedCFunction __pyx_umethod_PyDict_Type_get = {0, &__pyx_n_s_get,
                                                              0, 0, 0};
static __Pyx_CachedCFunction __pyx_umethod_PyDict_Type_items = {
    0, &__pyx_n_s_items, 0, 0, 0};
static PyObject *__pyx_float_0_;
static PyObject *__pyx_float_1_;
static PyObject *__pyx_float_0_0;
static PyObject *__pyx_float_0_5;
static PyObject *__pyx_float_1_0;
static PyObject *__pyx_float_2_0;
static PyObject *__pyx_float_180_;
static PyObject *__pyx_float_1eneg_5;
static PyObject *__pyx_float_1eneg_7;
static PyObject *__pyx_float_1eneg_8;
static PyObject *__pyx_float_neg_1_;
static PyObject *__pyx_float_neg_1_0;
static PyObject *__pyx_float_neg_1eneg_8;
static PyObject *__pyx_int_0;
static PyObject *__pyx_int_1;
static PyObject *__pyx_int_2;
static PyObject *__pyx_int_3;
static PyObject *__pyx_int_4;
static PyObject *__pyx_int_5;
static PyObject *__pyx_int_6;
static PyObject *__pyx_int_7;
static PyObject *__pyx_int_8;
static PyObject *__pyx_int_16;
static PyObject *__pyx_int_neg_1;
static PyObject *__pyx_tuple_;
static PyObject *__pyx_tuple__5;
static PyObject *__pyx_tuple__6;
static PyObject *__pyx_tuple__8;
static PyObject *__pyx_tuple__10;
static PyObject *__pyx_tuple__12;
static PyObject *__pyx_tuple__14;
static PyObject *__pyx_tuple__15;
static PyObject *__pyx_tuple__17;
static PyObject *__pyx_tuple__18;
static PyObject *__pyx_tuple__19;
static PyObject *__pyx_tuple__21;
static PyObject *__pyx_tuple__24;
static PyObject *__pyx_tuple__25;
static PyObject *__pyx_tuple__27;
static PyObject *__pyx_tuple__29;
static PyObject *__pyx_tuple__31;
static PyObject *__pyx_tuple__32;
static PyObject *__pyx_tuple__34;
static PyObject *__pyx_tuple__36;
static PyObject *__pyx_tuple__38;
static PyObject *__pyx_tuple__40;
static PyObject *__pyx_tuple__42;
static PyObject *__pyx_tuple__44;
static PyObject *__pyx_tuple__46;
static PyObject *__pyx_tuple__48;
static PyObject *__pyx_tuple__50;
static PyObject *__pyx_tuple__52;
static PyObject *__pyx_tuple__54;
static PyObject *__pyx_tuple__56;
static PyObject *__pyx_tuple__58;
static PyObject *__pyx_tuple__60;
static PyObject *__pyx_tuple__62;
static PyObject *__pyx_tuple__64;
static PyObject *__pyx_tuple__66;
static PyObject *__pyx_tuple__68;
static PyObject *__pyx_tuple__70;
static PyObject *__pyx_tuple__72;
static PyObject *__pyx_tuple__74;
static PyObject *__pyx_tuple__76;
static PyObject *__pyx_tuple__78;
static PyObject *__pyx_tuple__80;
static PyObject *__pyx_tuple__82;
static PyObject *__pyx_codeobj__2;
static PyObject *__pyx_codeobj__7;
static PyObject *__pyx_codeobj__9;
static PyObject *__pyx_codeobj__11;
static PyObject *__pyx_codeobj__13;
static PyObject *__pyx_codeobj__16;
static PyObject *__pyx_codeobj__20;
static PyObject *__pyx_codeobj__22;
static PyObject *__pyx_codeobj__26;
static PyObject *__pyx_codeobj__28;
static PyObject *__pyx_codeobj__30;
static PyObject *__pyx_codeobj__33;
static PyObject *__pyx_codeobj__35;
static PyObject *__pyx_codeobj__37;
static PyObject *__pyx_codeobj__39;
static PyObject *__pyx_codeobj__41;
static PyObject *__pyx_codeobj__43;
static PyObject *__pyx_codeobj__45;
static PyObject *__pyx_codeobj__47;
static PyObject *__pyx_codeobj__49;
static PyObject *__pyx_codeobj__51;
static PyObject *__pyx_codeobj__53;
static PyObject *__pyx_codeobj__55;
static PyObject *__pyx_codeobj__57;
static PyObject *__pyx_codeobj__59;
static PyObject *__pyx_codeobj__61;
static PyObject *__pyx_codeobj__63;
static PyObject *__pyx_codeobj__65;
static PyObject *__pyx_codeobj__67;
static PyObject *__pyx_codeobj__69;
static PyObject *__pyx_codeobj__71;
static PyObject *__pyx_codeobj__73;
static PyObject *__pyx_codeobj__75;
static PyObject *__pyx_codeobj__77;
static PyObject *__pyx_codeobj__79;
static PyObject *__pyx_codeobj__81;
static PyObject *__pyx_codeobj__83;
/* Late includes */

/* "pyg4ometry/pycsg/core.pyx":64
 *     Additions by Alex Pletzer (Pennsylvania State University)
 *     """
 *     def __init__(self):             # <<<<<<<<<<<<<<
 *         self.polygons = []
 *
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_1__init__(
    PyObject *__pyx_self, PyObject *__pyx_v_self); /*proto*/
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_1__init__ = {
    "__init__", (PyCFunction)__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_1__init__,
    METH_O, 0};
static PyObject *
__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_1__init__(PyObject *__pyx_self,
                                                  PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext("__init__ (wrapper)",
                                                        0);
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG___init__(
      __pyx_self, ((PyObject *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG___init__(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__init__", 0);

  /* "pyg4ometry/pycsg/core.pyx":65
   *     """
   *     def __init__(self):
   *         self.polygons = []             # <<<<<<<<<<<<<<
   *
   *     def __hash__(self):
   */
  __pyx_t_1 = PyList_New(0);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 65, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_polygons, __pyx_t_1) <
      0)
    __PYX_ERR(0, 65, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":64
   *     Additions by Alex Pletzer (Pennsylvania State University)
   *     """
   *     def __init__(self):             # <<<<<<<<<<<<<<
   *         self.polygons = []
   *
   */

  /* function exit code */
  __pyx_r = Py_None;
  __Pyx_INCREF(Py_None);
  goto __pyx_L0;
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.__init__", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":67
 *         self.polygons = []
 *
 *     def __hash__(self):             # <<<<<<<<<<<<<<
 *         verts = _np.array(self.toVerticesAndPolygons()[0])
 *         as_string = _np.array2string(verts)
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_3__hash__(
    PyObject *__pyx_self, PyObject *__pyx_v_self); /*proto*/
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_3__hash__ = {
    "__hash__", (PyCFunction)__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_3__hash__,
    METH_O, 0};
static PyObject *
__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_3__hash__(PyObject *__pyx_self,
                                                  PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext("__hash__ (wrapper)",
                                                        0);
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_2__hash__(
      __pyx_self, ((PyObject *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_2__hash__(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
  PyObject *__pyx_v_verts = NULL;
  PyObject *__pyx_v_as_string = NULL;
  PyObject *__pyx_v_checksum = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__hash__", 0);

  /* "pyg4ometry/pycsg/core.pyx":68
   *
   *     def __hash__(self):
   *         verts = _np.array(self.toVerticesAndPolygons()[0])             #
   * <<<<<<<<<<<<<< as_string = _np.array2string(verts) checksum =
   * int(_md5(as_string.encode()).hexdigest(), 16)
   */
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 68, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 68, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_4 =
      __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_toVerticesAndPolygons);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 68, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 68, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 =
      __Pyx_GetItemInt(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 68, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_t_4)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4);
  __Pyx_XDECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 68, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_v_verts = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":69
   *     def __hash__(self):
   *         verts = _np.array(self.toVerticesAndPolygons()[0])
   *         as_string = _np.array2string(verts)             # <<<<<<<<<<<<<<
   *         checksum = int(_md5(as_string.encode()).hexdigest(), 16)
   *
   */
  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 69, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_array2string);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 69, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3,
                                                     __pyx_v_verts)
                          : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_verts);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 69, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_v_as_string = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":70
   *         verts = _np.array(self.toVerticesAndPolygons()[0])
   *         as_string = _np.array2string(verts)
   *         checksum = int(_md5(as_string.encode()).hexdigest(), 16) #
   * <<<<<<<<<<<<<<
   *
   *         return checksum
   */
  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_md5);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 70, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_as_string, __pyx_n_s_encode);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 70, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
    if (likely(__pyx_t_6)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_5, function);
    }
  }
  __pyx_t_2 = (__pyx_t_6) ? __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_6)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 70, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  __pyx_t_4 = (__pyx_t_5)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_2)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 70, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_hexdigest);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 70, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 70, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyTuple_New(2);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 70, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
  __Pyx_INCREF(__pyx_int_16);
  __Pyx_GIVEREF(__pyx_int_16);
  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_16);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)(&PyInt_Type)), __pyx_t_3, NULL);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 70, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_v_checksum = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":72
   *         checksum = int(_md5(as_string.encode()).hexdigest(), 16)
   *
   *         return checksum             # <<<<<<<<<<<<<<
   *
   *     @classmethod
   */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_checksum);
  __pyx_r = __pyx_v_checksum;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":67
 *         self.polygons = []
 *
 *     def __hash__(self):             # <<<<<<<<<<<<<<
 *         verts = _np.array(self.toVerticesAndPolygons()[0])
 *         as_string = _np.array2string(verts)
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.__hash__", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XDECREF(__pyx_v_verts);
  __Pyx_XDECREF(__pyx_v_as_string);
  __Pyx_XDECREF(__pyx_v_checksum);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":75
 *
 *     @classmethod
 *     def fromPolygons(cls, polygons, testGeom = False):             #
 * <<<<<<<<<<<<<< csg = CSG() csg.polygons = polygons
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_5fromPolygons(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_5fromPolygons = {
    "fromPolygons",
    (PyCFunction)(void *)(PyCFunctionWithKeywords)
        __pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_5fromPolygons,
    METH_VARARGS | METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_5fromPolygons(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED PyObject *__pyx_v_cls = 0;
  PyObject *__pyx_v_polygons = 0;
  CYTHON_UNUSED PyObject *__pyx_v_testGeom = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext(
      "fromPolygons (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_cls, &__pyx_n_s_polygons,
                                            &__pyx_n_s_testGeom, 0};
    PyObject *values[3] = {0, 0, 0};
    values[2] = ((PyObject *)((PyObject *)Py_False));
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
      case 3:
        values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
      case 2:
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
      case 1:
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
      case 0:
        break;
      default:
        goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
      case 0:
        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_cls)) != 0))
          kw_args--;
        else
          goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
      case 1:
        if (likely((values[1] = __Pyx_PyDict_GetItemStr(
                        __pyx_kwds, __pyx_n_s_polygons)) != 0))
          kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("fromPolygons", 0, 2, 3, 1);
          __PYX_ERR(0, 75, __pyx_L3_error)
        }
        CYTHON_FALLTHROUGH;
      case 2:
        if (kw_args > 0) {
          PyObject *value =
              __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_testGeom);
          if (value) {
            values[2] = value;
            kw_args--;
          }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames,
                                                 0, values, pos_args,
                                                 "fromPolygons") < 0))
          __PYX_ERR(0, 75, __pyx_L3_error)
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
      case 3:
        values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
      case 2:
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        break;
      default:
        goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_cls = values[0];
    __pyx_v_polygons = values[1];
    __pyx_v_testGeom = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
__pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("fromPolygons", 0, 2, 3,
                             PyTuple_GET_SIZE(__pyx_args));
  __PYX_ERR(0, 75, __pyx_L3_error)
__pyx_L3_error:;
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.fromPolygons", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
__pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_4fromPolygons(
      __pyx_self, __pyx_v_cls, __pyx_v_polygons, __pyx_v_testGeom);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_4fromPolygons(
    CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_cls,
    PyObject *__pyx_v_polygons, CYTHON_UNUSED PyObject *__pyx_v_testGeom) {
  PyObject *__pyx_v_csg = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("fromPolygons", 0);

  /* "pyg4ometry/pycsg/core.pyx":76
   *     @classmethod
   *     def fromPolygons(cls, polygons, testGeom = False):
   *         csg = CSG()             # <<<<<<<<<<<<<<
   *         csg.polygons = polygons
   *         return csg
   */
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_CSG);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 76, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 76, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_csg = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":77
   *     def fromPolygons(cls, polygons, testGeom = False):
   *         csg = CSG()
   *         csg.polygons = polygons             # <<<<<<<<<<<<<<
   *         return csg
   *
   */
  if (__Pyx_PyObject_SetAttrStr(__pyx_v_csg, __pyx_n_s_polygons,
                                __pyx_v_polygons) < 0)
    __PYX_ERR(0, 77, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":78
   *         csg = CSG()
   *         csg.polygons = polygons
   *         return csg             # <<<<<<<<<<<<<<
   *
   *     def clone(self):
   */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_csg);
  __pyx_r = __pyx_v_csg;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":75
 *
 *     @classmethod
 *     def fromPolygons(cls, polygons, testGeom = False):             #
 * <<<<<<<<<<<<<< csg = CSG() csg.polygons = polygons
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.fromPolygons", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XDECREF(__pyx_v_csg);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":80
 *         return csg
 *
 *     def clone(self):             # <<<<<<<<<<<<<<
 *         csg = CSG()
 *         csg.polygons = list([p.clone() for p in self.polygons])
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_7clone(
    PyObject *__pyx_self, PyObject *__pyx_v_self); /*proto*/
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_7clone = {
    "clone", (PyCFunction)__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_7clone,
    METH_O, 0};
static PyObject *
__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_7clone(PyObject *__pyx_self,
                                               PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext("clone (wrapper)", 0);
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6clone(
      __pyx_self, ((PyObject *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6clone(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
  PyObject *__pyx_v_csg = NULL;
  PyObject *__pyx_7genexpr__pyx_v_p = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  Py_ssize_t __pyx_t_4;
  PyObject *(*__pyx_t_5)(PyObject *);
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("clone", 0);

  /* "pyg4ometry/pycsg/core.pyx":81
   *
   *     def clone(self):
   *         csg = CSG()             # <<<<<<<<<<<<<<
   *         csg.polygons = list([p.clone() for p in self.polygons])
   *         return csg
   */
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_CSG);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 81, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 81, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_csg = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":82
   *     def clone(self):
   *         csg = CSG()
   *         csg.polygons = list([p.clone() for p in self.polygons]) #
   * <<<<<<<<<<<<<< return csg
   *
   */
  { /* enter inner scope */
    __pyx_t_1 = PyList_New(0);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 82, __pyx_L5_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_polygons);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 82, __pyx_L5_error)
    __Pyx_GOTREF(__pyx_t_2);
    if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
      __pyx_t_3 = __pyx_t_2;
      __Pyx_INCREF(__pyx_t_3);
      __pyx_t_4 = 0;
      __pyx_t_5 = NULL;
    } else {
      __pyx_t_4 = -1;
      __pyx_t_3 = PyObject_GetIter(__pyx_t_2);
      if (unlikely(!__pyx_t_3))
        __PYX_ERR(0, 82, __pyx_L5_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext;
      if (unlikely(!__pyx_t_5))
        __PYX_ERR(0, 82, __pyx_L5_error)
    }
    __Pyx_DECREF(__pyx_t_2);
    __pyx_t_2 = 0;
    for (;;) {
      if (likely(!__pyx_t_5)) {
        if (likely(PyList_CheckExact(__pyx_t_3))) {
          if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_3))
            break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_2 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4);
          __Pyx_INCREF(__pyx_t_2);
          __pyx_t_4++;
          if (unlikely(0 < 0))
            __PYX_ERR(0, 82, __pyx_L5_error)
#else
          __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_4);
          __pyx_t_4++;
          if (unlikely(!__pyx_t_2))
            __PYX_ERR(0, 82, __pyx_L5_error)
          __Pyx_GOTREF(__pyx_t_2);
#endif
        } else {
          if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_3))
            break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4);
          __Pyx_INCREF(__pyx_t_2);
          __pyx_t_4++;
          if (unlikely(0 < 0))
            __PYX_ERR(0, 82, __pyx_L5_error)
#else
          __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_4);
          __pyx_t_4++;
          if (unlikely(!__pyx_t_2))
            __PYX_ERR(0, 82, __pyx_L5_error)
          __Pyx_GOTREF(__pyx_t_2);
#endif
        }
      } else {
        __pyx_t_2 = __pyx_t_5(__pyx_t_3);
        if (unlikely(!__pyx_t_2)) {
          PyObject *exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type,
                                                         PyExc_StopIteration)))
              PyErr_Clear();
            else
              __PYX_ERR(0, 82, __pyx_L5_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_2);
      }
      __Pyx_XDECREF_SET(__pyx_7genexpr__pyx_v_p, __pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_6 =
          __Pyx_PyObject_GetAttrStr(__pyx_7genexpr__pyx_v_p, __pyx_n_s_clone);
      if (unlikely(!__pyx_t_6))
        __PYX_ERR(0, 82, __pyx_L5_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_7 = NULL;
      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
        __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
        if (likely(__pyx_t_7)) {
          PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_6);
          __Pyx_INCREF(__pyx_t_7);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_6, function);
        }
      }
      __pyx_t_2 = (__pyx_t_7) ? __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_7)
                              : __Pyx_PyObject_CallNoArg(__pyx_t_6);
      __Pyx_XDECREF(__pyx_t_7);
      __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_2))
        __PYX_ERR(0, 82, __pyx_L5_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_6);
      __pyx_t_6 = 0;
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject *)__pyx_t_2)))
        __PYX_ERR(0, 82, __pyx_L5_error)
      __Pyx_DECREF(__pyx_t_2);
      __pyx_t_2 = 0;
    }
    __Pyx_DECREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __Pyx_XDECREF(__pyx_7genexpr__pyx_v_p);
    __pyx_7genexpr__pyx_v_p = 0;
    goto __pyx_L8_exit_scope;
  __pyx_L5_error:;
    __Pyx_XDECREF(__pyx_7genexpr__pyx_v_p);
    __pyx_7genexpr__pyx_v_p = 0;
    goto __pyx_L1_error;
  __pyx_L8_exit_scope:;
  } /* exit inner scope */
  __pyx_t_3 = PySequence_List(__pyx_t_1);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 82, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  if (__Pyx_PyObject_SetAttrStr(__pyx_v_csg, __pyx_n_s_polygons, __pyx_t_3) < 0)
    __PYX_ERR(0, 82, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;

  /* "pyg4ometry/pycsg/core.pyx":83
   *         csg = CSG()
   *         csg.polygons = list([p.clone() for p in self.polygons])
   *         return csg             # <<<<<<<<<<<<<<
   *
   *     def toPolygons(self):
   */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_csg);
  __pyx_r = __pyx_v_csg;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":80
 *         return csg
 *
 *     def clone(self):             # <<<<<<<<<<<<<<
 *         csg = CSG()
 *         csg.polygons = list([p.clone() for p in self.polygons])
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.clone", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XDECREF(__pyx_v_csg);
  __Pyx_XDECREF(__pyx_7genexpr__pyx_v_p);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":85
 *         return csg
 *
 *     def toPolygons(self):             # <<<<<<<<<<<<<<
 *         return self.polygons
 *
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_9toPolygons(
    PyObject *__pyx_self, PyObject *__pyx_v_self); /*proto*/
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_9toPolygons = {
    "toPolygons",
    (PyCFunction)__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_9toPolygons, METH_O,
    0};
static PyObject *
__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_9toPolygons(PyObject *__pyx_self,
                                                    PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext("toPolygons (wrapper)",
                                                        0);
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_8toPolygons(
      __pyx_self, ((PyObject *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_8toPolygons(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("toPolygons", 0);

  /* "pyg4ometry/pycsg/core.pyx":86
   *
   *     def toPolygons(self):
   *         return self.polygons             # <<<<<<<<<<<<<<
   *
   *     def isNull(self):
   */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_polygons);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 86, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":85
 *         return csg
 *
 *     def toPolygons(self):             # <<<<<<<<<<<<<<
 *         return self.polygons
 *
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.toPolygons", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":88
 *         return self.polygons
 *
 *     def isNull(self):             # <<<<<<<<<<<<<<
 *         return len(self.toPolygons()) == 0
 *
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_11isNull(
    PyObject *__pyx_self, PyObject *__pyx_v_self); /*proto*/
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_11isNull = {
    "isNull", (PyCFunction)__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_11isNull,
    METH_O, 0};
static PyObject *
__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_11isNull(PyObject *__pyx_self,
                                                 PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext("isNull (wrapper)", 0);
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_10isNull(
      __pyx_self, ((PyObject *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_10isNull(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  Py_ssize_t __pyx_t_4;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("isNull", 0);

  /* "pyg4ometry/pycsg/core.pyx":89
   *
   *     def isNull(self):
   *         return len(self.toPolygons()) == 0             # <<<<<<<<<<<<<<
   *
   *     def polygonCount(self):
   */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_toPolygons);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 89, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 89, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_4 = PyObject_Length(__pyx_t_1);
  if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1)))
    __PYX_ERR(0, 89, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyBool_FromLong((__pyx_t_4 == 0));
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 89, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":88
 *         return self.polygons
 *
 *     def isNull(self):             # <<<<<<<<<<<<<<
 *         return len(self.toPolygons()) == 0
 *
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.isNull", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":91
 *         return len(self.toPolygons()) == 0
 *
 *     def polygonCount(self):             # <<<<<<<<<<<<<<
 *         '''Return number of polygons in CSG solid'''
 *         return len(self.polygons)
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_13polygonCount(
    PyObject *__pyx_self, PyObject *__pyx_v_self); /*proto*/
static char __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_12polygonCount[] =
    "Return number of polygons in CSG solid";
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_13polygonCount = {
    "polygonCount",
    (PyCFunction)__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_13polygonCount, METH_O,
    __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_12polygonCount};
static PyObject *
__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_13polygonCount(PyObject *__pyx_self,
                                                       PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext(
      "polygonCount (wrapper)", 0);
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_12polygonCount(
      __pyx_self, ((PyObject *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_12polygonCount(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("polygonCount", 0);

  /* "pyg4ometry/pycsg/core.pyx":93
   *     def polygonCount(self):
   *         '''Return number of polygons in CSG solid'''
   *         return len(self.polygons)             # <<<<<<<<<<<<<<
   *
   *     def vertexCount(self):
   */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_polygons);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 93, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_Length(__pyx_t_1);
  if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1)))
    __PYX_ERR(0, 93, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_2);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 93, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":91
 *         return len(self.toPolygons()) == 0
 *
 *     def polygonCount(self):             # <<<<<<<<<<<<<<
 *         '''Return number of polygons in CSG solid'''
 *         return len(self.polygons)
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.polygonCount", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":95
 *         return len(self.polygons)
 *
 *     def vertexCount(self):             # <<<<<<<<<<<<<<
 *         '''Return number of vertices in CSG solid'''
 *         vCount = 0
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_15vertexCount(
    PyObject *__pyx_self, PyObject *__pyx_v_self); /*proto*/
static char __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_14vertexCount[] =
    "Return number of vertices in CSG solid";
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_15vertexCount = {
    "vertexCount",
    (PyCFunction)__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_15vertexCount, METH_O,
    __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_14vertexCount};
static PyObject *
__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_15vertexCount(PyObject *__pyx_self,
                                                      PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext("vertexCount (wrapper)",
                                                        0);
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_14vertexCount(
      __pyx_self, ((PyObject *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_14vertexCount(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
  PyObject *__pyx_v_vCount = NULL;
  PyObject *__pyx_v_p = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  Py_ssize_t __pyx_t_5;
  PyObject *__pyx_t_6 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("vertexCount", 0);

  /* "pyg4ometry/pycsg/core.pyx":97
   *     def vertexCount(self):
   *         '''Return number of vertices in CSG solid'''
   *         vCount = 0             # <<<<<<<<<<<<<<
   *         for p in self.polygons :
   *             vCount += len(p.vertices)
   */
  __Pyx_INCREF(__pyx_int_0);
  __pyx_v_vCount = __pyx_int_0;

  /* "pyg4ometry/pycsg/core.pyx":98
   *         '''Return number of vertices in CSG solid'''
   *         vCount = 0
   *         for p in self.polygons :             # <<<<<<<<<<<<<<
   *             vCount += len(p.vertices)
   *
   */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_polygons);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 98, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1;
    __Pyx_INCREF(__pyx_t_2);
    __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1;
    __pyx_t_2 = PyObject_GetIter(__pyx_t_1);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 98, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext;
    if (unlikely(!__pyx_t_4))
      __PYX_ERR(0, 98, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2))
          break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3);
        __Pyx_INCREF(__pyx_t_1);
        __pyx_t_3++;
        if (unlikely(0 < 0))
          __PYX_ERR(0, 98, __pyx_L1_error)
#else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3);
        __pyx_t_3++;
        if (unlikely(!__pyx_t_1))
          __PYX_ERR(0, 98, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
#endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2))
          break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3);
        __Pyx_INCREF(__pyx_t_1);
        __pyx_t_3++;
        if (unlikely(0 < 0))
          __PYX_ERR(0, 98, __pyx_L1_error)
#else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3);
        __pyx_t_3++;
        if (unlikely(!__pyx_t_1))
          __PYX_ERR(0, 98, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
#endif
      }
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject *exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type,
                                                       PyExc_StopIteration)))
            PyErr_Clear();
          else
            __PYX_ERR(0, 98, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_p, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "pyg4ometry/pycsg/core.pyx":99
     *         vCount = 0
     *         for p in self.polygons :
     *             vCount += len(p.vertices)             # <<<<<<<<<<<<<<
     *
     *         return vCount
     */
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_p, __pyx_n_s_vertices);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 99, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = PyObject_Length(__pyx_t_1);
    if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1)))
      __PYX_ERR(0, 99, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_5);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 99, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_6 = PyNumber_InPlaceAdd(__pyx_v_vCount, __pyx_t_1);
    if (unlikely(!__pyx_t_6))
      __PYX_ERR(0, 99, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __Pyx_DECREF_SET(__pyx_v_vCount, __pyx_t_6);
    __pyx_t_6 = 0;

    /* "pyg4ometry/pycsg/core.pyx":98
     *         '''Return number of vertices in CSG solid'''
     *         vCount = 0
     *         for p in self.polygons :             # <<<<<<<<<<<<<<
     *             vCount += len(p.vertices)
     *
     */
  }
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":101
   *             vCount += len(p.vertices)
   *
   *         return vCount             # <<<<<<<<<<<<<<
   *
   *     def refine(self):
   */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_vCount);
  __pyx_r = __pyx_v_vCount;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":95
 *         return len(self.polygons)
 *
 *     def vertexCount(self):             # <<<<<<<<<<<<<<
 *         '''Return number of vertices in CSG solid'''
 *         vCount = 0
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.vertexCount", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XDECREF(__pyx_v_vCount);
  __Pyx_XDECREF(__pyx_v_p);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":103
 *         return vCount
 *
 *     def refine(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return a refined CSG. To each polygon, a middle point is added to
 * each edge and to the center
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_17refine(
    PyObject *__pyx_self, PyObject *__pyx_v_self); /*proto*/
static char __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_16refine[] =
    "\n        Return a refined CSG. To each polygon, a middle point is added "
    "to each edge and to the center \n        of the polygon\n        ";
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_17refine = {
    "refine", (PyCFunction)__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_17refine,
    METH_O, __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_16refine};
static PyObject *
__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_17refine(PyObject *__pyx_self,
                                                 PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext("refine (wrapper)", 0);
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_16refine(
      __pyx_self, ((PyObject *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_16refine(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
  PyObject *__pyx_v_newCSG = NULL;
  PyObject *__pyx_v_poly = NULL;
  PyObject *__pyx_v_verts = NULL;
  PyObject *__pyx_v_numVerts = NULL;
  PyObject *__pyx_v_midPos = NULL;
  PyObject *__pyx_v_midNormal = NULL;
  PyObject *__pyx_v_midVert = NULL;
  PyObject *__pyx_v_newVerts = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_vs = NULL;
  PyObject *__pyx_v_newPoly = NULL;
  PyObject *__pyx_8genexpr1__pyx_v_v = NULL;
  PyObject *__pyx_8genexpr2__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  Py_ssize_t __pyx_t_4;
  PyObject *(*__pyx_t_5)(PyObject *);
  Py_ssize_t __pyx_t_6;
  int __pyx_t_7;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  PyObject *__pyx_t_10 = NULL;
  PyObject *(*__pyx_t_11)(PyObject *);
  PyObject *__pyx_t_12 = NULL;
  int __pyx_t_13;
  int __pyx_t_14;
  PyObject *__pyx_t_15 = NULL;
  int __pyx_t_16;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("refine", 0);

  /* "pyg4ometry/pycsg/core.pyx":108
   *         of the polygon
   *         """
   *         newCSG = CSG()             # <<<<<<<<<<<<<<
   *         for poly in self.polygons:
   *
   */
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_CSG);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 108, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 108, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_newCSG = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":109
   *         """
   *         newCSG = CSG()
   *         for poly in self.polygons:             # <<<<<<<<<<<<<<
   *
   *             verts = poly.vertices
   */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_polygons);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 109, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1;
    __Pyx_INCREF(__pyx_t_2);
    __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1;
    __pyx_t_2 = PyObject_GetIter(__pyx_t_1);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 109, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_5 = Py_TYPE(__pyx_t_2)->tp_iternext;
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 109, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_5)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_2))
          break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_4);
        __Pyx_INCREF(__pyx_t_1);
        __pyx_t_4++;
        if (unlikely(0 < 0))
          __PYX_ERR(0, 109, __pyx_L1_error)
#else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_4);
        __pyx_t_4++;
        if (unlikely(!__pyx_t_1))
          __PYX_ERR(0, 109, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
#endif
      } else {
        if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_2))
          break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_4);
        __Pyx_INCREF(__pyx_t_1);
        __pyx_t_4++;
        if (unlikely(0 < 0))
          __PYX_ERR(0, 109, __pyx_L1_error)
#else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_4);
        __pyx_t_4++;
        if (unlikely(!__pyx_t_1))
          __PYX_ERR(0, 109, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
#endif
      }
    } else {
      __pyx_t_1 = __pyx_t_5(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject *exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type,
                                                       PyExc_StopIteration)))
            PyErr_Clear();
          else
            __PYX_ERR(0, 109, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_poly, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "pyg4ometry/pycsg/core.pyx":111
     *         for poly in self.polygons:
     *
     *             verts = poly.vertices             # <<<<<<<<<<<<<<
     *             numVerts = len(verts)
     *
     */
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_poly, __pyx_n_s_vertices);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 111, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_XDECREF_SET(__pyx_v_verts, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "pyg4ometry/pycsg/core.pyx":112
     *
     *             verts = poly.vertices
     *             numVerts = len(verts)             # <<<<<<<<<<<<<<
     *
     *             if numVerts == 0:
     */
    __pyx_t_6 = PyObject_Length(__pyx_v_verts);
    if (unlikely(__pyx_t_6 == ((Py_ssize_t)-1)))
      __PYX_ERR(0, 112, __pyx_L1_error)
    __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_6);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 112, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_XDECREF_SET(__pyx_v_numVerts, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "pyg4ometry/pycsg/core.pyx":114
     *             numVerts = len(verts)
     *
     *             if numVerts == 0:             # <<<<<<<<<<<<<<
     *                 continue
     *
     */
    __pyx_t_1 = __Pyx_PyInt_EqObjC(__pyx_v_numVerts, __pyx_int_0, 0, 0);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 114, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_1);
    if (unlikely(__pyx_t_7 < 0))
      __PYX_ERR(0, 114, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    if (__pyx_t_7) {

      /* "pyg4ometry/pycsg/core.pyx":115
       *
       *             if numVerts == 0:
       *                 continue             # <<<<<<<<<<<<<<
       *
       *             midPos = reduce(operator.add, [v.pos for v in verts]) /
       * float(numVerts)
       */
      goto __pyx_L3_continue;

      /* "pyg4ometry/pycsg/core.pyx":114
       *             numVerts = len(verts)
       *
       *             if numVerts == 0:             # <<<<<<<<<<<<<<
       *                 continue
       *
       */
    }

    /* "pyg4ometry/pycsg/core.pyx":117
     *                 continue
     *
     *             midPos = reduce(operator.add, [v.pos for v in verts]) /
     * float(numVerts)             # <<<<<<<<<<<<<< midNormal = None if
     * verts[0].normal is not None:
     */
    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_reduce);
    if (unlikely(!__pyx_t_3))
      __PYX_ERR(0, 117, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_operator);
    if (unlikely(!__pyx_t_8))
      __PYX_ERR(0, 117, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_add);
    if (unlikely(!__pyx_t_9))
      __PYX_ERR(0, 117, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(__pyx_t_8);
    __pyx_t_8 = 0;
    { /* enter inner scope */
      __pyx_t_8 = PyList_New(0);
      if (unlikely(!__pyx_t_8))
        __PYX_ERR(0, 117, __pyx_L8_error)
      __Pyx_GOTREF(__pyx_t_8);
      if (likely(PyList_CheckExact(__pyx_v_verts)) ||
          PyTuple_CheckExact(__pyx_v_verts)) {
        __pyx_t_10 = __pyx_v_verts;
        __Pyx_INCREF(__pyx_t_10);
        __pyx_t_6 = 0;
        __pyx_t_11 = NULL;
      } else {
        __pyx_t_6 = -1;
        __pyx_t_10 = PyObject_GetIter(__pyx_v_verts);
        if (unlikely(!__pyx_t_10))
          __PYX_ERR(0, 117, __pyx_L8_error)
        __Pyx_GOTREF(__pyx_t_10);
        __pyx_t_11 = Py_TYPE(__pyx_t_10)->tp_iternext;
        if (unlikely(!__pyx_t_11))
          __PYX_ERR(0, 117, __pyx_L8_error)
      }
      for (;;) {
        if (likely(!__pyx_t_11)) {
          if (likely(PyList_CheckExact(__pyx_t_10))) {
            if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_10))
              break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_12 = PyList_GET_ITEM(__pyx_t_10, __pyx_t_6);
            __Pyx_INCREF(__pyx_t_12);
            __pyx_t_6++;
            if (unlikely(0 < 0))
              __PYX_ERR(0, 117, __pyx_L8_error)
#else
            __pyx_t_12 = PySequence_ITEM(__pyx_t_10, __pyx_t_6);
            __pyx_t_6++;
            if (unlikely(!__pyx_t_12))
              __PYX_ERR(0, 117, __pyx_L8_error)
            __Pyx_GOTREF(__pyx_t_12);
#endif
          } else {
            if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_10))
              break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_12 = PyTuple_GET_ITEM(__pyx_t_10, __pyx_t_6);
            __Pyx_INCREF(__pyx_t_12);
            __pyx_t_6++;
            if (unlikely(0 < 0))
              __PYX_ERR(0, 117, __pyx_L8_error)
#else
            __pyx_t_12 = PySequence_ITEM(__pyx_t_10, __pyx_t_6);
            __pyx_t_6++;
            if (unlikely(!__pyx_t_12))
              __PYX_ERR(0, 117, __pyx_L8_error)
            __Pyx_GOTREF(__pyx_t_12);
#endif
          }
        } else {
          __pyx_t_12 = __pyx_t_11(__pyx_t_10);
          if (unlikely(!__pyx_t_12)) {
            PyObject *exc_type = PyErr_Occurred();
            if (exc_type) {
              if (likely(__Pyx_PyErr_GivenExceptionMatches(
                      exc_type, PyExc_StopIteration)))
                PyErr_Clear();
              else
                __PYX_ERR(0, 117, __pyx_L8_error)
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_12);
        }
        __Pyx_XDECREF_SET(__pyx_8genexpr1__pyx_v_v, __pyx_t_12);
        __pyx_t_12 = 0;
        __pyx_t_12 =
            __Pyx_PyObject_GetAttrStr(__pyx_8genexpr1__pyx_v_v, __pyx_n_s_pos);
        if (unlikely(!__pyx_t_12))
          __PYX_ERR(0, 117, __pyx_L8_error)
        __Pyx_GOTREF(__pyx_t_12);
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_8, (PyObject *)__pyx_t_12)))
          __PYX_ERR(0, 117, __pyx_L8_error)
        __Pyx_DECREF(__pyx_t_12);
        __pyx_t_12 = 0;
      }
      __Pyx_DECREF(__pyx_t_10);
      __pyx_t_10 = 0;
      __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_v);
      __pyx_8genexpr1__pyx_v_v = 0;
      goto __pyx_L11_exit_scope;
    __pyx_L8_error:;
      __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_v);
      __pyx_8genexpr1__pyx_v_v = 0;
      goto __pyx_L1_error;
    __pyx_L11_exit_scope:;
    } /* exit inner scope */
    __pyx_t_10 = NULL;
    __pyx_t_13 = 0;
    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_10)) {
        PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_10);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
        __pyx_t_13 = 1;
      }
    }
#if CYTHON_FAST_PYCALL
    if (PyFunction_Check(__pyx_t_3)) {
      PyObject *__pyx_temp[3] = {__pyx_t_10, __pyx_t_9, __pyx_t_8};
      __pyx_t_1 = __Pyx_PyFunction_FastCall(
          __pyx_t_3, __pyx_temp + 1 - __pyx_t_13, 2 + __pyx_t_13);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 117, __pyx_L1_error)
      __Pyx_XDECREF(__pyx_t_10);
      __pyx_t_10 = 0;
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      __Pyx_DECREF(__pyx_t_8);
      __pyx_t_8 = 0;
    } else
#endif
#if CYTHON_FAST_PYCCALL
        if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
      PyObject *__pyx_temp[3] = {__pyx_t_10, __pyx_t_9, __pyx_t_8};
      __pyx_t_1 = __Pyx_PyCFunction_FastCall(
          __pyx_t_3, __pyx_temp + 1 - __pyx_t_13, 2 + __pyx_t_13);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 117, __pyx_L1_error)
      __Pyx_XDECREF(__pyx_t_10);
      __pyx_t_10 = 0;
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      __Pyx_DECREF(__pyx_t_8);
      __pyx_t_8 = 0;
    } else
#endif
    {
      __pyx_t_12 = PyTuple_New(2 + __pyx_t_13);
      if (unlikely(!__pyx_t_12))
        __PYX_ERR(0, 117, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      if (__pyx_t_10) {
        __Pyx_GIVEREF(__pyx_t_10);
        PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10);
        __pyx_t_10 = NULL;
      }
      __Pyx_GIVEREF(__pyx_t_9);
      PyTuple_SET_ITEM(__pyx_t_12, 0 + __pyx_t_13, __pyx_t_9);
      __Pyx_GIVEREF(__pyx_t_8);
      PyTuple_SET_ITEM(__pyx_t_12, 1 + __pyx_t_13, __pyx_t_8);
      __pyx_t_9 = 0;
      __pyx_t_8 = 0;
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_12, NULL);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 117, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_12);
      __pyx_t_12 = 0;
    }
    __Pyx_DECREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = __Pyx_PyNumber_Float(__pyx_v_numVerts);
    if (unlikely(!__pyx_t_3))
      __PYX_ERR(0, 117, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_12 = __Pyx_PyNumber_Divide(__pyx_t_1, __pyx_t_3);
    if (unlikely(!__pyx_t_12))
      __PYX_ERR(0, 117, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __Pyx_XDECREF_SET(__pyx_v_midPos, __pyx_t_12);
    __pyx_t_12 = 0;

    /* "pyg4ometry/pycsg/core.pyx":118
     *
     *             midPos = reduce(operator.add, [v.pos for v in verts]) /
     * float(numVerts) midNormal = None             # <<<<<<<<<<<<<< if
     * verts[0].normal is not None: midNormal = poly.plane.normal
     */
    __Pyx_INCREF(Py_None);
    __Pyx_XDECREF_SET(__pyx_v_midNormal, Py_None);

    /* "pyg4ometry/pycsg/core.pyx":119
     *             midPos = reduce(operator.add, [v.pos for v in verts]) /
     * float(numVerts) midNormal = None if verts[0].normal is not None: #
     * <<<<<<<<<<<<<< midNormal = poly.plane.normal midVert = Vertex(midPos,
     * midNormal)
     */
    __pyx_t_12 = __Pyx_GetItemInt(__pyx_v_verts, 0, long, 1,
                                  __Pyx_PyInt_From_long, 0, 0, 1);
    if (unlikely(!__pyx_t_12))
      __PYX_ERR(0, 119, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_normal);
    if (unlikely(!__pyx_t_3))
      __PYX_ERR(0, 119, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_12);
    __pyx_t_12 = 0;
    __pyx_t_7 = (__pyx_t_3 != Py_None);
    __Pyx_DECREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_14 = (__pyx_t_7 != 0);
    if (__pyx_t_14) {

      /* "pyg4ometry/pycsg/core.pyx":120
       *             midNormal = None
       *             if verts[0].normal is not None:
       *                 midNormal = poly.plane.normal             #
       * <<<<<<<<<<<<<< midVert = Vertex(midPos, midNormal)
       *
       */
      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_poly, __pyx_n_s_plane);
      if (unlikely(!__pyx_t_3))
        __PYX_ERR(0, 120, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_normal);
      if (unlikely(!__pyx_t_12))
        __PYX_ERR(0, 120, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __Pyx_DECREF(__pyx_t_3);
      __pyx_t_3 = 0;
      __Pyx_DECREF_SET(__pyx_v_midNormal, __pyx_t_12);
      __pyx_t_12 = 0;

      /* "pyg4ometry/pycsg/core.pyx":119
       *             midPos = reduce(operator.add, [v.pos for v in verts]) /
       * float(numVerts) midNormal = None if verts[0].normal is not None: #
       * <<<<<<<<<<<<<< midNormal = poly.plane.normal midVert = Vertex(midPos,
       * midNormal)
       */
    }

    /* "pyg4ometry/pycsg/core.pyx":121
     *             if verts[0].normal is not None:
     *                 midNormal = poly.plane.normal
     *             midVert = Vertex(midPos, midNormal)             #
     * <<<<<<<<<<<<<<
     *
     *             newVerts = verts + \
     */
    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_Vertex);
    if (unlikely(!__pyx_t_3))
      __PYX_ERR(0, 121, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_1 = NULL;
    __pyx_t_13 = 0;
    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_1)) {
        PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_1);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
        __pyx_t_13 = 1;
      }
    }
#if CYTHON_FAST_PYCALL
    if (PyFunction_Check(__pyx_t_3)) {
      PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_v_midPos, __pyx_v_midNormal};
      __pyx_t_12 = __Pyx_PyFunction_FastCall(
          __pyx_t_3, __pyx_temp + 1 - __pyx_t_13, 2 + __pyx_t_13);
      if (unlikely(!__pyx_t_12))
        __PYX_ERR(0, 121, __pyx_L1_error)
      __Pyx_XDECREF(__pyx_t_1);
      __pyx_t_1 = 0;
      __Pyx_GOTREF(__pyx_t_12);
    } else
#endif
#if CYTHON_FAST_PYCCALL
        if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
      PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_v_midPos, __pyx_v_midNormal};
      __pyx_t_12 = __Pyx_PyCFunction_FastCall(
          __pyx_t_3, __pyx_temp + 1 - __pyx_t_13, 2 + __pyx_t_13);
      if (unlikely(!__pyx_t_12))
        __PYX_ERR(0, 121, __pyx_L1_error)
      __Pyx_XDECREF(__pyx_t_1);
      __pyx_t_1 = 0;
      __Pyx_GOTREF(__pyx_t_12);
    } else
#endif
    {
      __pyx_t_8 = PyTuple_New(2 + __pyx_t_13);
      if (unlikely(!__pyx_t_8))
        __PYX_ERR(0, 121, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      if (__pyx_t_1) {
        __Pyx_GIVEREF(__pyx_t_1);
        PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_1);
        __pyx_t_1 = NULL;
      }
      __Pyx_INCREF(__pyx_v_midPos);
      __Pyx_GIVEREF(__pyx_v_midPos);
      PyTuple_SET_ITEM(__pyx_t_8, 0 + __pyx_t_13, __pyx_v_midPos);
      __Pyx_INCREF(__pyx_v_midNormal);
      __Pyx_GIVEREF(__pyx_v_midNormal);
      PyTuple_SET_ITEM(__pyx_t_8, 1 + __pyx_t_13, __pyx_v_midNormal);
      __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_8, NULL);
      if (unlikely(!__pyx_t_12))
        __PYX_ERR(0, 121, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __Pyx_DECREF(__pyx_t_8);
      __pyx_t_8 = 0;
    }
    __Pyx_DECREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __Pyx_XDECREF_SET(__pyx_v_midVert, __pyx_t_12);
    __pyx_t_12 = 0;

    /* "pyg4ometry/pycsg/core.pyx":123
     *             midVert = Vertex(midPos, midNormal)
     *
     *             newVerts = verts + \             # <<<<<<<<<<<<<<
     *                        [verts[i].interpolate(verts[(i + 1)%numVerts],
     * 0.5) for i in range(numVerts)] + \ [midVert]
     */
    { /* enter inner scope */

      /* "pyg4ometry/pycsg/core.pyx":124
       *
       *             newVerts = verts + \
       *                        [verts[i].interpolate(verts[(i + 1)%numVerts],
       * 0.5) for i in range(numVerts)] + \             # <<<<<<<<<<<<<<
       *                        [midVert]
       *
       */
      __pyx_t_12 = PyList_New(0);
      if (unlikely(!__pyx_t_12))
        __PYX_ERR(0, 124, __pyx_L15_error)
      __Pyx_GOTREF(__pyx_t_12);
      __pyx_t_3 =
          __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_v_numVerts);
      if (unlikely(!__pyx_t_3))
        __PYX_ERR(0, 124, __pyx_L15_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (likely(PyList_CheckExact(__pyx_t_3)) ||
          PyTuple_CheckExact(__pyx_t_3)) {
        __pyx_t_8 = __pyx_t_3;
        __Pyx_INCREF(__pyx_t_8);
        __pyx_t_6 = 0;
        __pyx_t_11 = NULL;
      } else {
        __pyx_t_6 = -1;
        __pyx_t_8 = PyObject_GetIter(__pyx_t_3);
        if (unlikely(!__pyx_t_8))
          __PYX_ERR(0, 124, __pyx_L15_error)
        __Pyx_GOTREF(__pyx_t_8);
        __pyx_t_11 = Py_TYPE(__pyx_t_8)->tp_iternext;
        if (unlikely(!__pyx_t_11))
          __PYX_ERR(0, 124, __pyx_L15_error)
      }
      __Pyx_DECREF(__pyx_t_3);
      __pyx_t_3 = 0;
      for (;;) {
        if (likely(!__pyx_t_11)) {
          if (likely(PyList_CheckExact(__pyx_t_8))) {
            if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_8))
              break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_3 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_6);
            __Pyx_INCREF(__pyx_t_3);
            __pyx_t_6++;
            if (unlikely(0 < 0))
              __PYX_ERR(0, 124, __pyx_L15_error)
#else
            __pyx_t_3 = PySequence_ITEM(__pyx_t_8, __pyx_t_6);
            __pyx_t_6++;
            if (unlikely(!__pyx_t_3))
              __PYX_ERR(0, 124, __pyx_L15_error)
            __Pyx_GOTREF(__pyx_t_3);
#endif
          } else {
            if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_8))
              break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_6);
            __Pyx_INCREF(__pyx_t_3);
            __pyx_t_6++;
            if (unlikely(0 < 0))
              __PYX_ERR(0, 124, __pyx_L15_error)
#else
            __pyx_t_3 = PySequence_ITEM(__pyx_t_8, __pyx_t_6);
            __pyx_t_6++;
            if (unlikely(!__pyx_t_3))
              __PYX_ERR(0, 124, __pyx_L15_error)
            __Pyx_GOTREF(__pyx_t_3);
#endif
          }
        } else {
          __pyx_t_3 = __pyx_t_11(__pyx_t_8);
          if (unlikely(!__pyx_t_3)) {
            PyObject *exc_type = PyErr_Occurred();
            if (exc_type) {
              if (likely(__Pyx_PyErr_GivenExceptionMatches(
                      exc_type, PyExc_StopIteration)))
                PyErr_Clear();
              else
                __PYX_ERR(0, 124, __pyx_L15_error)
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_3);
        }
        __Pyx_XDECREF_SET(__pyx_8genexpr2__pyx_v_i, __pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_1 =
            __Pyx_PyObject_GetItem(__pyx_v_verts, __pyx_8genexpr2__pyx_v_i);
        if (unlikely(!__pyx_t_1))
          __PYX_ERR(0, 124, __pyx_L15_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_interpolate);
        if (unlikely(!__pyx_t_9))
          __PYX_ERR(0, 124, __pyx_L15_error)
        __Pyx_GOTREF(__pyx_t_9);
        __Pyx_DECREF(__pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 =
            __Pyx_PyInt_AddObjC(__pyx_8genexpr2__pyx_v_i, __pyx_int_1, 1, 0, 0);
        if (unlikely(!__pyx_t_1))
          __PYX_ERR(0, 124, __pyx_L15_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_10 = PyNumber_Remainder(__pyx_t_1, __pyx_v_numVerts);
        if (unlikely(!__pyx_t_10))
          __PYX_ERR(0, 124, __pyx_L15_error)
        __Pyx_GOTREF(__pyx_t_10);
        __Pyx_DECREF(__pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_verts, __pyx_t_10);
        if (unlikely(!__pyx_t_1))
          __PYX_ERR(0, 124, __pyx_L15_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_10);
        __pyx_t_10 = 0;
        __pyx_t_10 = NULL;
        __pyx_t_13 = 0;
        if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_9))) {
          __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_9);
          if (likely(__pyx_t_10)) {
            PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_9);
            __Pyx_INCREF(__pyx_t_10);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_9, function);
            __pyx_t_13 = 1;
          }
        }
#if CYTHON_FAST_PYCALL
        if (PyFunction_Check(__pyx_t_9)) {
          PyObject *__pyx_temp[3] = {__pyx_t_10, __pyx_t_1, __pyx_float_0_5};
          __pyx_t_3 = __Pyx_PyFunction_FastCall(
              __pyx_t_9, __pyx_temp + 1 - __pyx_t_13, 2 + __pyx_t_13);
          if (unlikely(!__pyx_t_3))
            __PYX_ERR(0, 124, __pyx_L15_error)
          __Pyx_XDECREF(__pyx_t_10);
          __pyx_t_10 = 0;
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_DECREF(__pyx_t_1);
          __pyx_t_1 = 0;
        } else
#endif
#if CYTHON_FAST_PYCCALL
            if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
          PyObject *__pyx_temp[3] = {__pyx_t_10, __pyx_t_1, __pyx_float_0_5};
          __pyx_t_3 = __Pyx_PyCFunction_FastCall(
              __pyx_t_9, __pyx_temp + 1 - __pyx_t_13, 2 + __pyx_t_13);
          if (unlikely(!__pyx_t_3))
            __PYX_ERR(0, 124, __pyx_L15_error)
          __Pyx_XDECREF(__pyx_t_10);
          __pyx_t_10 = 0;
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_DECREF(__pyx_t_1);
          __pyx_t_1 = 0;
        } else
#endif
        {
          __pyx_t_15 = PyTuple_New(2 + __pyx_t_13);
          if (unlikely(!__pyx_t_15))
            __PYX_ERR(0, 124, __pyx_L15_error)
          __Pyx_GOTREF(__pyx_t_15);
          if (__pyx_t_10) {
            __Pyx_GIVEREF(__pyx_t_10);
            PyTuple_SET_ITEM(__pyx_t_15, 0, __pyx_t_10);
            __pyx_t_10 = NULL;
          }
          __Pyx_GIVEREF(__pyx_t_1);
          PyTuple_SET_ITEM(__pyx_t_15, 0 + __pyx_t_13, __pyx_t_1);
          __Pyx_INCREF(__pyx_float_0_5);
          __Pyx_GIVEREF(__pyx_float_0_5);
          PyTuple_SET_ITEM(__pyx_t_15, 1 + __pyx_t_13, __pyx_float_0_5);
          __pyx_t_1 = 0;
          __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_15, NULL);
          if (unlikely(!__pyx_t_3))
            __PYX_ERR(0, 124, __pyx_L15_error)
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_DECREF(__pyx_t_15);
          __pyx_t_15 = 0;
        }
        __Pyx_DECREF(__pyx_t_9);
        __pyx_t_9 = 0;
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_12, (PyObject *)__pyx_t_3)))
          __PYX_ERR(0, 124, __pyx_L15_error)
        __Pyx_DECREF(__pyx_t_3);
        __pyx_t_3 = 0;
      }
      __Pyx_DECREF(__pyx_t_8);
      __pyx_t_8 = 0;
      __Pyx_XDECREF(__pyx_8genexpr2__pyx_v_i);
      __pyx_8genexpr2__pyx_v_i = 0;
      goto __pyx_L18_exit_scope;
    __pyx_L15_error:;
      __Pyx_XDECREF(__pyx_8genexpr2__pyx_v_i);
      __pyx_8genexpr2__pyx_v_i = 0;
      goto __pyx_L1_error;
    __pyx_L18_exit_scope:;
    } /* exit inner scope */

    /* "pyg4ometry/pycsg/core.pyx":123
     *             midVert = Vertex(midPos, midNormal)
     *
     *             newVerts = verts + \             # <<<<<<<<<<<<<<
     *                        [verts[i].interpolate(verts[(i + 1)%numVerts],
     * 0.5) for i in range(numVerts)] + \ [midVert]
     */
    __pyx_t_8 = PyNumber_Add(__pyx_v_verts, __pyx_t_12);
    if (unlikely(!__pyx_t_8))
      __PYX_ERR(0, 123, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_12);
    __pyx_t_12 = 0;

    /* "pyg4ometry/pycsg/core.pyx":125
     *             newVerts = verts + \
     *                        [verts[i].interpolate(verts[(i + 1)%numVerts],
     * 0.5) for i in range(numVerts)] + \ [midVert]             # <<<<<<<<<<<<<<
     *
     *             i = 0
     */
    __pyx_t_12 = PyList_New(1);
    if (unlikely(!__pyx_t_12))
      __PYX_ERR(0, 125, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __Pyx_INCREF(__pyx_v_midVert);
    __Pyx_GIVEREF(__pyx_v_midVert);
    PyList_SET_ITEM(__pyx_t_12, 0, __pyx_v_midVert);

    /* "pyg4ometry/pycsg/core.pyx":124
     *
     *             newVerts = verts + \
     *                        [verts[i].interpolate(verts[(i + 1)%numVerts],
     * 0.5) for i in range(numVerts)] + \             # <<<<<<<<<<<<<< [midVert]
     *
     */
    __pyx_t_3 = PyNumber_Add(__pyx_t_8, __pyx_t_12);
    if (unlikely(!__pyx_t_3))
      __PYX_ERR(0, 124, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_8);
    __pyx_t_8 = 0;
    __Pyx_DECREF(__pyx_t_12);
    __pyx_t_12 = 0;
    __Pyx_XDECREF_SET(__pyx_v_newVerts, __pyx_t_3);
    __pyx_t_3 = 0;

    /* "pyg4ometry/pycsg/core.pyx":127
     *                        [midVert]
     *
     *             i = 0             # <<<<<<<<<<<<<<
     *             vs = [newVerts[i], newVerts[i+numVerts],
     * newVerts[2*numVerts], newVerts[2*numVerts-1]] newPoly = Polygon(vs,
     * poly.shared)
     */
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_int_0);

    /* "pyg4ometry/pycsg/core.pyx":128
     *
     *             i = 0
     *             vs = [newVerts[i], newVerts[i+numVerts],
     * newVerts[2*numVerts], newVerts[2*numVerts-1]]             #
     * <<<<<<<<<<<<<< newPoly = Polygon(vs, poly.shared) newPoly.shared =
     * poly.shared
     */
    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_newVerts, __pyx_v_i);
    if (unlikely(!__pyx_t_3))
      __PYX_ERR(0, 128, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_12 = PyNumber_Add(__pyx_v_i, __pyx_v_numVerts);
    if (unlikely(!__pyx_t_12))
      __PYX_ERR(0, 128, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __pyx_t_8 = __Pyx_PyObject_GetItem(__pyx_v_newVerts, __pyx_t_12);
    if (unlikely(!__pyx_t_8))
      __PYX_ERR(0, 128, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_12);
    __pyx_t_12 = 0;
    __pyx_t_12 = PyNumber_Multiply(__pyx_int_2, __pyx_v_numVerts);
    if (unlikely(!__pyx_t_12))
      __PYX_ERR(0, 128, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_v_newVerts, __pyx_t_12);
    if (unlikely(!__pyx_t_9))
      __PYX_ERR(0, 128, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(__pyx_t_12);
    __pyx_t_12 = 0;
    __pyx_t_12 = PyNumber_Multiply(__pyx_int_2, __pyx_v_numVerts);
    if (unlikely(!__pyx_t_12))
      __PYX_ERR(0, 128, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __pyx_t_15 = __Pyx_PyInt_SubtractObjC(__pyx_t_12, __pyx_int_1, 1, 0, 0);
    if (unlikely(!__pyx_t_15))
      __PYX_ERR(0, 128, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_15);
    __Pyx_DECREF(__pyx_t_12);
    __pyx_t_12 = 0;
    __pyx_t_12 = __Pyx_PyObject_GetItem(__pyx_v_newVerts, __pyx_t_15);
    if (unlikely(!__pyx_t_12))
      __PYX_ERR(0, 128, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __Pyx_DECREF(__pyx_t_15);
    __pyx_t_15 = 0;
    __pyx_t_15 = PyList_New(4);
    if (unlikely(!__pyx_t_15))
      __PYX_ERR(0, 128, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_15);
    __Pyx_GIVEREF(__pyx_t_3);
    PyList_SET_ITEM(__pyx_t_15, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_8);
    PyList_SET_ITEM(__pyx_t_15, 1, __pyx_t_8);
    __Pyx_GIVEREF(__pyx_t_9);
    PyList_SET_ITEM(__pyx_t_15, 2, __pyx_t_9);
    __Pyx_GIVEREF(__pyx_t_12);
    PyList_SET_ITEM(__pyx_t_15, 3, __pyx_t_12);
    __pyx_t_3 = 0;
    __pyx_t_8 = 0;
    __pyx_t_9 = 0;
    __pyx_t_12 = 0;
    __Pyx_XDECREF_SET(__pyx_v_vs, ((PyObject *)__pyx_t_15));
    __pyx_t_15 = 0;

    /* "pyg4ometry/pycsg/core.pyx":129
     *             i = 0
     *             vs = [newVerts[i], newVerts[i+numVerts],
     * newVerts[2*numVerts], newVerts[2*numVerts-1]] newPoly = Polygon(vs,
     * poly.shared)             # <<<<<<<<<<<<<< newPoly.shared = poly.shared
     *             newPoly.plane = poly.plane
     */
    __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_Polygon);
    if (unlikely(!__pyx_t_12))
      __PYX_ERR(0, 129, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_poly, __pyx_n_s_shared);
    if (unlikely(!__pyx_t_9))
      __PYX_ERR(0, 129, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __pyx_t_8 = NULL;
    __pyx_t_13 = 0;
    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_12))) {
      __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_12);
      if (likely(__pyx_t_8)) {
        PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_12);
        __Pyx_INCREF(__pyx_t_8);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_12, function);
        __pyx_t_13 = 1;
      }
    }
#if CYTHON_FAST_PYCALL
    if (PyFunction_Check(__pyx_t_12)) {
      PyObject *__pyx_temp[3] = {__pyx_t_8, __pyx_v_vs, __pyx_t_9};
      __pyx_t_15 = __Pyx_PyFunction_FastCall(
          __pyx_t_12, __pyx_temp + 1 - __pyx_t_13, 2 + __pyx_t_13);
      if (unlikely(!__pyx_t_15))
        __PYX_ERR(0, 129, __pyx_L1_error)
      __Pyx_XDECREF(__pyx_t_8);
      __pyx_t_8 = 0;
      __Pyx_GOTREF(__pyx_t_15);
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
    } else
#endif
#if CYTHON_FAST_PYCCALL
        if (__Pyx_PyFastCFunction_Check(__pyx_t_12)) {
      PyObject *__pyx_temp[3] = {__pyx_t_8, __pyx_v_vs, __pyx_t_9};
      __pyx_t_15 = __Pyx_PyCFunction_FastCall(
          __pyx_t_12, __pyx_temp + 1 - __pyx_t_13, 2 + __pyx_t_13);
      if (unlikely(!__pyx_t_15))
        __PYX_ERR(0, 129, __pyx_L1_error)
      __Pyx_XDECREF(__pyx_t_8);
      __pyx_t_8 = 0;
      __Pyx_GOTREF(__pyx_t_15);
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
    } else
#endif
    {
      __pyx_t_3 = PyTuple_New(2 + __pyx_t_13);
      if (unlikely(!__pyx_t_3))
        __PYX_ERR(0, 129, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (__pyx_t_8) {
        __Pyx_GIVEREF(__pyx_t_8);
        PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_8);
        __pyx_t_8 = NULL;
      }
      __Pyx_INCREF(__pyx_v_vs);
      __Pyx_GIVEREF(__pyx_v_vs);
      PyTuple_SET_ITEM(__pyx_t_3, 0 + __pyx_t_13, __pyx_v_vs);
      __Pyx_GIVEREF(__pyx_t_9);
      PyTuple_SET_ITEM(__pyx_t_3, 1 + __pyx_t_13, __pyx_t_9);
      __pyx_t_9 = 0;
      __pyx_t_15 = __Pyx_PyObject_Call(__pyx_t_12, __pyx_t_3, NULL);
      if (unlikely(!__pyx_t_15))
        __PYX_ERR(0, 129, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_15);
      __Pyx_DECREF(__pyx_t_3);
      __pyx_t_3 = 0;
    }
    __Pyx_DECREF(__pyx_t_12);
    __pyx_t_12 = 0;
    __Pyx_XDECREF_SET(__pyx_v_newPoly, __pyx_t_15);
    __pyx_t_15 = 0;

    /* "pyg4ometry/pycsg/core.pyx":130
     *             vs = [newVerts[i], newVerts[i+numVerts],
     * newVerts[2*numVerts], newVerts[2*numVerts-1]] newPoly = Polygon(vs,
     * poly.shared) newPoly.shared = poly.shared             # <<<<<<<<<<<<<<
     *             newPoly.plane = poly.plane
     *             newCSG.polygons.append(newPoly)
     */
    __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_v_poly, __pyx_n_s_shared);
    if (unlikely(!__pyx_t_15))
      __PYX_ERR(0, 130, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_15);
    if (__Pyx_PyObject_SetAttrStr(__pyx_v_newPoly, __pyx_n_s_shared,
                                  __pyx_t_15) < 0)
      __PYX_ERR(0, 130, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_15);
    __pyx_t_15 = 0;

    /* "pyg4ometry/pycsg/core.pyx":131
     *             newPoly = Polygon(vs, poly.shared)
     *             newPoly.shared = poly.shared
     *             newPoly.plane = poly.plane             # <<<<<<<<<<<<<<
     *             newCSG.polygons.append(newPoly)
     *
     */
    __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_v_poly, __pyx_n_s_plane);
    if (unlikely(!__pyx_t_15))
      __PYX_ERR(0, 131, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_15);
    if (__Pyx_PyObject_SetAttrStr(__pyx_v_newPoly, __pyx_n_s_plane,
                                  __pyx_t_15) < 0)
      __PYX_ERR(0, 131, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_15);
    __pyx_t_15 = 0;

    /* "pyg4ometry/pycsg/core.pyx":132
     *             newPoly.shared = poly.shared
     *             newPoly.plane = poly.plane
     *             newCSG.polygons.append(newPoly)             # <<<<<<<<<<<<<<
     *
     *             for i in range(1, numVerts):
     */
    __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_v_newCSG, __pyx_n_s_polygons);
    if (unlikely(!__pyx_t_15))
      __PYX_ERR(0, 132, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_15);
    __pyx_t_16 = __Pyx_PyObject_Append(__pyx_t_15, __pyx_v_newPoly);
    if (unlikely(__pyx_t_16 == ((int)-1)))
      __PYX_ERR(0, 132, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_15);
    __pyx_t_15 = 0;

    /* "pyg4ometry/pycsg/core.pyx":134
     *             newCSG.polygons.append(newPoly)
     *
     *             for i in range(1, numVerts):             # <<<<<<<<<<<<<<
     *                 vs = [newVerts[i], newVerts[numVerts+i],
     * newVerts[2*numVerts], newVerts[numVerts+i-1]] newPoly = Polygon(vs,
     * poly.shared)
     */
    __pyx_t_15 = PyTuple_New(2);
    if (unlikely(!__pyx_t_15))
      __PYX_ERR(0, 134, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_15);
    __Pyx_INCREF(__pyx_int_1);
    __Pyx_GIVEREF(__pyx_int_1);
    PyTuple_SET_ITEM(__pyx_t_15, 0, __pyx_int_1);
    __Pyx_INCREF(__pyx_v_numVerts);
    __Pyx_GIVEREF(__pyx_v_numVerts);
    PyTuple_SET_ITEM(__pyx_t_15, 1, __pyx_v_numVerts);
    __pyx_t_12 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_15, NULL);
    if (unlikely(!__pyx_t_12))
      __PYX_ERR(0, 134, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __Pyx_DECREF(__pyx_t_15);
    __pyx_t_15 = 0;
    if (likely(PyList_CheckExact(__pyx_t_12)) ||
        PyTuple_CheckExact(__pyx_t_12)) {
      __pyx_t_15 = __pyx_t_12;
      __Pyx_INCREF(__pyx_t_15);
      __pyx_t_6 = 0;
      __pyx_t_11 = NULL;
    } else {
      __pyx_t_6 = -1;
      __pyx_t_15 = PyObject_GetIter(__pyx_t_12);
      if (unlikely(!__pyx_t_15))
        __PYX_ERR(0, 134, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_15);
      __pyx_t_11 = Py_TYPE(__pyx_t_15)->tp_iternext;
      if (unlikely(!__pyx_t_11))
        __PYX_ERR(0, 134, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_12);
    __pyx_t_12 = 0;
    for (;;) {
      if (likely(!__pyx_t_11)) {
        if (likely(PyList_CheckExact(__pyx_t_15))) {
          if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_15))
            break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_12 = PyList_GET_ITEM(__pyx_t_15, __pyx_t_6);
          __Pyx_INCREF(__pyx_t_12);
          __pyx_t_6++;
          if (unlikely(0 < 0))
            __PYX_ERR(0, 134, __pyx_L1_error)
#else
          __pyx_t_12 = PySequence_ITEM(__pyx_t_15, __pyx_t_6);
          __pyx_t_6++;
          if (unlikely(!__pyx_t_12))
            __PYX_ERR(0, 134, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_12);
#endif
        } else {
          if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_15))
            break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_12 = PyTuple_GET_ITEM(__pyx_t_15, __pyx_t_6);
          __Pyx_INCREF(__pyx_t_12);
          __pyx_t_6++;
          if (unlikely(0 < 0))
            __PYX_ERR(0, 134, __pyx_L1_error)
#else
          __pyx_t_12 = PySequence_ITEM(__pyx_t_15, __pyx_t_6);
          __pyx_t_6++;
          if (unlikely(!__pyx_t_12))
            __PYX_ERR(0, 134, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_12);
#endif
        }
      } else {
        __pyx_t_12 = __pyx_t_11(__pyx_t_15);
        if (unlikely(!__pyx_t_12)) {
          PyObject *exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type,
                                                         PyExc_StopIteration)))
              PyErr_Clear();
            else
              __PYX_ERR(0, 134, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_12);
      }
      __Pyx_DECREF_SET(__pyx_v_i, __pyx_t_12);
      __pyx_t_12 = 0;

      /* "pyg4ometry/pycsg/core.pyx":135
       *
       *             for i in range(1, numVerts):
       *                 vs = [newVerts[i], newVerts[numVerts+i],
       * newVerts[2*numVerts], newVerts[numVerts+i-1]]             #
       * <<<<<<<<<<<<<< newPoly = Polygon(vs, poly.shared)
       *                 newCSG.polygons.append(newPoly)
       */
      __pyx_t_12 = __Pyx_PyObject_GetItem(__pyx_v_newVerts, __pyx_v_i);
      if (unlikely(!__pyx_t_12))
        __PYX_ERR(0, 135, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __pyx_t_3 = PyNumber_Add(__pyx_v_numVerts, __pyx_v_i);
      if (unlikely(!__pyx_t_3))
        __PYX_ERR(0, 135, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_v_newVerts, __pyx_t_3);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 135, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = PyNumber_Multiply(__pyx_int_2, __pyx_v_numVerts);
      if (unlikely(!__pyx_t_3))
        __PYX_ERR(0, 135, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_8 = __Pyx_PyObject_GetItem(__pyx_v_newVerts, __pyx_t_3);
      if (unlikely(!__pyx_t_8))
        __PYX_ERR(0, 135, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = PyNumber_Add(__pyx_v_numVerts, __pyx_v_i);
      if (unlikely(!__pyx_t_3))
        __PYX_ERR(0, 135, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_t_3, __pyx_int_1, 1, 0, 0);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 135, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_newVerts, __pyx_t_1);
      if (unlikely(!__pyx_t_3))
        __PYX_ERR(0, 135, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_1 = PyList_New(4);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 135, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_GIVEREF(__pyx_t_12);
      PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_12);
      __Pyx_GIVEREF(__pyx_t_9);
      PyList_SET_ITEM(__pyx_t_1, 1, __pyx_t_9);
      __Pyx_GIVEREF(__pyx_t_8);
      PyList_SET_ITEM(__pyx_t_1, 2, __pyx_t_8);
      __Pyx_GIVEREF(__pyx_t_3);
      PyList_SET_ITEM(__pyx_t_1, 3, __pyx_t_3);
      __pyx_t_12 = 0;
      __pyx_t_9 = 0;
      __pyx_t_8 = 0;
      __pyx_t_3 = 0;
      __Pyx_DECREF_SET(__pyx_v_vs, ((PyObject *)__pyx_t_1));
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":136
       *             for i in range(1, numVerts):
       *                 vs = [newVerts[i], newVerts[numVerts+i],
       * newVerts[2*numVerts], newVerts[numVerts+i-1]] newPoly = Polygon(vs,
       * poly.shared)             # <<<<<<<<<<<<<<
       *                 newCSG.polygons.append(newPoly)
       *
       */
      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_Polygon);
      if (unlikely(!__pyx_t_3))
        __PYX_ERR(0, 136, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_poly, __pyx_n_s_shared);
      if (unlikely(!__pyx_t_8))
        __PYX_ERR(0, 136, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_9 = NULL;
      __pyx_t_13 = 0;
      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_3);
        if (likely(__pyx_t_9)) {
          PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
          __Pyx_INCREF(__pyx_t_9);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_3, function);
          __pyx_t_13 = 1;
        }
      }
#if CYTHON_FAST_PYCALL
      if (PyFunction_Check(__pyx_t_3)) {
        PyObject *__pyx_temp[3] = {__pyx_t_9, __pyx_v_vs, __pyx_t_8};
        __pyx_t_1 = __Pyx_PyFunction_FastCall(
            __pyx_t_3, __pyx_temp + 1 - __pyx_t_13, 2 + __pyx_t_13);
        if (unlikely(!__pyx_t_1))
          __PYX_ERR(0, 136, __pyx_L1_error)
        __Pyx_XDECREF(__pyx_t_9);
        __pyx_t_9 = 0;
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_8);
        __pyx_t_8 = 0;
      } else
#endif
#if CYTHON_FAST_PYCCALL
          if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
        PyObject *__pyx_temp[3] = {__pyx_t_9, __pyx_v_vs, __pyx_t_8};
        __pyx_t_1 = __Pyx_PyCFunction_FastCall(
            __pyx_t_3, __pyx_temp + 1 - __pyx_t_13, 2 + __pyx_t_13);
        if (unlikely(!__pyx_t_1))
          __PYX_ERR(0, 136, __pyx_L1_error)
        __Pyx_XDECREF(__pyx_t_9);
        __pyx_t_9 = 0;
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_8);
        __pyx_t_8 = 0;
      } else
#endif
      {
        __pyx_t_12 = PyTuple_New(2 + __pyx_t_13);
        if (unlikely(!__pyx_t_12))
          __PYX_ERR(0, 136, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        if (__pyx_t_9) {
          __Pyx_GIVEREF(__pyx_t_9);
          PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_9);
          __pyx_t_9 = NULL;
        }
        __Pyx_INCREF(__pyx_v_vs);
        __Pyx_GIVEREF(__pyx_v_vs);
        PyTuple_SET_ITEM(__pyx_t_12, 0 + __pyx_t_13, __pyx_v_vs);
        __Pyx_GIVEREF(__pyx_t_8);
        PyTuple_SET_ITEM(__pyx_t_12, 1 + __pyx_t_13, __pyx_t_8);
        __pyx_t_8 = 0;
        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_12, NULL);
        if (unlikely(!__pyx_t_1))
          __PYX_ERR(0, 136, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_12);
        __pyx_t_12 = 0;
      }
      __Pyx_DECREF(__pyx_t_3);
      __pyx_t_3 = 0;
      __Pyx_DECREF_SET(__pyx_v_newPoly, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":137
       *                 vs = [newVerts[i], newVerts[numVerts+i],
       * newVerts[2*numVerts], newVerts[numVerts+i-1]] newPoly = Polygon(vs,
       * poly.shared) newCSG.polygons.append(newPoly)             #
       * <<<<<<<<<<<<<<
       *
       *         return newCSG
       */
      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_newCSG, __pyx_n_s_polygons);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 137, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_16 = __Pyx_PyObject_Append(__pyx_t_1, __pyx_v_newPoly);
      if (unlikely(__pyx_t_16 == ((int)-1)))
        __PYX_ERR(0, 137, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1);
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":134
       *             newCSG.polygons.append(newPoly)
       *
       *             for i in range(1, numVerts):             # <<<<<<<<<<<<<<
       *                 vs = [newVerts[i], newVerts[numVerts+i],
       * newVerts[2*numVerts], newVerts[numVerts+i-1]] newPoly = Polygon(vs,
       * poly.shared)
       */
    }
    __Pyx_DECREF(__pyx_t_15);
    __pyx_t_15 = 0;

  /* "pyg4ometry/pycsg/core.pyx":109
   *         """
   *         newCSG = CSG()
   *         for poly in self.polygons:             # <<<<<<<<<<<<<<
   *
   *             verts = poly.vertices
   */
  __pyx_L3_continue:;
  }
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":139
   *                 newCSG.polygons.append(newPoly)
   *
   *         return newCSG             # <<<<<<<<<<<<<<
   *
   *     def translate(self, disp):
   */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_newCSG);
  __pyx_r = __pyx_v_newCSG;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":103
 *         return vCount
 *
 *     def refine(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return a refined CSG. To each polygon, a middle point is added to
 * each edge and to the center
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_XDECREF(__pyx_t_15);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.refine", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XDECREF(__pyx_v_newCSG);
  __Pyx_XDECREF(__pyx_v_poly);
  __Pyx_XDECREF(__pyx_v_verts);
  __Pyx_XDECREF(__pyx_v_numVerts);
  __Pyx_XDECREF(__pyx_v_midPos);
  __Pyx_XDECREF(__pyx_v_midNormal);
  __Pyx_XDECREF(__pyx_v_midVert);
  __Pyx_XDECREF(__pyx_v_newVerts);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XDECREF(__pyx_v_vs);
  __Pyx_XDECREF(__pyx_v_newPoly);
  __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_v);
  __Pyx_XDECREF(__pyx_8genexpr2__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":141
 *         return newCSG
 *
 *     def translate(self, disp):             # <<<<<<<<<<<<<<
 *         """
 *         Translate Geometry.
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_19translate(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_18translate[] =
    "\n        Translate Geometry.\n           disp: displacement (array of "
    "floats)\n        ";
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_19translate = {
    "translate",
    (PyCFunction)(void *)(PyCFunctionWithKeywords)
        __pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_19translate,
    METH_VARARGS | METH_KEYWORDS,
    __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_18translate};
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_19translate(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_self = 0;
  PyObject *__pyx_v_disp = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext("translate (wrapper)",
                                                        0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self, &__pyx_n_s_disp,
                                            0};
    PyObject *values[2] = {0, 0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
      case 2:
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
      case 1:
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
      case 0:
        break;
      default:
        goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
      case 0:
        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_self)) != 0))
          kw_args--;
        else
          goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
      case 1:
        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_disp)) != 0))
          kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("translate", 1, 2, 2, 1);
          __PYX_ERR(0, 141, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames,
                                                 0, values, pos_args,
                                                 "translate") < 0))
          __PYX_ERR(0, 141, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_self = values[0];
    __pyx_v_disp = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
__pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("translate", 1, 2, 2,
                             PyTuple_GET_SIZE(__pyx_args));
  __PYX_ERR(0, 141, __pyx_L3_error)
__pyx_L3_error:;
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.translate", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
__pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_18translate(
      __pyx_self, __pyx_v_self, __pyx_v_disp);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_18translate(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self,
    PyObject *__pyx_v_disp) {
  PyObject *__pyx_v_d = NULL;
  PyObject *__pyx_v_poly = NULL;
  PyObject *__pyx_v_v = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  int __pyx_t_7;
  PyObject *__pyx_t_8 = NULL;
  Py_ssize_t __pyx_t_9;
  PyObject *(*__pyx_t_10)(PyObject *);
  Py_ssize_t __pyx_t_11;
  PyObject *(*__pyx_t_12)(PyObject *);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("translate", 0);

  /* "pyg4ometry/pycsg/core.pyx":146
   *            disp: displacement (array of floats)
   *         """
   *         d = Vector(disp[0], disp[1], disp[2])             # <<<<<<<<<<<<<<
   *         for poly in self.polygons:
   *             for v in poly.vertices:
   */
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_Vector);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 146, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_disp, 0, long, 1, __Pyx_PyInt_From_long,
                               0, 0, 1);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 146, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_disp, 1, long, 1, __Pyx_PyInt_From_long,
                               0, 0, 1);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 146, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_disp, 2, long, 1, __Pyx_PyInt_From_long,
                               0, 0, 1);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 146, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = NULL;
  __pyx_t_7 = 0;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_6)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_7 = 1;
    }
  }
#if CYTHON_FAST_PYCALL
  if (PyFunction_Check(__pyx_t_2)) {
    PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_t_3, __pyx_t_4, __pyx_t_5};
    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp + 1 - __pyx_t_7,
                                          3 + __pyx_t_7);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 146, __pyx_L1_error)
    __Pyx_XDECREF(__pyx_t_6);
    __pyx_t_6 = 0;
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_4);
    __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_5);
    __pyx_t_5 = 0;
  } else
#endif
#if CYTHON_FAST_PYCCALL
      if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
    PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_t_3, __pyx_t_4, __pyx_t_5};
    __pyx_t_1 = __Pyx_PyCFunction_FastCall(
        __pyx_t_2, __pyx_temp + 1 - __pyx_t_7, 3 + __pyx_t_7);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 146, __pyx_L1_error)
    __Pyx_XDECREF(__pyx_t_6);
    __pyx_t_6 = 0;
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_4);
    __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_5);
    __pyx_t_5 = 0;
  } else
#endif
  {
    __pyx_t_8 = PyTuple_New(3 + __pyx_t_7);
    if (unlikely(!__pyx_t_8))
      __PYX_ERR(0, 146, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    if (__pyx_t_6) {
      __Pyx_GIVEREF(__pyx_t_6);
      PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_6);
      __pyx_t_6 = NULL;
    }
    __Pyx_GIVEREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_8, 0 + __pyx_t_7, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_8, 1 + __pyx_t_7, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_8, 2 + __pyx_t_7, __pyx_t_5);
    __pyx_t_3 = 0;
    __pyx_t_4 = 0;
    __pyx_t_5 = 0;
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_8, NULL);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 146, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_8);
    __pyx_t_8 = 0;
  }
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_d = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":147
   *         """
   *         d = Vector(disp[0], disp[1], disp[2])
   *         for poly in self.polygons:             # <<<<<<<<<<<<<<
   *             for v in poly.vertices:
   *                 v.pos = v.pos.plus(d)
   */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_polygons);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 147, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1;
    __Pyx_INCREF(__pyx_t_2);
    __pyx_t_9 = 0;
    __pyx_t_10 = NULL;
  } else {
    __pyx_t_9 = -1;
    __pyx_t_2 = PyObject_GetIter(__pyx_t_1);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 147, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_10 = Py_TYPE(__pyx_t_2)->tp_iternext;
    if (unlikely(!__pyx_t_10))
      __PYX_ERR(0, 147, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_10)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_9 >= PyList_GET_SIZE(__pyx_t_2))
          break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_9);
        __Pyx_INCREF(__pyx_t_1);
        __pyx_t_9++;
        if (unlikely(0 < 0))
          __PYX_ERR(0, 147, __pyx_L1_error)
#else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_9);
        __pyx_t_9++;
        if (unlikely(!__pyx_t_1))
          __PYX_ERR(0, 147, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
#endif
      } else {
        if (__pyx_t_9 >= PyTuple_GET_SIZE(__pyx_t_2))
          break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_9);
        __Pyx_INCREF(__pyx_t_1);
        __pyx_t_9++;
        if (unlikely(0 < 0))
          __PYX_ERR(0, 147, __pyx_L1_error)
#else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_9);
        __pyx_t_9++;
        if (unlikely(!__pyx_t_1))
          __PYX_ERR(0, 147, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
#endif
      }
    } else {
      __pyx_t_1 = __pyx_t_10(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject *exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type,
                                                       PyExc_StopIteration)))
            PyErr_Clear();
          else
            __PYX_ERR(0, 147, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_poly, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "pyg4ometry/pycsg/core.pyx":148
     *         d = Vector(disp[0], disp[1], disp[2])
     *         for poly in self.polygons:
     *             for v in poly.vertices:             # <<<<<<<<<<<<<<
     *                 v.pos = v.pos.plus(d)
     *                 # no change to the normals
     */
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_poly, __pyx_n_s_vertices);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 148, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
      __pyx_t_8 = __pyx_t_1;
      __Pyx_INCREF(__pyx_t_8);
      __pyx_t_11 = 0;
      __pyx_t_12 = NULL;
    } else {
      __pyx_t_11 = -1;
      __pyx_t_8 = PyObject_GetIter(__pyx_t_1);
      if (unlikely(!__pyx_t_8))
        __PYX_ERR(0, 148, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_12 = Py_TYPE(__pyx_t_8)->tp_iternext;
      if (unlikely(!__pyx_t_12))
        __PYX_ERR(0, 148, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_12)) {
        if (likely(PyList_CheckExact(__pyx_t_8))) {
          if (__pyx_t_11 >= PyList_GET_SIZE(__pyx_t_8))
            break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_11);
          __Pyx_INCREF(__pyx_t_1);
          __pyx_t_11++;
          if (unlikely(0 < 0))
            __PYX_ERR(0, 148, __pyx_L1_error)
#else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_8, __pyx_t_11);
          __pyx_t_11++;
          if (unlikely(!__pyx_t_1))
            __PYX_ERR(0, 148, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
#endif
        } else {
          if (__pyx_t_11 >= PyTuple_GET_SIZE(__pyx_t_8))
            break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_11);
          __Pyx_INCREF(__pyx_t_1);
          __pyx_t_11++;
          if (unlikely(0 < 0))
            __PYX_ERR(0, 148, __pyx_L1_error)
#else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_8, __pyx_t_11);
          __pyx_t_11++;
          if (unlikely(!__pyx_t_1))
            __PYX_ERR(0, 148, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
#endif
        }
      } else {
        __pyx_t_1 = __pyx_t_12(__pyx_t_8);
        if (unlikely(!__pyx_t_1)) {
          PyObject *exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type,
                                                         PyExc_StopIteration)))
              PyErr_Clear();
            else
              __PYX_ERR(0, 148, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_1);
      }
      __Pyx_XDECREF_SET(__pyx_v_v, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":149
       *         for poly in self.polygons:
       *             for v in poly.vertices:
       *                 v.pos = v.pos.plus(d)             # <<<<<<<<<<<<<<
       *                 # no change to the normals
       *
       */
      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_v, __pyx_n_s_pos);
      if (unlikely(!__pyx_t_5))
        __PYX_ERR(0, 149, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_plus);
      if (unlikely(!__pyx_t_4))
        __PYX_ERR(0, 149, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_5);
      __pyx_t_5 = 0;
      __pyx_t_5 = NULL;
      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
        __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
        if (likely(__pyx_t_5)) {
          PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_4);
          __Pyx_INCREF(__pyx_t_5);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_4, function);
        }
      }
      __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5,
                                                         __pyx_v_d)
                              : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_d);
      __Pyx_XDECREF(__pyx_t_5);
      __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 149, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_4);
      __pyx_t_4 = 0;
      if (__Pyx_PyObject_SetAttrStr(__pyx_v_v, __pyx_n_s_pos, __pyx_t_1) < 0)
        __PYX_ERR(0, 149, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1);
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":148
       *         d = Vector(disp[0], disp[1], disp[2])
       *         for poly in self.polygons:
       *             for v in poly.vertices:             # <<<<<<<<<<<<<<
       *                 v.pos = v.pos.plus(d)
       *                 # no change to the normals
       */
    }
    __Pyx_DECREF(__pyx_t_8);
    __pyx_t_8 = 0;

    /* "pyg4ometry/pycsg/core.pyx":147
     *         """
     *         d = Vector(disp[0], disp[1], disp[2])
     *         for poly in self.polygons:             # <<<<<<<<<<<<<<
     *             for v in poly.vertices:
     *                 v.pos = v.pos.plus(d)
     */
  }
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":141
   *         return newCSG
   *
   *     def translate(self, disp):             # <<<<<<<<<<<<<<
   *         """
   *         Translate Geometry.
   */

  /* function exit code */
  __pyx_r = Py_None;
  __Pyx_INCREF(Py_None);
  goto __pyx_L0;
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.translate", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XDECREF(__pyx_v_d);
  __Pyx_XDECREF(__pyx_v_poly);
  __Pyx_XDECREF(__pyx_v_v);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":153
 *
 *
 *     def scale(self, scale):             # <<<<<<<<<<<<<<
 *         """
 *         Translate Geometry.
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_21scale(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_20scale[] =
    "\n        Translate Geometry.\n           scale: displacement (array of "
    "floats)\n        ";
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_21scale = {
    "scale",
    (PyCFunction)(void *)(PyCFunctionWithKeywords)
        __pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_21scale,
    METH_VARARGS | METH_KEYWORDS,
    __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_20scale};
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_21scale(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_self = 0;
  PyObject *__pyx_v_scale = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext("scale (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self, &__pyx_n_s_scale,
                                            0};
    PyObject *values[2] = {0, 0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
      case 2:
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
      case 1:
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
      case 0:
        break;
      default:
        goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
      case 0:
        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_self)) != 0))
          kw_args--;
        else
          goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
      case 1:
        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_scale)) != 0))
          kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("scale", 1, 2, 2, 1);
          __PYX_ERR(0, 153, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames,
                                                 0, values, pos_args,
                                                 "scale") < 0))
          __PYX_ERR(0, 153, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_self = values[0];
    __pyx_v_scale = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
__pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("scale", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args));
  __PYX_ERR(0, 153, __pyx_L3_error)
__pyx_L3_error:;
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.scale", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
__pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_20scale(
      __pyx_self, __pyx_v_self, __pyx_v_scale);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_20scale(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self,
    PyObject *__pyx_v_scale) {
  PyObject *__pyx_v_d = NULL;
  PyObject *__pyx_v_poly = NULL;
  PyObject *__pyx_v_v = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  int __pyx_t_7;
  PyObject *__pyx_t_8 = NULL;
  Py_ssize_t __pyx_t_9;
  PyObject *(*__pyx_t_10)(PyObject *);
  Py_ssize_t __pyx_t_11;
  PyObject *(*__pyx_t_12)(PyObject *);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("scale", 0);

  /* "pyg4ometry/pycsg/core.pyx":158
   *            scale: displacement (array of floats)
   *         """
   *         d = Vector(scale[0], scale[1], scale[2])             #
   * <<<<<<<<<<<<<< for poly in self.polygons: for v in poly.vertices:
   */
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_Vector);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 158, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_scale, 0, long, 1, __Pyx_PyInt_From_long,
                               0, 0, 1);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 158, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_scale, 1, long, 1, __Pyx_PyInt_From_long,
                               0, 0, 1);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 158, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_scale, 2, long, 1, __Pyx_PyInt_From_long,
                               0, 0, 1);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 158, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = NULL;
  __pyx_t_7 = 0;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_6)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_7 = 1;
    }
  }
#if CYTHON_FAST_PYCALL
  if (PyFunction_Check(__pyx_t_2)) {
    PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_t_3, __pyx_t_4, __pyx_t_5};
    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp + 1 - __pyx_t_7,
                                          3 + __pyx_t_7);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 158, __pyx_L1_error)
    __Pyx_XDECREF(__pyx_t_6);
    __pyx_t_6 = 0;
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_4);
    __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_5);
    __pyx_t_5 = 0;
  } else
#endif
#if CYTHON_FAST_PYCCALL
      if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
    PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_t_3, __pyx_t_4, __pyx_t_5};
    __pyx_t_1 = __Pyx_PyCFunction_FastCall(
        __pyx_t_2, __pyx_temp + 1 - __pyx_t_7, 3 + __pyx_t_7);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 158, __pyx_L1_error)
    __Pyx_XDECREF(__pyx_t_6);
    __pyx_t_6 = 0;
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_4);
    __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_5);
    __pyx_t_5 = 0;
  } else
#endif
  {
    __pyx_t_8 = PyTuple_New(3 + __pyx_t_7);
    if (unlikely(!__pyx_t_8))
      __PYX_ERR(0, 158, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    if (__pyx_t_6) {
      __Pyx_GIVEREF(__pyx_t_6);
      PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_6);
      __pyx_t_6 = NULL;
    }
    __Pyx_GIVEREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_8, 0 + __pyx_t_7, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_8, 1 + __pyx_t_7, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_8, 2 + __pyx_t_7, __pyx_t_5);
    __pyx_t_3 = 0;
    __pyx_t_4 = 0;
    __pyx_t_5 = 0;
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_8, NULL);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 158, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_8);
    __pyx_t_8 = 0;
  }
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_d = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":159
   *         """
   *         d = Vector(scale[0], scale[1], scale[2])
   *         for poly in self.polygons:             # <<<<<<<<<<<<<<
   *             for v in poly.vertices:
   *                 v.pos = v.pos.scale(d)
   */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_polygons);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 159, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1;
    __Pyx_INCREF(__pyx_t_2);
    __pyx_t_9 = 0;
    __pyx_t_10 = NULL;
  } else {
    __pyx_t_9 = -1;
    __pyx_t_2 = PyObject_GetIter(__pyx_t_1);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 159, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_10 = Py_TYPE(__pyx_t_2)->tp_iternext;
    if (unlikely(!__pyx_t_10))
      __PYX_ERR(0, 159, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_10)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_9 >= PyList_GET_SIZE(__pyx_t_2))
          break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_9);
        __Pyx_INCREF(__pyx_t_1);
        __pyx_t_9++;
        if (unlikely(0 < 0))
          __PYX_ERR(0, 159, __pyx_L1_error)
#else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_9);
        __pyx_t_9++;
        if (unlikely(!__pyx_t_1))
          __PYX_ERR(0, 159, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
#endif
      } else {
        if (__pyx_t_9 >= PyTuple_GET_SIZE(__pyx_t_2))
          break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_9);
        __Pyx_INCREF(__pyx_t_1);
        __pyx_t_9++;
        if (unlikely(0 < 0))
          __PYX_ERR(0, 159, __pyx_L1_error)
#else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_9);
        __pyx_t_9++;
        if (unlikely(!__pyx_t_1))
          __PYX_ERR(0, 159, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
#endif
      }
    } else {
      __pyx_t_1 = __pyx_t_10(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject *exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type,
                                                       PyExc_StopIteration)))
            PyErr_Clear();
          else
            __PYX_ERR(0, 159, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_poly, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "pyg4ometry/pycsg/core.pyx":160
     *         d = Vector(scale[0], scale[1], scale[2])
     *         for poly in self.polygons:
     *             for v in poly.vertices:             # <<<<<<<<<<<<<<
     *                 v.pos = v.pos.scale(d)
     *                 # no change to the normals
     */
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_poly, __pyx_n_s_vertices);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 160, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
      __pyx_t_8 = __pyx_t_1;
      __Pyx_INCREF(__pyx_t_8);
      __pyx_t_11 = 0;
      __pyx_t_12 = NULL;
    } else {
      __pyx_t_11 = -1;
      __pyx_t_8 = PyObject_GetIter(__pyx_t_1);
      if (unlikely(!__pyx_t_8))
        __PYX_ERR(0, 160, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_12 = Py_TYPE(__pyx_t_8)->tp_iternext;
      if (unlikely(!__pyx_t_12))
        __PYX_ERR(0, 160, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_12)) {
        if (likely(PyList_CheckExact(__pyx_t_8))) {
          if (__pyx_t_11 >= PyList_GET_SIZE(__pyx_t_8))
            break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_11);
          __Pyx_INCREF(__pyx_t_1);
          __pyx_t_11++;
          if (unlikely(0 < 0))
            __PYX_ERR(0, 160, __pyx_L1_error)
#else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_8, __pyx_t_11);
          __pyx_t_11++;
          if (unlikely(!__pyx_t_1))
            __PYX_ERR(0, 160, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
#endif
        } else {
          if (__pyx_t_11 >= PyTuple_GET_SIZE(__pyx_t_8))
            break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_11);
          __Pyx_INCREF(__pyx_t_1);
          __pyx_t_11++;
          if (unlikely(0 < 0))
            __PYX_ERR(0, 160, __pyx_L1_error)
#else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_8, __pyx_t_11);
          __pyx_t_11++;
          if (unlikely(!__pyx_t_1))
            __PYX_ERR(0, 160, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
#endif
        }
      } else {
        __pyx_t_1 = __pyx_t_12(__pyx_t_8);
        if (unlikely(!__pyx_t_1)) {
          PyObject *exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type,
                                                         PyExc_StopIteration)))
              PyErr_Clear();
            else
              __PYX_ERR(0, 160, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_1);
      }
      __Pyx_XDECREF_SET(__pyx_v_v, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":161
       *         for poly in self.polygons:
       *             for v in poly.vertices:
       *                 v.pos = v.pos.scale(d)             # <<<<<<<<<<<<<<
       *                 # no change to the normals
       *
       */
      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_v, __pyx_n_s_pos);
      if (unlikely(!__pyx_t_5))
        __PYX_ERR(0, 161, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_scale);
      if (unlikely(!__pyx_t_4))
        __PYX_ERR(0, 161, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_5);
      __pyx_t_5 = 0;
      __pyx_t_5 = NULL;
      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
        __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
        if (likely(__pyx_t_5)) {
          PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_4);
          __Pyx_INCREF(__pyx_t_5);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_4, function);
        }
      }
      __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5,
                                                         __pyx_v_d)
                              : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_d);
      __Pyx_XDECREF(__pyx_t_5);
      __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 161, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_4);
      __pyx_t_4 = 0;
      if (__Pyx_PyObject_SetAttrStr(__pyx_v_v, __pyx_n_s_pos, __pyx_t_1) < 0)
        __PYX_ERR(0, 161, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1);
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":160
       *         d = Vector(scale[0], scale[1], scale[2])
       *         for poly in self.polygons:
       *             for v in poly.vertices:             # <<<<<<<<<<<<<<
       *                 v.pos = v.pos.scale(d)
       *                 # no change to the normals
       */
    }
    __Pyx_DECREF(__pyx_t_8);
    __pyx_t_8 = 0;

    /* "pyg4ometry/pycsg/core.pyx":159
     *         """
     *         d = Vector(scale[0], scale[1], scale[2])
     *         for poly in self.polygons:             # <<<<<<<<<<<<<<
     *             for v in poly.vertices:
     *                 v.pos = v.pos.scale(d)
     */
  }
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":153
   *
   *
   *     def scale(self, scale):             # <<<<<<<<<<<<<<
   *         """
   *         Translate Geometry.
   */

  /* function exit code */
  __pyx_r = Py_None;
  __Pyx_INCREF(Py_None);
  goto __pyx_L0;
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.scale", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XDECREF(__pyx_v_d);
  __Pyx_XDECREF(__pyx_v_poly);
  __Pyx_XDECREF(__pyx_v_v);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":164
 *                 # no change to the normals
 *
 *     def rotate(self, axis, angleDeg):             # <<<<<<<<<<<<<<
 *         """
 *         Rotate geometry.
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_23rotate(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_22rotate[] =
    "\n        Rotate geometry.\n           axis: axis of rotation (array of "
    "floats)\n           angleDeg: rotation angle in degrees\n        ";
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_23rotate = {
    "rotate",
    (PyCFunction)(void *)(PyCFunctionWithKeywords)
        __pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_23rotate,
    METH_VARARGS | METH_KEYWORDS,
    __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_22rotate};
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_23rotate(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_self = 0;
  PyObject *__pyx_v_axis = 0;
  PyObject *__pyx_v_angleDeg = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext("rotate (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self, &__pyx_n_s_axis,
                                            &__pyx_n_s_angleDeg, 0};
    PyObject *values[3] = {0, 0, 0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
      case 3:
        values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
      case 2:
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
      case 1:
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
      case 0:
        break;
      default:
        goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
      case 0:
        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_self)) != 0))
          kw_args--;
        else
          goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
      case 1:
        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_axis)) != 0))
          kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("rotate", 1, 3, 3, 1);
          __PYX_ERR(0, 164, __pyx_L3_error)
        }
        CYTHON_FALLTHROUGH;
      case 2:
        if (likely((values[2] = __Pyx_PyDict_GetItemStr(
                        __pyx_kwds, __pyx_n_s_angleDeg)) != 0))
          kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("rotate", 1, 3, 3, 2);
          __PYX_ERR(0, 164, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames,
                                                 0, values, pos_args,
                                                 "rotate") < 0))
          __PYX_ERR(0, 164, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
    }
    __pyx_v_self = values[0];
    __pyx_v_axis = values[1];
    __pyx_v_angleDeg = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
__pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("rotate", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args));
  __PYX_ERR(0, 164, __pyx_L3_error)
__pyx_L3_error:;
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.rotate", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
__pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_22rotate(
      __pyx_self, __pyx_v_self, __pyx_v_axis, __pyx_v_angleDeg);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":174
 *         sinAngle = _np.sin(_np.pi * angleDeg / 180.)
 *
 *         def newVector(v):             # <<<<<<<<<<<<<<
 *             vA = v.dot(ax)
 *             vPerp = v.minus(ax.times(vA))
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_6rotate_1newVector(
    PyObject *__pyx_self, PyObject *__pyx_v_v); /*proto*/
static PyMethodDef
    __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_6rotate_1newVector = {
        "newVector",
        (PyCFunction)__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_6rotate_1newVector,
        METH_O, 0};
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_6rotate_1newVector(
    PyObject *__pyx_self, PyObject *__pyx_v_v) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext("newVector (wrapper)",
                                                        0);
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6rotate_newVector(
      __pyx_self, ((PyObject *)__pyx_v_v));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *
__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6rotate_newVector(PyObject *__pyx_self,
                                                          PyObject *__pyx_v_v) {
  struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate
      *__pyx_cur_scope;
  struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate
      *__pyx_outer_scope;
  PyObject *__pyx_v_vA = NULL;
  PyObject *__pyx_v_vPerp = NULL;
  PyObject *__pyx_v_vPerpLen = NULL;
  PyObject *__pyx_v_u1 = NULL;
  PyObject *__pyx_v_u2 = NULL;
  PyObject *__pyx_v_vCosA = NULL;
  PyObject *__pyx_v_vSinA = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("newVector", 0);
  __pyx_outer_scope =
      (struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate *)
          __Pyx_CyFunction_GetClosure(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;

  /* "pyg4ometry/pycsg/core.pyx":175
   *
   *         def newVector(v):
   *             vA = v.dot(ax)             # <<<<<<<<<<<<<<
   *             vPerp = v.minus(ax.times(vA))
   *             vPerpLen = vPerp.length()
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_v, __pyx_n_s_dot);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 175, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (unlikely(!__pyx_cur_scope->__pyx_v_ax)) {
    __Pyx_RaiseClosureNameError("ax");
    __PYX_ERR(0, 175, __pyx_L1_error)
  }
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 =
      (__pyx_t_3)
          ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3,
                                     __pyx_cur_scope->__pyx_v_ax)
          : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_cur_scope->__pyx_v_ax);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 175, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_vA = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":176
   *         def newVector(v):
   *             vA = v.dot(ax)
   *             vPerp = v.minus(ax.times(vA))             # <<<<<<<<<<<<<<
   *             vPerpLen = vPerp.length()
   *             if vPerpLen == 0:
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_v, __pyx_n_s_minus);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 176, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (unlikely(!__pyx_cur_scope->__pyx_v_ax)) {
    __Pyx_RaiseClosureNameError("ax");
    __PYX_ERR(0, 176, __pyx_L1_error)
  }
  __pyx_t_4 =
      __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_ax, __pyx_n_s_times);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 176, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  __pyx_t_3 = (__pyx_t_5)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_v_vA)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_vA);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 176, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_4)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 176, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_vPerp = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":177
   *             vA = v.dot(ax)
   *             vPerp = v.minus(ax.times(vA))
   *             vPerpLen = vPerp.length()             # <<<<<<<<<<<<<<
   *             if vPerpLen == 0:
   *                 # vector is parallel to axis, no need to rotate
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_vPerp, __pyx_n_s_length);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 177, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 177, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_vPerpLen = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":178
   *             vPerp = v.minus(ax.times(vA))
   *             vPerpLen = vPerp.length()
   *             if vPerpLen == 0:             # <<<<<<<<<<<<<<
   *                 # vector is parallel to axis, no need to rotate
   *                 return v
   */
  __pyx_t_1 = __Pyx_PyInt_EqObjC(__pyx_v_vPerpLen, __pyx_int_0, 0, 0);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 178, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_1);
  if (unlikely(__pyx_t_6 < 0))
    __PYX_ERR(0, 178, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  if (__pyx_t_6) {

    /* "pyg4ometry/pycsg/core.pyx":180
     *             if vPerpLen == 0:
     *                 # vector is parallel to axis, no need to rotate
     *                 return v             # <<<<<<<<<<<<<<
     *             u1 = vPerp.unit()
     *             u2 = u1.cross(ax)
     */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_v_v);
    __pyx_r = __pyx_v_v;
    goto __pyx_L0;

    /* "pyg4ometry/pycsg/core.pyx":178
     *             vPerp = v.minus(ax.times(vA))
     *             vPerpLen = vPerp.length()
     *             if vPerpLen == 0:             # <<<<<<<<<<<<<<
     *                 # vector is parallel to axis, no need to rotate
     *                 return v
     */
  }

  /* "pyg4ometry/pycsg/core.pyx":181
   *                 # vector is parallel to axis, no need to rotate
   *                 return v
   *             u1 = vPerp.unit()             # <<<<<<<<<<<<<<
   *             u2 = u1.cross(ax)
   *             vCosA = vPerpLen*cosAngle
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_vPerp, __pyx_n_s_unit);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 181, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 181, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_u1 = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":182
   *                 return v
   *             u1 = vPerp.unit()
   *             u2 = u1.cross(ax)             # <<<<<<<<<<<<<<
   *             vCosA = vPerpLen*cosAngle
   *             vSinA = vPerpLen*sinAngle
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_u1, __pyx_n_s_cross);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 182, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (unlikely(!__pyx_cur_scope->__pyx_v_ax)) {
    __Pyx_RaiseClosureNameError("ax");
    __PYX_ERR(0, 182, __pyx_L1_error)
  }
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 =
      (__pyx_t_3)
          ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3,
                                     __pyx_cur_scope->__pyx_v_ax)
          : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_cur_scope->__pyx_v_ax);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 182, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_u2 = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":183
   *             u1 = vPerp.unit()
   *             u2 = u1.cross(ax)
   *             vCosA = vPerpLen*cosAngle             # <<<<<<<<<<<<<<
   *             vSinA = vPerpLen*sinAngle
   *             return ax.times(vA).plus(u1.times(vCosA).plus(u2.times(vSinA)))
   */
  if (unlikely(!__pyx_cur_scope->__pyx_v_cosAngle)) {
    __Pyx_RaiseClosureNameError("cosAngle");
    __PYX_ERR(0, 183, __pyx_L1_error)
  }
  __pyx_t_1 =
      PyNumber_Multiply(__pyx_v_vPerpLen, __pyx_cur_scope->__pyx_v_cosAngle);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 183, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_vCosA = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":184
   *             u2 = u1.cross(ax)
   *             vCosA = vPerpLen*cosAngle
   *             vSinA = vPerpLen*sinAngle             # <<<<<<<<<<<<<<
   *             return ax.times(vA).plus(u1.times(vCosA).plus(u2.times(vSinA)))
   *
   */
  if (unlikely(!__pyx_cur_scope->__pyx_v_sinAngle)) {
    __Pyx_RaiseClosureNameError("sinAngle");
    __PYX_ERR(0, 184, __pyx_L1_error)
  }
  __pyx_t_1 =
      PyNumber_Multiply(__pyx_v_vPerpLen, __pyx_cur_scope->__pyx_v_sinAngle);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 184, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_vSinA = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":185
   *             vCosA = vPerpLen*cosAngle
   *             vSinA = vPerpLen*sinAngle
   *             return ax.times(vA).plus(u1.times(vCosA).plus(u2.times(vSinA)))
   * # <<<<<<<<<<<<<<
   *
   *         for poly in self.polygons:
   */
  __Pyx_XDECREF(__pyx_r);
  if (unlikely(!__pyx_cur_scope->__pyx_v_ax)) {
    __Pyx_RaiseClosureNameError("ax");
    __PYX_ERR(0, 185, __pyx_L1_error)
  }
  __pyx_t_3 =
      __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_ax, __pyx_n_s_times);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 185, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  __pyx_t_2 = (__pyx_t_4)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_v_vA)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_vA);
  __Pyx_XDECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 185, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_plus);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 185, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_u1, __pyx_n_s_times);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 185, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_7 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_5);
    if (likely(__pyx_t_7)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_7);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_5, function);
    }
  }
  __pyx_t_4 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_7,
                                                     __pyx_v_vCosA)
                          : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_vCosA);
  __Pyx_XDECREF(__pyx_t_7);
  __pyx_t_7 = 0;
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 185, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_plus);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 185, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_u2, __pyx_n_s_times);
  if (unlikely(!__pyx_t_7))
    __PYX_ERR(0, 185, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_8 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_7))) {
    __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_7);
    if (likely(__pyx_t_8)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_8);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_7, function);
    }
  }
  __pyx_t_4 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_8,
                                                     __pyx_v_vSinA)
                          : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_v_vSinA);
  __Pyx_XDECREF(__pyx_t_8);
  __pyx_t_8 = 0;
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 185, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_7);
  __pyx_t_7 = 0;
  __pyx_t_7 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_5);
    if (likely(__pyx_t_7)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_7);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_5, function);
    }
  }
  __pyx_t_2 = (__pyx_t_7)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_7, __pyx_t_4)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_4);
  __Pyx_XDECREF(__pyx_t_7);
  __pyx_t_7 = 0;
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 185, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_5)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_2)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 185, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":174
 *         sinAngle = _np.sin(_np.pi * angleDeg / 180.)
 *
 *         def newVector(v):             # <<<<<<<<<<<<<<
 *             vA = v.dot(ax)
 *             vPerp = v.minus(ax.times(vA))
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.rotate.newVector",
                     __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XDECREF(__pyx_v_vA);
  __Pyx_XDECREF(__pyx_v_vPerp);
  __Pyx_XDECREF(__pyx_v_vPerpLen);
  __Pyx_XDECREF(__pyx_v_u1);
  __Pyx_XDECREF(__pyx_v_u2);
  __Pyx_XDECREF(__pyx_v_vCosA);
  __Pyx_XDECREF(__pyx_v_vSinA);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":164
 *                 # no change to the normals
 *
 *     def rotate(self, axis, angleDeg):             # <<<<<<<<<<<<<<
 *         """
 *         Rotate geometry.
 */

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_22rotate(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self,
    PyObject *__pyx_v_axis, PyObject *__pyx_v_angleDeg) {
  struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate
      *__pyx_cur_scope;
  PyObject *__pyx_v_newVector = 0;
  PyObject *__pyx_v_poly = NULL;
  PyObject *__pyx_v_vert = NULL;
  PyObject *__pyx_v_normal = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_t_8;
  PyObject *__pyx_t_9 = NULL;
  Py_ssize_t __pyx_t_10;
  PyObject *(*__pyx_t_11)(PyObject *);
  Py_ssize_t __pyx_t_12;
  PyObject *(*__pyx_t_13)(PyObject *);
  int __pyx_t_14;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("rotate", 0);
  __pyx_cur_scope =
      (struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate *)
          __pyx_tp_new_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate(
              __pyx_ptype_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate,
              __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((
        struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate *)
                           Py_None);
    __Pyx_INCREF(Py_None);
    __PYX_ERR(0, 164, __pyx_L1_error)
  } else {
    __Pyx_GOTREF(__pyx_cur_scope);
  }

  /* "pyg4ometry/pycsg/core.pyx":170
   *            angleDeg: rotation angle in degrees
   *         """
   *         ax = Vector(axis[0], axis[1], axis[2]).unit()             #
   * <<<<<<<<<<<<<< cosAngle = _np.cos(_np.pi * angleDeg / 180.) sinAngle =
   * _np.sin(_np.pi * angleDeg / 180.)
   */
  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_Vector);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 170, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_axis, 0, long, 1, __Pyx_PyInt_From_long,
                               0, 0, 1);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 170, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_axis, 1, long, 1, __Pyx_PyInt_From_long,
                               0, 0, 1);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 170, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_axis, 2, long, 1, __Pyx_PyInt_From_long,
                               0, 0, 1);
  if (unlikely(!__pyx_t_6))
    __PYX_ERR(0, 170, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_7 = NULL;
  __pyx_t_8 = 0;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_7)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_7);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
      __pyx_t_8 = 1;
    }
  }
#if CYTHON_FAST_PYCALL
  if (PyFunction_Check(__pyx_t_3)) {
    PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_t_4, __pyx_t_5, __pyx_t_6};
    __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp + 1 - __pyx_t_8,
                                          3 + __pyx_t_8);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 170, __pyx_L1_error)
    __Pyx_XDECREF(__pyx_t_7);
    __pyx_t_7 = 0;
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_4);
    __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_5);
    __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_t_6);
    __pyx_t_6 = 0;
  } else
#endif
#if CYTHON_FAST_PYCCALL
      if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
    PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_t_4, __pyx_t_5, __pyx_t_6};
    __pyx_t_2 = __Pyx_PyCFunction_FastCall(
        __pyx_t_3, __pyx_temp + 1 - __pyx_t_8, 3 + __pyx_t_8);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 170, __pyx_L1_error)
    __Pyx_XDECREF(__pyx_t_7);
    __pyx_t_7 = 0;
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_4);
    __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_5);
    __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_t_6);
    __pyx_t_6 = 0;
  } else
#endif
  {
    __pyx_t_9 = PyTuple_New(3 + __pyx_t_8);
    if (unlikely(!__pyx_t_9))
      __PYX_ERR(0, 170, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    if (__pyx_t_7) {
      __Pyx_GIVEREF(__pyx_t_7);
      PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_7);
      __pyx_t_7 = NULL;
    }
    __Pyx_GIVEREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_9, 0 + __pyx_t_8, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_9, 1 + __pyx_t_8, __pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_6);
    PyTuple_SET_ITEM(__pyx_t_9, 2 + __pyx_t_8, __pyx_t_6);
    __pyx_t_4 = 0;
    __pyx_t_5 = 0;
    __pyx_t_6 = 0;
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_9, NULL);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 170, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_9);
    __pyx_t_9 = 0;
  }
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_unit);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 170, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 170, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_cur_scope->__pyx_v_ax = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":171
   *         """
   *         ax = Vector(axis[0], axis[1], axis[2]).unit()
   *         cosAngle = _np.cos(_np.pi * angleDeg / 180.)             #
   * <<<<<<<<<<<<<< sinAngle = _np.sin(_np.pi * angleDeg / 180.)
   *
   */
  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 171, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_cos);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 171, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 171, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_pi);
  if (unlikely(!__pyx_t_9))
    __PYX_ERR(0, 171, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_9);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyNumber_Multiply(__pyx_t_9, __pyx_v_angleDeg);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 171, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_9);
  __pyx_t_9 = 0;
  __pyx_t_9 =
      __Pyx_PyFloat_TrueDivideObjC(__pyx_t_3, __pyx_float_180_, 180., 0, 0);
  if (unlikely(!__pyx_t_9))
    __PYX_ERR(0, 171, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_9);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_9)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_9);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_9);
  __pyx_t_9 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 171, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_cur_scope->__pyx_v_cosAngle = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":172
   *         ax = Vector(axis[0], axis[1], axis[2]).unit()
   *         cosAngle = _np.cos(_np.pi * angleDeg / 180.)
   *         sinAngle = _np.sin(_np.pi * angleDeg / 180.)             #
   * <<<<<<<<<<<<<<
   *
   *         def newVector(v):
   */
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 172, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_sin);
  if (unlikely(!__pyx_t_9))
    __PYX_ERR(0, 172, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_9);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 172, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_pi);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 172, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = PyNumber_Multiply(__pyx_t_3, __pyx_v_angleDeg);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 172, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 =
      __Pyx_PyFloat_TrueDivideObjC(__pyx_t_2, __pyx_float_180_, 180., 0, 0);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 172, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_9);
    if (likely(__pyx_t_2)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_9);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_9, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_2, __pyx_t_3)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_t_3);
  __Pyx_XDECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 172, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_9);
  __pyx_t_9 = 0;
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_cur_scope->__pyx_v_sinAngle = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":174
   *         sinAngle = _np.sin(_np.pi * angleDeg / 180.)
   *
   *         def newVector(v):             # <<<<<<<<<<<<<<
   *             vA = v.dot(ax)
   *             vPerp = v.minus(ax.times(vA))
   */
  __pyx_t_1 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_6rotate_1newVector, 0,
      __pyx_n_s_CSG_rotate_locals_newVector, ((PyObject *)__pyx_cur_scope),
      __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d, ((PyObject *)__pyx_codeobj__2));
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 174, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_newVector = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":187
   *             return ax.times(vA).plus(u1.times(vCosA).plus(u2.times(vSinA)))
   *
   *         for poly in self.polygons:             # <<<<<<<<<<<<<<
   *             for vert in poly.vertices:
   *                 vert.pos = newVector(vert.pos)
   */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_polygons);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 187, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_9 = __pyx_t_1;
    __Pyx_INCREF(__pyx_t_9);
    __pyx_t_10 = 0;
    __pyx_t_11 = NULL;
  } else {
    __pyx_t_10 = -1;
    __pyx_t_9 = PyObject_GetIter(__pyx_t_1);
    if (unlikely(!__pyx_t_9))
      __PYX_ERR(0, 187, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __pyx_t_11 = Py_TYPE(__pyx_t_9)->tp_iternext;
    if (unlikely(!__pyx_t_11))
      __PYX_ERR(0, 187, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_11)) {
      if (likely(PyList_CheckExact(__pyx_t_9))) {
        if (__pyx_t_10 >= PyList_GET_SIZE(__pyx_t_9))
          break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_9, __pyx_t_10);
        __Pyx_INCREF(__pyx_t_1);
        __pyx_t_10++;
        if (unlikely(0 < 0))
          __PYX_ERR(0, 187, __pyx_L1_error)
#else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_9, __pyx_t_10);
        __pyx_t_10++;
        if (unlikely(!__pyx_t_1))
          __PYX_ERR(0, 187, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
#endif
      } else {
        if (__pyx_t_10 >= PyTuple_GET_SIZE(__pyx_t_9))
          break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_9, __pyx_t_10);
        __Pyx_INCREF(__pyx_t_1);
        __pyx_t_10++;
        if (unlikely(0 < 0))
          __PYX_ERR(0, 187, __pyx_L1_error)
#else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_9, __pyx_t_10);
        __pyx_t_10++;
        if (unlikely(!__pyx_t_1))
          __PYX_ERR(0, 187, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
#endif
      }
    } else {
      __pyx_t_1 = __pyx_t_11(__pyx_t_9);
      if (unlikely(!__pyx_t_1)) {
        PyObject *exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type,
                                                       PyExc_StopIteration)))
            PyErr_Clear();
          else
            __PYX_ERR(0, 187, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_poly, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "pyg4ometry/pycsg/core.pyx":188
     *
     *         for poly in self.polygons:
     *             for vert in poly.vertices:             # <<<<<<<<<<<<<<
     *                 vert.pos = newVector(vert.pos)
     *                 normal = vert.normal
     */
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_poly, __pyx_n_s_vertices);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 188, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
      __pyx_t_3 = __pyx_t_1;
      __Pyx_INCREF(__pyx_t_3);
      __pyx_t_12 = 0;
      __pyx_t_13 = NULL;
    } else {
      __pyx_t_12 = -1;
      __pyx_t_3 = PyObject_GetIter(__pyx_t_1);
      if (unlikely(!__pyx_t_3))
        __PYX_ERR(0, 188, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_13 = Py_TYPE(__pyx_t_3)->tp_iternext;
      if (unlikely(!__pyx_t_13))
        __PYX_ERR(0, 188, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_13)) {
        if (likely(PyList_CheckExact(__pyx_t_3))) {
          if (__pyx_t_12 >= PyList_GET_SIZE(__pyx_t_3))
            break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_12);
          __Pyx_INCREF(__pyx_t_1);
          __pyx_t_12++;
          if (unlikely(0 < 0))
            __PYX_ERR(0, 188, __pyx_L1_error)
#else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_12);
          __pyx_t_12++;
          if (unlikely(!__pyx_t_1))
            __PYX_ERR(0, 188, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
#endif
        } else {
          if (__pyx_t_12 >= PyTuple_GET_SIZE(__pyx_t_3))
            break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_12);
          __Pyx_INCREF(__pyx_t_1);
          __pyx_t_12++;
          if (unlikely(0 < 0))
            __PYX_ERR(0, 188, __pyx_L1_error)
#else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_12);
          __pyx_t_12++;
          if (unlikely(!__pyx_t_1))
            __PYX_ERR(0, 188, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
#endif
        }
      } else {
        __pyx_t_1 = __pyx_t_13(__pyx_t_3);
        if (unlikely(!__pyx_t_1)) {
          PyObject *exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type,
                                                         PyExc_StopIteration)))
              PyErr_Clear();
            else
              __PYX_ERR(0, 188, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_1);
      }
      __Pyx_XDECREF_SET(__pyx_v_vert, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":189
       *         for poly in self.polygons:
       *             for vert in poly.vertices:
       *                 vert.pos = newVector(vert.pos)             #
       * <<<<<<<<<<<<<< normal = vert.normal if normal.length() > 0:
       */
      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_vert, __pyx_n_s_pos);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 189, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_2 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6rotate_newVector(
          __pyx_v_newVector, __pyx_t_1);
      if (unlikely(!__pyx_t_2))
        __PYX_ERR(0, 189, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_1);
      __pyx_t_1 = 0;
      if (__Pyx_PyObject_SetAttrStr(__pyx_v_vert, __pyx_n_s_pos, __pyx_t_2) < 0)
        __PYX_ERR(0, 189, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_2);
      __pyx_t_2 = 0;

      /* "pyg4ometry/pycsg/core.pyx":190
       *             for vert in poly.vertices:
       *                 vert.pos = newVector(vert.pos)
       *                 normal = vert.normal             # <<<<<<<<<<<<<<
       *                 if normal.length() > 0:
       *                     vert.normal = newVector(vert.normal)
       */
      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_vert, __pyx_n_s_normal);
      if (unlikely(!__pyx_t_2))
        __PYX_ERR(0, 190, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_XDECREF_SET(__pyx_v_normal, __pyx_t_2);
      __pyx_t_2 = 0;

      /* "pyg4ometry/pycsg/core.pyx":191
       *                 vert.pos = newVector(vert.pos)
       *                 normal = vert.normal
       *                 if normal.length() > 0:             # <<<<<<<<<<<<<<
       *                     vert.normal = newVector(vert.normal)
       *
       */
      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_normal, __pyx_n_s_length);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 191, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_6 = NULL;
      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
        __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
        if (likely(__pyx_t_6)) {
          PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_1);
          __Pyx_INCREF(__pyx_t_6);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_1, function);
        }
      }
      __pyx_t_2 = (__pyx_t_6) ? __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_6)
                              : __Pyx_PyObject_CallNoArg(__pyx_t_1);
      __Pyx_XDECREF(__pyx_t_6);
      __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_2))
        __PYX_ERR(0, 191, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_1 = PyObject_RichCompare(__pyx_t_2, __pyx_int_0, Py_GT);
      __Pyx_XGOTREF(__pyx_t_1);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 191, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_14 = __Pyx_PyObject_IsTrue(__pyx_t_1);
      if (unlikely(__pyx_t_14 < 0))
        __PYX_ERR(0, 191, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1);
      __pyx_t_1 = 0;
      if (__pyx_t_14) {

        /* "pyg4ometry/pycsg/core.pyx":192
         *                 normal = vert.normal
         *                 if normal.length() > 0:
         *                     vert.normal = newVector(vert.normal) #
         * <<<<<<<<<<<<<<
         *
         *     def toVerticesAndPolygons(self):
         */
        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_vert, __pyx_n_s_normal);
        if (unlikely(!__pyx_t_1))
          __PYX_ERR(0, 192, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_2 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6rotate_newVector(
            __pyx_v_newVector, __pyx_t_1);
        if (unlikely(!__pyx_t_2))
          __PYX_ERR(0, 192, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_1);
        __pyx_t_1 = 0;
        if (__Pyx_PyObject_SetAttrStr(__pyx_v_vert, __pyx_n_s_normal,
                                      __pyx_t_2) < 0)
          __PYX_ERR(0, 192, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_2);
        __pyx_t_2 = 0;

        /* "pyg4ometry/pycsg/core.pyx":191
         *                 vert.pos = newVector(vert.pos)
         *                 normal = vert.normal
         *                 if normal.length() > 0:             # <<<<<<<<<<<<<<
         *                     vert.normal = newVector(vert.normal)
         *
         */
      }

      /* "pyg4ometry/pycsg/core.pyx":188
       *
       *         for poly in self.polygons:
       *             for vert in poly.vertices:             # <<<<<<<<<<<<<<
       *                 vert.pos = newVector(vert.pos)
       *                 normal = vert.normal
       */
    }
    __Pyx_DECREF(__pyx_t_3);
    __pyx_t_3 = 0;

    /* "pyg4ometry/pycsg/core.pyx":187
     *             return
     * ax.times(vA).plus(u1.times(vCosA).plus(u2.times(vSinA)))
     *
     *         for poly in self.polygons:             # <<<<<<<<<<<<<<
     *             for vert in poly.vertices:
     *                 vert.pos = newVector(vert.pos)
     */
  }
  __Pyx_DECREF(__pyx_t_9);
  __pyx_t_9 = 0;

  /* "pyg4ometry/pycsg/core.pyx":164
   *                 # no change to the normals
   *
   *     def rotate(self, axis, angleDeg):             # <<<<<<<<<<<<<<
   *         """
   *         Rotate geometry.
   */

  /* function exit code */
  __pyx_r = Py_None;
  __Pyx_INCREF(Py_None);
  goto __pyx_L0;
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.rotate", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XDECREF(__pyx_v_newVector);
  __Pyx_XDECREF(__pyx_v_poly);
  __Pyx_XDECREF(__pyx_v_vert);
  __Pyx_XDECREF(__pyx_v_normal);
  __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":194
 *                     vert.normal = newVector(vert.normal)
 *
 *     def toVerticesAndPolygons(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return list of vertices, polygons (cells), and the total
 */

/* Python wrapper */
static PyObject *
__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_25toVerticesAndPolygons(
    PyObject *__pyx_self, PyObject *__pyx_v_self); /*proto*/
static char __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_24toVerticesAndPolygons[] =
    "\n        Return list of vertices, polygons (cells), and the total\n      "
    "  number of vertex indices in the polygon connectivity list\n        "
    "(count).\n        ";
static PyMethodDef
    __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_25toVerticesAndPolygons = {
        "toVerticesAndPolygons",
        (PyCFunction)
            __pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_25toVerticesAndPolygons,
        METH_O,
        __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_24toVerticesAndPolygons};
static PyObject *
__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_25toVerticesAndPolygons(
    PyObject *__pyx_self, PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext(
      "toVerticesAndPolygons (wrapper)", 0);
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_24toVerticesAndPolygons(
      __pyx_self, ((PyObject *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *
__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_24toVerticesAndPolygons(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
  double __pyx_v_offset;
  PyObject *__pyx_v_verts = NULL;
  PyObject *__pyx_v_polys = NULL;
  PyObject *__pyx_v_vertexIndexMap = NULL;
  PyObject *__pyx_v_count = NULL;
  PyObject *__pyx_v_poly = NULL;
  PyObject *__pyx_v_cell = NULL;
  PyObject *__pyx_v_v = NULL;
  PyObject *__pyx_v_p = NULL;
  PyObject *__pyx_v_vKey = NULL;
  PyObject *__pyx_v_index = NULL;
  PyObject *__pyx_v_sortedVertexIndex = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_c = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  PyObject *__pyx_t_5 = NULL;
  Py_ssize_t __pyx_t_6;
  PyObject *(*__pyx_t_7)(PyObject *);
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  PyObject *__pyx_t_10 = NULL;
  PyObject *__pyx_t_11 = NULL;
  int __pyx_t_12;
  int __pyx_t_13;
  Py_ssize_t __pyx_t_14;
  int __pyx_t_15;
  PyObject *(*__pyx_t_16)(PyObject *);
  double __pyx_t_17;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("toVerticesAndPolygons", 0);

  /* "pyg4ometry/pycsg/core.pyx":200
   *         (count).
   *         """
   *         offset = 1.234567890 #gives unique key             # <<<<<<<<<<<<<<
   *         verts = []
   *         polys = []
   */
  __pyx_v_offset = 1.234567890;

  /* "pyg4ometry/pycsg/core.pyx":201
   *         """
   *         offset = 1.234567890 #gives unique key
   *         verts = []             # <<<<<<<<<<<<<<
   *         polys = []
   *         vertexIndexMap = {}
   */
  __pyx_t_1 = PyList_New(0);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 201, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_verts = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":202
   *         offset = 1.234567890 #gives unique key
   *         verts = []
   *         polys = []             # <<<<<<<<<<<<<<
   *         vertexIndexMap = {}
   *         count = 0
   */
  __pyx_t_1 = PyList_New(0);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 202, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_polys = ((PyObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":203
   *         verts = []
   *         polys = []
   *         vertexIndexMap = {}             # <<<<<<<<<<<<<<
   *         count = 0
   *         for poly in self.polygons:
   */
  __pyx_t_1 = __Pyx_PyDict_NewPresized(0);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 203, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_vertexIndexMap = ((PyObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":204
   *         polys = []
   *         vertexIndexMap = {}
   *         count = 0             # <<<<<<<<<<<<<<
   *         for poly in self.polygons:
   *             verts = poly.vertices
   */
  __Pyx_INCREF(__pyx_int_0);
  __pyx_v_count = __pyx_int_0;

  /* "pyg4ometry/pycsg/core.pyx":205
   *         vertexIndexMap = {}
   *         count = 0
   *         for poly in self.polygons:             # <<<<<<<<<<<<<<
   *             verts = poly.vertices
   *             cell = []
   */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_polygons);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 205, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1;
    __Pyx_INCREF(__pyx_t_2);
    __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1;
    __pyx_t_2 = PyObject_GetIter(__pyx_t_1);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 205, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext;
    if (unlikely(!__pyx_t_4))
      __PYX_ERR(0, 205, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2))
          break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3);
        __Pyx_INCREF(__pyx_t_1);
        __pyx_t_3++;
        if (unlikely(0 < 0))
          __PYX_ERR(0, 205, __pyx_L1_error)
#else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3);
        __pyx_t_3++;
        if (unlikely(!__pyx_t_1))
          __PYX_ERR(0, 205, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
#endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2))
          break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3);
        __Pyx_INCREF(__pyx_t_1);
        __pyx_t_3++;
        if (unlikely(0 < 0))
          __PYX_ERR(0, 205, __pyx_L1_error)
#else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3);
        __pyx_t_3++;
        if (unlikely(!__pyx_t_1))
          __PYX_ERR(0, 205, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
#endif
      }
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject *exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type,
                                                       PyExc_StopIteration)))
            PyErr_Clear();
          else
            __PYX_ERR(0, 205, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_poly, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "pyg4ometry/pycsg/core.pyx":206
     *         count = 0
     *         for poly in self.polygons:
     *             verts = poly.vertices             # <<<<<<<<<<<<<<
     *             cell = []
     *             for v in poly.vertices:
     */
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_poly, __pyx_n_s_vertices);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 206, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF_SET(__pyx_v_verts, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "pyg4ometry/pycsg/core.pyx":207
     *         for poly in self.polygons:
     *             verts = poly.vertices
     *             cell = []             # <<<<<<<<<<<<<<
     *             for v in poly.vertices:
     *                 p = v.pos
     */
    __pyx_t_1 = PyList_New(0);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 207, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_XDECREF_SET(__pyx_v_cell, ((PyObject *)__pyx_t_1));
    __pyx_t_1 = 0;

    /* "pyg4ometry/pycsg/core.pyx":208
     *             verts = poly.vertices
     *             cell = []
     *             for v in poly.vertices:             # <<<<<<<<<<<<<<
     *                 p = v.pos
     *                 # use string key to remove degeneracy associated
     */
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_poly, __pyx_n_s_vertices);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 208, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
      __pyx_t_5 = __pyx_t_1;
      __Pyx_INCREF(__pyx_t_5);
      __pyx_t_6 = 0;
      __pyx_t_7 = NULL;
    } else {
      __pyx_t_6 = -1;
      __pyx_t_5 = PyObject_GetIter(__pyx_t_1);
      if (unlikely(!__pyx_t_5))
        __PYX_ERR(0, 208, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_7 = Py_TYPE(__pyx_t_5)->tp_iternext;
      if (unlikely(!__pyx_t_7))
        __PYX_ERR(0, 208, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_7)) {
        if (likely(PyList_CheckExact(__pyx_t_5))) {
          if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_5))
            break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_6);
          __Pyx_INCREF(__pyx_t_1);
          __pyx_t_6++;
          if (unlikely(0 < 0))
            __PYX_ERR(0, 208, __pyx_L1_error)
#else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_5, __pyx_t_6);
          __pyx_t_6++;
          if (unlikely(!__pyx_t_1))
            __PYX_ERR(0, 208, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
#endif
        } else {
          if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_5))
            break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_6);
          __Pyx_INCREF(__pyx_t_1);
          __pyx_t_6++;
          if (unlikely(0 < 0))
            __PYX_ERR(0, 208, __pyx_L1_error)
#else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_5, __pyx_t_6);
          __pyx_t_6++;
          if (unlikely(!__pyx_t_1))
            __PYX_ERR(0, 208, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
#endif
        }
      } else {
        __pyx_t_1 = __pyx_t_7(__pyx_t_5);
        if (unlikely(!__pyx_t_1)) {
          PyObject *exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type,
                                                         PyExc_StopIteration)))
              PyErr_Clear();
            else
              __PYX_ERR(0, 208, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_1);
      }
      __Pyx_XDECREF_SET(__pyx_v_v, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":209
       *             cell = []
       *             for v in poly.vertices:
       *                 p = v.pos             # <<<<<<<<<<<<<<
       *                 # use string key to remove degeneracy associated
       *                 # very close points. The format %.10e ensures that
       */
      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_v, __pyx_n_s_pos);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 209, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_XDECREF_SET(__pyx_v_p, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":215
       *                 # treated as the same. For instance 1.2e-10 and
       *                 # 1.3e-10 are essentially the same.
       *                 vKey = '%.10e,%.10e,%.10e' % (p[0] + offset, #
       * <<<<<<<<<<<<<< p[1] + offset, p[2] + offset)
       */
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_p, 0, long, 1, __Pyx_PyInt_From_long,
                                   0, 0, 1);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 215, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_8 = PyFloat_FromDouble(__pyx_v_offset);
      if (unlikely(!__pyx_t_8))
        __PYX_ERR(0, 215, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_9 = PyNumber_Add(__pyx_t_1, __pyx_t_8);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 215, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_1);
      __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_8);
      __pyx_t_8 = 0;

      /* "pyg4ometry/pycsg/core.pyx":216
       *                 # 1.3e-10 are essentially the same.
       *                 vKey = '%.10e,%.10e,%.10e' % (p[0] + offset,
       *                                               p[1] + offset, #
       * <<<<<<<<<<<<<< p[2] + offset) if not vKey in vertexIndexMap:
       */
      __pyx_t_8 = __Pyx_GetItemInt(__pyx_v_p, 1, long, 1, __Pyx_PyInt_From_long,
                                   0, 0, 1);
      if (unlikely(!__pyx_t_8))
        __PYX_ERR(0, 216, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_1 = PyFloat_FromDouble(__pyx_v_offset);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 216, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_10 = PyNumber_Add(__pyx_t_8, __pyx_t_1);
      if (unlikely(!__pyx_t_10))
        __PYX_ERR(0, 216, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_DECREF(__pyx_t_8);
      __pyx_t_8 = 0;
      __Pyx_DECREF(__pyx_t_1);
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":217
       *                 vKey = '%.10e,%.10e,%.10e' % (p[0] + offset,
       *                                               p[1] + offset,
       *                                               p[2] + offset) #
       * <<<<<<<<<<<<<< if not vKey in vertexIndexMap: vertexIndexMap[vKey] =
       * len(vertexIndexMap)
       */
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_p, 2, long, 1, __Pyx_PyInt_From_long,
                                   0, 0, 1);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 217, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_8 = PyFloat_FromDouble(__pyx_v_offset);
      if (unlikely(!__pyx_t_8))
        __PYX_ERR(0, 217, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_11 = PyNumber_Add(__pyx_t_1, __pyx_t_8);
      if (unlikely(!__pyx_t_11))
        __PYX_ERR(0, 217, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_DECREF(__pyx_t_1);
      __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_8);
      __pyx_t_8 = 0;

      /* "pyg4ometry/pycsg/core.pyx":215
       *                 # treated as the same. For instance 1.2e-10 and
       *                 # 1.3e-10 are essentially the same.
       *                 vKey = '%.10e,%.10e,%.10e' % (p[0] + offset, #
       * <<<<<<<<<<<<<< p[1] + offset, p[2] + offset)
       */
      __pyx_t_8 = PyTuple_New(3);
      if (unlikely(!__pyx_t_8))
        __PYX_ERR(0, 215, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_GIVEREF(__pyx_t_9);
      PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_9);
      __Pyx_GIVEREF(__pyx_t_10);
      PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_t_10);
      __Pyx_GIVEREF(__pyx_t_11);
      PyTuple_SET_ITEM(__pyx_t_8, 2, __pyx_t_11);
      __pyx_t_9 = 0;
      __pyx_t_10 = 0;
      __pyx_t_11 = 0;
      __pyx_t_11 = PyUnicode_Format(__pyx_kp_u_10e_10e_10e, __pyx_t_8);
      if (unlikely(!__pyx_t_11))
        __PYX_ERR(0, 215, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_DECREF(__pyx_t_8);
      __pyx_t_8 = 0;
      __Pyx_XDECREF_SET(__pyx_v_vKey, ((PyObject *)__pyx_t_11));
      __pyx_t_11 = 0;

      /* "pyg4ometry/pycsg/core.pyx":218
       *                                               p[1] + offset,
       *                                               p[2] + offset)
       *                 if not vKey in vertexIndexMap:             #
       * <<<<<<<<<<<<<< vertexIndexMap[vKey] = len(vertexIndexMap) index =
       * vertexIndexMap[vKey]
       */
      __pyx_t_12 = (__Pyx_PyDict_ContainsTF(__pyx_v_vKey,
                                            __pyx_v_vertexIndexMap, Py_NE));
      if (unlikely(__pyx_t_12 < 0))
        __PYX_ERR(0, 218, __pyx_L1_error)
      __pyx_t_13 = (__pyx_t_12 != 0);
      if (__pyx_t_13) {

        /* "pyg4ometry/pycsg/core.pyx":219
         *                                               p[2] + offset)
         *                 if not vKey in vertexIndexMap:
         *                     vertexIndexMap[vKey] = len(vertexIndexMap) #
         * <<<<<<<<<<<<<< index = vertexIndexMap[vKey] cell.append(index)
         */
        __pyx_t_14 = PyDict_Size(__pyx_v_vertexIndexMap);
        if (unlikely(__pyx_t_14 == ((Py_ssize_t)-1)))
          __PYX_ERR(0, 219, __pyx_L1_error)
        __pyx_t_11 = PyInt_FromSsize_t(__pyx_t_14);
        if (unlikely(!__pyx_t_11))
          __PYX_ERR(0, 219, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        if (unlikely(PyDict_SetItem(__pyx_v_vertexIndexMap, __pyx_v_vKey,
                                    __pyx_t_11) < 0))
          __PYX_ERR(0, 219, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_11);
        __pyx_t_11 = 0;

        /* "pyg4ometry/pycsg/core.pyx":218
         *                                               p[1] + offset,
         *                                               p[2] + offset)
         *                 if not vKey in vertexIndexMap:             #
         * <<<<<<<<<<<<<< vertexIndexMap[vKey] = len(vertexIndexMap) index =
         * vertexIndexMap[vKey]
         */
      }

      /* "pyg4ometry/pycsg/core.pyx":220
       *                 if not vKey in vertexIndexMap:
       *                     vertexIndexMap[vKey] = len(vertexIndexMap)
       *                 index = vertexIndexMap[vKey]             #
       * <<<<<<<<<<<<<< cell.append(index) count += 1
       */
      __pyx_t_11 = __Pyx_PyDict_GetItem(__pyx_v_vertexIndexMap, __pyx_v_vKey);
      if (unlikely(!__pyx_t_11))
        __PYX_ERR(0, 220, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_XDECREF_SET(__pyx_v_index, __pyx_t_11);
      __pyx_t_11 = 0;

      /* "pyg4ometry/pycsg/core.pyx":221
       *                     vertexIndexMap[vKey] = len(vertexIndexMap)
       *                 index = vertexIndexMap[vKey]
       *                 cell.append(index)             # <<<<<<<<<<<<<<
       *                 count += 1
       *             polys.append(cell)
       */
      __pyx_t_15 = __Pyx_PyList_Append(__pyx_v_cell, __pyx_v_index);
      if (unlikely(__pyx_t_15 == ((int)-1)))
        __PYX_ERR(0, 221, __pyx_L1_error)

      /* "pyg4ometry/pycsg/core.pyx":222
       *                 index = vertexIndexMap[vKey]
       *                 cell.append(index)
       *                 count += 1             # <<<<<<<<<<<<<<
       *             polys.append(cell)
       *         # sort by index
       */
      __pyx_t_11 = __Pyx_PyInt_AddObjC(__pyx_v_count, __pyx_int_1, 1, 1, 0);
      if (unlikely(!__pyx_t_11))
        __PYX_ERR(0, 222, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_DECREF_SET(__pyx_v_count, __pyx_t_11);
      __pyx_t_11 = 0;

      /* "pyg4ometry/pycsg/core.pyx":208
       *             verts = poly.vertices
       *             cell = []
       *             for v in poly.vertices:             # <<<<<<<<<<<<<<
       *                 p = v.pos
       *                 # use string key to remove degeneracy associated
       */
    }
    __Pyx_DECREF(__pyx_t_5);
    __pyx_t_5 = 0;

    /* "pyg4ometry/pycsg/core.pyx":223
     *                 cell.append(index)
     *                 count += 1
     *             polys.append(cell)             # <<<<<<<<<<<<<<
     *         # sort by index
     *         sortedVertexIndex = sorted(list(vertexIndexMap.items()),
     */
    __pyx_t_15 = __Pyx_PyList_Append(__pyx_v_polys, __pyx_v_cell);
    if (unlikely(__pyx_t_15 == ((int)-1)))
      __PYX_ERR(0, 223, __pyx_L1_error)

    /* "pyg4ometry/pycsg/core.pyx":205
     *         vertexIndexMap = {}
     *         count = 0
     *         for poly in self.polygons:             # <<<<<<<<<<<<<<
     *             verts = poly.vertices
     *             cell = []
     */
  }
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":225
   *             polys.append(cell)
   *         # sort by index
   *         sortedVertexIndex = sorted(list(vertexIndexMap.items()), #
   * <<<<<<<<<<<<<< key=operator.itemgetter(1)) verts = []
   */
  __pyx_t_2 = __Pyx_PyDict_Items(__pyx_v_vertexIndexMap);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 225, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = PySequence_List(__pyx_t_2);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 225, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = PyTuple_New(1);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 225, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5);
  __pyx_t_5 = 0;

  /* "pyg4ometry/pycsg/core.pyx":226
   *         # sort by index
   *         sortedVertexIndex = sorted(list(vertexIndexMap.items()),
   *                                    key=operator.itemgetter(1)) #
   * <<<<<<<<<<<<<< verts = [] for v, i in sortedVertexIndex:
   */
  __pyx_t_5 = __Pyx_PyDict_NewPresized(1);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 226, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_operator);
  if (unlikely(!__pyx_t_8))
    __PYX_ERR(0, 226, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_8);
  __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_itemgetter);
  if (unlikely(!__pyx_t_10))
    __PYX_ERR(0, 226, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_10);
  __Pyx_DECREF(__pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_10))) {
    __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_10);
    if (likely(__pyx_t_8)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_10);
      __Pyx_INCREF(__pyx_t_8);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_10, function);
    }
  }
  __pyx_t_11 =
      (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_8, __pyx_int_1)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_int_1);
  __Pyx_XDECREF(__pyx_t_8);
  __pyx_t_8 = 0;
  if (unlikely(!__pyx_t_11))
    __PYX_ERR(0, 226, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_11);
  __Pyx_DECREF(__pyx_t_10);
  __pyx_t_10 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_key, __pyx_t_11) < 0)
    __PYX_ERR(0, 226, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_11);
  __pyx_t_11 = 0;

  /* "pyg4ometry/pycsg/core.pyx":225
   *             polys.append(cell)
   *         # sort by index
   *         sortedVertexIndex = sorted(list(vertexIndexMap.items()), #
   * <<<<<<<<<<<<<< key=operator.itemgetter(1)) verts = []
   */
  __pyx_t_11 = __Pyx_PyObject_Call(__pyx_builtin_sorted, __pyx_t_2, __pyx_t_5);
  if (unlikely(!__pyx_t_11))
    __PYX_ERR(0, 225, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_11);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_v_sortedVertexIndex = __pyx_t_11;
  __pyx_t_11 = 0;

  /* "pyg4ometry/pycsg/core.pyx":227
   *         sortedVertexIndex = sorted(list(vertexIndexMap.items()),
   *                                    key=operator.itemgetter(1))
   *         verts = []             # <<<<<<<<<<<<<<
   *         for v, i in sortedVertexIndex:
   *             p = []
   */
  __pyx_t_11 = PyList_New(0);
  if (unlikely(!__pyx_t_11))
    __PYX_ERR(0, 227, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_11);
  __Pyx_DECREF_SET(__pyx_v_verts, __pyx_t_11);
  __pyx_t_11 = 0;

  /* "pyg4ometry/pycsg/core.pyx":228
   *                                    key=operator.itemgetter(1))
   *         verts = []
   *         for v, i in sortedVertexIndex:             # <<<<<<<<<<<<<<
   *             p = []
   *             for c in v.split(','):
   */
  if (likely(PyList_CheckExact(__pyx_v_sortedVertexIndex)) ||
      PyTuple_CheckExact(__pyx_v_sortedVertexIndex)) {
    __pyx_t_11 = __pyx_v_sortedVertexIndex;
    __Pyx_INCREF(__pyx_t_11);
    __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1;
    __pyx_t_11 = PyObject_GetIter(__pyx_v_sortedVertexIndex);
    if (unlikely(!__pyx_t_11))
      __PYX_ERR(0, 228, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __pyx_t_4 = Py_TYPE(__pyx_t_11)->tp_iternext;
    if (unlikely(!__pyx_t_4))
      __PYX_ERR(0, 228, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_11))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_11))
          break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_11, __pyx_t_3);
        __Pyx_INCREF(__pyx_t_5);
        __pyx_t_3++;
        if (unlikely(0 < 0))
          __PYX_ERR(0, 228, __pyx_L1_error)
#else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_11, __pyx_t_3);
        __pyx_t_3++;
        if (unlikely(!__pyx_t_5))
          __PYX_ERR(0, 228, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
#endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_11))
          break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_11, __pyx_t_3);
        __Pyx_INCREF(__pyx_t_5);
        __pyx_t_3++;
        if (unlikely(0 < 0))
          __PYX_ERR(0, 228, __pyx_L1_error)
#else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_11, __pyx_t_3);
        __pyx_t_3++;
        if (unlikely(!__pyx_t_5))
          __PYX_ERR(0, 228, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
#endif
      }
    } else {
      __pyx_t_5 = __pyx_t_4(__pyx_t_11);
      if (unlikely(!__pyx_t_5)) {
        PyObject *exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type,
                                                       PyExc_StopIteration)))
            PyErr_Clear();
          else
            __PYX_ERR(0, 228, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_5);
    }
    if ((likely(PyTuple_CheckExact(__pyx_t_5))) ||
        (PyList_CheckExact(__pyx_t_5))) {
      PyObject *sequence = __pyx_t_5;
      Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
      if (unlikely(size != 2)) {
        if (size > 2)
          __Pyx_RaiseTooManyValuesError(2);
        else if (size >= 0)
          __Pyx_RaiseNeedMoreValuesError(size);
        __PYX_ERR(0, 228, __pyx_L1_error)
      }
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
      if (likely(PyTuple_CheckExact(sequence))) {
        __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0);
        __pyx_t_10 = PyTuple_GET_ITEM(sequence, 1);
      } else {
        __pyx_t_2 = PyList_GET_ITEM(sequence, 0);
        __pyx_t_10 = PyList_GET_ITEM(sequence, 1);
      }
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_10);
#else
      __pyx_t_2 = PySequence_ITEM(sequence, 0);
      if (unlikely(!__pyx_t_2))
        __PYX_ERR(0, 228, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_10 = PySequence_ITEM(sequence, 1);
      if (unlikely(!__pyx_t_10))
        __PYX_ERR(0, 228, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
#endif
      __Pyx_DECREF(__pyx_t_5);
      __pyx_t_5 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_8 = PyObject_GetIter(__pyx_t_5);
      if (unlikely(!__pyx_t_8))
        __PYX_ERR(0, 228, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_5);
      __pyx_t_5 = 0;
      __pyx_t_16 = Py_TYPE(__pyx_t_8)->tp_iternext;
      index = 0;
      __pyx_t_2 = __pyx_t_16(__pyx_t_8);
      if (unlikely(!__pyx_t_2))
        goto __pyx_L10_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_2);
      index = 1;
      __pyx_t_10 = __pyx_t_16(__pyx_t_8);
      if (unlikely(!__pyx_t_10))
        goto __pyx_L10_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_10);
      if (__Pyx_IternextUnpackEndCheck(__pyx_t_16(__pyx_t_8), 2) < 0)
        __PYX_ERR(0, 228, __pyx_L1_error)
      __pyx_t_16 = NULL;
      __Pyx_DECREF(__pyx_t_8);
      __pyx_t_8 = 0;
      goto __pyx_L11_unpacking_done;
    __pyx_L10_unpacking_failed:;
      __Pyx_DECREF(__pyx_t_8);
      __pyx_t_8 = 0;
      __pyx_t_16 = NULL;
      if (__Pyx_IterFinish() == 0)
        __Pyx_RaiseNeedMoreValuesError(index);
      __PYX_ERR(0, 228, __pyx_L1_error)
    __pyx_L11_unpacking_done:;
    }
    __Pyx_XDECREF_SET(__pyx_v_v, __pyx_t_2);
    __pyx_t_2 = 0;
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_10);
    __pyx_t_10 = 0;

    /* "pyg4ometry/pycsg/core.pyx":229
     *         verts = []
     *         for v, i in sortedVertexIndex:
     *             p = []             # <<<<<<<<<<<<<<
     *             for c in v.split(','):
     *                 p.append(float(c) - offset)
     */
    __pyx_t_5 = PyList_New(0);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 229, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_XDECREF_SET(__pyx_v_p, __pyx_t_5);
    __pyx_t_5 = 0;

    /* "pyg4ometry/pycsg/core.pyx":230
     *         for v, i in sortedVertexIndex:
     *             p = []
     *             for c in v.split(','):             # <<<<<<<<<<<<<<
     *                 p.append(float(c) - offset)
     *             verts.append(tuple(p))
     */
    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_v, __pyx_n_s_split);
    if (unlikely(!__pyx_t_10))
      __PYX_ERR(0, 230, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
    __pyx_t_2 = NULL;
    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_10);
      if (likely(__pyx_t_2)) {
        PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_10);
        __Pyx_INCREF(__pyx_t_2);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_10, function);
      }
    }
    __pyx_t_5 =
        (__pyx_t_2)
            ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_2, __pyx_kp_u__3)
            : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_kp_u__3);
    __Pyx_XDECREF(__pyx_t_2);
    __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 230, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_10);
    __pyx_t_10 = 0;
    if (likely(PyList_CheckExact(__pyx_t_5)) || PyTuple_CheckExact(__pyx_t_5)) {
      __pyx_t_10 = __pyx_t_5;
      __Pyx_INCREF(__pyx_t_10);
      __pyx_t_6 = 0;
      __pyx_t_7 = NULL;
    } else {
      __pyx_t_6 = -1;
      __pyx_t_10 = PyObject_GetIter(__pyx_t_5);
      if (unlikely(!__pyx_t_10))
        __PYX_ERR(0, 230, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __pyx_t_7 = Py_TYPE(__pyx_t_10)->tp_iternext;
      if (unlikely(!__pyx_t_7))
        __PYX_ERR(0, 230, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_5);
    __pyx_t_5 = 0;
    for (;;) {
      if (likely(!__pyx_t_7)) {
        if (likely(PyList_CheckExact(__pyx_t_10))) {
          if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_10))
            break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_5 = PyList_GET_ITEM(__pyx_t_10, __pyx_t_6);
          __Pyx_INCREF(__pyx_t_5);
          __pyx_t_6++;
          if (unlikely(0 < 0))
            __PYX_ERR(0, 230, __pyx_L1_error)
#else
          __pyx_t_5 = PySequence_ITEM(__pyx_t_10, __pyx_t_6);
          __pyx_t_6++;
          if (unlikely(!__pyx_t_5))
            __PYX_ERR(0, 230, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
#endif
        } else {
          if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_10))
            break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_10, __pyx_t_6);
          __Pyx_INCREF(__pyx_t_5);
          __pyx_t_6++;
          if (unlikely(0 < 0))
            __PYX_ERR(0, 230, __pyx_L1_error)
#else
          __pyx_t_5 = PySequence_ITEM(__pyx_t_10, __pyx_t_6);
          __pyx_t_6++;
          if (unlikely(!__pyx_t_5))
            __PYX_ERR(0, 230, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
#endif
        }
      } else {
        __pyx_t_5 = __pyx_t_7(__pyx_t_10);
        if (unlikely(!__pyx_t_5)) {
          PyObject *exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type,
                                                         PyExc_StopIteration)))
              PyErr_Clear();
            else
              __PYX_ERR(0, 230, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_5);
      }
      __Pyx_XDECREF_SET(__pyx_v_c, __pyx_t_5);
      __pyx_t_5 = 0;

      /* "pyg4ometry/pycsg/core.pyx":231
       *             p = []
       *             for c in v.split(','):
       *                 p.append(float(c) - offset)             #
       * <<<<<<<<<<<<<< verts.append(tuple(p)) return verts, polys, count
       */
      __pyx_t_17 = __Pyx_PyObject_AsDouble(__pyx_v_c);
      if (unlikely(__pyx_t_17 == ((double)((double)-1)) && PyErr_Occurred()))
        __PYX_ERR(0, 231, __pyx_L1_error)
      __pyx_t_5 = PyFloat_FromDouble((__pyx_t_17 - __pyx_v_offset));
      if (unlikely(!__pyx_t_5))
        __PYX_ERR(0, 231, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_15 = __Pyx_PyObject_Append(__pyx_v_p, __pyx_t_5);
      if (unlikely(__pyx_t_15 == ((int)-1)))
        __PYX_ERR(0, 231, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_5);
      __pyx_t_5 = 0;

      /* "pyg4ometry/pycsg/core.pyx":230
       *         for v, i in sortedVertexIndex:
       *             p = []
       *             for c in v.split(','):             # <<<<<<<<<<<<<<
       *                 p.append(float(c) - offset)
       *             verts.append(tuple(p))
       */
    }
    __Pyx_DECREF(__pyx_t_10);
    __pyx_t_10 = 0;

    /* "pyg4ometry/pycsg/core.pyx":232
     *             for c in v.split(','):
     *                 p.append(float(c) - offset)
     *             verts.append(tuple(p))             # <<<<<<<<<<<<<<
     *         return verts, polys, count
     *
     */
    __pyx_t_10 = __Pyx_PySequence_Tuple(__pyx_v_p);
    if (unlikely(!__pyx_t_10))
      __PYX_ERR(0, 232, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
    __pyx_t_15 = __Pyx_PyObject_Append(__pyx_v_verts, __pyx_t_10);
    if (unlikely(__pyx_t_15 == ((int)-1)))
      __PYX_ERR(0, 232, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_10);
    __pyx_t_10 = 0;

    /* "pyg4ometry/pycsg/core.pyx":228
     *                                    key=operator.itemgetter(1))
     *         verts = []
     *         for v, i in sortedVertexIndex:             # <<<<<<<<<<<<<<
     *             p = []
     *             for c in v.split(','):
     */
  }
  __Pyx_DECREF(__pyx_t_11);
  __pyx_t_11 = 0;

  /* "pyg4ometry/pycsg/core.pyx":233
   *                 p.append(float(c) - offset)
   *             verts.append(tuple(p))
   *         return verts, polys, count             # <<<<<<<<<<<<<<
   *
   *     def saveVTK(self, filename):
   */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_11 = PyTuple_New(3);
  if (unlikely(!__pyx_t_11))
    __PYX_ERR(0, 233, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_11);
  __Pyx_INCREF(__pyx_v_verts);
  __Pyx_GIVEREF(__pyx_v_verts);
  PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_v_verts);
  __Pyx_INCREF(__pyx_v_polys);
  __Pyx_GIVEREF(__pyx_v_polys);
  PyTuple_SET_ITEM(__pyx_t_11, 1, __pyx_v_polys);
  __Pyx_INCREF(__pyx_v_count);
  __Pyx_GIVEREF(__pyx_v_count);
  PyTuple_SET_ITEM(__pyx_t_11, 2, __pyx_v_count);
  __pyx_r = __pyx_t_11;
  __pyx_t_11 = 0;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":194
 *                     vert.normal = newVector(vert.normal)
 *
 *     def toVerticesAndPolygons(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return list of vertices, polygons (cells), and the total
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.toVerticesAndPolygons",
                     __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XDECREF(__pyx_v_verts);
  __Pyx_XDECREF(__pyx_v_polys);
  __Pyx_XDECREF(__pyx_v_vertexIndexMap);
  __Pyx_XDECREF(__pyx_v_count);
  __Pyx_XDECREF(__pyx_v_poly);
  __Pyx_XDECREF(__pyx_v_cell);
  __Pyx_XDECREF(__pyx_v_v);
  __Pyx_XDECREF(__pyx_v_p);
  __Pyx_XDECREF(__pyx_v_vKey);
  __Pyx_XDECREF(__pyx_v_index);
  __Pyx_XDECREF(__pyx_v_sortedVertexIndex);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XDECREF(__pyx_v_c);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":235
 *         return verts, polys, count
 *
 *     def saveVTK(self, filename):             # <<<<<<<<<<<<<<
 *         """
 *         Save polygons in VTK file.
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_27saveVTK(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_26saveVTK[] =
    "\n        Save polygons in VTK file.\n        ";
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_27saveVTK = {
    "saveVTK",
    (PyCFunction)(void *)(PyCFunctionWithKeywords)
        __pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_27saveVTK,
    METH_VARARGS | METH_KEYWORDS,
    __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_26saveVTK};
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_27saveVTK(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_self = 0;
  PyObject *__pyx_v_filename = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext("saveVTK (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,
                                            &__pyx_n_s_filename, 0};
    PyObject *values[2] = {0, 0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
      case 2:
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
      case 1:
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
      case 0:
        break;
      default:
        goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
      case 0:
        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_self)) != 0))
          kw_args--;
        else
          goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
      case 1:
        if (likely((values[1] = __Pyx_PyDict_GetItemStr(
                        __pyx_kwds, __pyx_n_s_filename)) != 0))
          kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("saveVTK", 1, 2, 2, 1);
          __PYX_ERR(0, 235, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames,
                                                 0, values, pos_args,
                                                 "saveVTK") < 0))
          __PYX_ERR(0, 235, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_self = values[0];
    __pyx_v_filename = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
__pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("saveVTK", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args));
  __PYX_ERR(0, 235, __pyx_L3_error)
__pyx_L3_error:;
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.saveVTK", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
__pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_26saveVTK(
      __pyx_self, __pyx_v_self, __pyx_v_filename);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_26saveVTK(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self,
    PyObject *__pyx_v_filename) {
  PyObject *__pyx_v_f = NULL;
  PyObject *__pyx_v_verts = NULL;
  PyObject *__pyx_v_cells = NULL;
  PyObject *__pyx_v_count = NULL;
  PyObject *__pyx_v_v = NULL;
  PyObject *__pyx_v_numCells = NULL;
  PyObject *__pyx_v_cell = NULL;
  PyObject *__pyx_v_index = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  PyObject *(*__pyx_t_10)(PyObject *);
  Py_ssize_t __pyx_t_11;
  PyObject *__pyx_t_12 = NULL;
  PyObject *(*__pyx_t_13)(PyObject *);
  PyObject *__pyx_t_14 = NULL;
  PyObject *__pyx_t_15 = NULL;
  PyObject *__pyx_t_16 = NULL;
  int __pyx_t_17;
  PyObject *__pyx_t_18 = NULL;
  Py_ssize_t __pyx_t_19;
  PyObject *(*__pyx_t_20)(PyObject *);
  PyObject *__pyx_t_21 = NULL;
  int __pyx_t_22;
  int __pyx_t_23;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("saveVTK", 0);

  /* "pyg4ometry/pycsg/core.pyx":239
   *         Save polygons in VTK file.
   *         """
   *         with open(filename, 'w') as f:             # <<<<<<<<<<<<<<
   *             f.write('# vtk DataFile Version 3.0\n')
   *             f.write('pycsg output\n')
   */
  /*with:*/ {
    __pyx_t_1 = PyTuple_New(2);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 239, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_filename);
    __Pyx_GIVEREF(__pyx_v_filename);
    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_filename);
    __Pyx_INCREF(__pyx_n_u_w);
    __Pyx_GIVEREF(__pyx_n_u_w);
    PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_n_u_w);
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_open, __pyx_t_1, NULL);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 239, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_3 = __Pyx_PyObject_LookupSpecial(__pyx_t_2, __pyx_n_s_exit);
    if (unlikely(!__pyx_t_3))
      __PYX_ERR(0, 239, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = __Pyx_PyObject_LookupSpecial(__pyx_t_2, __pyx_n_s_enter);
    if (unlikely(!__pyx_t_4))
      __PYX_ERR(0, 239, __pyx_L3_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = NULL;
    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
      if (likely(__pyx_t_5)) {
        PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_4);
        __Pyx_INCREF(__pyx_t_5);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_4, function);
      }
    }
    __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5)
                            : __Pyx_PyObject_CallNoArg(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_5);
    __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 239, __pyx_L3_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = __pyx_t_1;
    __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_2);
    __pyx_t_2 = 0;
    /*try:*/ {
      {
        __Pyx_PyThreadState_declare __Pyx_PyThreadState_assign
            __Pyx_ExceptionSave(&__pyx_t_6, &__pyx_t_7, &__pyx_t_8);
        __Pyx_XGOTREF(__pyx_t_6);
        __Pyx_XGOTREF(__pyx_t_7);
        __Pyx_XGOTREF(__pyx_t_8);
        /*try:*/ {
          __pyx_v_f = __pyx_t_4;
          __pyx_t_4 = 0;

          /* "pyg4ometry/pycsg/core.pyx":240
           *         """
           *         with open(filename, 'w') as f:
           *             f.write('# vtk DataFile Version 3.0\n')             #
           * <<<<<<<<<<<<<< f.write('pycsg output\n') f.write('ASCII\n')
           */
          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_write);
          if (unlikely(!__pyx_t_2))
            __PYX_ERR(0, 240, __pyx_L7_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_1 = NULL;
          if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
            __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
            if (likely(__pyx_t_1)) {
              PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
              __Pyx_INCREF(__pyx_t_1);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_2, function);
            }
          }
          __pyx_t_4 = (__pyx_t_1)
                          ? __Pyx_PyObject_Call2Args(
                                __pyx_t_2, __pyx_t_1,
                                __pyx_kp_u_vtk_DataFile_Version_3_0)
                          : __Pyx_PyObject_CallOneArg(
                                __pyx_t_2, __pyx_kp_u_vtk_DataFile_Version_3_0);
          __Pyx_XDECREF(__pyx_t_1);
          __pyx_t_1 = 0;
          if (unlikely(!__pyx_t_4))
            __PYX_ERR(0, 240, __pyx_L7_error)
          __Pyx_GOTREF(__pyx_t_4);
          __Pyx_DECREF(__pyx_t_2);
          __pyx_t_2 = 0;
          __Pyx_DECREF(__pyx_t_4);
          __pyx_t_4 = 0;

          /* "pyg4ometry/pycsg/core.pyx":241
           *         with open(filename, 'w') as f:
           *             f.write('# vtk DataFile Version 3.0\n')
           *             f.write('pycsg output\n')             # <<<<<<<<<<<<<<
           *             f.write('ASCII\n')
           *             f.write('DATASET POLYDATA\n')
           */
          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_write);
          if (unlikely(!__pyx_t_2))
            __PYX_ERR(0, 241, __pyx_L7_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_1 = NULL;
          if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
            __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
            if (likely(__pyx_t_1)) {
              PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
              __Pyx_INCREF(__pyx_t_1);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_2, function);
            }
          }
          __pyx_t_4 = (__pyx_t_1)
                          ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_1,
                                                     __pyx_kp_u_pycsg_output)
                          : __Pyx_PyObject_CallOneArg(__pyx_t_2,
                                                      __pyx_kp_u_pycsg_output);
          __Pyx_XDECREF(__pyx_t_1);
          __pyx_t_1 = 0;
          if (unlikely(!__pyx_t_4))
            __PYX_ERR(0, 241, __pyx_L7_error)
          __Pyx_GOTREF(__pyx_t_4);
          __Pyx_DECREF(__pyx_t_2);
          __pyx_t_2 = 0;
          __Pyx_DECREF(__pyx_t_4);
          __pyx_t_4 = 0;

          /* "pyg4ometry/pycsg/core.pyx":242
           *             f.write('# vtk DataFile Version 3.0\n')
           *             f.write('pycsg output\n')
           *             f.write('ASCII\n')             # <<<<<<<<<<<<<<
           *             f.write('DATASET POLYDATA\n')
           *
           */
          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_write);
          if (unlikely(!__pyx_t_2))
            __PYX_ERR(0, 242, __pyx_L7_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_1 = NULL;
          if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
            __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
            if (likely(__pyx_t_1)) {
              PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
              __Pyx_INCREF(__pyx_t_1);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_2, function);
            }
          }
          __pyx_t_4 =
              (__pyx_t_1)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_1,
                                             __pyx_n_u_ASCII)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_n_u_ASCII);
          __Pyx_XDECREF(__pyx_t_1);
          __pyx_t_1 = 0;
          if (unlikely(!__pyx_t_4))
            __PYX_ERR(0, 242, __pyx_L7_error)
          __Pyx_GOTREF(__pyx_t_4);
          __Pyx_DECREF(__pyx_t_2);
          __pyx_t_2 = 0;
          __Pyx_DECREF(__pyx_t_4);
          __pyx_t_4 = 0;

          /* "pyg4ometry/pycsg/core.pyx":243
           *             f.write('pycsg output\n')
           *             f.write('ASCII\n')
           *             f.write('DATASET POLYDATA\n')             #
           * <<<<<<<<<<<<<<
           *
           *             verts, cells, count = self.toVerticesAndPolygons()
           */
          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_write);
          if (unlikely(!__pyx_t_2))
            __PYX_ERR(0, 243, __pyx_L7_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_1 = NULL;
          if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
            __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
            if (likely(__pyx_t_1)) {
              PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
              __Pyx_INCREF(__pyx_t_1);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_2, function);
            }
          }
          __pyx_t_4 =
              (__pyx_t_1)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_1,
                                             __pyx_kp_u_DATASET_POLYDATA)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2,
                                              __pyx_kp_u_DATASET_POLYDATA);
          __Pyx_XDECREF(__pyx_t_1);
          __pyx_t_1 = 0;
          if (unlikely(!__pyx_t_4))
            __PYX_ERR(0, 243, __pyx_L7_error)
          __Pyx_GOTREF(__pyx_t_4);
          __Pyx_DECREF(__pyx_t_2);
          __pyx_t_2 = 0;
          __Pyx_DECREF(__pyx_t_4);
          __pyx_t_4 = 0;

          /* "pyg4ometry/pycsg/core.pyx":245
           *             f.write('DATASET POLYDATA\n')
           *
           *             verts, cells, count = self.toVerticesAndPolygons() #
           * <<<<<<<<<<<<<<
           *
           *             f.write('POINTS {0} float\n'.format(len(verts)))
           */
          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(
              __pyx_v_self, __pyx_n_s_toVerticesAndPolygons);
          if (unlikely(!__pyx_t_2))
            __PYX_ERR(0, 245, __pyx_L7_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_1 = NULL;
          if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
            __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
            if (likely(__pyx_t_1)) {
              PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
              __Pyx_INCREF(__pyx_t_1);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_2, function);
            }
          }
          __pyx_t_4 = (__pyx_t_1)
                          ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_1)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_2);
          __Pyx_XDECREF(__pyx_t_1);
          __pyx_t_1 = 0;
          if (unlikely(!__pyx_t_4))
            __PYX_ERR(0, 245, __pyx_L7_error)
          __Pyx_GOTREF(__pyx_t_4);
          __Pyx_DECREF(__pyx_t_2);
          __pyx_t_2 = 0;
          if ((likely(PyTuple_CheckExact(__pyx_t_4))) ||
              (PyList_CheckExact(__pyx_t_4))) {
            PyObject *sequence = __pyx_t_4;
            Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
            if (unlikely(size != 3)) {
              if (size > 3)
                __Pyx_RaiseTooManyValuesError(3);
              else if (size >= 0)
                __Pyx_RaiseNeedMoreValuesError(size);
              __PYX_ERR(0, 245, __pyx_L7_error)
            }
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
            if (likely(PyTuple_CheckExact(sequence))) {
              __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0);
              __pyx_t_1 = PyTuple_GET_ITEM(sequence, 1);
              __pyx_t_5 = PyTuple_GET_ITEM(sequence, 2);
            } else {
              __pyx_t_2 = PyList_GET_ITEM(sequence, 0);
              __pyx_t_1 = PyList_GET_ITEM(sequence, 1);
              __pyx_t_5 = PyList_GET_ITEM(sequence, 2);
            }
            __Pyx_INCREF(__pyx_t_2);
            __Pyx_INCREF(__pyx_t_1);
            __Pyx_INCREF(__pyx_t_5);
#else
            __pyx_t_2 = PySequence_ITEM(sequence, 0);
            if (unlikely(!__pyx_t_2))
              __PYX_ERR(0, 245, __pyx_L7_error)
            __Pyx_GOTREF(__pyx_t_2);
            __pyx_t_1 = PySequence_ITEM(sequence, 1);
            if (unlikely(!__pyx_t_1))
              __PYX_ERR(0, 245, __pyx_L7_error)
            __Pyx_GOTREF(__pyx_t_1);
            __pyx_t_5 = PySequence_ITEM(sequence, 2);
            if (unlikely(!__pyx_t_5))
              __PYX_ERR(0, 245, __pyx_L7_error)
            __Pyx_GOTREF(__pyx_t_5);
#endif
            __Pyx_DECREF(__pyx_t_4);
            __pyx_t_4 = 0;
          } else {
            Py_ssize_t index = -1;
            __pyx_t_9 = PyObject_GetIter(__pyx_t_4);
            if (unlikely(!__pyx_t_9))
              __PYX_ERR(0, 245, __pyx_L7_error)
            __Pyx_GOTREF(__pyx_t_9);
            __Pyx_DECREF(__pyx_t_4);
            __pyx_t_4 = 0;
            __pyx_t_10 = Py_TYPE(__pyx_t_9)->tp_iternext;
            index = 0;
            __pyx_t_2 = __pyx_t_10(__pyx_t_9);
            if (unlikely(!__pyx_t_2))
              goto __pyx_L13_unpacking_failed;
            __Pyx_GOTREF(__pyx_t_2);
            index = 1;
            __pyx_t_1 = __pyx_t_10(__pyx_t_9);
            if (unlikely(!__pyx_t_1))
              goto __pyx_L13_unpacking_failed;
            __Pyx_GOTREF(__pyx_t_1);
            index = 2;
            __pyx_t_5 = __pyx_t_10(__pyx_t_9);
            if (unlikely(!__pyx_t_5))
              goto __pyx_L13_unpacking_failed;
            __Pyx_GOTREF(__pyx_t_5);
            if (__Pyx_IternextUnpackEndCheck(__pyx_t_10(__pyx_t_9), 3) < 0)
              __PYX_ERR(0, 245, __pyx_L7_error)
            __pyx_t_10 = NULL;
            __Pyx_DECREF(__pyx_t_9);
            __pyx_t_9 = 0;
            goto __pyx_L14_unpacking_done;
          __pyx_L13_unpacking_failed:;
            __Pyx_DECREF(__pyx_t_9);
            __pyx_t_9 = 0;
            __pyx_t_10 = NULL;
            if (__Pyx_IterFinish() == 0)
              __Pyx_RaiseNeedMoreValuesError(index);
            __PYX_ERR(0, 245, __pyx_L7_error)
          __pyx_L14_unpacking_done:;
          }
          __pyx_v_verts = __pyx_t_2;
          __pyx_t_2 = 0;
          __pyx_v_cells = __pyx_t_1;
          __pyx_t_1 = 0;
          __pyx_v_count = __pyx_t_5;
          __pyx_t_5 = 0;

          /* "pyg4ometry/pycsg/core.pyx":247
           *             verts, cells, count = self.toVerticesAndPolygons()
           *
           *             f.write('POINTS {0} float\n'.format(len(verts))) #
           * <<<<<<<<<<<<<< for v in verts: f.write('{0} {1} {2}\n'.format(v[0],
           * v[1], v[2]))
           */
          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_write);
          if (unlikely(!__pyx_t_5))
            __PYX_ERR(0, 247, __pyx_L7_error)
          __Pyx_GOTREF(__pyx_t_5);
          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_POINTS_0_float,
                                                __pyx_n_s_format);
          if (unlikely(!__pyx_t_2))
            __PYX_ERR(0, 247, __pyx_L7_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_11 = PyObject_Length(__pyx_v_verts);
          if (unlikely(__pyx_t_11 == ((Py_ssize_t)-1)))
            __PYX_ERR(0, 247, __pyx_L7_error)
          __pyx_t_9 = PyInt_FromSsize_t(__pyx_t_11);
          if (unlikely(!__pyx_t_9))
            __PYX_ERR(0, 247, __pyx_L7_error)
          __Pyx_GOTREF(__pyx_t_9);
          __pyx_t_12 = NULL;
          if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
            __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_2);
            if (likely(__pyx_t_12)) {
              PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
              __Pyx_INCREF(__pyx_t_12);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_2, function);
            }
          }
          __pyx_t_1 =
              (__pyx_t_12)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_12, __pyx_t_9)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_9);
          __Pyx_XDECREF(__pyx_t_12);
          __pyx_t_12 = 0;
          __Pyx_DECREF(__pyx_t_9);
          __pyx_t_9 = 0;
          if (unlikely(!__pyx_t_1))
            __PYX_ERR(0, 247, __pyx_L7_error)
          __Pyx_GOTREF(__pyx_t_1);
          __Pyx_DECREF(__pyx_t_2);
          __pyx_t_2 = 0;
          __pyx_t_2 = NULL;
          if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
            __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
            if (likely(__pyx_t_2)) {
              PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_5);
              __Pyx_INCREF(__pyx_t_2);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_5, function);
            }
          }
          __pyx_t_4 =
              (__pyx_t_2)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_2, __pyx_t_1)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_1);
          __Pyx_XDECREF(__pyx_t_2);
          __pyx_t_2 = 0;
          __Pyx_DECREF(__pyx_t_1);
          __pyx_t_1 = 0;
          if (unlikely(!__pyx_t_4))
            __PYX_ERR(0, 247, __pyx_L7_error)
          __Pyx_GOTREF(__pyx_t_4);
          __Pyx_DECREF(__pyx_t_5);
          __pyx_t_5 = 0;
          __Pyx_DECREF(__pyx_t_4);
          __pyx_t_4 = 0;

          /* "pyg4ometry/pycsg/core.pyx":248
           *
           *             f.write('POINTS {0} float\n'.format(len(verts)))
           *             for v in verts:             # <<<<<<<<<<<<<<
           *                 f.write('{0} {1} {2}\n'.format(v[0], v[1], v[2]))
           *             numCells = len(cells)
           */
          if (likely(PyList_CheckExact(__pyx_v_verts)) ||
              PyTuple_CheckExact(__pyx_v_verts)) {
            __pyx_t_4 = __pyx_v_verts;
            __Pyx_INCREF(__pyx_t_4);
            __pyx_t_11 = 0;
            __pyx_t_13 = NULL;
          } else {
            __pyx_t_11 = -1;
            __pyx_t_4 = PyObject_GetIter(__pyx_v_verts);
            if (unlikely(!__pyx_t_4))
              __PYX_ERR(0, 248, __pyx_L7_error)
            __Pyx_GOTREF(__pyx_t_4);
            __pyx_t_13 = Py_TYPE(__pyx_t_4)->tp_iternext;
            if (unlikely(!__pyx_t_13))
              __PYX_ERR(0, 248, __pyx_L7_error)
          }
          for (;;) {
            if (likely(!__pyx_t_13)) {
              if (likely(PyList_CheckExact(__pyx_t_4))) {
                if (__pyx_t_11 >= PyList_GET_SIZE(__pyx_t_4))
                  break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
                __pyx_t_5 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_11);
                __Pyx_INCREF(__pyx_t_5);
                __pyx_t_11++;
                if (unlikely(0 < 0))
                  __PYX_ERR(0, 248, __pyx_L7_error)
#else
                __pyx_t_5 = PySequence_ITEM(__pyx_t_4, __pyx_t_11);
                __pyx_t_11++;
                if (unlikely(!__pyx_t_5))
                  __PYX_ERR(0, 248, __pyx_L7_error)
                __Pyx_GOTREF(__pyx_t_5);
#endif
              } else {
                if (__pyx_t_11 >= PyTuple_GET_SIZE(__pyx_t_4))
                  break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
                __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_11);
                __Pyx_INCREF(__pyx_t_5);
                __pyx_t_11++;
                if (unlikely(0 < 0))
                  __PYX_ERR(0, 248, __pyx_L7_error)
#else
                __pyx_t_5 = PySequence_ITEM(__pyx_t_4, __pyx_t_11);
                __pyx_t_11++;
                if (unlikely(!__pyx_t_5))
                  __PYX_ERR(0, 248, __pyx_L7_error)
                __Pyx_GOTREF(__pyx_t_5);
#endif
              }
            } else {
              __pyx_t_5 = __pyx_t_13(__pyx_t_4);
              if (unlikely(!__pyx_t_5)) {
                PyObject *exc_type = PyErr_Occurred();
                if (exc_type) {
                  if (likely(__Pyx_PyErr_GivenExceptionMatches(
                          exc_type, PyExc_StopIteration)))
                    PyErr_Clear();
                  else
                    __PYX_ERR(0, 248, __pyx_L7_error)
                }
                break;
              }
              __Pyx_GOTREF(__pyx_t_5);
            }
            __Pyx_XDECREF_SET(__pyx_v_v, __pyx_t_5);
            __pyx_t_5 = 0;

            /* "pyg4ometry/pycsg/core.pyx":249
             *             f.write('POINTS {0} float\n'.format(len(verts)))
             *             for v in verts:
             *                 f.write('{0} {1} {2}\n'.format(v[0], v[1], v[2]))
             * #
             * <<<<<<<<<<<<<< numCells = len(cells) f.write('POLYGONS {0}
             * {1}\n'.format(numCells, count + numCells))
             */
            __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_write);
            if (unlikely(!__pyx_t_1))
              __PYX_ERR(0, 249, __pyx_L7_error)
            __Pyx_GOTREF(__pyx_t_1);
            __pyx_t_9 =
                __Pyx_PyObject_GetAttrStr(__pyx_kp_u_0_1_2, __pyx_n_s_format);
            if (unlikely(!__pyx_t_9))
              __PYX_ERR(0, 249, __pyx_L7_error)
            __Pyx_GOTREF(__pyx_t_9);
            __pyx_t_12 = __Pyx_GetItemInt(__pyx_v_v, 0, long, 1,
                                          __Pyx_PyInt_From_long, 0, 0, 1);
            if (unlikely(!__pyx_t_12))
              __PYX_ERR(0, 249, __pyx_L7_error)
            __Pyx_GOTREF(__pyx_t_12);
            __pyx_t_14 = __Pyx_GetItemInt(__pyx_v_v, 1, long, 1,
                                          __Pyx_PyInt_From_long, 0, 0, 1);
            if (unlikely(!__pyx_t_14))
              __PYX_ERR(0, 249, __pyx_L7_error)
            __Pyx_GOTREF(__pyx_t_14);
            __pyx_t_15 = __Pyx_GetItemInt(__pyx_v_v, 2, long, 1,
                                          __Pyx_PyInt_From_long, 0, 0, 1);
            if (unlikely(!__pyx_t_15))
              __PYX_ERR(0, 249, __pyx_L7_error)
            __Pyx_GOTREF(__pyx_t_15);
            __pyx_t_16 = NULL;
            __pyx_t_17 = 0;
            if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_9))) {
              __pyx_t_16 = PyMethod_GET_SELF(__pyx_t_9);
              if (likely(__pyx_t_16)) {
                PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_9);
                __Pyx_INCREF(__pyx_t_16);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_9, function);
                __pyx_t_17 = 1;
              }
            }
#if CYTHON_FAST_PYCALL
            if (PyFunction_Check(__pyx_t_9)) {
              PyObject *__pyx_temp[4] = {__pyx_t_16, __pyx_t_12, __pyx_t_14,
                                         __pyx_t_15};
              __pyx_t_2 = __Pyx_PyFunction_FastCall(
                  __pyx_t_9, __pyx_temp + 1 - __pyx_t_17, 3 + __pyx_t_17);
              if (unlikely(!__pyx_t_2))
                __PYX_ERR(0, 249, __pyx_L7_error)
              __Pyx_XDECREF(__pyx_t_16);
              __pyx_t_16 = 0;
              __Pyx_GOTREF(__pyx_t_2);
              __Pyx_DECREF(__pyx_t_12);
              __pyx_t_12 = 0;
              __Pyx_DECREF(__pyx_t_14);
              __pyx_t_14 = 0;
              __Pyx_DECREF(__pyx_t_15);
              __pyx_t_15 = 0;
            } else
#endif
#if CYTHON_FAST_PYCCALL
                if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
              PyObject *__pyx_temp[4] = {__pyx_t_16, __pyx_t_12, __pyx_t_14,
                                         __pyx_t_15};
              __pyx_t_2 = __Pyx_PyCFunction_FastCall(
                  __pyx_t_9, __pyx_temp + 1 - __pyx_t_17, 3 + __pyx_t_17);
              if (unlikely(!__pyx_t_2))
                __PYX_ERR(0, 249, __pyx_L7_error)
              __Pyx_XDECREF(__pyx_t_16);
              __pyx_t_16 = 0;
              __Pyx_GOTREF(__pyx_t_2);
              __Pyx_DECREF(__pyx_t_12);
              __pyx_t_12 = 0;
              __Pyx_DECREF(__pyx_t_14);
              __pyx_t_14 = 0;
              __Pyx_DECREF(__pyx_t_15);
              __pyx_t_15 = 0;
            } else
#endif
            {
              __pyx_t_18 = PyTuple_New(3 + __pyx_t_17);
              if (unlikely(!__pyx_t_18))
                __PYX_ERR(0, 249, __pyx_L7_error)
              __Pyx_GOTREF(__pyx_t_18);
              if (__pyx_t_16) {
                __Pyx_GIVEREF(__pyx_t_16);
                PyTuple_SET_ITEM(__pyx_t_18, 0, __pyx_t_16);
                __pyx_t_16 = NULL;
              }
              __Pyx_GIVEREF(__pyx_t_12);
              PyTuple_SET_ITEM(__pyx_t_18, 0 + __pyx_t_17, __pyx_t_12);
              __Pyx_GIVEREF(__pyx_t_14);
              PyTuple_SET_ITEM(__pyx_t_18, 1 + __pyx_t_17, __pyx_t_14);
              __Pyx_GIVEREF(__pyx_t_15);
              PyTuple_SET_ITEM(__pyx_t_18, 2 + __pyx_t_17, __pyx_t_15);
              __pyx_t_12 = 0;
              __pyx_t_14 = 0;
              __pyx_t_15 = 0;
              __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_18, NULL);
              if (unlikely(!__pyx_t_2))
                __PYX_ERR(0, 249, __pyx_L7_error)
              __Pyx_GOTREF(__pyx_t_2);
              __Pyx_DECREF(__pyx_t_18);
              __pyx_t_18 = 0;
            }
            __Pyx_DECREF(__pyx_t_9);
            __pyx_t_9 = 0;
            __pyx_t_9 = NULL;
            if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
              __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_1);
              if (likely(__pyx_t_9)) {
                PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_1);
                __Pyx_INCREF(__pyx_t_9);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_1, function);
              }
            }
            __pyx_t_5 =
                (__pyx_t_9)
                    ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_9, __pyx_t_2)
                    : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_2);
            __Pyx_XDECREF(__pyx_t_9);
            __pyx_t_9 = 0;
            __Pyx_DECREF(__pyx_t_2);
            __pyx_t_2 = 0;
            if (unlikely(!__pyx_t_5))
              __PYX_ERR(0, 249, __pyx_L7_error)
            __Pyx_GOTREF(__pyx_t_5);
            __Pyx_DECREF(__pyx_t_1);
            __pyx_t_1 = 0;
            __Pyx_DECREF(__pyx_t_5);
            __pyx_t_5 = 0;

            /* "pyg4ometry/pycsg/core.pyx":248
             *
             *             f.write('POINTS {0} float\n'.format(len(verts)))
             *             for v in verts:             # <<<<<<<<<<<<<<
             *                 f.write('{0} {1} {2}\n'.format(v[0], v[1], v[2]))
             *             numCells = len(cells)
             */
          }
          __Pyx_DECREF(__pyx_t_4);
          __pyx_t_4 = 0;

          /* "pyg4ometry/pycsg/core.pyx":250
           *             for v in verts:
           *                 f.write('{0} {1} {2}\n'.format(v[0], v[1], v[2]))
           *             numCells = len(cells)             # <<<<<<<<<<<<<<
           *             f.write('POLYGONS {0} {1}\n'.format(numCells, count +
           * numCells)) for cell in cells:
           */
          __pyx_t_11 = PyObject_Length(__pyx_v_cells);
          if (unlikely(__pyx_t_11 == ((Py_ssize_t)-1)))
            __PYX_ERR(0, 250, __pyx_L7_error)
          __pyx_t_4 = PyInt_FromSsize_t(__pyx_t_11);
          if (unlikely(!__pyx_t_4))
            __PYX_ERR(0, 250, __pyx_L7_error)
          __Pyx_GOTREF(__pyx_t_4);
          __pyx_v_numCells = __pyx_t_4;
          __pyx_t_4 = 0;

          /* "pyg4ometry/pycsg/core.pyx":251
           *                 f.write('{0} {1} {2}\n'.format(v[0], v[1], v[2]))
           *             numCells = len(cells)
           *             f.write('POLYGONS {0} {1}\n'.format(numCells, count +
           * numCells))             # <<<<<<<<<<<<<< for cell in cells:
           * f.write('{0}
           * '.format(len(cell)))
           */
          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_write);
          if (unlikely(!__pyx_t_5))
            __PYX_ERR(0, 251, __pyx_L7_error)
          __Pyx_GOTREF(__pyx_t_5);
          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_POLYGONS_0_1,
                                                __pyx_n_s_format);
          if (unlikely(!__pyx_t_2))
            __PYX_ERR(0, 251, __pyx_L7_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_9 = PyNumber_Add(__pyx_v_count, __pyx_v_numCells);
          if (unlikely(!__pyx_t_9))
            __PYX_ERR(0, 251, __pyx_L7_error)
          __Pyx_GOTREF(__pyx_t_9);
          __pyx_t_18 = NULL;
          __pyx_t_17 = 0;
          if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
            __pyx_t_18 = PyMethod_GET_SELF(__pyx_t_2);
            if (likely(__pyx_t_18)) {
              PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
              __Pyx_INCREF(__pyx_t_18);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_2, function);
              __pyx_t_17 = 1;
            }
          }
#if CYTHON_FAST_PYCALL
          if (PyFunction_Check(__pyx_t_2)) {
            PyObject *__pyx_temp[3] = {__pyx_t_18, __pyx_v_numCells, __pyx_t_9};
            __pyx_t_1 = __Pyx_PyFunction_FastCall(
                __pyx_t_2, __pyx_temp + 1 - __pyx_t_17, 2 + __pyx_t_17);
            if (unlikely(!__pyx_t_1))
              __PYX_ERR(0, 251, __pyx_L7_error)
            __Pyx_XDECREF(__pyx_t_18);
            __pyx_t_18 = 0;
            __Pyx_GOTREF(__pyx_t_1);
            __Pyx_DECREF(__pyx_t_9);
            __pyx_t_9 = 0;
          } else
#endif
#if CYTHON_FAST_PYCCALL
              if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
            PyObject *__pyx_temp[3] = {__pyx_t_18, __pyx_v_numCells, __pyx_t_9};
            __pyx_t_1 = __Pyx_PyCFunction_FastCall(
                __pyx_t_2, __pyx_temp + 1 - __pyx_t_17, 2 + __pyx_t_17);
            if (unlikely(!__pyx_t_1))
              __PYX_ERR(0, 251, __pyx_L7_error)
            __Pyx_XDECREF(__pyx_t_18);
            __pyx_t_18 = 0;
            __Pyx_GOTREF(__pyx_t_1);
            __Pyx_DECREF(__pyx_t_9);
            __pyx_t_9 = 0;
          } else
#endif
          {
            __pyx_t_15 = PyTuple_New(2 + __pyx_t_17);
            if (unlikely(!__pyx_t_15))
              __PYX_ERR(0, 251, __pyx_L7_error)
            __Pyx_GOTREF(__pyx_t_15);
            if (__pyx_t_18) {
              __Pyx_GIVEREF(__pyx_t_18);
              PyTuple_SET_ITEM(__pyx_t_15, 0, __pyx_t_18);
              __pyx_t_18 = NULL;
            }
            __Pyx_INCREF(__pyx_v_numCells);
            __Pyx_GIVEREF(__pyx_v_numCells);
            PyTuple_SET_ITEM(__pyx_t_15, 0 + __pyx_t_17, __pyx_v_numCells);
            __Pyx_GIVEREF(__pyx_t_9);
            PyTuple_SET_ITEM(__pyx_t_15, 1 + __pyx_t_17, __pyx_t_9);
            __pyx_t_9 = 0;
            __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_15, NULL);
            if (unlikely(!__pyx_t_1))
              __PYX_ERR(0, 251, __pyx_L7_error)
            __Pyx_GOTREF(__pyx_t_1);
            __Pyx_DECREF(__pyx_t_15);
            __pyx_t_15 = 0;
          }
          __Pyx_DECREF(__pyx_t_2);
          __pyx_t_2 = 0;
          __pyx_t_2 = NULL;
          if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
            __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
            if (likely(__pyx_t_2)) {
              PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_5);
              __Pyx_INCREF(__pyx_t_2);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_5, function);
            }
          }
          __pyx_t_4 =
              (__pyx_t_2)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_2, __pyx_t_1)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_1);
          __Pyx_XDECREF(__pyx_t_2);
          __pyx_t_2 = 0;
          __Pyx_DECREF(__pyx_t_1);
          __pyx_t_1 = 0;
          if (unlikely(!__pyx_t_4))
            __PYX_ERR(0, 251, __pyx_L7_error)
          __Pyx_GOTREF(__pyx_t_4);
          __Pyx_DECREF(__pyx_t_5);
          __pyx_t_5 = 0;
          __Pyx_DECREF(__pyx_t_4);
          __pyx_t_4 = 0;

          /* "pyg4ometry/pycsg/core.pyx":252
           *             numCells = len(cells)
           *             f.write('POLYGONS {0} {1}\n'.format(numCells, count +
           * numCells)) for cell in cells:             # <<<<<<<<<<<<<<
           * f.write('{0}
           * '.format(len(cell))) for index in cell:
           */
          if (likely(PyList_CheckExact(__pyx_v_cells)) ||
              PyTuple_CheckExact(__pyx_v_cells)) {
            __pyx_t_4 = __pyx_v_cells;
            __Pyx_INCREF(__pyx_t_4);
            __pyx_t_11 = 0;
            __pyx_t_13 = NULL;
          } else {
            __pyx_t_11 = -1;
            __pyx_t_4 = PyObject_GetIter(__pyx_v_cells);
            if (unlikely(!__pyx_t_4))
              __PYX_ERR(0, 252, __pyx_L7_error)
            __Pyx_GOTREF(__pyx_t_4);
            __pyx_t_13 = Py_TYPE(__pyx_t_4)->tp_iternext;
            if (unlikely(!__pyx_t_13))
              __PYX_ERR(0, 252, __pyx_L7_error)
          }
          for (;;) {
            if (likely(!__pyx_t_13)) {
              if (likely(PyList_CheckExact(__pyx_t_4))) {
                if (__pyx_t_11 >= PyList_GET_SIZE(__pyx_t_4))
                  break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
                __pyx_t_5 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_11);
                __Pyx_INCREF(__pyx_t_5);
                __pyx_t_11++;
                if (unlikely(0 < 0))
                  __PYX_ERR(0, 252, __pyx_L7_error)
#else
                __pyx_t_5 = PySequence_ITEM(__pyx_t_4, __pyx_t_11);
                __pyx_t_11++;
                if (unlikely(!__pyx_t_5))
                  __PYX_ERR(0, 252, __pyx_L7_error)
                __Pyx_GOTREF(__pyx_t_5);
#endif
              } else {
                if (__pyx_t_11 >= PyTuple_GET_SIZE(__pyx_t_4))
                  break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
                __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_11);
                __Pyx_INCREF(__pyx_t_5);
                __pyx_t_11++;
                if (unlikely(0 < 0))
                  __PYX_ERR(0, 252, __pyx_L7_error)
#else
                __pyx_t_5 = PySequence_ITEM(__pyx_t_4, __pyx_t_11);
                __pyx_t_11++;
                if (unlikely(!__pyx_t_5))
                  __PYX_ERR(0, 252, __pyx_L7_error)
                __Pyx_GOTREF(__pyx_t_5);
#endif
              }
            } else {
              __pyx_t_5 = __pyx_t_13(__pyx_t_4);
              if (unlikely(!__pyx_t_5)) {
                PyObject *exc_type = PyErr_Occurred();
                if (exc_type) {
                  if (likely(__Pyx_PyErr_GivenExceptionMatches(
                          exc_type, PyExc_StopIteration)))
                    PyErr_Clear();
                  else
                    __PYX_ERR(0, 252, __pyx_L7_error)
                }
                break;
              }
              __Pyx_GOTREF(__pyx_t_5);
            }
            __Pyx_XDECREF_SET(__pyx_v_cell, __pyx_t_5);
            __pyx_t_5 = 0;

            /* "pyg4ometry/pycsg/core.pyx":253
             *             f.write('POLYGONS {0} {1}\n'.format(numCells, count +
             * numCells)) for cell in cells: f.write('{0} '.format(len(cell))) #
             * <<<<<<<<<<<<<< for index in cell: f.write('{0} '.format(index))
             */
            __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_write);
            if (unlikely(!__pyx_t_1))
              __PYX_ERR(0, 253, __pyx_L7_error)
            __Pyx_GOTREF(__pyx_t_1);
            __pyx_t_15 =
                __Pyx_PyObject_GetAttrStr(__pyx_kp_u_0, __pyx_n_s_format);
            if (unlikely(!__pyx_t_15))
              __PYX_ERR(0, 253, __pyx_L7_error)
            __Pyx_GOTREF(__pyx_t_15);
            __pyx_t_19 = PyObject_Length(__pyx_v_cell);
            if (unlikely(__pyx_t_19 == ((Py_ssize_t)-1)))
              __PYX_ERR(0, 253, __pyx_L7_error)
            __pyx_t_9 = PyInt_FromSsize_t(__pyx_t_19);
            if (unlikely(!__pyx_t_9))
              __PYX_ERR(0, 253, __pyx_L7_error)
            __Pyx_GOTREF(__pyx_t_9);
            __pyx_t_18 = NULL;
            if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_15))) {
              __pyx_t_18 = PyMethod_GET_SELF(__pyx_t_15);
              if (likely(__pyx_t_18)) {
                PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_15);
                __Pyx_INCREF(__pyx_t_18);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_15, function);
              }
            }
            __pyx_t_2 = (__pyx_t_18)
                            ? __Pyx_PyObject_Call2Args(__pyx_t_15, __pyx_t_18,
                                                       __pyx_t_9)
                            : __Pyx_PyObject_CallOneArg(__pyx_t_15, __pyx_t_9);
            __Pyx_XDECREF(__pyx_t_18);
            __pyx_t_18 = 0;
            __Pyx_DECREF(__pyx_t_9);
            __pyx_t_9 = 0;
            if (unlikely(!__pyx_t_2))
              __PYX_ERR(0, 253, __pyx_L7_error)
            __Pyx_GOTREF(__pyx_t_2);
            __Pyx_DECREF(__pyx_t_15);
            __pyx_t_15 = 0;
            __pyx_t_15 = NULL;
            if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
              __pyx_t_15 = PyMethod_GET_SELF(__pyx_t_1);
              if (likely(__pyx_t_15)) {
                PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_1);
                __Pyx_INCREF(__pyx_t_15);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_1, function);
              }
            }
            __pyx_t_5 =
                (__pyx_t_15)
                    ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_15, __pyx_t_2)
                    : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_2);
            __Pyx_XDECREF(__pyx_t_15);
            __pyx_t_15 = 0;
            __Pyx_DECREF(__pyx_t_2);
            __pyx_t_2 = 0;
            if (unlikely(!__pyx_t_5))
              __PYX_ERR(0, 253, __pyx_L7_error)
            __Pyx_GOTREF(__pyx_t_5);
            __Pyx_DECREF(__pyx_t_1);
            __pyx_t_1 = 0;
            __Pyx_DECREF(__pyx_t_5);
            __pyx_t_5 = 0;

            /* "pyg4ometry/pycsg/core.pyx":254
             *             for cell in cells:
             *                 f.write('{0} '.format(len(cell)))
             *                 for index in cell:             # <<<<<<<<<<<<<<
             *                     f.write('{0} '.format(index))
             *                 f.write('\n')
             */
            if (likely(PyList_CheckExact(__pyx_v_cell)) ||
                PyTuple_CheckExact(__pyx_v_cell)) {
              __pyx_t_5 = __pyx_v_cell;
              __Pyx_INCREF(__pyx_t_5);
              __pyx_t_19 = 0;
              __pyx_t_20 = NULL;
            } else {
              __pyx_t_19 = -1;
              __pyx_t_5 = PyObject_GetIter(__pyx_v_cell);
              if (unlikely(!__pyx_t_5))
                __PYX_ERR(0, 254, __pyx_L7_error)
              __Pyx_GOTREF(__pyx_t_5);
              __pyx_t_20 = Py_TYPE(__pyx_t_5)->tp_iternext;
              if (unlikely(!__pyx_t_20))
                __PYX_ERR(0, 254, __pyx_L7_error)
            }
            for (;;) {
              if (likely(!__pyx_t_20)) {
                if (likely(PyList_CheckExact(__pyx_t_5))) {
                  if (__pyx_t_19 >= PyList_GET_SIZE(__pyx_t_5))
                    break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
                  __pyx_t_1 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_19);
                  __Pyx_INCREF(__pyx_t_1);
                  __pyx_t_19++;
                  if (unlikely(0 < 0))
                    __PYX_ERR(0, 254, __pyx_L7_error)
#else
                  __pyx_t_1 = PySequence_ITEM(__pyx_t_5, __pyx_t_19);
                  __pyx_t_19++;
                  if (unlikely(!__pyx_t_1))
                    __PYX_ERR(0, 254, __pyx_L7_error)
                  __Pyx_GOTREF(__pyx_t_1);
#endif
                } else {
                  if (__pyx_t_19 >= PyTuple_GET_SIZE(__pyx_t_5))
                    break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
                  __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_19);
                  __Pyx_INCREF(__pyx_t_1);
                  __pyx_t_19++;
                  if (unlikely(0 < 0))
                    __PYX_ERR(0, 254, __pyx_L7_error)
#else
                  __pyx_t_1 = PySequence_ITEM(__pyx_t_5, __pyx_t_19);
                  __pyx_t_19++;
                  if (unlikely(!__pyx_t_1))
                    __PYX_ERR(0, 254, __pyx_L7_error)
                  __Pyx_GOTREF(__pyx_t_1);
#endif
                }
              } else {
                __pyx_t_1 = __pyx_t_20(__pyx_t_5);
                if (unlikely(!__pyx_t_1)) {
                  PyObject *exc_type = PyErr_Occurred();
                  if (exc_type) {
                    if (likely(__Pyx_PyErr_GivenExceptionMatches(
                            exc_type, PyExc_StopIteration)))
                      PyErr_Clear();
                    else
                      __PYX_ERR(0, 254, __pyx_L7_error)
                  }
                  break;
                }
                __Pyx_GOTREF(__pyx_t_1);
              }
              __Pyx_XDECREF_SET(__pyx_v_index, __pyx_t_1);
              __pyx_t_1 = 0;

              /* "pyg4ometry/pycsg/core.pyx":255
               *                 f.write('{0} '.format(len(cell)))
               *                 for index in cell:
               *                     f.write('{0} '.format(index))             #
               * <<<<<<<<<<<<<< f.write('\n')
               *
               */
              __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_write);
              if (unlikely(!__pyx_t_2))
                __PYX_ERR(0, 255, __pyx_L7_error)
              __Pyx_GOTREF(__pyx_t_2);
              __pyx_t_9 =
                  __Pyx_PyObject_GetAttrStr(__pyx_kp_u_0, __pyx_n_s_format);
              if (unlikely(!__pyx_t_9))
                __PYX_ERR(0, 255, __pyx_L7_error)
              __Pyx_GOTREF(__pyx_t_9);
              __pyx_t_18 = NULL;
              if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_9))) {
                __pyx_t_18 = PyMethod_GET_SELF(__pyx_t_9);
                if (likely(__pyx_t_18)) {
                  PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_9);
                  __Pyx_INCREF(__pyx_t_18);
                  __Pyx_INCREF(function);
                  __Pyx_DECREF_SET(__pyx_t_9, function);
                }
              }
              __pyx_t_15 =
                  (__pyx_t_18)
                      ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_18,
                                                 __pyx_v_index)
                      : __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_v_index);
              __Pyx_XDECREF(__pyx_t_18);
              __pyx_t_18 = 0;
              if (unlikely(!__pyx_t_15))
                __PYX_ERR(0, 255, __pyx_L7_error)
              __Pyx_GOTREF(__pyx_t_15);
              __Pyx_DECREF(__pyx_t_9);
              __pyx_t_9 = 0;
              __pyx_t_9 = NULL;
              if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
                __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_2);
                if (likely(__pyx_t_9)) {
                  PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
                  __Pyx_INCREF(__pyx_t_9);
                  __Pyx_INCREF(function);
                  __Pyx_DECREF_SET(__pyx_t_2, function);
                }
              }
              __pyx_t_1 =
                  (__pyx_t_9)
                      ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_9,
                                                 __pyx_t_15)
                      : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_15);
              __Pyx_XDECREF(__pyx_t_9);
              __pyx_t_9 = 0;
              __Pyx_DECREF(__pyx_t_15);
              __pyx_t_15 = 0;
              if (unlikely(!__pyx_t_1))
                __PYX_ERR(0, 255, __pyx_L7_error)
              __Pyx_GOTREF(__pyx_t_1);
              __Pyx_DECREF(__pyx_t_2);
              __pyx_t_2 = 0;
              __Pyx_DECREF(__pyx_t_1);
              __pyx_t_1 = 0;

              /* "pyg4ometry/pycsg/core.pyx":254
               *             for cell in cells:
               *                 f.write('{0} '.format(len(cell)))
               *                 for index in cell:             # <<<<<<<<<<<<<<
               *                     f.write('{0} '.format(index))
               *                 f.write('\n')
               */
            }
            __Pyx_DECREF(__pyx_t_5);
            __pyx_t_5 = 0;

            /* "pyg4ometry/pycsg/core.pyx":256
             *                 for index in cell:
             *                     f.write('{0} '.format(index))
             *                 f.write('\n')             # <<<<<<<<<<<<<<
             *
             *     def union(self, csg):
             */
            __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_write);
            if (unlikely(!__pyx_t_1))
              __PYX_ERR(0, 256, __pyx_L7_error)
            __Pyx_GOTREF(__pyx_t_1);
            __pyx_t_2 = NULL;
            if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
              __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
              if (likely(__pyx_t_2)) {
                PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_1);
                __Pyx_INCREF(__pyx_t_2);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_1, function);
              }
            }
            __pyx_t_5 =
                (__pyx_t_2)
                    ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_2,
                                               __pyx_kp_u__4)
                    : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_kp_u__4);
            __Pyx_XDECREF(__pyx_t_2);
            __pyx_t_2 = 0;
            if (unlikely(!__pyx_t_5))
              __PYX_ERR(0, 256, __pyx_L7_error)
            __Pyx_GOTREF(__pyx_t_5);
            __Pyx_DECREF(__pyx_t_1);
            __pyx_t_1 = 0;
            __Pyx_DECREF(__pyx_t_5);
            __pyx_t_5 = 0;

            /* "pyg4ometry/pycsg/core.pyx":252
             *             numCells = len(cells)
             *             f.write('POLYGONS {0} {1}\n'.format(numCells, count +
             * numCells)) for cell in cells:             # <<<<<<<<<<<<<<
             *                 f.write('{0} '.format(len(cell)))
             *                 for index in cell:
             */
          }
          __Pyx_DECREF(__pyx_t_4);
          __pyx_t_4 = 0;

          /* "pyg4ometry/pycsg/core.pyx":239
           *         Save polygons in VTK file.
           *         """
           *         with open(filename, 'w') as f:             # <<<<<<<<<<<<<<
           *             f.write('# vtk DataFile Version 3.0\n')
           *             f.write('pycsg output\n')
           */
        }
        __Pyx_XDECREF(__pyx_t_6);
        __pyx_t_6 = 0;
        __Pyx_XDECREF(__pyx_t_7);
        __pyx_t_7 = 0;
        __Pyx_XDECREF(__pyx_t_8);
        __pyx_t_8 = 0;
        goto __pyx_L12_try_end;
      __pyx_L7_error:;
        __Pyx_XDECREF(__pyx_t_1);
        __pyx_t_1 = 0;
        __Pyx_XDECREF(__pyx_t_12);
        __pyx_t_12 = 0;
        __Pyx_XDECREF(__pyx_t_14);
        __pyx_t_14 = 0;
        __Pyx_XDECREF(__pyx_t_15);
        __pyx_t_15 = 0;
        __Pyx_XDECREF(__pyx_t_16);
        __pyx_t_16 = 0;
        __Pyx_XDECREF(__pyx_t_18);
        __pyx_t_18 = 0;
        __Pyx_XDECREF(__pyx_t_2);
        __pyx_t_2 = 0;
        __Pyx_XDECREF(__pyx_t_4);
        __pyx_t_4 = 0;
        __Pyx_XDECREF(__pyx_t_5);
        __pyx_t_5 = 0;
        __Pyx_XDECREF(__pyx_t_9);
        __pyx_t_9 = 0;
        /*except:*/ {
          __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.saveVTK", __pyx_clineno,
                             __pyx_lineno, __pyx_filename);
          if (__Pyx_GetException(&__pyx_t_4, &__pyx_t_5, &__pyx_t_1) < 0)
            __PYX_ERR(0, 239, __pyx_L9_except_error)
          __Pyx_GOTREF(__pyx_t_4);
          __Pyx_GOTREF(__pyx_t_5);
          __Pyx_GOTREF(__pyx_t_1);
          __pyx_t_2 = PyTuple_Pack(3, __pyx_t_4, __pyx_t_5, __pyx_t_1);
          if (unlikely(!__pyx_t_2))
            __PYX_ERR(0, 239, __pyx_L9_except_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_21 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_2, NULL);
          __Pyx_DECREF(__pyx_t_3);
          __pyx_t_3 = 0;
          __Pyx_DECREF(__pyx_t_2);
          __pyx_t_2 = 0;
          if (unlikely(!__pyx_t_21))
            __PYX_ERR(0, 239, __pyx_L9_except_error)
          __Pyx_GOTREF(__pyx_t_21);
          __pyx_t_22 = __Pyx_PyObject_IsTrue(__pyx_t_21);
          __Pyx_DECREF(__pyx_t_21);
          __pyx_t_21 = 0;
          if (__pyx_t_22 < 0)
            __PYX_ERR(0, 239, __pyx_L9_except_error)
          __pyx_t_23 = ((!(__pyx_t_22 != 0)) != 0);
          if (__pyx_t_23) {
            __Pyx_GIVEREF(__pyx_t_4);
            __Pyx_GIVEREF(__pyx_t_5);
            __Pyx_XGIVEREF(__pyx_t_1);
            __Pyx_ErrRestoreWithState(__pyx_t_4, __pyx_t_5, __pyx_t_1);
            __pyx_t_4 = 0;
            __pyx_t_5 = 0;
            __pyx_t_1 = 0;
            __PYX_ERR(0, 239, __pyx_L9_except_error)
          }
          __Pyx_XDECREF(__pyx_t_4);
          __pyx_t_4 = 0;
          __Pyx_XDECREF(__pyx_t_5);
          __pyx_t_5 = 0;
          __Pyx_XDECREF(__pyx_t_1);
          __pyx_t_1 = 0;
          goto __pyx_L8_exception_handled;
        }
      __pyx_L9_except_error:;
        __Pyx_XGIVEREF(__pyx_t_6);
        __Pyx_XGIVEREF(__pyx_t_7);
        __Pyx_XGIVEREF(__pyx_t_8);
        __Pyx_ExceptionReset(__pyx_t_6, __pyx_t_7, __pyx_t_8);
        goto __pyx_L1_error;
      __pyx_L8_exception_handled:;
        __Pyx_XGIVEREF(__pyx_t_6);
        __Pyx_XGIVEREF(__pyx_t_7);
        __Pyx_XGIVEREF(__pyx_t_8);
        __Pyx_ExceptionReset(__pyx_t_6, __pyx_t_7, __pyx_t_8);
      __pyx_L12_try_end:;
      }
    }
    /*finally:*/ {
      /*normal exit:*/ {
        if (__pyx_t_3) {
          __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__5, NULL);
          __Pyx_DECREF(__pyx_t_3);
          __pyx_t_3 = 0;
          if (unlikely(!__pyx_t_8))
            __PYX_ERR(0, 239, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          __Pyx_DECREF(__pyx_t_8);
          __pyx_t_8 = 0;
        }
        goto __pyx_L6;
      }
    __pyx_L6:;
    }
    goto __pyx_L24;
  __pyx_L3_error:;
    __Pyx_DECREF(__pyx_t_3);
    __pyx_t_3 = 0;
    goto __pyx_L1_error;
  __pyx_L24:;
  }

  /* "pyg4ometry/pycsg/core.pyx":235
   *         return verts, polys, count
   *
   *     def saveVTK(self, filename):             # <<<<<<<<<<<<<<
   *         """
   *         Save polygons in VTK file.
   */

  /* function exit code */
  __pyx_r = Py_None;
  __Pyx_INCREF(Py_None);
  goto __pyx_L0;
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_XDECREF(__pyx_t_14);
  __Pyx_XDECREF(__pyx_t_15);
  __Pyx_XDECREF(__pyx_t_16);
  __Pyx_XDECREF(__pyx_t_18);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.saveVTK", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XDECREF(__pyx_v_f);
  __Pyx_XDECREF(__pyx_v_verts);
  __Pyx_XDECREF(__pyx_v_cells);
  __Pyx_XDECREF(__pyx_v_count);
  __Pyx_XDECREF(__pyx_v_v);
  __Pyx_XDECREF(__pyx_v_numCells);
  __Pyx_XDECREF(__pyx_v_cell);
  __Pyx_XDECREF(__pyx_v_index);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":258
 *                 f.write('\n')
 *
 *     def union(self, csg):             # <<<<<<<<<<<<<<
 *         """
 *         Return a new CSG solid representing space in either this solid or in
 * the
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_29union(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_28union[] =
    "\n        Return a new CSG solid representing space in either this solid "
    "or in the\n        solid `csg`. Neither this solid nor the solid `csg` "
    "are modified.::\n        \n            A.union(B)\n        \n            "
    "+-------+            +-------+\n            |       |            |       "
    "|\n            |   A   |            |       |\n            |    +--+----+ "
    "  =   |       +----+\n            +----+--+    |       +----+       |\n   "
    "              |   B   |            |       |\n                 |       |  "
    "          |       |\n                 +-------+            +-------+\n    "
    "    ";
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_29union = {
    "union",
    (PyCFunction)(void *)(PyCFunctionWithKeywords)
        __pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_29union,
    METH_VARARGS | METH_KEYWORDS,
    __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_28union};
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_29union(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_self = 0;
  PyObject *__pyx_v_csg = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext("union (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self, &__pyx_n_s_csg, 0};
    PyObject *values[2] = {0, 0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
      case 2:
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
      case 1:
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
      case 0:
        break;
      default:
        goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
      case 0:
        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_self)) != 0))
          kw_args--;
        else
          goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
      case 1:
        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_csg)) != 0))
          kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("union", 1, 2, 2, 1);
          __PYX_ERR(0, 258, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames,
                                                 0, values, pos_args,
                                                 "union") < 0))
          __PYX_ERR(0, 258, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_self = values[0];
    __pyx_v_csg = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
__pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("union", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args));
  __PYX_ERR(0, 258, __pyx_L3_error)
__pyx_L3_error:;
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.union", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
__pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_28union(
      __pyx_self, __pyx_v_self, __pyx_v_csg);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_28union(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self,
    PyObject *__pyx_v_csg) {
  PyObject *__pyx_v_a = NULL;
  PyObject *__pyx_v_b = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("union", 0);

  /* "pyg4ometry/pycsg/core.pyx":274
   *                  +-------+            +-------+
   *         """
   *         a = BSPNode(self.clone().polygons)             # <<<<<<<<<<<<<<
   *         b = BSPNode(csg.clone().polygons)
   *         a.clipTo(b)
   */
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_BSPNode);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 274, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_clone);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 274, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 274, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_polygons);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 274, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_4)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 274, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_a = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":275
   *         """
   *         a = BSPNode(self.clone().polygons)
   *         b = BSPNode(csg.clone().polygons)             # <<<<<<<<<<<<<<
   *         a.clipTo(b)
   *         b.clipTo(a)
   */
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_BSPNode);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 275, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_csg, __pyx_n_s_clone);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 275, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_5)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 275, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_polygons);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 275, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_4)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 275, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_b = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":276
   *         a = BSPNode(self.clone().polygons)
   *         b = BSPNode(csg.clone().polygons)
   *         a.clipTo(b)             # <<<<<<<<<<<<<<
   *         b.clipTo(a)
   *         b.invert()
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_a, __pyx_n_s_clipTo);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 276, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_b)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_b);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 276, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":277
   *         b = BSPNode(csg.clone().polygons)
   *         a.clipTo(b)
   *         b.clipTo(a)             # <<<<<<<<<<<<<<
   *         b.invert()
   *         b.clipTo(a)
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_b, __pyx_n_s_clipTo);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 277, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_a)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_a);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 277, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":278
   *         a.clipTo(b)
   *         b.clipTo(a)
   *         b.invert()             # <<<<<<<<<<<<<<
   *         b.clipTo(a)
   *         b.invert()
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_b, __pyx_n_s_invert);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 278, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 278, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":279
   *         b.clipTo(a)
   *         b.invert()
   *         b.clipTo(a)             # <<<<<<<<<<<<<<
   *         b.invert()
   *         a.build(b.allPolygons());
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_b, __pyx_n_s_clipTo);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 279, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_a)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_a);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 279, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":280
   *         b.invert()
   *         b.clipTo(a)
   *         b.invert()             # <<<<<<<<<<<<<<
   *         a.build(b.allPolygons());
   *         return CSG.fromPolygons(a.allPolygons())
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_b, __pyx_n_s_invert);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 280, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 280, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":281
   *         b.clipTo(a)
   *         b.invert()
   *         a.build(b.allPolygons());             # <<<<<<<<<<<<<<
   *         return CSG.fromPolygons(a.allPolygons())
   *
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_a, __pyx_n_s_build);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 281, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_b, __pyx_n_s_allPolygons);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 281, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 281, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_4)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 281, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":282
   *         b.invert()
   *         a.build(b.allPolygons());
   *         return CSG.fromPolygons(a.allPolygons())             #
   * <<<<<<<<<<<<<<
   *
   *     def __add__(self, csg):
   */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_CSG);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 282, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_fromPolygons);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 282, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_a, __pyx_n_s_allPolygons);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 282, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 282, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_4)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
  __Pyx_XDECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 282, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":258
 *                 f.write('\n')
 *
 *     def union(self, csg):             # <<<<<<<<<<<<<<
 *         """
 *         Return a new CSG solid representing space in either this solid or in
 * the
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.union", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XDECREF(__pyx_v_a);
  __Pyx_XDECREF(__pyx_v_b);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":284
 *         return CSG.fromPolygons(a.allPolygons())
 *
 *     def __add__(self, csg):             # <<<<<<<<<<<<<<
 *         return self.union(csg)
 *
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_31__add__(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_31__add__ = {
    "__add__",
    (PyCFunction)(void *)(PyCFunctionWithKeywords)
        __pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_31__add__,
    METH_VARARGS | METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_31__add__(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_self = 0;
  PyObject *__pyx_v_csg = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext("__add__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self, &__pyx_n_s_csg, 0};
    PyObject *values[2] = {0, 0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
      case 2:
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
      case 1:
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
      case 0:
        break;
      default:
        goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
      case 0:
        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_self)) != 0))
          kw_args--;
        else
          goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
      case 1:
        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_csg)) != 0))
          kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("__add__", 1, 2, 2, 1);
          __PYX_ERR(0, 284, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames,
                                                 0, values, pos_args,
                                                 "__add__") < 0))
          __PYX_ERR(0, 284, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_self = values[0];
    __pyx_v_csg = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
__pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__add__", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args));
  __PYX_ERR(0, 284, __pyx_L3_error)
__pyx_L3_error:;
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.__add__", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
__pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_30__add__(
      __pyx_self, __pyx_v_self, __pyx_v_csg);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_30__add__(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self,
    PyObject *__pyx_v_csg) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__add__", 0);

  /* "pyg4ometry/pycsg/core.pyx":285
   *
   *     def __add__(self, csg):
   *         return self.union(csg)             # <<<<<<<<<<<<<<
   *
   *     def subtract(self, csg):
   */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_union);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 285, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_csg)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_csg);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 285, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":284
 *         return CSG.fromPolygons(a.allPolygons())
 *
 *     def __add__(self, csg):             # <<<<<<<<<<<<<<
 *         return self.union(csg)
 *
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.__add__", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":287
 *         return self.union(csg)
 *
 *     def subtract(self, csg):             # <<<<<<<<<<<<<<
 *         """
 *         Return a new CSG solid representing space in this solid but not in
 * the
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_33subtract(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_32subtract[] =
    "\n        Return a new CSG solid representing space in this solid but not "
    "in the\n        solid `csg`. Neither this solid nor the solid `csg` are "
    "modified.::\n        \n            A.subtract(B)\n        \n            "
    "+-------+            +-------+\n            |       |            |       "
    "|\n            |   A   |            |       |\n            |    +--+----+ "
    "  =   |    +--+\n            +----+--+    |       +----+\n                "
    " |   B   |\n                 |       |\n                 +-------+\n      "
    "  ";
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_33subtract = {
    "subtract",
    (PyCFunction)(void *)(PyCFunctionWithKeywords)
        __pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_33subtract,
    METH_VARARGS | METH_KEYWORDS,
    __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_32subtract};
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_33subtract(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_self = 0;
  PyObject *__pyx_v_csg = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext("subtract (wrapper)",
                                                        0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self, &__pyx_n_s_csg, 0};
    PyObject *values[2] = {0, 0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
      case 2:
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
      case 1:
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
      case 0:
        break;
      default:
        goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
      case 0:
        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_self)) != 0))
          kw_args--;
        else
          goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
      case 1:
        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_csg)) != 0))
          kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("subtract", 1, 2, 2, 1);
          __PYX_ERR(0, 287, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames,
                                                 0, values, pos_args,
                                                 "subtract") < 0))
          __PYX_ERR(0, 287, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_self = values[0];
    __pyx_v_csg = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
__pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("subtract", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args));
  __PYX_ERR(0, 287, __pyx_L3_error)
__pyx_L3_error:;
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.subtract", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
__pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_32subtract(
      __pyx_self, __pyx_v_self, __pyx_v_csg);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_32subtract(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self,
    PyObject *__pyx_v_csg) {
  PyObject *__pyx_v_a = NULL;
  PyObject *__pyx_v_b = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("subtract", 0);

  /* "pyg4ometry/pycsg/core.pyx":303
   *                  +-------+
   *         """
   *         a = BSPNode(self.clone().polygons)             # <<<<<<<<<<<<<<
   *         b = BSPNode(csg.clone().polygons)
   *         a.invert()
   */
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_BSPNode);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 303, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_clone);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 303, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 303, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_polygons);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 303, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_4)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 303, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_a = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":304
   *         """
   *         a = BSPNode(self.clone().polygons)
   *         b = BSPNode(csg.clone().polygons)             # <<<<<<<<<<<<<<
   *         a.invert()
   *         a.clipTo(b)
   */
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_BSPNode);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 304, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_csg, __pyx_n_s_clone);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 304, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_5)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 304, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_polygons);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 304, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_4)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 304, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_b = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":305
   *         a = BSPNode(self.clone().polygons)
   *         b = BSPNode(csg.clone().polygons)
   *         a.invert()             # <<<<<<<<<<<<<<
   *         a.clipTo(b)
   *         b.clipTo(a)
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_a, __pyx_n_s_invert);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 305, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 305, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":306
   *         b = BSPNode(csg.clone().polygons)
   *         a.invert()
   *         a.clipTo(b)             # <<<<<<<<<<<<<<
   *         b.clipTo(a)
   *         b.invert()
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_a, __pyx_n_s_clipTo);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 306, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_b)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_b);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 306, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":307
   *         a.invert()
   *         a.clipTo(b)
   *         b.clipTo(a)             # <<<<<<<<<<<<<<
   *         b.invert()
   *         b.clipTo(a)
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_b, __pyx_n_s_clipTo);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 307, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_a)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_a);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 307, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":308
   *         a.clipTo(b)
   *         b.clipTo(a)
   *         b.invert()             # <<<<<<<<<<<<<<
   *         b.clipTo(a)
   *         b.invert()
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_b, __pyx_n_s_invert);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 308, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 308, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":309
   *         b.clipTo(a)
   *         b.invert()
   *         b.clipTo(a)             # <<<<<<<<<<<<<<
   *         b.invert()
   *         a.build(b.allPolygons())
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_b, __pyx_n_s_clipTo);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 309, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_a)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_a);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 309, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":310
   *         b.invert()
   *         b.clipTo(a)
   *         b.invert()             # <<<<<<<<<<<<<<
   *         a.build(b.allPolygons())
   *         a.invert()
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_b, __pyx_n_s_invert);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 310, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 310, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":311
   *         b.clipTo(a)
   *         b.invert()
   *         a.build(b.allPolygons())             # <<<<<<<<<<<<<<
   *         a.invert()
   *         return CSG.fromPolygons(a.allPolygons())
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_a, __pyx_n_s_build);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 311, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_b, __pyx_n_s_allPolygons);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 311, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 311, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_4)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 311, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":312
   *         b.invert()
   *         a.build(b.allPolygons())
   *         a.invert()             # <<<<<<<<<<<<<<
   *         return CSG.fromPolygons(a.allPolygons())
   *
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_a, __pyx_n_s_invert);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 312, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 312, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":313
   *         a.build(b.allPolygons())
   *         a.invert()
   *         return CSG.fromPolygons(a.allPolygons())             #
   * <<<<<<<<<<<<<<
   *
   *     def __sub__(self, csg):
   */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_CSG);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 313, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_fromPolygons);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 313, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_a, __pyx_n_s_allPolygons);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 313, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 313, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_4)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
  __Pyx_XDECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 313, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":287
 *         return self.union(csg)
 *
 *     def subtract(self, csg):             # <<<<<<<<<<<<<<
 *         """
 *         Return a new CSG solid representing space in this solid but not in
 * the
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.subtract", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XDECREF(__pyx_v_a);
  __Pyx_XDECREF(__pyx_v_b);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":315
 *         return CSG.fromPolygons(a.allPolygons())
 *
 *     def __sub__(self, csg):             # <<<<<<<<<<<<<<
 *         return self.subtract(csg)
 *
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_35__sub__(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_35__sub__ = {
    "__sub__",
    (PyCFunction)(void *)(PyCFunctionWithKeywords)
        __pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_35__sub__,
    METH_VARARGS | METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_35__sub__(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_self = 0;
  PyObject *__pyx_v_csg = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext("__sub__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self, &__pyx_n_s_csg, 0};
    PyObject *values[2] = {0, 0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
      case 2:
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
      case 1:
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
      case 0:
        break;
      default:
        goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
      case 0:
        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_self)) != 0))
          kw_args--;
        else
          goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
      case 1:
        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_csg)) != 0))
          kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("__sub__", 1, 2, 2, 1);
          __PYX_ERR(0, 315, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames,
                                                 0, values, pos_args,
                                                 "__sub__") < 0))
          __PYX_ERR(0, 315, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_self = values[0];
    __pyx_v_csg = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
__pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__sub__", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args));
  __PYX_ERR(0, 315, __pyx_L3_error)
__pyx_L3_error:;
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.__sub__", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
__pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_34__sub__(
      __pyx_self, __pyx_v_self, __pyx_v_csg);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_34__sub__(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self,
    PyObject *__pyx_v_csg) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__sub__", 0);

  /* "pyg4ometry/pycsg/core.pyx":316
   *
   *     def __sub__(self, csg):
   *         return self.subtract(csg)             # <<<<<<<<<<<<<<
   *
   *     def intersect(self, csg):
   */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_subtract);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 316, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_csg)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_csg);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 316, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":315
 *         return CSG.fromPolygons(a.allPolygons())
 *
 *     def __sub__(self, csg):             # <<<<<<<<<<<<<<
 *         return self.subtract(csg)
 *
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.__sub__", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":318
 *         return self.subtract(csg)
 *
 *     def intersect(self, csg):             # <<<<<<<<<<<<<<
 *         """
 *         Return a new CSG solid representing space both this solid and in the
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_37intersect(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_36intersect[] =
    "\n        Return a new CSG solid representing space both this solid and "
    "in the\n        solid `csg`. Neither this solid nor the solid `csg` are "
    "modified.::\n        \n            A.intersect(B)\n        \n            "
    "+-------+\n            |       |\n            |   A   |\n            |    "
    "+--+----+   =   +--+\n            +----+--+    |       +--+\n             "
    "    |   B   |\n                 |       |\n                 +-------+\n   "
    "     ";
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_37intersect = {
    "intersect",
    (PyCFunction)(void *)(PyCFunctionWithKeywords)
        __pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_37intersect,
    METH_VARARGS | METH_KEYWORDS,
    __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_36intersect};
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_37intersect(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_self = 0;
  PyObject *__pyx_v_csg = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext("intersect (wrapper)",
                                                        0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self, &__pyx_n_s_csg, 0};
    PyObject *values[2] = {0, 0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
      case 2:
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
      case 1:
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
      case 0:
        break;
      default:
        goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
      case 0:
        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_self)) != 0))
          kw_args--;
        else
          goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
      case 1:
        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_csg)) != 0))
          kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("intersect", 1, 2, 2, 1);
          __PYX_ERR(0, 318, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames,
                                                 0, values, pos_args,
                                                 "intersect") < 0))
          __PYX_ERR(0, 318, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_self = values[0];
    __pyx_v_csg = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
__pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("intersect", 1, 2, 2,
                             PyTuple_GET_SIZE(__pyx_args));
  __PYX_ERR(0, 318, __pyx_L3_error)
__pyx_L3_error:;
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.intersect", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
__pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_36intersect(
      __pyx_self, __pyx_v_self, __pyx_v_csg);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_36intersect(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self,
    PyObject *__pyx_v_csg) {
  PyObject *__pyx_v_a = NULL;
  PyObject *__pyx_v_b = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("intersect", 0);

  /* "pyg4ometry/pycsg/core.pyx":334
   *                  +-------+
   *         """
   *         a = BSPNode(self.clone().polygons)             # <<<<<<<<<<<<<<
   *         b = BSPNode(csg.clone().polygons)
   *         a.invert()
   */
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_BSPNode);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 334, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_clone);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 334, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 334, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_polygons);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 334, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_4)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 334, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_a = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":335
   *         """
   *         a = BSPNode(self.clone().polygons)
   *         b = BSPNode(csg.clone().polygons)             # <<<<<<<<<<<<<<
   *         a.invert()
   *         b.clipTo(a)
   */
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_BSPNode);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 335, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_csg, __pyx_n_s_clone);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 335, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_5)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 335, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_polygons);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 335, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_4)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 335, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_b = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":336
   *         a = BSPNode(self.clone().polygons)
   *         b = BSPNode(csg.clone().polygons)
   *         a.invert()             # <<<<<<<<<<<<<<
   *         b.clipTo(a)
   *         b.invert()
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_a, __pyx_n_s_invert);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 336, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 336, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":337
   *         b = BSPNode(csg.clone().polygons)
   *         a.invert()
   *         b.clipTo(a)             # <<<<<<<<<<<<<<
   *         b.invert()
   *         a.clipTo(b)
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_b, __pyx_n_s_clipTo);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 337, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_a)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_a);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 337, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":338
   *         a.invert()
   *         b.clipTo(a)
   *         b.invert()             # <<<<<<<<<<<<<<
   *         a.clipTo(b)
   *         b.clipTo(a)
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_b, __pyx_n_s_invert);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 338, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 338, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":339
   *         b.clipTo(a)
   *         b.invert()
   *         a.clipTo(b)             # <<<<<<<<<<<<<<
   *         b.clipTo(a)
   *         a.build(b.allPolygons())
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_a, __pyx_n_s_clipTo);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 339, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_b)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_b);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 339, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":340
   *         b.invert()
   *         a.clipTo(b)
   *         b.clipTo(a)             # <<<<<<<<<<<<<<
   *         a.build(b.allPolygons())
   *         a.invert()
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_b, __pyx_n_s_clipTo);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 340, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_a)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_a);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 340, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":341
   *         a.clipTo(b)
   *         b.clipTo(a)
   *         a.build(b.allPolygons())             # <<<<<<<<<<<<<<
   *         a.invert()
   *         return CSG.fromPolygons(a.allPolygons())
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_a, __pyx_n_s_build);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 341, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_b, __pyx_n_s_allPolygons);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 341, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 341, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_4)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 341, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":342
   *         b.clipTo(a)
   *         a.build(b.allPolygons())
   *         a.invert()             # <<<<<<<<<<<<<<
   *         return CSG.fromPolygons(a.allPolygons())
   *
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_a, __pyx_n_s_invert);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 342, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 342, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":343
   *         a.build(b.allPolygons())
   *         a.invert()
   *         return CSG.fromPolygons(a.allPolygons())             #
   * <<<<<<<<<<<<<<
   *
   *     def coplanarIntersection(self, csg):
   */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_CSG);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 343, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_fromPolygons);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 343, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_a, __pyx_n_s_allPolygons);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 343, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 343, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_4)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
  __Pyx_XDECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 343, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":318
 *         return self.subtract(csg)
 *
 *     def intersect(self, csg):             # <<<<<<<<<<<<<<
 *         """
 *         Return a new CSG solid representing space both this solid and in the
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.intersect", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XDECREF(__pyx_v_a);
  __Pyx_XDECREF(__pyx_v_b);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":345
 *         return CSG.fromPolygons(a.allPolygons())
 *
 *     def coplanarIntersection(self, csg):             # <<<<<<<<<<<<<<
 *         # print 'pycsg.core.coplanarIntersection>'
 *
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_39coplanarIntersection(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef
    __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_39coplanarIntersection = {
        "coplanarIntersection",
        (PyCFunction)(void *)(PyCFunctionWithKeywords)
            __pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_39coplanarIntersection,
        METH_VARARGS | METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_39coplanarIntersection(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_self = 0;
  PyObject *__pyx_v_csg = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext(
      "coplanarIntersection (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self, &__pyx_n_s_csg, 0};
    PyObject *values[2] = {0, 0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
      case 2:
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
      case 1:
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
      case 0:
        break;
      default:
        goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
      case 0:
        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_self)) != 0))
          kw_args--;
        else
          goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
      case 1:
        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_csg)) != 0))
          kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("coplanarIntersection", 1, 2, 2, 1);
          __PYX_ERR(0, 345, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames,
                                                 0, values, pos_args,
                                                 "coplanarIntersection") < 0))
          __PYX_ERR(0, 345, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_self = values[0];
    __pyx_v_csg = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
__pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("coplanarIntersection", 1, 2, 2,
                             PyTuple_GET_SIZE(__pyx_args));
  __PYX_ERR(0, 345, __pyx_L3_error)
__pyx_L3_error:;
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.coplanarIntersection",
                     __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
__pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_38coplanarIntersection(
      __pyx_self, __pyx_v_self, __pyx_v_csg);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":356
 *         polygons = []
 *
 *         def coplanarPolys(apoly,bpoly) :             # <<<<<<<<<<<<<<
 *             COPLANAR = 0  # all the vertices are within EPSILON distance from
 * plane FRONT = 1  # all the vertices are in front of the plane
 */

/* Python wrapper */
static PyObject *
__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_1coplanarPolys(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef
    __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_1coplanarPolys =
        {"coplanarPolys",
         (PyCFunction)(void *)(PyCFunctionWithKeywords)
             __pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_1coplanarPolys,
         METH_VARARGS | METH_KEYWORDS, 0};
static PyObject *
__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_1coplanarPolys(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_apoly = 0;
  PyObject *__pyx_v_bpoly = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext(
      "coplanarPolys (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_apoly, &__pyx_n_s_bpoly,
                                            0};
    PyObject *values[2] = {0, 0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
      case 2:
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
      case 1:
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
      case 0:
        break;
      default:
        goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
      case 0:
        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_apoly)) != 0))
          kw_args--;
        else
          goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
      case 1:
        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_bpoly)) != 0))
          kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("coplanarPolys", 1, 2, 2, 1);
          __PYX_ERR(0, 356, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames,
                                                 0, values, pos_args,
                                                 "coplanarPolys") < 0))
          __PYX_ERR(0, 356, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_apoly = values[0];
    __pyx_v_bpoly = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
__pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("coplanarPolys", 1, 2, 2,
                             PyTuple_GET_SIZE(__pyx_args));
  __PYX_ERR(0, 356, __pyx_L3_error)
__pyx_L3_error:;
  __Pyx_AddTraceback(
      "pyg4ometry.pycsg.core.CSG.coplanarIntersection.coplanarPolys",
      __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
__pyx_L4_argument_unpacking_done:;
  __pyx_r =
      __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_coplanarPolys(
          __pyx_self, __pyx_v_apoly, __pyx_v_bpoly);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *
__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_coplanarPolys(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_apoly,
    PyObject *__pyx_v_bpoly) {
  CYTHON_UNUSED long __pyx_v_COPLANAR;
  CYTHON_UNUSED long __pyx_v_FRONT;
  CYTHON_UNUSED long __pyx_v_BACK;
  PyObject *__pyx_v_aplane = NULL;
  PyObject *__pyx_v_bplane = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("coplanarPolys", 0);

  /* "pyg4ometry/pycsg/core.pyx":357
   *
   *         def coplanarPolys(apoly,bpoly) :
   *             COPLANAR = 0  # all the vertices are within EPSILON distance
   * from plane             # <<<<<<<<<<<<<< FRONT = 1  # all the vertices are
   * in front of the plane BACK = 2  # all the vertices are at the back of the
   * plane
   */
  __pyx_v_COPLANAR = 0;

  /* "pyg4ometry/pycsg/core.pyx":358
   *         def coplanarPolys(apoly,bpoly) :
   *             COPLANAR = 0  # all the vertices are within EPSILON distance
   * from plane FRONT = 1  # all the vertices are in front of the plane #
   * <<<<<<<<<<<<<< BACK = 2  # all the vertices are at the back of the plane
   *
   */
  __pyx_v_FRONT = 1;

  /* "pyg4ometry/pycsg/core.pyx":359
   *             COPLANAR = 0  # all the vertices are within EPSILON distance
   * from plane FRONT = 1  # all the vertices are in front of the plane BACK = 2
   * # all the vertices are at the back of the plane             #
   * <<<<<<<<<<<<<<
   *
   *             aplane = apoly.plane
   */
  __pyx_v_BACK = 2;

  /* "pyg4ometry/pycsg/core.pyx":361
   *             BACK = 2  # all the vertices are at the back of the plane
   *
   *             aplane = apoly.plane             # <<<<<<<<<<<<<<
   *             bplane = bpoly.plane
   *
   */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_apoly, __pyx_n_s_plane);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 361, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_aplane = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":362
   *
   *             aplane = apoly.plane
   *             bplane = bpoly.plane             # <<<<<<<<<<<<<<
   *
   *             if abs(aplane.normal.dot(bplane.normal)-1) < 1e-5 and
   * abs(aplane.w-bplane.w) < 1e-7  :
   */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_bpoly, __pyx_n_s_plane);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 362, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_bplane = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":364
   *             bplane = bpoly.plane
   *
   *             if abs(aplane.normal.dot(bplane.normal)-1) < 1e-5 and
   * abs(aplane.w-bplane.w) < 1e-7  :             # <<<<<<<<<<<<<< return True
   *             elif abs(aplane.normal.dot(bplane.normal)+1) < 1e-5 and
   * abs(aplane.w+bplane.w) < 1e-7 :
   */
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_aplane, __pyx_n_s_normal);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 364, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_dot);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 364, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_bplane, __pyx_n_s_normal);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 364, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  __pyx_t_1 = (__pyx_t_5)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_t_3)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 364, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyInt_SubtractObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 364, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyNumber_Absolute(__pyx_t_4);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 364, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyObject_RichCompare(__pyx_t_1, __pyx_float_1eneg_5, Py_LT);
  __Pyx_XGOTREF(__pyx_t_4);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 364, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_4);
  if (unlikely(__pyx_t_6 < 0))
    __PYX_ERR(0, 364, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  if (__pyx_t_6) {
  } else {
    __pyx_t_2 = __pyx_t_6;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_aplane, __pyx_n_s_w);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 364, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_bplane, __pyx_n_s_w);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 364, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = PyNumber_Subtract(__pyx_t_4, __pyx_t_1);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 364, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyNumber_Absolute(__pyx_t_3);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 364, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyObject_RichCompare(__pyx_t_1, __pyx_float_1eneg_7, Py_LT);
  __Pyx_XGOTREF(__pyx_t_3);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 364, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3);
  if (unlikely(__pyx_t_6 < 0))
    __PYX_ERR(0, 364, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_2 = __pyx_t_6;
__pyx_L4_bool_binop_done:;
  if (__pyx_t_2) {

    /* "pyg4ometry/pycsg/core.pyx":365
     *
     *             if abs(aplane.normal.dot(bplane.normal)-1) < 1e-5 and
     * abs(aplane.w-bplane.w) < 1e-7  : return True             # <<<<<<<<<<<<<<
     *             elif abs(aplane.normal.dot(bplane.normal)+1) < 1e-5 and
     * abs(aplane.w+bplane.w) < 1e-7 : return True
     */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(Py_True);
    __pyx_r = Py_True;
    goto __pyx_L0;

    /* "pyg4ometry/pycsg/core.pyx":364
     *             bplane = bpoly.plane
     *
     *             if abs(aplane.normal.dot(bplane.normal)-1) < 1e-5 and
     * abs(aplane.w-bplane.w) < 1e-7  :             # <<<<<<<<<<<<<< return True
     *             elif abs(aplane.normal.dot(bplane.normal)+1) < 1e-5 and
     * abs(aplane.w+bplane.w) < 1e-7 :
     */
  }

  /* "pyg4ometry/pycsg/core.pyx":366
   *             if abs(aplane.normal.dot(bplane.normal)-1) < 1e-5 and
   * abs(aplane.w-bplane.w) < 1e-7  : return True elif
   * abs(aplane.normal.dot(bplane.normal)+1) < 1e-5 and abs(aplane.w+bplane.w) <
   * 1e-7 :             # <<<<<<<<<<<<<< return True else :
   */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_aplane, __pyx_n_s_normal);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 366, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_dot);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 366, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_bplane, __pyx_n_s_normal);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 366, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  __pyx_t_3 = (__pyx_t_5)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_t_1)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_1);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 366, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_t_3, __pyx_int_1, 1, 0, 0);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 366, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyNumber_Absolute(__pyx_t_4);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 366, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyObject_RichCompare(__pyx_t_3, __pyx_float_1eneg_5, Py_LT);
  __Pyx_XGOTREF(__pyx_t_4);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 366, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_4);
  if (unlikely(__pyx_t_6 < 0))
    __PYX_ERR(0, 366, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  if (__pyx_t_6) {
  } else {
    __pyx_t_2 = __pyx_t_6;
    goto __pyx_L6_bool_binop_done;
  }
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_aplane, __pyx_n_s_w);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 366, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_bplane, __pyx_n_s_w);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 366, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = PyNumber_Add(__pyx_t_4, __pyx_t_3);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 366, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyNumber_Absolute(__pyx_t_1);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 366, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_RichCompare(__pyx_t_3, __pyx_float_1eneg_7, Py_LT);
  __Pyx_XGOTREF(__pyx_t_1);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 366, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_1);
  if (unlikely(__pyx_t_6 < 0))
    __PYX_ERR(0, 366, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_2 = __pyx_t_6;
__pyx_L6_bool_binop_done:;
  if (__pyx_t_2) {

    /* "pyg4ometry/pycsg/core.pyx":367
     *                 return True
     *             elif abs(aplane.normal.dot(bplane.normal)+1) < 1e-5 and
     * abs(aplane.w+bplane.w) < 1e-7 : return True             # <<<<<<<<<<<<<<
     *             else :
     *                 return False
     */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(Py_True);
    __pyx_r = Py_True;
    goto __pyx_L0;

    /* "pyg4ometry/pycsg/core.pyx":366
     *             if abs(aplane.normal.dot(bplane.normal)-1) < 1e-5 and
     * abs(aplane.w-bplane.w) < 1e-7  : return True elif
     * abs(aplane.normal.dot(bplane.normal)+1) < 1e-5 and abs(aplane.w+bplane.w)
     * < 1e-7 :             # <<<<<<<<<<<<<< return True else :
     */
  }

  /* "pyg4ometry/pycsg/core.pyx":369
   *                 return True
   *             else :
   *                 return False             # <<<<<<<<<<<<<<
   *
   *         def polyVertsInside(apoly, bpoly):
   */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(Py_False);
    __pyx_r = Py_False;
    goto __pyx_L0;
  }

/* "pyg4ometry/pycsg/core.pyx":356
 *         polygons = []
 *
 *         def coplanarPolys(apoly,bpoly) :             # <<<<<<<<<<<<<<
 *             COPLANAR = 0  # all the vertices are within EPSILON distance from
 * plane FRONT = 1  # all the vertices are in front of the plane
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback(
      "pyg4ometry.pycsg.core.CSG.coplanarIntersection.coplanarPolys",
      __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XDECREF(__pyx_v_aplane);
  __Pyx_XDECREF(__pyx_v_bplane);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":371
 *                 return False
 *
 *         def polyVertsInside(apoly, bpoly):             # <<<<<<<<<<<<<<
 *
 *             aplane = apoly.plane
 */

/* Python wrapper */
static PyObject *
__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_3polyVertsInside(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef
    __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_3polyVertsInside =
        {"polyVertsInside",
         (PyCFunction)(void *)(PyCFunctionWithKeywords)
             __pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_3polyVertsInside,
         METH_VARARGS | METH_KEYWORDS, 0};
static PyObject *
__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_3polyVertsInside(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_apoly = 0;
  PyObject *__pyx_v_bpoly = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext(
      "polyVertsInside (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_apoly, &__pyx_n_s_bpoly,
                                            0};
    PyObject *values[2] = {0, 0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
      case 2:
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
      case 1:
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
      case 0:
        break;
      default:
        goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
      case 0:
        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_apoly)) != 0))
          kw_args--;
        else
          goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
      case 1:
        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_bpoly)) != 0))
          kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("polyVertsInside", 1, 2, 2, 1);
          __PYX_ERR(0, 371, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames,
                                                 0, values, pos_args,
                                                 "polyVertsInside") < 0))
          __PYX_ERR(0, 371, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_apoly = values[0];
    __pyx_v_bpoly = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
__pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("polyVertsInside", 1, 2, 2,
                             PyTuple_GET_SIZE(__pyx_args));
  __PYX_ERR(0, 371, __pyx_L3_error)
__pyx_L3_error:;
  __Pyx_AddTraceback(
      "pyg4ometry.pycsg.core.CSG.coplanarIntersection.polyVertsInside",
      __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
__pyx_L4_argument_unpacking_done:;
  __pyx_r =
      __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_2polyVertsInside(
          __pyx_self, __pyx_v_apoly, __pyx_v_bpoly);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *
__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_2polyVertsInside(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_apoly,
    PyObject *__pyx_v_bpoly) {
  PyObject *__pyx_v_aplane = NULL;
  PyObject *__pyx_v_vertsInside = NULL;
  Py_ssize_t __pyx_v_i;
  PyObject *__pyx_v_ploc = NULL;
  PyObject *__pyx_v_j = NULL;
  PyObject *__pyx_v_av = NULL;
  PyObject *__pyx_v_avunit = NULL;
  PyObject *__pyx_v_anormal = NULL;
  PyObject *__pyx_v_t = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  Py_ssize_t __pyx_t_3;
  Py_ssize_t __pyx_t_4;
  Py_ssize_t __pyx_t_5;
  PyObject *__pyx_t_6 = NULL;
  PyObject *(*__pyx_t_7)(PyObject *);
  Py_ssize_t __pyx_t_8;
  PyObject *__pyx_t_9 = NULL;
  int __pyx_t_10;
  PyObject *__pyx_t_11 = NULL;
  PyObject *__pyx_t_12 = NULL;
  int __pyx_t_13;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("polyVertsInside", 0);

  /* "pyg4ometry/pycsg/core.pyx":373
   *         def polyVertsInside(apoly, bpoly):
   *
   *             aplane = apoly.plane             # <<<<<<<<<<<<<<
   *
   *             vertsInside = []
   */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_apoly, __pyx_n_s_plane);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 373, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_aplane = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":375
   *             aplane = apoly.plane
   *
   *             vertsInside = []             # <<<<<<<<<<<<<<
   *             for i in range(len(bpoly.vertices)):
   *                 ploc = 0
   */
  __pyx_t_1 = PyList_New(0);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 375, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_vertsInside = ((PyObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":376
   *
   *             vertsInside = []
   *             for i in range(len(bpoly.vertices)):             #
   * <<<<<<<<<<<<<< ploc = 0
   *
   */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_bpoly, __pyx_n_s_vertices);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 376, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_Length(__pyx_t_1);
  if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1)))
    __PYX_ERR(0, 376, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_3; __pyx_t_4 += 1) {
    __pyx_v_i = __pyx_t_4;

    /* "pyg4ometry/pycsg/core.pyx":377
     *             vertsInside = []
     *             for i in range(len(bpoly.vertices)):
     *                 ploc = 0             # <<<<<<<<<<<<<<
     *
     *                 for j in range(len(apoly.vertices)):
     */
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_XDECREF_SET(__pyx_v_ploc, __pyx_int_0);

    /* "pyg4ometry/pycsg/core.pyx":379
     *                 ploc = 0
     *
     *                 for j in range(len(apoly.vertices)):             #
     * <<<<<<<<<<<<<< if j == len(apoly.vertices) - 1: av =
     * apoly.vertices[0].pos - apoly.vertices[j].pos
     */
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_apoly, __pyx_n_s_vertices);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 379, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = PyObject_Length(__pyx_t_1);
    if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1)))
      __PYX_ERR(0, 379, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_5);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 379, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_1);
    if (unlikely(!__pyx_t_6))
      __PYX_ERR(0, 379, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    if (likely(PyList_CheckExact(__pyx_t_6)) || PyTuple_CheckExact(__pyx_t_6)) {
      __pyx_t_1 = __pyx_t_6;
      __Pyx_INCREF(__pyx_t_1);
      __pyx_t_5 = 0;
      __pyx_t_7 = NULL;
    } else {
      __pyx_t_5 = -1;
      __pyx_t_1 = PyObject_GetIter(__pyx_t_6);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 379, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_7 = Py_TYPE(__pyx_t_1)->tp_iternext;
      if (unlikely(!__pyx_t_7))
        __PYX_ERR(0, 379, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_6);
    __pyx_t_6 = 0;
    for (;;) {
      if (likely(!__pyx_t_7)) {
        if (likely(PyList_CheckExact(__pyx_t_1))) {
          if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_1))
            break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_6 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_5);
          __Pyx_INCREF(__pyx_t_6);
          __pyx_t_5++;
          if (unlikely(0 < 0))
            __PYX_ERR(0, 379, __pyx_L1_error)
#else
          __pyx_t_6 = PySequence_ITEM(__pyx_t_1, __pyx_t_5);
          __pyx_t_5++;
          if (unlikely(!__pyx_t_6))
            __PYX_ERR(0, 379, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
#endif
        } else {
          if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_1))
            break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_5);
          __Pyx_INCREF(__pyx_t_6);
          __pyx_t_5++;
          if (unlikely(0 < 0))
            __PYX_ERR(0, 379, __pyx_L1_error)
#else
          __pyx_t_6 = PySequence_ITEM(__pyx_t_1, __pyx_t_5);
          __pyx_t_5++;
          if (unlikely(!__pyx_t_6))
            __PYX_ERR(0, 379, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
#endif
        }
      } else {
        __pyx_t_6 = __pyx_t_7(__pyx_t_1);
        if (unlikely(!__pyx_t_6)) {
          PyObject *exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type,
                                                         PyExc_StopIteration)))
              PyErr_Clear();
            else
              __PYX_ERR(0, 379, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_6);
      }
      __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_6);
      __pyx_t_6 = 0;

      /* "pyg4ometry/pycsg/core.pyx":380
       *
       *                 for j in range(len(apoly.vertices)):
       *                     if j == len(apoly.vertices) - 1:             #
       * <<<<<<<<<<<<<< av = apoly.vertices[0].pos - apoly.vertices[j].pos else:
       */
      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_apoly, __pyx_n_s_vertices);
      if (unlikely(!__pyx_t_6))
        __PYX_ERR(0, 380, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_8 = PyObject_Length(__pyx_t_6);
      if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1)))
        __PYX_ERR(0, 380, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_6 = PyInt_FromSsize_t((__pyx_t_8 - 1));
      if (unlikely(!__pyx_t_6))
        __PYX_ERR(0, 380, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_9 = PyObject_RichCompare(__pyx_v_j, __pyx_t_6, Py_EQ);
      __Pyx_XGOTREF(__pyx_t_9);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 380, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_9);
      if (unlikely(__pyx_t_10 < 0))
        __PYX_ERR(0, 380, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      if (__pyx_t_10) {

        /* "pyg4ometry/pycsg/core.pyx":381
         *                 for j in range(len(apoly.vertices)):
         *                     if j == len(apoly.vertices) - 1:
         *                         av = apoly.vertices[0].pos -
         * apoly.vertices[j].pos             # <<<<<<<<<<<<<< else: av =
         * apoly.vertices[j + 1].pos - apoly.vertices[j].pos
         */
        __pyx_t_9 =
            __Pyx_PyObject_GetAttrStr(__pyx_v_apoly, __pyx_n_s_vertices);
        if (unlikely(!__pyx_t_9))
          __PYX_ERR(0, 381, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_9, 0, long, 1,
                                     __Pyx_PyInt_From_long, 0, 0, 1);
        if (unlikely(!__pyx_t_6))
          __PYX_ERR(0, 381, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_9);
        __pyx_t_9 = 0;
        __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_pos);
        if (unlikely(!__pyx_t_9))
          __PYX_ERR(0, 381, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __Pyx_DECREF(__pyx_t_6);
        __pyx_t_6 = 0;
        __pyx_t_6 =
            __Pyx_PyObject_GetAttrStr(__pyx_v_apoly, __pyx_n_s_vertices);
        if (unlikely(!__pyx_t_6))
          __PYX_ERR(0, 381, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_v_j);
        if (unlikely(!__pyx_t_11))
          __PYX_ERR(0, 381, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_6);
        __pyx_t_6 = 0;
        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_pos);
        if (unlikely(!__pyx_t_6))
          __PYX_ERR(0, 381, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_11);
        __pyx_t_11 = 0;
        __pyx_t_11 = PyNumber_Subtract(__pyx_t_9, __pyx_t_6);
        if (unlikely(!__pyx_t_11))
          __PYX_ERR(0, 381, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_9);
        __pyx_t_9 = 0;
        __Pyx_DECREF(__pyx_t_6);
        __pyx_t_6 = 0;
        __Pyx_XDECREF_SET(__pyx_v_av, __pyx_t_11);
        __pyx_t_11 = 0;

        /* "pyg4ometry/pycsg/core.pyx":380
         *
         *                 for j in range(len(apoly.vertices)):
         *                     if j == len(apoly.vertices) - 1:             #
         * <<<<<<<<<<<<<< av = apoly.vertices[0].pos - apoly.vertices[j].pos
         *                     else:
         */
        goto __pyx_L7;
      }

      /* "pyg4ometry/pycsg/core.pyx":383
       *                         av = apoly.vertices[0].pos -
       * apoly.vertices[j].pos else: av = apoly.vertices[j + 1].pos -
       * apoly.vertices[j].pos             # <<<<<<<<<<<<<< avunit = av.unit()
       *                     anormal = aplane.normal.cross(avunit)
       */
      /*else*/ {
        __pyx_t_11 =
            __Pyx_PyObject_GetAttrStr(__pyx_v_apoly, __pyx_n_s_vertices);
        if (unlikely(!__pyx_t_11))
          __PYX_ERR(0, 383, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __pyx_t_6 = __Pyx_PyInt_AddObjC(__pyx_v_j, __pyx_int_1, 1, 0, 0);
        if (unlikely(!__pyx_t_6))
          __PYX_ERR(0, 383, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_t_11, __pyx_t_6);
        if (unlikely(!__pyx_t_9))
          __PYX_ERR(0, 383, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __Pyx_DECREF(__pyx_t_11);
        __pyx_t_11 = 0;
        __Pyx_DECREF(__pyx_t_6);
        __pyx_t_6 = 0;
        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_pos);
        if (unlikely(!__pyx_t_6))
          __PYX_ERR(0, 383, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_9);
        __pyx_t_9 = 0;
        __pyx_t_9 =
            __Pyx_PyObject_GetAttrStr(__pyx_v_apoly, __pyx_n_s_vertices);
        if (unlikely(!__pyx_t_9))
          __PYX_ERR(0, 383, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_t_9, __pyx_v_j);
        if (unlikely(!__pyx_t_11))
          __PYX_ERR(0, 383, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_9);
        __pyx_t_9 = 0;
        __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_pos);
        if (unlikely(!__pyx_t_9))
          __PYX_ERR(0, 383, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __Pyx_DECREF(__pyx_t_11);
        __pyx_t_11 = 0;
        __pyx_t_11 = PyNumber_Subtract(__pyx_t_6, __pyx_t_9);
        if (unlikely(!__pyx_t_11))
          __PYX_ERR(0, 383, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_6);
        __pyx_t_6 = 0;
        __Pyx_DECREF(__pyx_t_9);
        __pyx_t_9 = 0;
        __Pyx_XDECREF_SET(__pyx_v_av, __pyx_t_11);
        __pyx_t_11 = 0;
      }
    __pyx_L7:;

      /* "pyg4ometry/pycsg/core.pyx":384
       *                     else:
       *                         av = apoly.vertices[j + 1].pos -
       * apoly.vertices[j].pos avunit = av.unit()             # <<<<<<<<<<<<<<
       *                     anormal = aplane.normal.cross(avunit)
       *
       */
      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_av, __pyx_n_s_unit);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 384, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_6 = NULL;
      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_9))) {
        __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_9);
        if (likely(__pyx_t_6)) {
          PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_9);
          __Pyx_INCREF(__pyx_t_6);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_9, function);
        }
      }
      __pyx_t_11 = (__pyx_t_6) ? __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_t_6)
                               : __Pyx_PyObject_CallNoArg(__pyx_t_9);
      __Pyx_XDECREF(__pyx_t_6);
      __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_11))
        __PYX_ERR(0, 384, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      __Pyx_XDECREF_SET(__pyx_v_avunit, __pyx_t_11);
      __pyx_t_11 = 0;

      /* "pyg4ometry/pycsg/core.pyx":385
       *                         av = apoly.vertices[j + 1].pos -
       * apoly.vertices[j].pos avunit = av.unit() anormal =
       * aplane.normal.cross(avunit)             # <<<<<<<<<<<<<<
       *
       *                     # distance inside place
       */
      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_aplane, __pyx_n_s_normal);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 385, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_cross);
      if (unlikely(!__pyx_t_6))
        __PYX_ERR(0, 385, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      __pyx_t_9 = NULL;
      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
        __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_6);
        if (likely(__pyx_t_9)) {
          PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_6);
          __Pyx_INCREF(__pyx_t_9);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_6, function);
        }
      }
      __pyx_t_11 =
          (__pyx_t_9)
              ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_9, __pyx_v_avunit)
              : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_avunit);
      __Pyx_XDECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      if (unlikely(!__pyx_t_11))
        __PYX_ERR(0, 385, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_DECREF(__pyx_t_6);
      __pyx_t_6 = 0;
      __Pyx_XDECREF_SET(__pyx_v_anormal, __pyx_t_11);
      __pyx_t_11 = 0;

      /* "pyg4ometry/pycsg/core.pyx":388
       *
       *                     # distance inside place
       *                     t = anormal.dot(bpoly.vertices[i].pos) -
       * apoly.vertices[j].pos.dot(anormal)             # <<<<<<<<<<<<<<
       *
       *                     # check if inside
       */
      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_anormal, __pyx_n_s_dot);
      if (unlikely(!__pyx_t_6))
        __PYX_ERR(0, 388, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_bpoly, __pyx_n_s_vertices);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 388, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_12 = __Pyx_GetItemInt(__pyx_t_9, __pyx_v_i, Py_ssize_t, 1,
                                    PyInt_FromSsize_t, 0, 1, 1);
      if (unlikely(!__pyx_t_12))
        __PYX_ERR(0, 388, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_pos);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 388, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_12);
      __pyx_t_12 = 0;
      __pyx_t_12 = NULL;
      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
        __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_6);
        if (likely(__pyx_t_12)) {
          PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_6);
          __Pyx_INCREF(__pyx_t_12);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_6, function);
        }
      }
      __pyx_t_11 =
          (__pyx_t_12)
              ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_12, __pyx_t_9)
              : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_9);
      __Pyx_XDECREF(__pyx_t_12);
      __pyx_t_12 = 0;
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      if (unlikely(!__pyx_t_11))
        __PYX_ERR(0, 388, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_DECREF(__pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_apoly, __pyx_n_s_vertices);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 388, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_12 = __Pyx_PyObject_GetItem(__pyx_t_9, __pyx_v_j);
      if (unlikely(!__pyx_t_12))
        __PYX_ERR(0, 388, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_pos);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 388, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_12);
      __pyx_t_12 = 0;
      __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_dot);
      if (unlikely(!__pyx_t_12))
        __PYX_ERR(0, 388, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      __pyx_t_9 = NULL;
      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_12))) {
        __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_12);
        if (likely(__pyx_t_9)) {
          PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_12);
          __Pyx_INCREF(__pyx_t_9);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_12, function);
        }
      }
      __pyx_t_6 =
          (__pyx_t_9)
              ? __Pyx_PyObject_Call2Args(__pyx_t_12, __pyx_t_9, __pyx_v_anormal)
              : __Pyx_PyObject_CallOneArg(__pyx_t_12, __pyx_v_anormal);
      __Pyx_XDECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      if (unlikely(!__pyx_t_6))
        __PYX_ERR(0, 388, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_12);
      __pyx_t_12 = 0;
      __pyx_t_12 = PyNumber_Subtract(__pyx_t_11, __pyx_t_6);
      if (unlikely(!__pyx_t_12))
        __PYX_ERR(0, 388, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __Pyx_DECREF(__pyx_t_11);
      __pyx_t_11 = 0;
      __Pyx_DECREF(__pyx_t_6);
      __pyx_t_6 = 0;
      __Pyx_XDECREF_SET(__pyx_v_t, __pyx_t_12);
      __pyx_t_12 = 0;

      /* "pyg4ometry/pycsg/core.pyx":391
       *
       *                     # check if inside
       *                     if t >= 0:             # <<<<<<<<<<<<<<
       *                         ploc += 1
       *
       */
      __pyx_t_12 = PyObject_RichCompare(__pyx_v_t, __pyx_int_0, Py_GE);
      __Pyx_XGOTREF(__pyx_t_12);
      if (unlikely(!__pyx_t_12))
        __PYX_ERR(0, 391, __pyx_L1_error)
      __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_12);
      if (unlikely(__pyx_t_10 < 0))
        __PYX_ERR(0, 391, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_12);
      __pyx_t_12 = 0;
      if (__pyx_t_10) {

        /* "pyg4ometry/pycsg/core.pyx":392
         *                     # check if inside
         *                     if t >= 0:
         *                         ploc += 1             # <<<<<<<<<<<<<<
         *
         *                 if ploc == len(apoly.vertices):
         */
        __pyx_t_12 = __Pyx_PyInt_AddObjC(__pyx_v_ploc, __pyx_int_1, 1, 1, 0);
        if (unlikely(!__pyx_t_12))
          __PYX_ERR(0, 392, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_DECREF_SET(__pyx_v_ploc, __pyx_t_12);
        __pyx_t_12 = 0;

        /* "pyg4ometry/pycsg/core.pyx":391
         *
         *                     # check if inside
         *                     if t >= 0:             # <<<<<<<<<<<<<<
         *                         ploc += 1
         *
         */
      }

      /* "pyg4ometry/pycsg/core.pyx":379
       *                 ploc = 0
       *
       *                 for j in range(len(apoly.vertices)):             #
       * <<<<<<<<<<<<<< if j == len(apoly.vertices) - 1: av =
       * apoly.vertices[0].pos - apoly.vertices[j].pos
       */
    }
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;

    /* "pyg4ometry/pycsg/core.pyx":394
     *                         ploc += 1
     *
     *                 if ploc == len(apoly.vertices):             #
     * <<<<<<<<<<<<<< vertsInside.append(bpoly.vertices[i].pos)
     *
     */
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_apoly, __pyx_n_s_vertices);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 394, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = PyObject_Length(__pyx_t_1);
    if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1)))
      __PYX_ERR(0, 394, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_5);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 394, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_12 = PyObject_RichCompare(__pyx_v_ploc, __pyx_t_1, Py_EQ);
    __Pyx_XGOTREF(__pyx_t_12);
    if (unlikely(!__pyx_t_12))
      __PYX_ERR(0, 394, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_12);
    if (unlikely(__pyx_t_10 < 0))
      __PYX_ERR(0, 394, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_12);
    __pyx_t_12 = 0;
    if (__pyx_t_10) {

      /* "pyg4ometry/pycsg/core.pyx":395
       *
       *                 if ploc == len(apoly.vertices):
       *                     vertsInside.append(bpoly.vertices[i].pos) #
       * <<<<<<<<<<<<<<
       *
       *             return vertsInside
       */
      __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_v_bpoly, __pyx_n_s_vertices);
      if (unlikely(!__pyx_t_12))
        __PYX_ERR(0, 395, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_12, __pyx_v_i, Py_ssize_t, 1,
                                   PyInt_FromSsize_t, 0, 1, 1);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 395, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_12);
      __pyx_t_12 = 0;
      __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_pos);
      if (unlikely(!__pyx_t_12))
        __PYX_ERR(0, 395, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __Pyx_DECREF(__pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_13 = __Pyx_PyList_Append(__pyx_v_vertsInside, __pyx_t_12);
      if (unlikely(__pyx_t_13 == ((int)-1)))
        __PYX_ERR(0, 395, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_12);
      __pyx_t_12 = 0;

      /* "pyg4ometry/pycsg/core.pyx":394
       *                         ploc += 1
       *
       *                 if ploc == len(apoly.vertices):             #
       * <<<<<<<<<<<<<< vertsInside.append(bpoly.vertices[i].pos)
       *
       */
    }
  }

  /* "pyg4ometry/pycsg/core.pyx":397
   *                     vertsInside.append(bpoly.vertices[i].pos)
   *
   *             return vertsInside             # <<<<<<<<<<<<<<
   *
   *         def polyEdgeIntersection(apoly, bpoly) :
   */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_vertsInside);
  __pyx_r = __pyx_v_vertsInside;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":371
 *                 return False
 *
 *         def polyVertsInside(apoly, bpoly):             # <<<<<<<<<<<<<<
 *
 *             aplane = apoly.plane
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_AddTraceback(
      "pyg4ometry.pycsg.core.CSG.coplanarIntersection.polyVertsInside",
      __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XDECREF(__pyx_v_aplane);
  __Pyx_XDECREF(__pyx_v_vertsInside);
  __Pyx_XDECREF(__pyx_v_ploc);
  __Pyx_XDECREF(__pyx_v_j);
  __Pyx_XDECREF(__pyx_v_av);
  __Pyx_XDECREF(__pyx_v_avunit);
  __Pyx_XDECREF(__pyx_v_anormal);
  __Pyx_XDECREF(__pyx_v_t);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":399
 *             return vertsInside
 *
 *         def polyEdgeIntersection(apoly, bpoly) :             # <<<<<<<<<<<<<<
 *
 *             vertsInter = []
 */

/* Python wrapper */
static PyObject *
__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_5polyEdgeIntersection(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef
    __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_5polyEdgeIntersection =
        {"polyEdgeIntersection",
         (PyCFunction)(void *)(PyCFunctionWithKeywords)
             __pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_5polyEdgeIntersection,
         METH_VARARGS | METH_KEYWORDS, 0};
static PyObject *
__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_5polyEdgeIntersection(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_apoly = 0;
  PyObject *__pyx_v_bpoly = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext(
      "polyEdgeIntersection (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_apoly, &__pyx_n_s_bpoly,
                                            0};
    PyObject *values[2] = {0, 0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
      case 2:
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
      case 1:
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
      case 0:
        break;
      default:
        goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
      case 0:
        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_apoly)) != 0))
          kw_args--;
        else
          goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
      case 1:
        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_bpoly)) != 0))
          kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("polyEdgeIntersection", 1, 2, 2, 1);
          __PYX_ERR(0, 399, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames,
                                                 0, values, pos_args,
                                                 "polyEdgeIntersection") < 0))
          __PYX_ERR(0, 399, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_apoly = values[0];
    __pyx_v_bpoly = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
__pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("polyEdgeIntersection", 1, 2, 2,
                             PyTuple_GET_SIZE(__pyx_args));
  __PYX_ERR(0, 399, __pyx_L3_error)
__pyx_L3_error:;
  __Pyx_AddTraceback(
      "pyg4ometry.pycsg.core.CSG.coplanarIntersection.polyEdgeIntersection",
      __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
__pyx_L4_argument_unpacking_done:;
  __pyx_r =
      __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_4polyEdgeIntersection(
          __pyx_self, __pyx_v_apoly, __pyx_v_bpoly);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *
__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_4polyEdgeIntersection(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_apoly,
    PyObject *__pyx_v_bpoly) {
  PyObject *__pyx_v_vertsInter = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_bv = NULL;
  PyObject *__pyx_v_bvunit = NULL;
  PyObject *__pyx_v_b0 = NULL;
  PyObject *__pyx_v_j = NULL;
  PyObject *__pyx_v_av = NULL;
  PyObject *__pyx_v_avunit = NULL;
  PyObject *__pyx_v_a0 = NULL;
  PyObject *__pyx_v_aPlaneNormal = NULL;
  PyObject *__pyx_v_denom = NULL;
  PyObject *__pyx_v_soln = NULL;
  PyObject *__pyx_v_inter = NULL;
  PyObject *__pyx_v_adist = NULL;
  PyObject *__pyx_v_bdist = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_andist = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *(*__pyx_t_4)(PyObject *);
  Py_ssize_t __pyx_t_5;
  PyObject *__pyx_t_6 = NULL;
  int __pyx_t_7;
  PyObject *__pyx_t_8 = NULL;
  PyObject *(*__pyx_t_9)(PyObject *);
  Py_ssize_t __pyx_t_10;
  PyObject *__pyx_t_11 = NULL;
  PyObject *__pyx_t_12 = NULL;
  int __pyx_t_13;
  int __pyx_t_14;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("polyEdgeIntersection", 0);

  /* "pyg4ometry/pycsg/core.pyx":401
   *         def polyEdgeIntersection(apoly, bpoly) :
   *
   *             vertsInter = []             # <<<<<<<<<<<<<<
   *
   *             for i in range(len(bpoly.vertices)) :
   */
  __pyx_t_1 = PyList_New(0);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 401, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_vertsInter = ((PyObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":403
   *             vertsInter = []
   *
   *             for i in range(len(bpoly.vertices)) :             #
   * <<<<<<<<<<<<<< if i == len(bpoly.vertices) - 1: bv = bpoly.vertices[0].pos
   * - bpoly.vertices[i].pos
   */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_bpoly, __pyx_n_s_vertices);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 403, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_Length(__pyx_t_1);
  if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1)))
    __PYX_ERR(0, 403, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_2);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 403, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_1);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 403, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
    __pyx_t_1 = __pyx_t_3;
    __Pyx_INCREF(__pyx_t_1);
    __pyx_t_2 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_2 = -1;
    __pyx_t_1 = PyObject_GetIter(__pyx_t_3);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 403, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = Py_TYPE(__pyx_t_1)->tp_iternext;
    if (unlikely(!__pyx_t_4))
      __PYX_ERR(0, 403, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1))
          break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2);
        __Pyx_INCREF(__pyx_t_3);
        __pyx_t_2++;
        if (unlikely(0 < 0))
          __PYX_ERR(0, 403, __pyx_L1_error)
#else
        __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2);
        __pyx_t_2++;
        if (unlikely(!__pyx_t_3))
          __PYX_ERR(0, 403, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
#endif
      } else {
        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1))
          break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2);
        __Pyx_INCREF(__pyx_t_3);
        __pyx_t_2++;
        if (unlikely(0 < 0))
          __PYX_ERR(0, 403, __pyx_L1_error)
#else
        __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2);
        __pyx_t_2++;
        if (unlikely(!__pyx_t_3))
          __PYX_ERR(0, 403, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
#endif
      }
    } else {
      __pyx_t_3 = __pyx_t_4(__pyx_t_1);
      if (unlikely(!__pyx_t_3)) {
        PyObject *exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type,
                                                       PyExc_StopIteration)))
            PyErr_Clear();
          else
            __PYX_ERR(0, 403, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_3);
    __pyx_t_3 = 0;

    /* "pyg4ometry/pycsg/core.pyx":404
     *
     *             for i in range(len(bpoly.vertices)) :
     *                 if i == len(bpoly.vertices) - 1:             #
     * <<<<<<<<<<<<<< bv = bpoly.vertices[0].pos - bpoly.vertices[i].pos else:
     */
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_bpoly, __pyx_n_s_vertices);
    if (unlikely(!__pyx_t_3))
      __PYX_ERR(0, 404, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_5 = PyObject_Length(__pyx_t_3);
    if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1)))
      __PYX_ERR(0, 404, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyInt_FromSsize_t((__pyx_t_5 - 1));
    if (unlikely(!__pyx_t_3))
      __PYX_ERR(0, 404, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_6 = PyObject_RichCompare(__pyx_v_i, __pyx_t_3, Py_EQ);
    __Pyx_XGOTREF(__pyx_t_6);
    if (unlikely(!__pyx_t_6))
      __PYX_ERR(0, 404, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6);
    if (unlikely(__pyx_t_7 < 0))
      __PYX_ERR(0, 404, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6);
    __pyx_t_6 = 0;
    if (__pyx_t_7) {

      /* "pyg4ometry/pycsg/core.pyx":405
       *             for i in range(len(bpoly.vertices)) :
       *                 if i == len(bpoly.vertices) - 1:
       *                     bv = bpoly.vertices[0].pos - bpoly.vertices[i].pos
       * # <<<<<<<<<<<<<< else: bv = bpoly.vertices[i + 1].pos -
       * bpoly.vertices[i].pos
       */
      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_bpoly, __pyx_n_s_vertices);
      if (unlikely(!__pyx_t_6))
        __PYX_ERR(0, 405, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_6, 0, long, 1, __Pyx_PyInt_From_long,
                                   0, 0, 1);
      if (unlikely(!__pyx_t_3))
        __PYX_ERR(0, 405, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_pos);
      if (unlikely(!__pyx_t_6))
        __PYX_ERR(0, 405, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_bpoly, __pyx_n_s_vertices);
      if (unlikely(!__pyx_t_3))
        __PYX_ERR(0, 405, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_8 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_v_i);
      if (unlikely(!__pyx_t_8))
        __PYX_ERR(0, 405, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_pos);
      if (unlikely(!__pyx_t_3))
        __PYX_ERR(0, 405, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_8);
      __pyx_t_8 = 0;
      __pyx_t_8 = PyNumber_Subtract(__pyx_t_6, __pyx_t_3);
      if (unlikely(!__pyx_t_8))
        __PYX_ERR(0, 405, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_6);
      __pyx_t_6 = 0;
      __Pyx_DECREF(__pyx_t_3);
      __pyx_t_3 = 0;
      __Pyx_XDECREF_SET(__pyx_v_bv, __pyx_t_8);
      __pyx_t_8 = 0;

      /* "pyg4ometry/pycsg/core.pyx":404
       *
       *             for i in range(len(bpoly.vertices)) :
       *                 if i == len(bpoly.vertices) - 1:             #
       * <<<<<<<<<<<<<< bv = bpoly.vertices[0].pos - bpoly.vertices[i].pos else:
       */
      goto __pyx_L5;
    }

    /* "pyg4ometry/pycsg/core.pyx":407
     *                     bv = bpoly.vertices[0].pos - bpoly.vertices[i].pos
     *                 else:
     *                     bv = bpoly.vertices[i + 1].pos -
     * bpoly.vertices[i].pos             # <<<<<<<<<<<<<< bvunit = bv.unit() b0
     * = bpoly.vertices[i].pos
     */
    /*else*/ {
      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_bpoly, __pyx_n_s_vertices);
      if (unlikely(!__pyx_t_8))
        __PYX_ERR(0, 407, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_1, 1, 0, 0);
      if (unlikely(!__pyx_t_3))
        __PYX_ERR(0, 407, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_8, __pyx_t_3);
      if (unlikely(!__pyx_t_6))
        __PYX_ERR(0, 407, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_8);
      __pyx_t_8 = 0;
      __Pyx_DECREF(__pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_pos);
      if (unlikely(!__pyx_t_3))
        __PYX_ERR(0, 407, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_bpoly, __pyx_n_s_vertices);
      if (unlikely(!__pyx_t_6))
        __PYX_ERR(0, 407, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_8 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_v_i);
      if (unlikely(!__pyx_t_8))
        __PYX_ERR(0, 407, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_pos);
      if (unlikely(!__pyx_t_6))
        __PYX_ERR(0, 407, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_8);
      __pyx_t_8 = 0;
      __pyx_t_8 = PyNumber_Subtract(__pyx_t_3, __pyx_t_6);
      if (unlikely(!__pyx_t_8))
        __PYX_ERR(0, 407, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_3);
      __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_6);
      __pyx_t_6 = 0;
      __Pyx_XDECREF_SET(__pyx_v_bv, __pyx_t_8);
      __pyx_t_8 = 0;
    }
  __pyx_L5:;

    /* "pyg4ometry/pycsg/core.pyx":408
     *                 else:
     *                     bv = bpoly.vertices[i + 1].pos -
     * bpoly.vertices[i].pos bvunit = bv.unit()             # <<<<<<<<<<<<<< b0
     * = bpoly.vertices[i].pos
     *
     */
    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_bv, __pyx_n_s_unit);
    if (unlikely(!__pyx_t_6))
      __PYX_ERR(0, 408, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_6);
      if (likely(__pyx_t_3)) {
        PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_6);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_6, function);
      }
    }
    __pyx_t_8 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_3)
                            : __Pyx_PyObject_CallNoArg(__pyx_t_6);
    __Pyx_XDECREF(__pyx_t_3);
    __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_8))
      __PYX_ERR(0, 408, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_6);
    __pyx_t_6 = 0;
    __Pyx_XDECREF_SET(__pyx_v_bvunit, __pyx_t_8);
    __pyx_t_8 = 0;

    /* "pyg4ometry/pycsg/core.pyx":409
     *                     bv = bpoly.vertices[i + 1].pos -
     * bpoly.vertices[i].pos bvunit = bv.unit() b0 = bpoly.vertices[i].pos #
     * <<<<<<<<<<<<<<
     *
     *                 for j in range(len(apoly.vertices)) :
     */
    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_bpoly, __pyx_n_s_vertices);
    if (unlikely(!__pyx_t_8))
      __PYX_ERR(0, 409, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_8, __pyx_v_i);
    if (unlikely(!__pyx_t_6))
      __PYX_ERR(0, 409, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_8);
    __pyx_t_8 = 0;
    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_pos);
    if (unlikely(!__pyx_t_8))
      __PYX_ERR(0, 409, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_6);
    __pyx_t_6 = 0;
    __Pyx_XDECREF_SET(__pyx_v_b0, __pyx_t_8);
    __pyx_t_8 = 0;

    /* "pyg4ometry/pycsg/core.pyx":411
     *                 b0 = bpoly.vertices[i].pos
     *
     *                 for j in range(len(apoly.vertices)) :             #
     * <<<<<<<<<<<<<< if j == len(apoly.vertices) - 1: av =
     * apoly.vertices[0].pos - apoly.vertices[j].pos
     */
    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_apoly, __pyx_n_s_vertices);
    if (unlikely(!__pyx_t_8))
      __PYX_ERR(0, 411, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __pyx_t_5 = PyObject_Length(__pyx_t_8);
    if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1)))
      __PYX_ERR(0, 411, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_8);
    __pyx_t_8 = 0;
    __pyx_t_8 = PyInt_FromSsize_t(__pyx_t_5);
    if (unlikely(!__pyx_t_8))
      __PYX_ERR(0, 411, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_8);
    if (unlikely(!__pyx_t_6))
      __PYX_ERR(0, 411, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_8);
    __pyx_t_8 = 0;
    if (likely(PyList_CheckExact(__pyx_t_6)) || PyTuple_CheckExact(__pyx_t_6)) {
      __pyx_t_8 = __pyx_t_6;
      __Pyx_INCREF(__pyx_t_8);
      __pyx_t_5 = 0;
      __pyx_t_9 = NULL;
    } else {
      __pyx_t_5 = -1;
      __pyx_t_8 = PyObject_GetIter(__pyx_t_6);
      if (unlikely(!__pyx_t_8))
        __PYX_ERR(0, 411, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_9 = Py_TYPE(__pyx_t_8)->tp_iternext;
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 411, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_6);
    __pyx_t_6 = 0;
    for (;;) {
      if (likely(!__pyx_t_9)) {
        if (likely(PyList_CheckExact(__pyx_t_8))) {
          if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_8))
            break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_6 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_5);
          __Pyx_INCREF(__pyx_t_6);
          __pyx_t_5++;
          if (unlikely(0 < 0))
            __PYX_ERR(0, 411, __pyx_L1_error)
#else
          __pyx_t_6 = PySequence_ITEM(__pyx_t_8, __pyx_t_5);
          __pyx_t_5++;
          if (unlikely(!__pyx_t_6))
            __PYX_ERR(0, 411, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
#endif
        } else {
          if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_8))
            break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_5);
          __Pyx_INCREF(__pyx_t_6);
          __pyx_t_5++;
          if (unlikely(0 < 0))
            __PYX_ERR(0, 411, __pyx_L1_error)
#else
          __pyx_t_6 = PySequence_ITEM(__pyx_t_8, __pyx_t_5);
          __pyx_t_5++;
          if (unlikely(!__pyx_t_6))
            __PYX_ERR(0, 411, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
#endif
        }
      } else {
        __pyx_t_6 = __pyx_t_9(__pyx_t_8);
        if (unlikely(!__pyx_t_6)) {
          PyObject *exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type,
                                                         PyExc_StopIteration)))
              PyErr_Clear();
            else
              __PYX_ERR(0, 411, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_6);
      }
      __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_6);
      __pyx_t_6 = 0;

      /* "pyg4ometry/pycsg/core.pyx":412
       *
       *                 for j in range(len(apoly.vertices)) :
       *                     if j == len(apoly.vertices) - 1:             #
       * <<<<<<<<<<<<<< av = apoly.vertices[0].pos - apoly.vertices[j].pos else:
       */
      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_apoly, __pyx_n_s_vertices);
      if (unlikely(!__pyx_t_6))
        __PYX_ERR(0, 412, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_10 = PyObject_Length(__pyx_t_6);
      if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1)))
        __PYX_ERR(0, 412, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_6 = PyInt_FromSsize_t((__pyx_t_10 - 1));
      if (unlikely(!__pyx_t_6))
        __PYX_ERR(0, 412, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_3 = PyObject_RichCompare(__pyx_v_j, __pyx_t_6, Py_EQ);
      __Pyx_XGOTREF(__pyx_t_3);
      if (unlikely(!__pyx_t_3))
        __PYX_ERR(0, 412, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_3);
      if (unlikely(__pyx_t_7 < 0))
        __PYX_ERR(0, 412, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3);
      __pyx_t_3 = 0;
      if (__pyx_t_7) {

        /* "pyg4ometry/pycsg/core.pyx":413
         *                 for j in range(len(apoly.vertices)) :
         *                     if j == len(apoly.vertices) - 1:
         *                         av = apoly.vertices[0].pos -
         * apoly.vertices[j].pos             # <<<<<<<<<<<<<< else: av =
         * apoly.vertices[j + 1].pos - apoly.vertices[j].pos
         */
        __pyx_t_3 =
            __Pyx_PyObject_GetAttrStr(__pyx_v_apoly, __pyx_n_s_vertices);
        if (unlikely(!__pyx_t_3))
          __PYX_ERR(0, 413, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_3, 0, long, 1,
                                     __Pyx_PyInt_From_long, 0, 0, 1);
        if (unlikely(!__pyx_t_6))
          __PYX_ERR(0, 413, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_pos);
        if (unlikely(!__pyx_t_3))
          __PYX_ERR(0, 413, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_6);
        __pyx_t_6 = 0;
        __pyx_t_6 =
            __Pyx_PyObject_GetAttrStr(__pyx_v_apoly, __pyx_n_s_vertices);
        if (unlikely(!__pyx_t_6))
          __PYX_ERR(0, 413, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_v_j);
        if (unlikely(!__pyx_t_11))
          __PYX_ERR(0, 413, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_6);
        __pyx_t_6 = 0;
        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_pos);
        if (unlikely(!__pyx_t_6))
          __PYX_ERR(0, 413, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_11);
        __pyx_t_11 = 0;
        __pyx_t_11 = PyNumber_Subtract(__pyx_t_3, __pyx_t_6);
        if (unlikely(!__pyx_t_11))
          __PYX_ERR(0, 413, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_3);
        __pyx_t_3 = 0;
        __Pyx_DECREF(__pyx_t_6);
        __pyx_t_6 = 0;
        __Pyx_XDECREF_SET(__pyx_v_av, __pyx_t_11);
        __pyx_t_11 = 0;

        /* "pyg4ometry/pycsg/core.pyx":412
         *
         *                 for j in range(len(apoly.vertices)) :
         *                     if j == len(apoly.vertices) - 1:             #
         * <<<<<<<<<<<<<< av = apoly.vertices[0].pos - apoly.vertices[j].pos
         *                     else:
         */
        goto __pyx_L8;
      }

      /* "pyg4ometry/pycsg/core.pyx":415
       *                         av = apoly.vertices[0].pos -
       * apoly.vertices[j].pos else: av = apoly.vertices[j + 1].pos -
       * apoly.vertices[j].pos             # <<<<<<<<<<<<<< avunit = av.unit()
       *                     a0 = apoly.vertices[j].pos
       */
      /*else*/ {
        __pyx_t_11 =
            __Pyx_PyObject_GetAttrStr(__pyx_v_apoly, __pyx_n_s_vertices);
        if (unlikely(!__pyx_t_11))
          __PYX_ERR(0, 415, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __pyx_t_6 = __Pyx_PyInt_AddObjC(__pyx_v_j, __pyx_int_1, 1, 0, 0);
        if (unlikely(!__pyx_t_6))
          __PYX_ERR(0, 415, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_11, __pyx_t_6);
        if (unlikely(!__pyx_t_3))
          __PYX_ERR(0, 415, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_11);
        __pyx_t_11 = 0;
        __Pyx_DECREF(__pyx_t_6);
        __pyx_t_6 = 0;
        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_pos);
        if (unlikely(!__pyx_t_6))
          __PYX_ERR(0, 415, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_3 =
            __Pyx_PyObject_GetAttrStr(__pyx_v_apoly, __pyx_n_s_vertices);
        if (unlikely(!__pyx_t_3))
          __PYX_ERR(0, 415, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_v_j);
        if (unlikely(!__pyx_t_11))
          __PYX_ERR(0, 415, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_pos);
        if (unlikely(!__pyx_t_3))
          __PYX_ERR(0, 415, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_11);
        __pyx_t_11 = 0;
        __pyx_t_11 = PyNumber_Subtract(__pyx_t_6, __pyx_t_3);
        if (unlikely(!__pyx_t_11))
          __PYX_ERR(0, 415, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_6);
        __pyx_t_6 = 0;
        __Pyx_DECREF(__pyx_t_3);
        __pyx_t_3 = 0;
        __Pyx_XDECREF_SET(__pyx_v_av, __pyx_t_11);
        __pyx_t_11 = 0;
      }
    __pyx_L8:;

      /* "pyg4ometry/pycsg/core.pyx":416
       *                     else:
       *                         av = apoly.vertices[j + 1].pos -
       * apoly.vertices[j].pos avunit = av.unit()             # <<<<<<<<<<<<<<
       *                     a0 = apoly.vertices[j].pos
       *
       */
      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_av, __pyx_n_s_unit);
      if (unlikely(!__pyx_t_3))
        __PYX_ERR(0, 416, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_6 = NULL;
      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
        if (likely(__pyx_t_6)) {
          PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
          __Pyx_INCREF(__pyx_t_6);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_3, function);
        }
      }
      __pyx_t_11 = (__pyx_t_6) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_6)
                               : __Pyx_PyObject_CallNoArg(__pyx_t_3);
      __Pyx_XDECREF(__pyx_t_6);
      __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_11))
        __PYX_ERR(0, 416, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_DECREF(__pyx_t_3);
      __pyx_t_3 = 0;
      __Pyx_XDECREF_SET(__pyx_v_avunit, __pyx_t_11);
      __pyx_t_11 = 0;

      /* "pyg4ometry/pycsg/core.pyx":417
       *                         av = apoly.vertices[j + 1].pos -
       * apoly.vertices[j].pos avunit = av.unit() a0 = apoly.vertices[j].pos #
       * <<<<<<<<<<<<<<
       *
       *                     aPlaneNormal   = avunit.cross(apoly.plane.normal)
       */
      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_apoly, __pyx_n_s_vertices);
      if (unlikely(!__pyx_t_11))
        __PYX_ERR(0, 417, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_11, __pyx_v_j);
      if (unlikely(!__pyx_t_3))
        __PYX_ERR(0, 417, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_11);
      __pyx_t_11 = 0;
      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_pos);
      if (unlikely(!__pyx_t_11))
        __PYX_ERR(0, 417, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_DECREF(__pyx_t_3);
      __pyx_t_3 = 0;
      __Pyx_XDECREF_SET(__pyx_v_a0, __pyx_t_11);
      __pyx_t_11 = 0;

      /* "pyg4ometry/pycsg/core.pyx":419
       *                     a0 = apoly.vertices[j].pos
       *
       *                     aPlaneNormal   = avunit.cross(apoly.plane.normal)
       * # <<<<<<<<<<<<<<
       *
       *                     denom = bvunit.dot(aPlaneNormal)
       */
      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_avunit, __pyx_n_s_cross);
      if (unlikely(!__pyx_t_3))
        __PYX_ERR(0, 419, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_apoly, __pyx_n_s_plane);
      if (unlikely(!__pyx_t_6))
        __PYX_ERR(0, 419, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_normal);
      if (unlikely(!__pyx_t_12))
        __PYX_ERR(0, 419, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __Pyx_DECREF(__pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_6 = NULL;
      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
        if (likely(__pyx_t_6)) {
          PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
          __Pyx_INCREF(__pyx_t_6);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_3, function);
        }
      }
      __pyx_t_11 =
          (__pyx_t_6)
              ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_6, __pyx_t_12)
              : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_12);
      __Pyx_XDECREF(__pyx_t_6);
      __pyx_t_6 = 0;
      __Pyx_DECREF(__pyx_t_12);
      __pyx_t_12 = 0;
      if (unlikely(!__pyx_t_11))
        __PYX_ERR(0, 419, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_DECREF(__pyx_t_3);
      __pyx_t_3 = 0;
      __Pyx_XDECREF_SET(__pyx_v_aPlaneNormal, __pyx_t_11);
      __pyx_t_11 = 0;

      /* "pyg4ometry/pycsg/core.pyx":421
       *                     aPlaneNormal   = avunit.cross(apoly.plane.normal)
       *
       *                     denom = bvunit.dot(aPlaneNormal)             #
       * <<<<<<<<<<<<<< if denom != 0 : soln   = -(b0 -
       * a0).dot(aPlaneNormal)/denom
       */
      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_bvunit, __pyx_n_s_dot);
      if (unlikely(!__pyx_t_3))
        __PYX_ERR(0, 421, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_12 = NULL;
      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_3);
        if (likely(__pyx_t_12)) {
          PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
          __Pyx_INCREF(__pyx_t_12);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_3, function);
        }
      }
      __pyx_t_11 =
          (__pyx_t_12)
              ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_12,
                                         __pyx_v_aPlaneNormal)
              : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_aPlaneNormal);
      __Pyx_XDECREF(__pyx_t_12);
      __pyx_t_12 = 0;
      if (unlikely(!__pyx_t_11))
        __PYX_ERR(0, 421, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_DECREF(__pyx_t_3);
      __pyx_t_3 = 0;
      __Pyx_XDECREF_SET(__pyx_v_denom, __pyx_t_11);
      __pyx_t_11 = 0;

      /* "pyg4ometry/pycsg/core.pyx":422
       *
       *                     denom = bvunit.dot(aPlaneNormal)
       *                     if denom != 0 :             # <<<<<<<<<<<<<<
       *                         soln   = -(b0 - a0).dot(aPlaneNormal)/denom
       *                         inter  =  soln*bvunit+b0
       */
      __pyx_t_11 = __Pyx_PyInt_NeObjC(__pyx_v_denom, __pyx_int_0, 0, 0);
      if (unlikely(!__pyx_t_11))
        __PYX_ERR(0, 422, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_11);
      if (unlikely(__pyx_t_7 < 0))
        __PYX_ERR(0, 422, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_11);
      __pyx_t_11 = 0;
      if (__pyx_t_7) {

        /* "pyg4ometry/pycsg/core.pyx":423
         *                     denom = bvunit.dot(aPlaneNormal)
         *                     if denom != 0 :
         *                         soln   = -(b0 - a0).dot(aPlaneNormal)/denom
         * # <<<<<<<<<<<<<< inter  =  soln*bvunit+b0 adist  =
         * (inter-a0).dot(avunit)
         */
        __pyx_t_3 = PyNumber_Subtract(__pyx_v_b0, __pyx_v_a0);
        if (unlikely(!__pyx_t_3))
          __PYX_ERR(0, 423, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_dot);
        if (unlikely(!__pyx_t_12))
          __PYX_ERR(0, 423, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_DECREF(__pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_3 = NULL;
        if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_12))) {
          __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_12);
          if (likely(__pyx_t_3)) {
            PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_12);
            __Pyx_INCREF(__pyx_t_3);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_12, function);
          }
        }
        __pyx_t_11 =
            (__pyx_t_3)
                ? __Pyx_PyObject_Call2Args(__pyx_t_12, __pyx_t_3,
                                           __pyx_v_aPlaneNormal)
                : __Pyx_PyObject_CallOneArg(__pyx_t_12, __pyx_v_aPlaneNormal);
        __Pyx_XDECREF(__pyx_t_3);
        __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_11))
          __PYX_ERR(0, 423, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_12);
        __pyx_t_12 = 0;
        __pyx_t_12 = PyNumber_Negative(__pyx_t_11);
        if (unlikely(!__pyx_t_12))
          __PYX_ERR(0, 423, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_DECREF(__pyx_t_11);
        __pyx_t_11 = 0;
        __pyx_t_11 = __Pyx_PyNumber_Divide(__pyx_t_12, __pyx_v_denom);
        if (unlikely(!__pyx_t_11))
          __PYX_ERR(0, 423, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_12);
        __pyx_t_12 = 0;
        __Pyx_XDECREF_SET(__pyx_v_soln, __pyx_t_11);
        __pyx_t_11 = 0;

        /* "pyg4ometry/pycsg/core.pyx":424
         *                     if denom != 0 :
         *                         soln   = -(b0 - a0).dot(aPlaneNormal)/denom
         *                         inter  =  soln*bvunit+b0             #
         * <<<<<<<<<<<<<< adist  = (inter-a0).dot(avunit) bdist  =
         * (inter-b0).dot(bvunit)
         */
        __pyx_t_11 = PyNumber_Multiply(__pyx_v_soln, __pyx_v_bvunit);
        if (unlikely(!__pyx_t_11))
          __PYX_ERR(0, 424, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __pyx_t_12 = PyNumber_Add(__pyx_t_11, __pyx_v_b0);
        if (unlikely(!__pyx_t_12))
          __PYX_ERR(0, 424, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_DECREF(__pyx_t_11);
        __pyx_t_11 = 0;
        __Pyx_XDECREF_SET(__pyx_v_inter, __pyx_t_12);
        __pyx_t_12 = 0;

        /* "pyg4ometry/pycsg/core.pyx":425
         *                         soln   = -(b0 - a0).dot(aPlaneNormal)/denom
         *                         inter  =  soln*bvunit+b0
         *                         adist  = (inter-a0).dot(avunit)             #
         * <<<<<<<<<<<<<< bdist  = (inter-b0).dot(bvunit) andist =
         * (inter-a0).dot(apoly.plane.normal)
         */
        __pyx_t_11 = PyNumber_Subtract(__pyx_v_inter, __pyx_v_a0);
        if (unlikely(!__pyx_t_11))
          __PYX_ERR(0, 425, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_dot);
        if (unlikely(!__pyx_t_3))
          __PYX_ERR(0, 425, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_11);
        __pyx_t_11 = 0;
        __pyx_t_11 = NULL;
        if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
          __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_3);
          if (likely(__pyx_t_11)) {
            PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
            __Pyx_INCREF(__pyx_t_11);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_3, function);
          }
        }
        __pyx_t_12 = (__pyx_t_11)
                         ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_11,
                                                    __pyx_v_avunit)
                         : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_avunit);
        __Pyx_XDECREF(__pyx_t_11);
        __pyx_t_11 = 0;
        if (unlikely(!__pyx_t_12))
          __PYX_ERR(0, 425, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_DECREF(__pyx_t_3);
        __pyx_t_3 = 0;
        __Pyx_XDECREF_SET(__pyx_v_adist, __pyx_t_12);
        __pyx_t_12 = 0;

        /* "pyg4ometry/pycsg/core.pyx":426
         *                         inter  =  soln*bvunit+b0
         *                         adist  = (inter-a0).dot(avunit)
         *                         bdist  = (inter-b0).dot(bvunit)             #
         * <<<<<<<<<<<<<< andist = (inter-a0).dot(apoly.plane.normal)
         *
         */
        __pyx_t_3 = PyNumber_Subtract(__pyx_v_inter, __pyx_v_b0);
        if (unlikely(!__pyx_t_3))
          __PYX_ERR(0, 426, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_dot);
        if (unlikely(!__pyx_t_11))
          __PYX_ERR(0, 426, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_3 = NULL;
        if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
          __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_11);
          if (likely(__pyx_t_3)) {
            PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_11);
            __Pyx_INCREF(__pyx_t_3);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_11, function);
          }
        }
        __pyx_t_12 =
            (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_3,
                                                   __pyx_v_bvunit)
                        : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_v_bvunit);
        __Pyx_XDECREF(__pyx_t_3);
        __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_12))
          __PYX_ERR(0, 426, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_DECREF(__pyx_t_11);
        __pyx_t_11 = 0;
        __Pyx_XDECREF_SET(__pyx_v_bdist, __pyx_t_12);
        __pyx_t_12 = 0;

        /* "pyg4ometry/pycsg/core.pyx":427
         *                         adist  = (inter-a0).dot(avunit)
         *                         bdist  = (inter-b0).dot(bvunit)
         *                         andist = (inter-a0).dot(apoly.plane.normal)
         * # <<<<<<<<<<<<<<
         *
         *                         if adist >= 0 and adist < av.length() and
         * bdist < bv.length() and soln > 0:
         */
        __pyx_t_11 = PyNumber_Subtract(__pyx_v_inter, __pyx_v_a0);
        if (unlikely(!__pyx_t_11))
          __PYX_ERR(0, 427, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_dot);
        if (unlikely(!__pyx_t_3))
          __PYX_ERR(0, 427, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_11);
        __pyx_t_11 = 0;
        __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_apoly, __pyx_n_s_plane);
        if (unlikely(!__pyx_t_11))
          __PYX_ERR(0, 427, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_normal);
        if (unlikely(!__pyx_t_6))
          __PYX_ERR(0, 427, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_11);
        __pyx_t_11 = 0;
        __pyx_t_11 = NULL;
        if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
          __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_3);
          if (likely(__pyx_t_11)) {
            PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
            __Pyx_INCREF(__pyx_t_11);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_3, function);
          }
        }
        __pyx_t_12 =
            (__pyx_t_11)
                ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_11, __pyx_t_6)
                : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_6);
        __Pyx_XDECREF(__pyx_t_11);
        __pyx_t_11 = 0;
        __Pyx_DECREF(__pyx_t_6);
        __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_12))
          __PYX_ERR(0, 427, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_DECREF(__pyx_t_3);
        __pyx_t_3 = 0;
        __Pyx_XDECREF_SET(__pyx_v_andist, __pyx_t_12);
        __pyx_t_12 = 0;

        /* "pyg4ometry/pycsg/core.pyx":429
         *                         andist = (inter-a0).dot(apoly.plane.normal)
         *
         *                         if adist >= 0 and adist < av.length() and
         * bdist < bv.length() and soln > 0:             # <<<<<<<<<<<<<<
         *                             vertsInter.append(_Vector(inter))
         *
         */
        __pyx_t_12 = PyObject_RichCompare(__pyx_v_adist, __pyx_int_0, Py_GE);
        __Pyx_XGOTREF(__pyx_t_12);
        if (unlikely(!__pyx_t_12))
          __PYX_ERR(0, 429, __pyx_L1_error)
        __pyx_t_13 = __Pyx_PyObject_IsTrue(__pyx_t_12);
        if (unlikely(__pyx_t_13 < 0))
          __PYX_ERR(0, 429, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_12);
        __pyx_t_12 = 0;
        if (__pyx_t_13) {
        } else {
          __pyx_t_7 = __pyx_t_13;
          goto __pyx_L11_bool_binop_done;
        }
        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_av, __pyx_n_s_length);
        if (unlikely(!__pyx_t_3))
          __PYX_ERR(0, 429, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_6 = NULL;
        if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
          __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
          if (likely(__pyx_t_6)) {
            PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
            __Pyx_INCREF(__pyx_t_6);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_3, function);
          }
        }
        __pyx_t_12 = (__pyx_t_6)
                         ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_6)
                         : __Pyx_PyObject_CallNoArg(__pyx_t_3);
        __Pyx_XDECREF(__pyx_t_6);
        __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_12))
          __PYX_ERR(0, 429, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_DECREF(__pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_3 = PyObject_RichCompare(__pyx_v_adist, __pyx_t_12, Py_LT);
        __Pyx_XGOTREF(__pyx_t_3);
        if (unlikely(!__pyx_t_3))
          __PYX_ERR(0, 429, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_12);
        __pyx_t_12 = 0;
        __pyx_t_13 = __Pyx_PyObject_IsTrue(__pyx_t_3);
        if (unlikely(__pyx_t_13 < 0))
          __PYX_ERR(0, 429, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_3);
        __pyx_t_3 = 0;
        if (__pyx_t_13) {
        } else {
          __pyx_t_7 = __pyx_t_13;
          goto __pyx_L11_bool_binop_done;
        }
        __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_v_bv, __pyx_n_s_length);
        if (unlikely(!__pyx_t_12))
          __PYX_ERR(0, 429, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __pyx_t_6 = NULL;
        if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_12))) {
          __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_12);
          if (likely(__pyx_t_6)) {
            PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_12);
            __Pyx_INCREF(__pyx_t_6);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_12, function);
          }
        }
        __pyx_t_3 = (__pyx_t_6)
                        ? __Pyx_PyObject_CallOneArg(__pyx_t_12, __pyx_t_6)
                        : __Pyx_PyObject_CallNoArg(__pyx_t_12);
        __Pyx_XDECREF(__pyx_t_6);
        __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_3))
          __PYX_ERR(0, 429, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_12);
        __pyx_t_12 = 0;
        __pyx_t_12 = PyObject_RichCompare(__pyx_v_bdist, __pyx_t_3, Py_LT);
        __Pyx_XGOTREF(__pyx_t_12);
        if (unlikely(!__pyx_t_12))
          __PYX_ERR(0, 429, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_13 = __Pyx_PyObject_IsTrue(__pyx_t_12);
        if (unlikely(__pyx_t_13 < 0))
          __PYX_ERR(0, 429, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_12);
        __pyx_t_12 = 0;
        if (__pyx_t_13) {
        } else {
          __pyx_t_7 = __pyx_t_13;
          goto __pyx_L11_bool_binop_done;
        }
        __pyx_t_12 = PyObject_RichCompare(__pyx_v_soln, __pyx_int_0, Py_GT);
        __Pyx_XGOTREF(__pyx_t_12);
        if (unlikely(!__pyx_t_12))
          __PYX_ERR(0, 429, __pyx_L1_error)
        __pyx_t_13 = __Pyx_PyObject_IsTrue(__pyx_t_12);
        if (unlikely(__pyx_t_13 < 0))
          __PYX_ERR(0, 429, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_12);
        __pyx_t_12 = 0;
        __pyx_t_7 = __pyx_t_13;
      __pyx_L11_bool_binop_done:;
        if (__pyx_t_7) {

          /* "pyg4ometry/pycsg/core.pyx":430
           *
           *                         if adist >= 0 and adist < av.length() and
           * bdist < bv.length() and soln > 0: vertsInter.append(_Vector(inter))
           * # <<<<<<<<<<<<<<
           *
           *             return vertsInter
           */
          __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_Vector_2);
          if (unlikely(!__pyx_t_3))
            __PYX_ERR(0, 430, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_t_6 = NULL;
          if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
            __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
            if (likely(__pyx_t_6)) {
              PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
              __Pyx_INCREF(__pyx_t_6);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_3, function);
            }
          }
          __pyx_t_12 =
              (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_6,
                                                     __pyx_v_inter)
                          : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_inter);
          __Pyx_XDECREF(__pyx_t_6);
          __pyx_t_6 = 0;
          if (unlikely(!__pyx_t_12))
            __PYX_ERR(0, 430, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_12);
          __Pyx_DECREF(__pyx_t_3);
          __pyx_t_3 = 0;
          __pyx_t_14 = __Pyx_PyList_Append(__pyx_v_vertsInter, __pyx_t_12);
          if (unlikely(__pyx_t_14 == ((int)-1)))
            __PYX_ERR(0, 430, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_12);
          __pyx_t_12 = 0;

          /* "pyg4ometry/pycsg/core.pyx":429
           *                         andist = (inter-a0).dot(apoly.plane.normal)
           *
           *                         if adist >= 0 and adist < av.length() and
           * bdist < bv.length() and soln > 0:             # <<<<<<<<<<<<<<
           *                             vertsInter.append(_Vector(inter))
           *
           */
        }

        /* "pyg4ometry/pycsg/core.pyx":422
         *
         *                     denom = bvunit.dot(aPlaneNormal)
         *                     if denom != 0 :             # <<<<<<<<<<<<<<
         *                         soln   = -(b0 - a0).dot(aPlaneNormal)/denom
         *                         inter  =  soln*bvunit+b0
         */
      }

      /* "pyg4ometry/pycsg/core.pyx":411
       *                 b0 = bpoly.vertices[i].pos
       *
       *                 for j in range(len(apoly.vertices)) :             #
       * <<<<<<<<<<<<<< if j == len(apoly.vertices) - 1: av =
       * apoly.vertices[0].pos - apoly.vertices[j].pos
       */
    }
    __Pyx_DECREF(__pyx_t_8);
    __pyx_t_8 = 0;

    /* "pyg4ometry/pycsg/core.pyx":403
     *             vertsInter = []
     *
     *             for i in range(len(bpoly.vertices)) :             #
     * <<<<<<<<<<<<<< if i == len(bpoly.vertices) - 1: bv =
     * bpoly.vertices[0].pos - bpoly.vertices[i].pos
     */
  }
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":432
   *                             vertsInter.append(_Vector(inter))
   *
   *             return vertsInter             # <<<<<<<<<<<<<<
   *
   *         def convexHull(positions,normal) :
   */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_vertsInter);
  __pyx_r = __pyx_v_vertsInter;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":399
 *             return vertsInside
 *
 *         def polyEdgeIntersection(apoly, bpoly) :             # <<<<<<<<<<<<<<
 *
 *             vertsInter = []
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_AddTraceback(
      "pyg4ometry.pycsg.core.CSG.coplanarIntersection.polyEdgeIntersection",
      __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XDECREF(__pyx_v_vertsInter);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XDECREF(__pyx_v_bv);
  __Pyx_XDECREF(__pyx_v_bvunit);
  __Pyx_XDECREF(__pyx_v_b0);
  __Pyx_XDECREF(__pyx_v_j);
  __Pyx_XDECREF(__pyx_v_av);
  __Pyx_XDECREF(__pyx_v_avunit);
  __Pyx_XDECREF(__pyx_v_a0);
  __Pyx_XDECREF(__pyx_v_aPlaneNormal);
  __Pyx_XDECREF(__pyx_v_denom);
  __Pyx_XDECREF(__pyx_v_soln);
  __Pyx_XDECREF(__pyx_v_inter);
  __Pyx_XDECREF(__pyx_v_adist);
  __Pyx_XDECREF(__pyx_v_bdist);
  __Pyx_XDECREF(__pyx_v_andist);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":434
 *             return vertsInter
 *
 *         def convexHull(positions,normal) :             # <<<<<<<<<<<<<<
 *
 *             if len(positions) < 3 :
 */

/* Python wrapper */
static PyObject *
__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_7convexHull(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef
    __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_7convexHull =
        {"convexHull",
         (PyCFunction)(void *)(PyCFunctionWithKeywords)
             __pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_7convexHull,
         METH_VARARGS | METH_KEYWORDS, 0};
static PyObject *
__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_7convexHull(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_positions = 0;
  PyObject *__pyx_v_normal = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext("convexHull (wrapper)",
                                                        0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_positions,
                                            &__pyx_n_s_normal, 0};
    PyObject *values[2] = {0, 0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
      case 2:
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
      case 1:
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
      case 0:
        break;
      default:
        goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
      case 0:
        if (likely((values[0] = __Pyx_PyDict_GetItemStr(
                        __pyx_kwds, __pyx_n_s_positions)) != 0))
          kw_args--;
        else
          goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
      case 1:
        if (likely((values[1] = __Pyx_PyDict_GetItemStr(
                        __pyx_kwds, __pyx_n_s_normal)) != 0))
          kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("convexHull", 1, 2, 2, 1);
          __PYX_ERR(0, 434, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames,
                                                 0, values, pos_args,
                                                 "convexHull") < 0))
          __PYX_ERR(0, 434, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_positions = values[0];
    __pyx_v_normal = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
__pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("convexHull", 1, 2, 2,
                             PyTuple_GET_SIZE(__pyx_args));
  __PYX_ERR(0, 434, __pyx_L3_error)
__pyx_L3_error:;
  __Pyx_AddTraceback(
      "pyg4ometry.pycsg.core.CSG.coplanarIntersection.convexHull",
      __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
__pyx_L4_argument_unpacking_done:;
  __pyx_r =
      __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_6convexHull(
          __pyx_self, __pyx_v_positions, __pyx_v_normal);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *
__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_6convexHull(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_positions,
    PyObject *__pyx_v_normal) {
  PyObject *__pyx_v_hull = NULL;
  PyObject *__pyx_v_q_now = NULL;
  PyObject *__pyx_v_q_next = NULL;
  PyObject *__pyx_v_nhull = NULL;
  PyObject *__pyx_v_p = NULL;
  PyObject *__pyx_v_p1 = NULL;
  PyObject *__pyx_v_p2 = NULL;
  PyObject *__pyx_v_v = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations Py_ssize_t __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  PyObject *(*__pyx_t_6)(PyObject *);
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  PyObject *__pyx_t_10 = NULL;
  PyObject *__pyx_t_11 = NULL;
  int __pyx_t_12;
  PyObject *__pyx_t_13 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("convexHull", 0);

  /* "pyg4ometry/pycsg/core.pyx":436
   *         def convexHull(positions,normal) :
   *
   *             if len(positions) < 3 :             # <<<<<<<<<<<<<<
   *                 return None
   *
   */
  __pyx_t_1 = PyObject_Length(__pyx_v_positions);
  if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1)))
    __PYX_ERR(0, 436, __pyx_L1_error)
  __pyx_t_2 = ((__pyx_t_1 < 3) != 0);
  if (__pyx_t_2) {

    /* "pyg4ometry/pycsg/core.pyx":437
     *
     *             if len(positions) < 3 :
     *                 return None             # <<<<<<<<<<<<<<
     *
     *             hull = []
     */
    __Pyx_XDECREF(__pyx_r);
    __pyx_r = Py_None;
    __Pyx_INCREF(Py_None);
    goto __pyx_L0;

    /* "pyg4ometry/pycsg/core.pyx":436
     *         def convexHull(positions,normal) :
     *
     *             if len(positions) < 3 :             # <<<<<<<<<<<<<<
     *                 return None
     *
     */
  }

  /* "pyg4ometry/pycsg/core.pyx":439
   *                 return None
   *
   *             hull = []             # <<<<<<<<<<<<<<
   *
   *             q_now  = positions[0]
   */
  __pyx_t_3 = PyList_New(0);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 439, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_v_hull = ((PyObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "pyg4ometry/pycsg/core.pyx":441
   *             hull = []
   *
   *             q_now  = positions[0]             # <<<<<<<<<<<<<<
   *             q_next = positions[1]
   *
   */
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_positions, 0, long, 1,
                               __Pyx_PyInt_From_long, 0, 0, 1);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 441, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_v_q_now = __pyx_t_3;
  __pyx_t_3 = 0;

  /* "pyg4ometry/pycsg/core.pyx":442
   *
   *             q_now  = positions[0]
   *             q_next = positions[1]             # <<<<<<<<<<<<<<
   *
   *             nhull = 0
   */
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_positions, 1, long, 1,
                               __Pyx_PyInt_From_long, 0, 0, 1);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 442, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_v_q_next = __pyx_t_3;
  __pyx_t_3 = 0;

  /* "pyg4ometry/pycsg/core.pyx":444
   *             q_next = positions[1]
   *
   *             nhull = 0             # <<<<<<<<<<<<<<
   *             while nhull < len(positions) :
   *
   */
  __Pyx_INCREF(__pyx_int_0);
  __pyx_v_nhull = __pyx_int_0;

  /* "pyg4ometry/pycsg/core.pyx":445
   *
   *             nhull = 0
   *             while nhull < len(positions) :             # <<<<<<<<<<<<<<
   *
   *                 hull.append(q_now)
   */
  while (1) {
    __pyx_t_1 = PyObject_Length(__pyx_v_positions);
    if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1)))
      __PYX_ERR(0, 445, __pyx_L1_error)
    __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_1);
    if (unlikely(!__pyx_t_3))
      __PYX_ERR(0, 445, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyObject_RichCompare(__pyx_v_nhull, __pyx_t_3, Py_LT);
    __Pyx_XGOTREF(__pyx_t_4);
    if (unlikely(!__pyx_t_4))
      __PYX_ERR(0, 445, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4);
    if (unlikely(__pyx_t_2 < 0))
      __PYX_ERR(0, 445, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4);
    __pyx_t_4 = 0;
    if (!__pyx_t_2)
      break;

    /* "pyg4ometry/pycsg/core.pyx":447
     *             while nhull < len(positions) :
     *
     *                 hull.append(q_now)             # <<<<<<<<<<<<<<
     *                 nhull = nhull + 1
     *
     */
    __pyx_t_5 = __Pyx_PyList_Append(__pyx_v_hull, __pyx_v_q_now);
    if (unlikely(__pyx_t_5 == ((int)-1)))
      __PYX_ERR(0, 447, __pyx_L1_error)

    /* "pyg4ometry/pycsg/core.pyx":448
     *
     *                 hull.append(q_now)
     *                 nhull = nhull + 1             # <<<<<<<<<<<<<<
     *
     *                 for p in positions :
     */
    __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_v_nhull, __pyx_int_1, 1, 0, 0);
    if (unlikely(!__pyx_t_4))
      __PYX_ERR(0, 448, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF_SET(__pyx_v_nhull, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "pyg4ometry/pycsg/core.pyx":450
     *                 nhull = nhull + 1
     *
     *                 for p in positions :             # <<<<<<<<<<<<<<
     *                     try :
     *                         p1 = (q_next-q_now).unit()
     */
    if (likely(PyList_CheckExact(__pyx_v_positions)) ||
        PyTuple_CheckExact(__pyx_v_positions)) {
      __pyx_t_4 = __pyx_v_positions;
      __Pyx_INCREF(__pyx_t_4);
      __pyx_t_1 = 0;
      __pyx_t_6 = NULL;
    } else {
      __pyx_t_1 = -1;
      __pyx_t_4 = PyObject_GetIter(__pyx_v_positions);
      if (unlikely(!__pyx_t_4))
        __PYX_ERR(0, 450, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext;
      if (unlikely(!__pyx_t_6))
        __PYX_ERR(0, 450, __pyx_L1_error)
    }
    for (;;) {
      if (likely(!__pyx_t_6)) {
        if (likely(PyList_CheckExact(__pyx_t_4))) {
          if (__pyx_t_1 >= PyList_GET_SIZE(__pyx_t_4))
            break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_3 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_1);
          __Pyx_INCREF(__pyx_t_3);
          __pyx_t_1++;
          if (unlikely(0 < 0))
            __PYX_ERR(0, 450, __pyx_L1_error)
#else
          __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_1);
          __pyx_t_1++;
          if (unlikely(!__pyx_t_3))
            __PYX_ERR(0, 450, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
#endif
        } else {
          if (__pyx_t_1 >= PyTuple_GET_SIZE(__pyx_t_4))
            break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_1);
          __Pyx_INCREF(__pyx_t_3);
          __pyx_t_1++;
          if (unlikely(0 < 0))
            __PYX_ERR(0, 450, __pyx_L1_error)
#else
          __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_1);
          __pyx_t_1++;
          if (unlikely(!__pyx_t_3))
            __PYX_ERR(0, 450, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
#endif
        }
      } else {
        __pyx_t_3 = __pyx_t_6(__pyx_t_4);
        if (unlikely(!__pyx_t_3)) {
          PyObject *exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type,
                                                         PyExc_StopIteration)))
              PyErr_Clear();
            else
              __PYX_ERR(0, 450, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_3);
      }
      __Pyx_XDECREF_SET(__pyx_v_p, __pyx_t_3);
      __pyx_t_3 = 0;

      /* "pyg4ometry/pycsg/core.pyx":451
       *
       *                 for p in positions :
       *                     try :             # <<<<<<<<<<<<<<
       *                         p1 = (q_next-q_now).unit()
       *                     except ZeroDivisionError :
       */
      {
        __Pyx_PyThreadState_declare __Pyx_PyThreadState_assign
            __Pyx_ExceptionSave(&__pyx_t_7, &__pyx_t_8, &__pyx_t_9);
        __Pyx_XGOTREF(__pyx_t_7);
        __Pyx_XGOTREF(__pyx_t_8);
        __Pyx_XGOTREF(__pyx_t_9);
        /*try:*/ {

          /* "pyg4ometry/pycsg/core.pyx":452
           *                 for p in positions :
           *                     try :
           *                         p1 = (q_next-q_now).unit()             #
           * <<<<<<<<<<<<<< except ZeroDivisionError : return None
           */
          __pyx_t_10 = PyNumber_Subtract(__pyx_v_q_next, __pyx_v_q_now);
          if (unlikely(!__pyx_t_10))
            __PYX_ERR(0, 452, __pyx_L8_error)
          __Pyx_GOTREF(__pyx_t_10);
          __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_unit);
          if (unlikely(!__pyx_t_11))
            __PYX_ERR(0, 452, __pyx_L8_error)
          __Pyx_GOTREF(__pyx_t_11);
          __Pyx_DECREF(__pyx_t_10);
          __pyx_t_10 = 0;
          __pyx_t_10 = NULL;
          if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
            __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_11);
            if (likely(__pyx_t_10)) {
              PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_11);
              __Pyx_INCREF(__pyx_t_10);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_11, function);
            }
          }
          __pyx_t_3 = (__pyx_t_10)
                          ? __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_10)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_11);
          __Pyx_XDECREF(__pyx_t_10);
          __pyx_t_10 = 0;
          if (unlikely(!__pyx_t_3))
            __PYX_ERR(0, 452, __pyx_L8_error)
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_DECREF(__pyx_t_11);
          __pyx_t_11 = 0;
          __Pyx_XDECREF_SET(__pyx_v_p1, __pyx_t_3);
          __pyx_t_3 = 0;

          /* "pyg4ometry/pycsg/core.pyx":451
           *
           *                 for p in positions :
           *                     try :             # <<<<<<<<<<<<<<
           *                         p1 = (q_next-q_now).unit()
           *                     except ZeroDivisionError :
           */
        }
        __Pyx_XDECREF(__pyx_t_7);
        __pyx_t_7 = 0;
        __Pyx_XDECREF(__pyx_t_8);
        __pyx_t_8 = 0;
        __Pyx_XDECREF(__pyx_t_9);
        __pyx_t_9 = 0;
        goto __pyx_L15_try_end;
      __pyx_L8_error:;
        __Pyx_XDECREF(__pyx_t_10);
        __pyx_t_10 = 0;
        __Pyx_XDECREF(__pyx_t_11);
        __pyx_t_11 = 0;
        __Pyx_XDECREF(__pyx_t_3);
        __pyx_t_3 = 0;

        /* "pyg4ometry/pycsg/core.pyx":453
         *                     try :
         *                         p1 = (q_next-q_now).unit()
         *                     except ZeroDivisionError :             #
         * <<<<<<<<<<<<<< return None try :
         */
        __pyx_t_12 =
            __Pyx_PyErr_ExceptionMatches(__pyx_builtin_ZeroDivisionError);
        if (__pyx_t_12) {
          __Pyx_AddTraceback(
              "pyg4ometry.pycsg.core.CSG.coplanarIntersection.convexHull",
              __pyx_clineno, __pyx_lineno, __pyx_filename);
          if (__Pyx_GetException(&__pyx_t_3, &__pyx_t_11, &__pyx_t_10) < 0)
            __PYX_ERR(0, 453, __pyx_L10_except_error)
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_GOTREF(__pyx_t_11);
          __Pyx_GOTREF(__pyx_t_10);

          /* "pyg4ometry/pycsg/core.pyx":454
           *                         p1 = (q_next-q_now).unit()
           *                     except ZeroDivisionError :
           *                         return None             # <<<<<<<<<<<<<<
           *                     try :
           *                         p2 = (p-q_now).unit()
           */
          __Pyx_XDECREF(__pyx_r);
          __pyx_r = Py_None;
          __Pyx_INCREF(Py_None);
          __Pyx_DECREF(__pyx_t_3);
          __pyx_t_3 = 0;
          __Pyx_DECREF(__pyx_t_4);
          __pyx_t_4 = 0;
          __Pyx_DECREF(__pyx_t_10);
          __pyx_t_10 = 0;
          __Pyx_DECREF(__pyx_t_11);
          __pyx_t_11 = 0;
          goto __pyx_L11_except_return;
        }
        goto __pyx_L10_except_error;
      __pyx_L10_except_error:;

        /* "pyg4ometry/pycsg/core.pyx":451
         *
         *                 for p in positions :
         *                     try :             # <<<<<<<<<<<<<<
         *                         p1 = (q_next-q_now).unit()
         *                     except ZeroDivisionError :
         */
        __Pyx_XGIVEREF(__pyx_t_7);
        __Pyx_XGIVEREF(__pyx_t_8);
        __Pyx_XGIVEREF(__pyx_t_9);
        __Pyx_ExceptionReset(__pyx_t_7, __pyx_t_8, __pyx_t_9);
        goto __pyx_L1_error;
      __pyx_L11_except_return:;
        __Pyx_XGIVEREF(__pyx_t_7);
        __Pyx_XGIVEREF(__pyx_t_8);
        __Pyx_XGIVEREF(__pyx_t_9);
        __Pyx_ExceptionReset(__pyx_t_7, __pyx_t_8, __pyx_t_9);
        goto __pyx_L0;
      __pyx_L15_try_end:;
      }

      /* "pyg4ometry/pycsg/core.pyx":455
       *                     except ZeroDivisionError :
       *                         return None
       *                     try :             # <<<<<<<<<<<<<<
       *                         p2 = (p-q_now).unit()
       *                     except ZeroDivisionError :
       */
      {
        __Pyx_PyThreadState_declare __Pyx_PyThreadState_assign
            __Pyx_ExceptionSave(&__pyx_t_9, &__pyx_t_8, &__pyx_t_7);
        __Pyx_XGOTREF(__pyx_t_9);
        __Pyx_XGOTREF(__pyx_t_8);
        __Pyx_XGOTREF(__pyx_t_7);
        /*try:*/ {

          /* "pyg4ometry/pycsg/core.pyx":456
           *                         return None
           *                     try :
           *                         p2 = (p-q_now).unit()             #
           * <<<<<<<<<<<<<< except ZeroDivisionError : return None
           */
          __pyx_t_11 = PyNumber_Subtract(__pyx_v_p, __pyx_v_q_now);
          if (unlikely(!__pyx_t_11))
            __PYX_ERR(0, 456, __pyx_L18_error)
          __Pyx_GOTREF(__pyx_t_11);
          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_unit);
          if (unlikely(!__pyx_t_3))
            __PYX_ERR(0, 456, __pyx_L18_error)
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_DECREF(__pyx_t_11);
          __pyx_t_11 = 0;
          __pyx_t_11 = NULL;
          if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
            __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_3);
            if (likely(__pyx_t_11)) {
              PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
              __Pyx_INCREF(__pyx_t_11);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_3, function);
            }
          }
          __pyx_t_10 = (__pyx_t_11)
                           ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_11)
                           : __Pyx_PyObject_CallNoArg(__pyx_t_3);
          __Pyx_XDECREF(__pyx_t_11);
          __pyx_t_11 = 0;
          if (unlikely(!__pyx_t_10))
            __PYX_ERR(0, 456, __pyx_L18_error)
          __Pyx_GOTREF(__pyx_t_10);
          __Pyx_DECREF(__pyx_t_3);
          __pyx_t_3 = 0;
          __Pyx_XDECREF_SET(__pyx_v_p2, __pyx_t_10);
          __pyx_t_10 = 0;

          /* "pyg4ometry/pycsg/core.pyx":455
           *                     except ZeroDivisionError :
           *                         return None
           *                     try :             # <<<<<<<<<<<<<<
           *                         p2 = (p-q_now).unit()
           *                     except ZeroDivisionError :
           */
        }
        __Pyx_XDECREF(__pyx_t_9);
        __pyx_t_9 = 0;
        __Pyx_XDECREF(__pyx_t_8);
        __pyx_t_8 = 0;
        __Pyx_XDECREF(__pyx_t_7);
        __pyx_t_7 = 0;
        goto __pyx_L25_try_end;
      __pyx_L18_error:;
        __Pyx_XDECREF(__pyx_t_10);
        __pyx_t_10 = 0;
        __Pyx_XDECREF(__pyx_t_11);
        __pyx_t_11 = 0;
        __Pyx_XDECREF(__pyx_t_3);
        __pyx_t_3 = 0;

        /* "pyg4ometry/pycsg/core.pyx":457
         *                     try :
         *                         p2 = (p-q_now).unit()
         *                     except ZeroDivisionError :             #
         * <<<<<<<<<<<<<< return None if p1.cross(p2).dot(normal) < 0 :
         */
        __pyx_t_12 =
            __Pyx_PyErr_ExceptionMatches(__pyx_builtin_ZeroDivisionError);
        if (__pyx_t_12) {
          __Pyx_AddTraceback(
              "pyg4ometry.pycsg.core.CSG.coplanarIntersection.convexHull",
              __pyx_clineno, __pyx_lineno, __pyx_filename);
          if (__Pyx_GetException(&__pyx_t_10, &__pyx_t_3, &__pyx_t_11) < 0)
            __PYX_ERR(0, 457, __pyx_L20_except_error)
          __Pyx_GOTREF(__pyx_t_10);
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_GOTREF(__pyx_t_11);

          /* "pyg4ometry/pycsg/core.pyx":458
           *                         p2 = (p-q_now).unit()
           *                     except ZeroDivisionError :
           *                         return None             # <<<<<<<<<<<<<<
           *                     if p1.cross(p2).dot(normal) < 0 :
           *                         q_next = p
           */
          __Pyx_XDECREF(__pyx_r);
          __pyx_r = Py_None;
          __Pyx_INCREF(Py_None);
          __Pyx_DECREF(__pyx_t_3);
          __pyx_t_3 = 0;
          __Pyx_DECREF(__pyx_t_4);
          __pyx_t_4 = 0;
          __Pyx_DECREF(__pyx_t_10);
          __pyx_t_10 = 0;
          __Pyx_DECREF(__pyx_t_11);
          __pyx_t_11 = 0;
          goto __pyx_L21_except_return;
        }
        goto __pyx_L20_except_error;
      __pyx_L20_except_error:;

        /* "pyg4ometry/pycsg/core.pyx":455
         *                     except ZeroDivisionError :
         *                         return None
         *                     try :             # <<<<<<<<<<<<<<
         *                         p2 = (p-q_now).unit()
         *                     except ZeroDivisionError :
         */
        __Pyx_XGIVEREF(__pyx_t_9);
        __Pyx_XGIVEREF(__pyx_t_8);
        __Pyx_XGIVEREF(__pyx_t_7);
        __Pyx_ExceptionReset(__pyx_t_9, __pyx_t_8, __pyx_t_7);
        goto __pyx_L1_error;
      __pyx_L21_except_return:;
        __Pyx_XGIVEREF(__pyx_t_9);
        __Pyx_XGIVEREF(__pyx_t_8);
        __Pyx_XGIVEREF(__pyx_t_7);
        __Pyx_ExceptionReset(__pyx_t_9, __pyx_t_8, __pyx_t_7);
        goto __pyx_L0;
      __pyx_L25_try_end:;
      }

      /* "pyg4ometry/pycsg/core.pyx":459
       *                     except ZeroDivisionError :
       *                         return None
       *                     if p1.cross(p2).dot(normal) < 0 :             #
       * <<<<<<<<<<<<<< q_next = p
       *
       */
      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_p1, __pyx_n_s_cross);
      if (unlikely(!__pyx_t_10))
        __PYX_ERR(0, 459, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __pyx_t_13 = NULL;
      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
        __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_10);
        if (likely(__pyx_t_13)) {
          PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_10);
          __Pyx_INCREF(__pyx_t_13);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_10, function);
        }
      }
      __pyx_t_3 =
          (__pyx_t_13)
              ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_13, __pyx_v_p2)
              : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_v_p2);
      __Pyx_XDECREF(__pyx_t_13);
      __pyx_t_13 = 0;
      if (unlikely(!__pyx_t_3))
        __PYX_ERR(0, 459, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_10);
      __pyx_t_10 = 0;
      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_dot);
      if (unlikely(!__pyx_t_10))
        __PYX_ERR(0, 459, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_DECREF(__pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = NULL;
      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_10);
        if (likely(__pyx_t_3)) {
          PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_10);
          __Pyx_INCREF(__pyx_t_3);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_10, function);
        }
      }
      __pyx_t_11 =
          (__pyx_t_3)
              ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_3, __pyx_v_normal)
              : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_v_normal);
      __Pyx_XDECREF(__pyx_t_3);
      __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_11))
        __PYX_ERR(0, 459, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_DECREF(__pyx_t_10);
      __pyx_t_10 = 0;
      __pyx_t_10 = PyObject_RichCompare(__pyx_t_11, __pyx_int_0, Py_LT);
      __Pyx_XGOTREF(__pyx_t_10);
      if (unlikely(!__pyx_t_10))
        __PYX_ERR(0, 459, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_11);
      __pyx_t_11 = 0;
      __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_10);
      if (unlikely(__pyx_t_2 < 0))
        __PYX_ERR(0, 459, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_10);
      __pyx_t_10 = 0;
      if (__pyx_t_2) {

        /* "pyg4ometry/pycsg/core.pyx":460
         *                         return None
         *                     if p1.cross(p2).dot(normal) < 0 :
         *                         q_next = p             # <<<<<<<<<<<<<<
         *
         *                 q_now = q_next
         */
        __Pyx_INCREF(__pyx_v_p);
        __Pyx_DECREF_SET(__pyx_v_q_next, __pyx_v_p);

        /* "pyg4ometry/pycsg/core.pyx":459
         *                     except ZeroDivisionError :
         *                         return None
         *                     if p1.cross(p2).dot(normal) < 0 :             #
         * <<<<<<<<<<<<<< q_next = p
         *
         */
      }

      /* "pyg4ometry/pycsg/core.pyx":450
       *                 nhull = nhull + 1
       *
       *                 for p in positions :             # <<<<<<<<<<<<<<
       *                     try :
       *                         p1 = (q_next-q_now).unit()
       */
    }
    __Pyx_DECREF(__pyx_t_4);
    __pyx_t_4 = 0;

    /* "pyg4ometry/pycsg/core.pyx":462
     *                         q_next = p
     *
     *                 q_now = q_next             # <<<<<<<<<<<<<<
     *                 q_next = positions[0]
     *
     */
    __Pyx_INCREF(__pyx_v_q_next);
    __Pyx_DECREF_SET(__pyx_v_q_now, __pyx_v_q_next);

    /* "pyg4ometry/pycsg/core.pyx":463
     *
     *                 q_now = q_next
     *                 q_next = positions[0]             # <<<<<<<<<<<<<<
     *
     *             v = []
     */
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_positions, 0, long, 1,
                                 __Pyx_PyInt_From_long, 0, 0, 1);
    if (unlikely(!__pyx_t_4))
      __PYX_ERR(0, 463, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF_SET(__pyx_v_q_next, __pyx_t_4);
    __pyx_t_4 = 0;
  }

  /* "pyg4ometry/pycsg/core.pyx":465
   *                 q_next = positions[0]
   *
   *             v = []             # <<<<<<<<<<<<<<
   *             for p in hull :
   *                 v.append(_Vertex(p))
   */
  __pyx_t_4 = PyList_New(0);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 465, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_v_v = ((PyObject *)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "pyg4ometry/pycsg/core.pyx":466
   *
   *             v = []
   *             for p in hull :             # <<<<<<<<<<<<<<
   *                 v.append(_Vertex(p))
   *
   */
  __pyx_t_4 = __pyx_v_hull;
  __Pyx_INCREF(__pyx_t_4);
  __pyx_t_1 = 0;
  for (;;) {
    if (__pyx_t_1 >= PyList_GET_SIZE(__pyx_t_4))
      break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_10 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_1);
    __Pyx_INCREF(__pyx_t_10);
    __pyx_t_1++;
    if (unlikely(0 < 0))
      __PYX_ERR(0, 466, __pyx_L1_error)
#else
    __pyx_t_10 = PySequence_ITEM(__pyx_t_4, __pyx_t_1);
    __pyx_t_1++;
    if (unlikely(!__pyx_t_10))
      __PYX_ERR(0, 466, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
#endif
    __Pyx_XDECREF_SET(__pyx_v_p, __pyx_t_10);
    __pyx_t_10 = 0;

    /* "pyg4ometry/pycsg/core.pyx":467
     *             v = []
     *             for p in hull :
     *                 v.append(_Vertex(p))             # <<<<<<<<<<<<<<
     *
     *             # print v
     */
    __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_Vertex_2);
    if (unlikely(!__pyx_t_11))
      __PYX_ERR(0, 467, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_11);
      if (likely(__pyx_t_3)) {
        PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_11);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_11, function);
      }
    }
    __pyx_t_10 =
        (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_3, __pyx_v_p)
                    : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_v_p);
    __Pyx_XDECREF(__pyx_t_3);
    __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_10))
      __PYX_ERR(0, 467, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
    __Pyx_DECREF(__pyx_t_11);
    __pyx_t_11 = 0;
    __pyx_t_5 = __Pyx_PyList_Append(__pyx_v_v, __pyx_t_10);
    if (unlikely(__pyx_t_5 == ((int)-1)))
      __PYX_ERR(0, 467, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_10);
    __pyx_t_10 = 0;

    /* "pyg4ometry/pycsg/core.pyx":466
     *
     *             v = []
     *             for p in hull :             # <<<<<<<<<<<<<<
     *                 v.append(_Vertex(p))
     *
     */
  }
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;

  /* "pyg4ometry/pycsg/core.pyx":470
   *
   *             # print v
   *             return Polygon(v)             # <<<<<<<<<<<<<<
   *
   *         for i in range(0,len(apolygons),1):                     # loop over
   * all A polygons
   */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_Polygon);
  if (unlikely(!__pyx_t_10))
    __PYX_ERR(0, 470, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_10);
  __pyx_t_11 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_10))) {
    __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_10);
    if (likely(__pyx_t_11)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_10);
      __Pyx_INCREF(__pyx_t_11);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_10, function);
    }
  }
  __pyx_t_4 = (__pyx_t_11)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_11, __pyx_v_v)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_v_v);
  __Pyx_XDECREF(__pyx_t_11);
  __pyx_t_11 = 0;
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 470, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_10);
  __pyx_t_10 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":434
 *             return vertsInter
 *
 *         def convexHull(positions,normal) :             # <<<<<<<<<<<<<<
 *
 *             if len(positions) < 3 :
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_XDECREF(__pyx_t_13);
  __Pyx_AddTraceback(
      "pyg4ometry.pycsg.core.CSG.coplanarIntersection.convexHull",
      __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XDECREF(__pyx_v_hull);
  __Pyx_XDECREF(__pyx_v_q_now);
  __Pyx_XDECREF(__pyx_v_q_next);
  __Pyx_XDECREF(__pyx_v_nhull);
  __Pyx_XDECREF(__pyx_v_p);
  __Pyx_XDECREF(__pyx_v_p1);
  __Pyx_XDECREF(__pyx_v_p2);
  __Pyx_XDECREF(__pyx_v_v);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":345
 *         return CSG.fromPolygons(a.allPolygons())
 *
 *     def coplanarIntersection(self, csg):             # <<<<<<<<<<<<<<
 *         # print 'pycsg.core.coplanarIntersection>'
 *
 */

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_38coplanarIntersection(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self,
    PyObject *__pyx_v_csg) {
  PyObject *__pyx_v_absp = NULL;
  PyObject *__pyx_v_bbsp = NULL;
  PyObject *__pyx_v_apolygons = NULL;
  PyObject *__pyx_v_bpolygons = NULL;
  PyObject *__pyx_v_polygons = NULL;
  PyObject *__pyx_v_coplanarPolys = 0;
  PyObject *__pyx_v_polyVertsInside = 0;
  PyObject *__pyx_v_polyEdgeIntersection = 0;
  PyObject *__pyx_v_convexHull = 0;
  Py_ssize_t __pyx_v_i;
  PyObject *__pyx_v_apoly = NULL;
  Py_ssize_t __pyx_v_j;
  PyObject *__pyx_v_bpoly = NULL;
  PyObject *__pyx_v_copl = NULL;
  PyObject *__pyx_v_aInsideB = NULL;
  PyObject *__pyx_v_bInsideA = NULL;
  PyObject *__pyx_v_aInterB = NULL;
  PyObject *__pyx_v_points = NULL;
  PyObject *__pyx_v_polygon = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  Py_ssize_t __pyx_t_6;
  Py_ssize_t __pyx_t_7;
  Py_ssize_t __pyx_t_8;
  Py_ssize_t __pyx_t_9;
  Py_ssize_t __pyx_t_10;
  Py_ssize_t __pyx_t_11;
  int __pyx_t_12;
  int __pyx_t_13;
  int __pyx_t_14;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("coplanarIntersection", 0);

  /* "pyg4ometry/pycsg/core.pyx":348
   *         # print 'pycsg.core.coplanarIntersection>'
   *
   *         absp = BSPNode(self.clone().polygons)             # <<<<<<<<<<<<<<
   *         bbsp = BSPNode(csg.clone().polygons)
   *
   */
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_BSPNode);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 348, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_clone);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 348, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 348, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_polygons);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 348, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_4)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 348, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_absp = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":349
   *
   *         absp = BSPNode(self.clone().polygons)
   *         bbsp = BSPNode(csg.clone().polygons)             # <<<<<<<<<<<<<<
   *
   *         apolygons = absp.allPolygons()
   */
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_BSPNode);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 349, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_csg, __pyx_n_s_clone);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 349, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_5)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 349, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_polygons);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 349, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_4)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 349, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_bbsp = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":351
   *         bbsp = BSPNode(csg.clone().polygons)
   *
   *         apolygons = absp.allPolygons()             # <<<<<<<<<<<<<<
   *         bpolygons = bbsp.allPolygons()
   *
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_absp, __pyx_n_s_allPolygons);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 351, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 351, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_apolygons = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":352
   *
   *         apolygons = absp.allPolygons()
   *         bpolygons = bbsp.allPolygons()             # <<<<<<<<<<<<<<
   *
   *         polygons = []
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_bbsp, __pyx_n_s_allPolygons);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 352, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 352, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_bpolygons = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":354
   *         bpolygons = bbsp.allPolygons()
   *
   *         polygons = []             # <<<<<<<<<<<<<<
   *
   *         def coplanarPolys(apoly,bpoly) :
   */
  __pyx_t_1 = PyList_New(0);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 354, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_polygons = ((PyObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":356
   *         polygons = []
   *
   *         def coplanarPolys(apoly,bpoly) :             # <<<<<<<<<<<<<<
   *             COPLANAR = 0  # all the vertices are within EPSILON distance
   * from plane FRONT = 1  # all the vertices are in front of the plane
   */
  __pyx_t_1 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_1coplanarPolys,
      0, __pyx_n_s_CSG_coplanarIntersection_locals, NULL,
      __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d, ((PyObject *)__pyx_codeobj__7));
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 356, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_coplanarPolys = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":371
   *                 return False
   *
   *         def polyVertsInside(apoly, bpoly):             # <<<<<<<<<<<<<<
   *
   *             aplane = apoly.plane
   */
  __pyx_t_1 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_3polyVertsInside,
      0, __pyx_n_s_CSG_coplanarIntersection_locals_2, NULL,
      __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d, ((PyObject *)__pyx_codeobj__9));
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 371, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_polyVertsInside = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":399
   *             return vertsInside
   *
   *         def polyEdgeIntersection(apoly, bpoly) :             #
   * <<<<<<<<<<<<<<
   *
   *             vertsInter = []
   */
  __pyx_t_1 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_5polyEdgeIntersection,
      0, __pyx_n_s_CSG_coplanarIntersection_locals_3, NULL,
      __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
      ((PyObject *)__pyx_codeobj__11));
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 399, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_polyEdgeIntersection = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":434
   *             return vertsInter
   *
   *         def convexHull(positions,normal) :             # <<<<<<<<<<<<<<
   *
   *             if len(positions) < 3 :
   */
  __pyx_t_1 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_7convexHull,
      0, __pyx_n_s_CSG_coplanarIntersection_locals_4, NULL,
      __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
      ((PyObject *)__pyx_codeobj__13));
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 434, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_convexHull = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":472
   *             return Polygon(v)
   *
   *         for i in range(0,len(apolygons),1):                     # loop over
   * all A polygons             # <<<<<<<<<<<<<< apoly  = apolygons[i] for j in
   * range(0,len(bpolygons),1):                 # loop over all B polygons
   */
  __pyx_t_6 = PyObject_Length(__pyx_v_apolygons);
  if (unlikely(__pyx_t_6 == ((Py_ssize_t)-1)))
    __PYX_ERR(0, 472, __pyx_L1_error)
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 < __pyx_t_7; __pyx_t_8 += 1) {
    __pyx_v_i = __pyx_t_8;

    /* "pyg4ometry/pycsg/core.pyx":473
     *
     *         for i in range(0,len(apolygons),1):                     # loop
     * over all A polygons apoly  = apolygons[i]             # <<<<<<<<<<<<<<
     *             for j in range(0,len(bpolygons),1):                 # loop
     * over all B polygons bpoly = bpolygons[j]
     */
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_apolygons, __pyx_v_i, Py_ssize_t, 1,
                                 PyInt_FromSsize_t, 0, 1, 1);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 473, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_XDECREF_SET(__pyx_v_apoly, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "pyg4ometry/pycsg/core.pyx":474
     *         for i in range(0,len(apolygons),1):                     # loop
     * over all A polygons apoly  = apolygons[i] for j in
     * range(0,len(bpolygons),1):                 # loop over all B polygons #
     * <<<<<<<<<<<<<< bpoly = bpolygons[j]
     *
     */
    __pyx_t_9 = PyObject_Length(__pyx_v_bpolygons);
    if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1)))
      __PYX_ERR(0, 474, __pyx_L1_error)
    __pyx_t_10 = __pyx_t_9;
    for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_10; __pyx_t_11 += 1) {
      __pyx_v_j = __pyx_t_11;

      /* "pyg4ometry/pycsg/core.pyx":475
       *             apoly  = apolygons[i]
       *             for j in range(0,len(bpolygons),1):                 # loop
       * over all B polygons bpoly = bpolygons[j]             # <<<<<<<<<<<<<<
       *
       *                 copl  = coplanarPolys(apoly,bpoly)
       */
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_bpolygons, __pyx_v_j, Py_ssize_t, 1,
                                   PyInt_FromSsize_t, 0, 1, 1);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 475, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_XDECREF_SET(__pyx_v_bpoly, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":477
       *                 bpoly = bpolygons[j]
       *
       *                 copl  = coplanarPolys(apoly,bpoly)             #
       * <<<<<<<<<<<<<<
       *
       *                 if not copl :
       */
      __pyx_t_1 =
          __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_coplanarPolys(
              __pyx_v_coplanarPolys, __pyx_v_apoly, __pyx_v_bpoly);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 477, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_XDECREF_SET(__pyx_v_copl, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":479
       *                 copl  = coplanarPolys(apoly,bpoly)
       *
       *                 if not copl :             # <<<<<<<<<<<<<<
       *                     continue
       *
       */
      __pyx_t_12 = __Pyx_PyObject_IsTrue(__pyx_v_copl);
      if (unlikely(__pyx_t_12 < 0))
        __PYX_ERR(0, 479, __pyx_L1_error)
      __pyx_t_13 = ((!__pyx_t_12) != 0);
      if (__pyx_t_13) {

        /* "pyg4ometry/pycsg/core.pyx":480
         *
         *                 if not copl :
         *                     continue             # <<<<<<<<<<<<<<
         *
         *                 aInsideB = polyVertsInside(apoly,bpoly)
         */
        goto __pyx_L5_continue;

        /* "pyg4ometry/pycsg/core.pyx":479
         *                 copl  = coplanarPolys(apoly,bpoly)
         *
         *                 if not copl :             # <<<<<<<<<<<<<<
         *                     continue
         *
         */
      }

      /* "pyg4ometry/pycsg/core.pyx":482
       *                     continue
       *
       *                 aInsideB = polyVertsInside(apoly,bpoly)             #
       * <<<<<<<<<<<<<< bInsideA = polyVertsInside(bpoly,apoly) aInterB  =
       * polyEdgeIntersection(apoly,bpoly)
       */
      __pyx_t_1 =
          __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_2polyVertsInside(
              __pyx_v_polyVertsInside, __pyx_v_apoly, __pyx_v_bpoly);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 482, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_XDECREF_SET(__pyx_v_aInsideB, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":483
       *
       *                 aInsideB = polyVertsInside(apoly,bpoly)
       *                 bInsideA = polyVertsInside(bpoly,apoly)             #
       * <<<<<<<<<<<<<< aInterB  = polyEdgeIntersection(apoly,bpoly)
       *
       */
      __pyx_t_1 =
          __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_2polyVertsInside(
              __pyx_v_polyVertsInside, __pyx_v_bpoly, __pyx_v_apoly);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 483, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_XDECREF_SET(__pyx_v_bInsideA, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":484
       *                 aInsideB = polyVertsInside(apoly,bpoly)
       *                 bInsideA = polyVertsInside(bpoly,apoly)
       *                 aInterB  = polyEdgeIntersection(apoly,bpoly) #
       * <<<<<<<<<<<<<<
       *
       *                 #if len(aInsideB) != 0 and len(bInsideA) != 0 and
       * len(aInterB) != 0 :
       */
      __pyx_t_1 =
          __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_4polyEdgeIntersection(
              __pyx_v_polyEdgeIntersection, __pyx_v_apoly, __pyx_v_bpoly);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 484, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_XDECREF_SET(__pyx_v_aInterB, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":492
       *                 #    print len(aInsideB),len(bInsideA),len(aInterB)
       *
       *                 points = []             # <<<<<<<<<<<<<<
       *                 points.extend(aInsideB)
       *                 points.extend(bInsideA)
       */
      __pyx_t_1 = PyList_New(0);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 492, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_XDECREF_SET(__pyx_v_points, ((PyObject *)__pyx_t_1));
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":493
       *
       *                 points = []
       *                 points.extend(aInsideB)             # <<<<<<<<<<<<<<
       *                 points.extend(bInsideA)
       *                 points.extend(aInterB)
       */
      __pyx_t_14 = __Pyx_PyList_Extend(__pyx_v_points, __pyx_v_aInsideB);
      if (unlikely(__pyx_t_14 == ((int)-1)))
        __PYX_ERR(0, 493, __pyx_L1_error)

      /* "pyg4ometry/pycsg/core.pyx":494
       *                 points = []
       *                 points.extend(aInsideB)
       *                 points.extend(bInsideA)             # <<<<<<<<<<<<<<
       *                 points.extend(aInterB)
       *
       */
      __pyx_t_14 = __Pyx_PyList_Extend(__pyx_v_points, __pyx_v_bInsideA);
      if (unlikely(__pyx_t_14 == ((int)-1)))
        __PYX_ERR(0, 494, __pyx_L1_error)

      /* "pyg4ometry/pycsg/core.pyx":495
       *                 points.extend(aInsideB)
       *                 points.extend(bInsideA)
       *                 points.extend(aInterB)             # <<<<<<<<<<<<<<
       *
       *                 polygon  = convexHull(points,bpoly.plane.normal)
       */
      __pyx_t_14 = __Pyx_PyList_Extend(__pyx_v_points, __pyx_v_aInterB);
      if (unlikely(__pyx_t_14 == ((int)-1)))
        __PYX_ERR(0, 495, __pyx_L1_error)

      /* "pyg4ometry/pycsg/core.pyx":497
       *                 points.extend(aInterB)
       *
       *                 polygon  = convexHull(points,bpoly.plane.normal) #
       * <<<<<<<<<<<<<< if polygon : polygons.append(polygon)
       */
      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_bpoly, __pyx_n_s_plane);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 497, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_normal);
      if (unlikely(!__pyx_t_2))
        __PYX_ERR(0, 497, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_1 =
          __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_20coplanarIntersection_6convexHull(
              __pyx_v_convexHull, __pyx_v_points, __pyx_t_2);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 497, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_2);
      __pyx_t_2 = 0;
      __Pyx_XDECREF_SET(__pyx_v_polygon, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":498
       *
       *                 polygon  = convexHull(points,bpoly.plane.normal)
       *                 if polygon :             # <<<<<<<<<<<<<<
       *                     polygons.append(polygon)
       *                 #else :
       */
      __pyx_t_13 = __Pyx_PyObject_IsTrue(__pyx_v_polygon);
      if (unlikely(__pyx_t_13 < 0))
        __PYX_ERR(0, 498, __pyx_L1_error)
      if (__pyx_t_13) {

        /* "pyg4ometry/pycsg/core.pyx":499
         *                 polygon  = convexHull(points,bpoly.plane.normal)
         *                 if polygon :
         *                     polygons.append(polygon)             #
         * <<<<<<<<<<<<<< #else : #    polygons.append(bpoly)
         */
        __pyx_t_14 = __Pyx_PyList_Append(__pyx_v_polygons, __pyx_v_polygon);
        if (unlikely(__pyx_t_14 == ((int)-1)))
          __PYX_ERR(0, 499, __pyx_L1_error)

        /* "pyg4ometry/pycsg/core.pyx":498
         *
         *                 polygon  = convexHull(points,bpoly.plane.normal)
         *                 if polygon :             # <<<<<<<<<<<<<<
         *                     polygons.append(polygon)
         *                 #else :
         */
      }
    __pyx_L5_continue:;
    }
  }

  /* "pyg4ometry/pycsg/core.pyx":502
   *                 #else :
   *                 #    polygons.append(bpoly)
   *         return CSG.fromPolygons(polygons)             # <<<<<<<<<<<<<<
   *
   *     def coplanar(self, csg):
   */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_CSG);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 502, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_fromPolygons);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 502, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  __pyx_t_1 =
      (__pyx_t_2)
          ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_v_polygons)
          : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_polygons);
  __Pyx_XDECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 502, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":345
 *         return CSG.fromPolygons(a.allPolygons())
 *
 *     def coplanarIntersection(self, csg):             # <<<<<<<<<<<<<<
 *         # print 'pycsg.core.coplanarIntersection>'
 *
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.coplanarIntersection",
                     __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XDECREF(__pyx_v_absp);
  __Pyx_XDECREF(__pyx_v_bbsp);
  __Pyx_XDECREF(__pyx_v_apolygons);
  __Pyx_XDECREF(__pyx_v_bpolygons);
  __Pyx_XDECREF(__pyx_v_polygons);
  __Pyx_XDECREF(__pyx_v_coplanarPolys);
  __Pyx_XDECREF(__pyx_v_polyVertsInside);
  __Pyx_XDECREF(__pyx_v_polyEdgeIntersection);
  __Pyx_XDECREF(__pyx_v_convexHull);
  __Pyx_XDECREF(__pyx_v_apoly);
  __Pyx_XDECREF(__pyx_v_bpoly);
  __Pyx_XDECREF(__pyx_v_copl);
  __Pyx_XDECREF(__pyx_v_aInsideB);
  __Pyx_XDECREF(__pyx_v_bInsideA);
  __Pyx_XDECREF(__pyx_v_aInterB);
  __Pyx_XDECREF(__pyx_v_points);
  __Pyx_XDECREF(__pyx_v_polygon);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":504
 *         return CSG.fromPolygons(polygons)
 *
 *     def coplanar(self, csg):             # <<<<<<<<<<<<<<
 *
 *         absp = BSPNode(self.clone().polygons)
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_41coplanar(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_41coplanar = {
    "coplanar",
    (PyCFunction)(void *)(PyCFunctionWithKeywords)
        __pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_41coplanar,
    METH_VARARGS | METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_41coplanar(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_self = 0;
  PyObject *__pyx_v_csg = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext("coplanar (wrapper)",
                                                        0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self, &__pyx_n_s_csg, 0};
    PyObject *values[2] = {0, 0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
      case 2:
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
      case 1:
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
      case 0:
        break;
      default:
        goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
      case 0:
        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_self)) != 0))
          kw_args--;
        else
          goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
      case 1:
        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_csg)) != 0))
          kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("coplanar", 1, 2, 2, 1);
          __PYX_ERR(0, 504, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames,
                                                 0, values, pos_args,
                                                 "coplanar") < 0))
          __PYX_ERR(0, 504, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_self = values[0];
    __pyx_v_csg = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
__pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("coplanar", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args));
  __PYX_ERR(0, 504, __pyx_L3_error)
__pyx_L3_error:;
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.coplanar", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
__pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_40coplanar(
      __pyx_self, __pyx_v_self, __pyx_v_csg);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_40coplanar(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self,
    PyObject *__pyx_v_csg) {
  PyObject *__pyx_v_absp = NULL;
  PyObject *__pyx_v_bbsp = NULL;
  PyObject *__pyx_v_apolygons = NULL;
  PyObject *__pyx_v_bpolygons = NULL;
  long __pyx_v_COPLANAR;
  long __pyx_v_FRONT;
  long __pyx_v_BACK;
  PyObject *__pyx_v_a = NULL;
  PyObject *__pyx_v_apoly = NULL;
  PyObject *__pyx_v_aplane = NULL;
  PyObject *__pyx_v_bpoly = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_bplane = NULL;
  PyObject *__pyx_v_polygonType = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_t = NULL;
  PyObject *__pyx_v_loc = NULL;
  int __pyx_v_aAdd;
  PyObject *__pyx_v_ploc = NULL;
  PyObject *__pyx_v_bv = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_bvOnA = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_bpOnA = NULL;
  PyObject *__pyx_v_j = NULL;
  PyObject *__pyx_v_av = NULL;
  PyObject *__pyx_v_avunit = NULL;
  PyObject *__pyx_v_anormal = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  Py_ssize_t __pyx_t_6;
  PyObject *(*__pyx_t_7)(PyObject *);
  Py_ssize_t __pyx_t_8;
  PyObject *(*__pyx_t_9)(PyObject *);
  Py_ssize_t __pyx_t_10;
  PyObject *(*__pyx_t_11)(PyObject *);
  PyObject *__pyx_t_12 = NULL;
  PyObject *__pyx_t_13 = NULL;
  int __pyx_t_14;
  Py_ssize_t __pyx_t_15;
  PyObject *(*__pyx_t_16)(PyObject *);
  Py_ssize_t __pyx_t_17;
  PyObject *__pyx_t_18 = NULL;
  int __pyx_t_19;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("coplanar", 0);

  /* "pyg4ometry/pycsg/core.pyx":506
   *     def coplanar(self, csg):
   *
   *         absp = BSPNode(self.clone().polygons)             # <<<<<<<<<<<<<<
   *         bbsp = BSPNode(csg.clone().polygons)
   *
   */
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_BSPNode);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 506, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_clone);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 506, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 506, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_polygons);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 506, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_4)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 506, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_absp = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":507
   *
   *         absp = BSPNode(self.clone().polygons)
   *         bbsp = BSPNode(csg.clone().polygons)             # <<<<<<<<<<<<<<
   *
   *         apolygons = absp.allPolygons()
   */
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_BSPNode);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 507, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_csg, __pyx_n_s_clone);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 507, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_5)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 507, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_polygons);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 507, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_4)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 507, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_bbsp = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":509
   *         bbsp = BSPNode(csg.clone().polygons)
   *
   *         apolygons = absp.allPolygons()             # <<<<<<<<<<<<<<
   *         bpolygons = bbsp.allPolygons()
   *
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_absp, __pyx_n_s_allPolygons);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 509, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 509, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_apolygons = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":510
   *
   *         apolygons = absp.allPolygons()
   *         bpolygons = bbsp.allPolygons()             # <<<<<<<<<<<<<<
   *
   *
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_bbsp, __pyx_n_s_allPolygons);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 510, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 510, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_bpolygons = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":513
   *
   *
   *         COPLANAR = 0 # all the vertices are within EPSILON distance from
   * plane             # <<<<<<<<<<<<<< FRONT    = 1 # all the vertices are in
   * front of the plane BACK     = 2 # all the vertices are at the back of the
   * plane
   */
  __pyx_v_COPLANAR = 0;

  /* "pyg4ometry/pycsg/core.pyx":514
   *
   *         COPLANAR = 0 # all the vertices are within EPSILON distance from
   * plane FRONT    = 1 # all the vertices are in front of the plane #
   * <<<<<<<<<<<<<< BACK     = 2 # all the vertices are at the back of the plane
   *
   */
  __pyx_v_FRONT = 1;

  /* "pyg4ometry/pycsg/core.pyx":515
   *         COPLANAR = 0 # all the vertices are within EPSILON distance from
   * plane FRONT    = 1 # all the vertices are in front of the plane BACK     =
   * 2 # all the vertices are at the back of the plane             #
   * <<<<<<<<<<<<<<
   *
   *         a = []
   */
  __pyx_v_BACK = 2;

  /* "pyg4ometry/pycsg/core.pyx":517
   *         BACK     = 2 # all the vertices are at the back of the plane
   *
   *         a = []             # <<<<<<<<<<<<<<
   *
   *         #for apoly in apolygons :
   */
  __pyx_t_1 = PyList_New(0);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 517, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_a = ((PyObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":534
   *
   *         # loop over all A polygons
   *         for apoly in apolygons :             # <<<<<<<<<<<<<<
   *             aplane = apoly.plane
   *             for bpoly in bpolygons :
   */
  if (likely(PyList_CheckExact(__pyx_v_apolygons)) ||
      PyTuple_CheckExact(__pyx_v_apolygons)) {
    __pyx_t_1 = __pyx_v_apolygons;
    __Pyx_INCREF(__pyx_t_1);
    __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1;
    __pyx_t_1 = PyObject_GetIter(__pyx_v_apolygons);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 534, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_7 = Py_TYPE(__pyx_t_1)->tp_iternext;
    if (unlikely(!__pyx_t_7))
      __PYX_ERR(0, 534, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_1))
          break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_6);
        __Pyx_INCREF(__pyx_t_2);
        __pyx_t_6++;
        if (unlikely(0 < 0))
          __PYX_ERR(0, 534, __pyx_L1_error)
#else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_6);
        __pyx_t_6++;
        if (unlikely(!__pyx_t_2))
          __PYX_ERR(0, 534, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
#endif
      } else {
        if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_1))
          break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_6);
        __Pyx_INCREF(__pyx_t_2);
        __pyx_t_6++;
        if (unlikely(0 < 0))
          __PYX_ERR(0, 534, __pyx_L1_error)
#else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_6);
        __pyx_t_6++;
        if (unlikely(!__pyx_t_2))
          __PYX_ERR(0, 534, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
#endif
      }
    } else {
      __pyx_t_2 = __pyx_t_7(__pyx_t_1);
      if (unlikely(!__pyx_t_2)) {
        PyObject *exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type,
                                                       PyExc_StopIteration)))
            PyErr_Clear();
          else
            __PYX_ERR(0, 534, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_XDECREF_SET(__pyx_v_apoly, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "pyg4ometry/pycsg/core.pyx":535
     *         # loop over all A polygons
     *         for apoly in apolygons :
     *             aplane = apoly.plane             # <<<<<<<<<<<<<<
     *             for bpoly in bpolygons :
     *                 bplane = bpoly.plane
     */
    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_apoly, __pyx_n_s_plane);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 535, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_XDECREF_SET(__pyx_v_aplane, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "pyg4ometry/pycsg/core.pyx":536
     *         for apoly in apolygons :
     *             aplane = apoly.plane
     *             for bpoly in bpolygons :             # <<<<<<<<<<<<<<
     *                 bplane = bpoly.plane
     *
     */
    if (likely(PyList_CheckExact(__pyx_v_bpolygons)) ||
        PyTuple_CheckExact(__pyx_v_bpolygons)) {
      __pyx_t_2 = __pyx_v_bpolygons;
      __Pyx_INCREF(__pyx_t_2);
      __pyx_t_8 = 0;
      __pyx_t_9 = NULL;
    } else {
      __pyx_t_8 = -1;
      __pyx_t_2 = PyObject_GetIter(__pyx_v_bpolygons);
      if (unlikely(!__pyx_t_2))
        __PYX_ERR(0, 536, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_9 = Py_TYPE(__pyx_t_2)->tp_iternext;
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 536, __pyx_L1_error)
    }
    for (;;) {
      if (likely(!__pyx_t_9)) {
        if (likely(PyList_CheckExact(__pyx_t_2))) {
          if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_2))
            break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_3 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_8);
          __Pyx_INCREF(__pyx_t_3);
          __pyx_t_8++;
          if (unlikely(0 < 0))
            __PYX_ERR(0, 536, __pyx_L1_error)
#else
          __pyx_t_3 = PySequence_ITEM(__pyx_t_2, __pyx_t_8);
          __pyx_t_8++;
          if (unlikely(!__pyx_t_3))
            __PYX_ERR(0, 536, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
#endif
        } else {
          if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_2))
            break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_8);
          __Pyx_INCREF(__pyx_t_3);
          __pyx_t_8++;
          if (unlikely(0 < 0))
            __PYX_ERR(0, 536, __pyx_L1_error)
#else
          __pyx_t_3 = PySequence_ITEM(__pyx_t_2, __pyx_t_8);
          __pyx_t_8++;
          if (unlikely(!__pyx_t_3))
            __PYX_ERR(0, 536, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
#endif
        }
      } else {
        __pyx_t_3 = __pyx_t_9(__pyx_t_2);
        if (unlikely(!__pyx_t_3)) {
          PyObject *exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type,
                                                         PyExc_StopIteration)))
              PyErr_Clear();
            else
              __PYX_ERR(0, 536, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_3);
      }
      __Pyx_XDECREF_SET(__pyx_v_bpoly, __pyx_t_3);
      __pyx_t_3 = 0;

      /* "pyg4ometry/pycsg/core.pyx":537
       *             aplane = apoly.plane
       *             for bpoly in bpolygons :
       *                 bplane = bpoly.plane             # <<<<<<<<<<<<<<
       *
       *                 # check if B polygon is coplanar
       */
      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_bpoly, __pyx_n_s_plane);
      if (unlikely(!__pyx_t_3))
        __PYX_ERR(0, 537, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_XDECREF_SET(__pyx_v_bplane, __pyx_t_3);
      __pyx_t_3 = 0;

      /* "pyg4ometry/pycsg/core.pyx":540
       *
       *                 # check if B polygon is coplanar
       *                 polygonType = 0             # <<<<<<<<<<<<<<
       *                 for i in range(len(bpoly.vertices)) :
       *                     t = aplane.normal.dot(bpoly.vertices[i].pos) -
       * aplane.w
       */
      __Pyx_INCREF(__pyx_int_0);
      __Pyx_XDECREF_SET(__pyx_v_polygonType, __pyx_int_0);

      /* "pyg4ometry/pycsg/core.pyx":541
       *                 # check if B polygon is coplanar
       *                 polygonType = 0
       *                 for i in range(len(bpoly.vertices)) :             #
       * <<<<<<<<<<<<<< t = aplane.normal.dot(bpoly.vertices[i].pos) - aplane.w
       *                     loc = -1
       */
      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_bpoly, __pyx_n_s_vertices);
      if (unlikely(!__pyx_t_3))
        __PYX_ERR(0, 541, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_10 = PyObject_Length(__pyx_t_3);
      if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1)))
        __PYX_ERR(0, 541, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_10);
      if (unlikely(!__pyx_t_3))
        __PYX_ERR(0, 541, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_3);
      if (unlikely(!__pyx_t_4))
        __PYX_ERR(0, 541, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_3);
      __pyx_t_3 = 0;
      if (likely(PyList_CheckExact(__pyx_t_4)) ||
          PyTuple_CheckExact(__pyx_t_4)) {
        __pyx_t_3 = __pyx_t_4;
        __Pyx_INCREF(__pyx_t_3);
        __pyx_t_10 = 0;
        __pyx_t_11 = NULL;
      } else {
        __pyx_t_10 = -1;
        __pyx_t_3 = PyObject_GetIter(__pyx_t_4);
        if (unlikely(!__pyx_t_3))
          __PYX_ERR(0, 541, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_11 = Py_TYPE(__pyx_t_3)->tp_iternext;
        if (unlikely(!__pyx_t_11))
          __PYX_ERR(0, 541, __pyx_L1_error)
      }
      __Pyx_DECREF(__pyx_t_4);
      __pyx_t_4 = 0;
      for (;;) {
        if (likely(!__pyx_t_11)) {
          if (likely(PyList_CheckExact(__pyx_t_3))) {
            if (__pyx_t_10 >= PyList_GET_SIZE(__pyx_t_3))
              break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_4 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_10);
            __Pyx_INCREF(__pyx_t_4);
            __pyx_t_10++;
            if (unlikely(0 < 0))
              __PYX_ERR(0, 541, __pyx_L1_error)
#else
            __pyx_t_4 = PySequence_ITEM(__pyx_t_3, __pyx_t_10);
            __pyx_t_10++;
            if (unlikely(!__pyx_t_4))
              __PYX_ERR(0, 541, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
#endif
          } else {
            if (__pyx_t_10 >= PyTuple_GET_SIZE(__pyx_t_3))
              break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_10);
            __Pyx_INCREF(__pyx_t_4);
            __pyx_t_10++;
            if (unlikely(0 < 0))
              __PYX_ERR(0, 541, __pyx_L1_error)
#else
            __pyx_t_4 = PySequence_ITEM(__pyx_t_3, __pyx_t_10);
            __pyx_t_10++;
            if (unlikely(!__pyx_t_4))
              __PYX_ERR(0, 541, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
#endif
          }
        } else {
          __pyx_t_4 = __pyx_t_11(__pyx_t_3);
          if (unlikely(!__pyx_t_4)) {
            PyObject *exc_type = PyErr_Occurred();
            if (exc_type) {
              if (likely(__Pyx_PyErr_GivenExceptionMatches(
                      exc_type, PyExc_StopIteration)))
                PyErr_Clear();
              else
                __PYX_ERR(0, 541, __pyx_L1_error)
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_4);
        }
        __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_4);
        __pyx_t_4 = 0;

        /* "pyg4ometry/pycsg/core.pyx":542
         *                 polygonType = 0
         *                 for i in range(len(bpoly.vertices)) :
         *                     t = aplane.normal.dot(bpoly.vertices[i].pos) -
         * aplane.w             # <<<<<<<<<<<<<< loc = -1
         *
         */
        __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_aplane, __pyx_n_s_normal);
        if (unlikely(!__pyx_t_5))
          __PYX_ERR(0, 542, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_dot);
        if (unlikely(!__pyx_t_12))
          __PYX_ERR(0, 542, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_DECREF(__pyx_t_5);
        __pyx_t_5 = 0;
        __pyx_t_5 =
            __Pyx_PyObject_GetAttrStr(__pyx_v_bpoly, __pyx_n_s_vertices);
        if (unlikely(!__pyx_t_5))
          __PYX_ERR(0, 542, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        __pyx_t_13 = __Pyx_PyObject_GetItem(__pyx_t_5, __pyx_v_i);
        if (unlikely(!__pyx_t_13))
          __PYX_ERR(0, 542, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_13);
        __Pyx_DECREF(__pyx_t_5);
        __pyx_t_5 = 0;
        __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_pos);
        if (unlikely(!__pyx_t_5))
          __PYX_ERR(0, 542, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_DECREF(__pyx_t_13);
        __pyx_t_13 = 0;
        __pyx_t_13 = NULL;
        if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_12))) {
          __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_12);
          if (likely(__pyx_t_13)) {
            PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_12);
            __Pyx_INCREF(__pyx_t_13);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_12, function);
          }
        }
        __pyx_t_4 =
            (__pyx_t_13)
                ? __Pyx_PyObject_Call2Args(__pyx_t_12, __pyx_t_13, __pyx_t_5)
                : __Pyx_PyObject_CallOneArg(__pyx_t_12, __pyx_t_5);
        __Pyx_XDECREF(__pyx_t_13);
        __pyx_t_13 = 0;
        __Pyx_DECREF(__pyx_t_5);
        __pyx_t_5 = 0;
        if (unlikely(!__pyx_t_4))
          __PYX_ERR(0, 542, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_DECREF(__pyx_t_12);
        __pyx_t_12 = 0;
        __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_v_aplane, __pyx_n_s_w);
        if (unlikely(!__pyx_t_12))
          __PYX_ERR(0, 542, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __pyx_t_5 = PyNumber_Subtract(__pyx_t_4, __pyx_t_12);
        if (unlikely(!__pyx_t_5))
          __PYX_ERR(0, 542, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_DECREF(__pyx_t_4);
        __pyx_t_4 = 0;
        __Pyx_DECREF(__pyx_t_12);
        __pyx_t_12 = 0;
        __Pyx_XDECREF_SET(__pyx_v_t, __pyx_t_5);
        __pyx_t_5 = 0;

        /* "pyg4ometry/pycsg/core.pyx":543
         *                 for i in range(len(bpoly.vertices)) :
         *                     t = aplane.normal.dot(bpoly.vertices[i].pos) -
         * aplane.w loc = -1             # <<<<<<<<<<<<<<
         *
         *                     if t < -1e-8 :
         */
        __Pyx_INCREF(__pyx_int_neg_1);
        __Pyx_XDECREF_SET(__pyx_v_loc, __pyx_int_neg_1);

        /* "pyg4ometry/pycsg/core.pyx":545
         *                     loc = -1
         *
         *                     if t < -1e-8 :             # <<<<<<<<<<<<<<
         *                         loc = BACK
         *                     elif t > 1e-8 :
         */
        __pyx_t_5 =
            PyObject_RichCompare(__pyx_v_t, __pyx_float_neg_1eneg_8, Py_LT);
        __Pyx_XGOTREF(__pyx_t_5);
        if (unlikely(!__pyx_t_5))
          __PYX_ERR(0, 545, __pyx_L1_error)
        __pyx_t_14 = __Pyx_PyObject_IsTrue(__pyx_t_5);
        if (unlikely(__pyx_t_14 < 0))
          __PYX_ERR(0, 545, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_5);
        __pyx_t_5 = 0;
        if (__pyx_t_14) {

          /* "pyg4ometry/pycsg/core.pyx":546
           *
           *                     if t < -1e-8 :
           *                         loc = BACK             # <<<<<<<<<<<<<<
           *                     elif t > 1e-8 :
           *                         loc = FRONT
           */
          __pyx_t_5 = __Pyx_PyInt_From_long(__pyx_v_BACK);
          if (unlikely(!__pyx_t_5))
            __PYX_ERR(0, 546, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          __Pyx_DECREF_SET(__pyx_v_loc, __pyx_t_5);
          __pyx_t_5 = 0;

          /* "pyg4ometry/pycsg/core.pyx":545
           *                     loc = -1
           *
           *                     if t < -1e-8 :             # <<<<<<<<<<<<<<
           *                         loc = BACK
           *                     elif t > 1e-8 :
           */
          goto __pyx_L9;
        }

        /* "pyg4ometry/pycsg/core.pyx":547
         *                     if t < -1e-8 :
         *                         loc = BACK
         *                     elif t > 1e-8 :             # <<<<<<<<<<<<<<
         *                         loc = FRONT
         *                     else :
         */
        __pyx_t_5 = PyObject_RichCompare(__pyx_v_t, __pyx_float_1eneg_8, Py_GT);
        __Pyx_XGOTREF(__pyx_t_5);
        if (unlikely(!__pyx_t_5))
          __PYX_ERR(0, 547, __pyx_L1_error)
        __pyx_t_14 = __Pyx_PyObject_IsTrue(__pyx_t_5);
        if (unlikely(__pyx_t_14 < 0))
          __PYX_ERR(0, 547, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_5);
        __pyx_t_5 = 0;
        if (__pyx_t_14) {

          /* "pyg4ometry/pycsg/core.pyx":548
           *                         loc = BACK
           *                     elif t > 1e-8 :
           *                         loc = FRONT             # <<<<<<<<<<<<<<
           *                     else :
           *                         loc = COPLANAR
           */
          __pyx_t_5 = __Pyx_PyInt_From_long(__pyx_v_FRONT);
          if (unlikely(!__pyx_t_5))
            __PYX_ERR(0, 548, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          __Pyx_DECREF_SET(__pyx_v_loc, __pyx_t_5);
          __pyx_t_5 = 0;

          /* "pyg4ometry/pycsg/core.pyx":547
           *                     if t < -1e-8 :
           *                         loc = BACK
           *                     elif t > 1e-8 :             # <<<<<<<<<<<<<<
           *                         loc = FRONT
           *                     else :
           */
          goto __pyx_L9;
        }

        /* "pyg4ometry/pycsg/core.pyx":550
         *                         loc = FRONT
         *                     else :
         *                         loc = COPLANAR             # <<<<<<<<<<<<<<
         *                     polygonType |= loc
         *
         */
        /*else*/ {
          __pyx_t_5 = __Pyx_PyInt_From_long(__pyx_v_COPLANAR);
          if (unlikely(!__pyx_t_5))
            __PYX_ERR(0, 550, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          __Pyx_DECREF_SET(__pyx_v_loc, __pyx_t_5);
          __pyx_t_5 = 0;
        }
      __pyx_L9:;

        /* "pyg4ometry/pycsg/core.pyx":551
         *                     else :
         *                         loc = COPLANAR
         *                     polygonType |= loc             # <<<<<<<<<<<<<<
         *
         *                 # if coplanar do a interior/exterior check
         */
        __pyx_t_5 = PyNumber_InPlaceOr(__pyx_v_polygonType, __pyx_v_loc);
        if (unlikely(!__pyx_t_5))
          __PYX_ERR(0, 551, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_DECREF_SET(__pyx_v_polygonType, __pyx_t_5);
        __pyx_t_5 = 0;

        /* "pyg4ometry/pycsg/core.pyx":541
         *                 # check if B polygon is coplanar
         *                 polygonType = 0
         *                 for i in range(len(bpoly.vertices)) :             #
         * <<<<<<<<<<<<<< t = aplane.normal.dot(bpoly.vertices[i].pos) -
         * aplane.w loc = -1
         */
      }
      __Pyx_DECREF(__pyx_t_3);
      __pyx_t_3 = 0;

      /* "pyg4ometry/pycsg/core.pyx":554
       *
       *                 # if coplanar do a interior/exterior check
       *                 if polygonType == COPLANAR :             #
       * <<<<<<<<<<<<<<
       *
       *                     aAdd = False
       */
      __pyx_t_3 = __Pyx_PyInt_From_long(__pyx_v_COPLANAR);
      if (unlikely(!__pyx_t_3))
        __PYX_ERR(0, 554, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_5 = PyObject_RichCompare(__pyx_v_polygonType, __pyx_t_3, Py_EQ);
      __Pyx_XGOTREF(__pyx_t_5);
      if (unlikely(!__pyx_t_5))
        __PYX_ERR(0, 554, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_14 = __Pyx_PyObject_IsTrue(__pyx_t_5);
      if (unlikely(__pyx_t_14 < 0))
        __PYX_ERR(0, 554, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_5);
      __pyx_t_5 = 0;
      if (__pyx_t_14) {

        /* "pyg4ometry/pycsg/core.pyx":556
         *                 if polygonType == COPLANAR :
         *
         *                     aAdd = False             # <<<<<<<<<<<<<<
         *
         *                     for i in range(len(bpoly.vertices)) :
         */
        __pyx_v_aAdd = 0;

        /* "pyg4ometry/pycsg/core.pyx":558
         *                     aAdd = False
         *
         *                     for i in range(len(bpoly.vertices)) : #
         * <<<<<<<<<<<<<< ploc = 0
         *
         */
        __pyx_t_5 =
            __Pyx_PyObject_GetAttrStr(__pyx_v_bpoly, __pyx_n_s_vertices);
        if (unlikely(!__pyx_t_5))
          __PYX_ERR(0, 558, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        __pyx_t_10 = PyObject_Length(__pyx_t_5);
        if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1)))
          __PYX_ERR(0, 558, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_5);
        __pyx_t_5 = 0;
        __pyx_t_5 = PyInt_FromSsize_t(__pyx_t_10);
        if (unlikely(!__pyx_t_5))
          __PYX_ERR(0, 558, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_5);
        if (unlikely(!__pyx_t_3))
          __PYX_ERR(0, 558, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_5);
        __pyx_t_5 = 0;
        if (likely(PyList_CheckExact(__pyx_t_3)) ||
            PyTuple_CheckExact(__pyx_t_3)) {
          __pyx_t_5 = __pyx_t_3;
          __Pyx_INCREF(__pyx_t_5);
          __pyx_t_10 = 0;
          __pyx_t_11 = NULL;
        } else {
          __pyx_t_10 = -1;
          __pyx_t_5 = PyObject_GetIter(__pyx_t_3);
          if (unlikely(!__pyx_t_5))
            __PYX_ERR(0, 558, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          __pyx_t_11 = Py_TYPE(__pyx_t_5)->tp_iternext;
          if (unlikely(!__pyx_t_11))
            __PYX_ERR(0, 558, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_3);
        __pyx_t_3 = 0;
        for (;;) {
          if (likely(!__pyx_t_11)) {
            if (likely(PyList_CheckExact(__pyx_t_5))) {
              if (__pyx_t_10 >= PyList_GET_SIZE(__pyx_t_5))
                break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
              __pyx_t_3 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_10);
              __Pyx_INCREF(__pyx_t_3);
              __pyx_t_10++;
              if (unlikely(0 < 0))
                __PYX_ERR(0, 558, __pyx_L1_error)
#else
              __pyx_t_3 = PySequence_ITEM(__pyx_t_5, __pyx_t_10);
              __pyx_t_10++;
              if (unlikely(!__pyx_t_3))
                __PYX_ERR(0, 558, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
#endif
            } else {
              if (__pyx_t_10 >= PyTuple_GET_SIZE(__pyx_t_5))
                break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
              __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_10);
              __Pyx_INCREF(__pyx_t_3);
              __pyx_t_10++;
              if (unlikely(0 < 0))
                __PYX_ERR(0, 558, __pyx_L1_error)
#else
              __pyx_t_3 = PySequence_ITEM(__pyx_t_5, __pyx_t_10);
              __pyx_t_10++;
              if (unlikely(!__pyx_t_3))
                __PYX_ERR(0, 558, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
#endif
            }
          } else {
            __pyx_t_3 = __pyx_t_11(__pyx_t_5);
            if (unlikely(!__pyx_t_3)) {
              PyObject *exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(__Pyx_PyErr_GivenExceptionMatches(
                        exc_type, PyExc_StopIteration)))
                  PyErr_Clear();
                else
                  __PYX_ERR(0, 558, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_3);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_3);
          __pyx_t_3 = 0;

          /* "pyg4ometry/pycsg/core.pyx":559
           *
           *                     for i in range(len(bpoly.vertices)) :
           *                         ploc = 0             # <<<<<<<<<<<<<<
           *
           *                         if i == len(bpoly.vertices)-1 :
           */
          __Pyx_INCREF(__pyx_int_0);
          __Pyx_XDECREF_SET(__pyx_v_ploc, __pyx_int_0);

          /* "pyg4ometry/pycsg/core.pyx":561
           *                         ploc = 0
           *
           *                         if i == len(bpoly.vertices)-1 : #
           * <<<<<<<<<<<<<< bv = bpoly.vertices[0].pos   - bpoly.vertices[i].pos
           *                         else :
           */
          __pyx_t_3 =
              __Pyx_PyObject_GetAttrStr(__pyx_v_bpoly, __pyx_n_s_vertices);
          if (unlikely(!__pyx_t_3))
            __PYX_ERR(0, 561, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_t_15 = PyObject_Length(__pyx_t_3);
          if (unlikely(__pyx_t_15 == ((Py_ssize_t)-1)))
            __PYX_ERR(0, 561, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_3);
          __pyx_t_3 = 0;
          __pyx_t_3 = PyInt_FromSsize_t((__pyx_t_15 - 1));
          if (unlikely(!__pyx_t_3))
            __PYX_ERR(0, 561, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_t_12 = PyObject_RichCompare(__pyx_v_i, __pyx_t_3, Py_EQ);
          __Pyx_XGOTREF(__pyx_t_12);
          if (unlikely(!__pyx_t_12))
            __PYX_ERR(0, 561, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_3);
          __pyx_t_3 = 0;
          __pyx_t_14 = __Pyx_PyObject_IsTrue(__pyx_t_12);
          if (unlikely(__pyx_t_14 < 0))
            __PYX_ERR(0, 561, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_12);
          __pyx_t_12 = 0;
          if (__pyx_t_14) {

            /* "pyg4ometry/pycsg/core.pyx":562
             *
             *                         if i == len(bpoly.vertices)-1 :
             *                             bv = bpoly.vertices[0].pos   -
             * bpoly.vertices[i].pos             # <<<<<<<<<<<<<< else : bv =
             * bpoly.vertices[i+1].pos - bpoly.vertices[i].pos
             */
            __pyx_t_12 =
                __Pyx_PyObject_GetAttrStr(__pyx_v_bpoly, __pyx_n_s_vertices);
            if (unlikely(!__pyx_t_12))
              __PYX_ERR(0, 562, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_12);
            __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_12, 0, long, 1,
                                         __Pyx_PyInt_From_long, 0, 0, 1);
            if (unlikely(!__pyx_t_3))
              __PYX_ERR(0, 562, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __Pyx_DECREF(__pyx_t_12);
            __pyx_t_12 = 0;
            __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_pos);
            if (unlikely(!__pyx_t_12))
              __PYX_ERR(0, 562, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_12);
            __Pyx_DECREF(__pyx_t_3);
            __pyx_t_3 = 0;
            __pyx_t_3 =
                __Pyx_PyObject_GetAttrStr(__pyx_v_bpoly, __pyx_n_s_vertices);
            if (unlikely(!__pyx_t_3))
              __PYX_ERR(0, 562, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_v_i);
            if (unlikely(!__pyx_t_4))
              __PYX_ERR(0, 562, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            __Pyx_DECREF(__pyx_t_3);
            __pyx_t_3 = 0;
            __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_pos);
            if (unlikely(!__pyx_t_3))
              __PYX_ERR(0, 562, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __Pyx_DECREF(__pyx_t_4);
            __pyx_t_4 = 0;
            __pyx_t_4 = PyNumber_Subtract(__pyx_t_12, __pyx_t_3);
            if (unlikely(!__pyx_t_4))
              __PYX_ERR(0, 562, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            __Pyx_DECREF(__pyx_t_12);
            __pyx_t_12 = 0;
            __Pyx_DECREF(__pyx_t_3);
            __pyx_t_3 = 0;
            __Pyx_XDECREF_SET(__pyx_v_bv, __pyx_t_4);
            __pyx_t_4 = 0;

            /* "pyg4ometry/pycsg/core.pyx":561
             *                         ploc = 0
             *
             *                         if i == len(bpoly.vertices)-1 : #
             * <<<<<<<<<<<<<< bv = bpoly.vertices[0].pos   -
             * bpoly.vertices[i].pos else :
             */
            goto __pyx_L13;
          }

          /* "pyg4ometry/pycsg/core.pyx":564
           *                             bv = bpoly.vertices[0].pos   -
           * bpoly.vertices[i].pos else : bv = bpoly.vertices[i+1].pos -
           * bpoly.vertices[i].pos             # <<<<<<<<<<<<<<
           *
           *
           */
          /*else*/ {
            __pyx_t_4 =
                __Pyx_PyObject_GetAttrStr(__pyx_v_bpoly, __pyx_n_s_vertices);
            if (unlikely(!__pyx_t_4))
              __PYX_ERR(0, 564, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_1, 1, 0, 0);
            if (unlikely(!__pyx_t_3))
              __PYX_ERR(0, 564, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __pyx_t_12 = __Pyx_PyObject_GetItem(__pyx_t_4, __pyx_t_3);
            if (unlikely(!__pyx_t_12))
              __PYX_ERR(0, 564, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_12);
            __Pyx_DECREF(__pyx_t_4);
            __pyx_t_4 = 0;
            __Pyx_DECREF(__pyx_t_3);
            __pyx_t_3 = 0;
            __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_pos);
            if (unlikely(!__pyx_t_3))
              __PYX_ERR(0, 564, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __Pyx_DECREF(__pyx_t_12);
            __pyx_t_12 = 0;
            __pyx_t_12 =
                __Pyx_PyObject_GetAttrStr(__pyx_v_bpoly, __pyx_n_s_vertices);
            if (unlikely(!__pyx_t_12))
              __PYX_ERR(0, 564, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_12);
            __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_t_12, __pyx_v_i);
            if (unlikely(!__pyx_t_4))
              __PYX_ERR(0, 564, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            __Pyx_DECREF(__pyx_t_12);
            __pyx_t_12 = 0;
            __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_pos);
            if (unlikely(!__pyx_t_12))
              __PYX_ERR(0, 564, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_12);
            __Pyx_DECREF(__pyx_t_4);
            __pyx_t_4 = 0;
            __pyx_t_4 = PyNumber_Subtract(__pyx_t_3, __pyx_t_12);
            if (unlikely(!__pyx_t_4))
              __PYX_ERR(0, 564, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            __Pyx_DECREF(__pyx_t_3);
            __pyx_t_3 = 0;
            __Pyx_DECREF(__pyx_t_12);
            __pyx_t_12 = 0;
            __Pyx_XDECREF_SET(__pyx_v_bv, __pyx_t_4);
            __pyx_t_4 = 0;
          }
        __pyx_L13:;

          /* "pyg4ometry/pycsg/core.pyx":568
           *
           *                         # project b edge (bv) onto apoly plane
           *                         bvOnA =
           * bv-aplane.normal*aplane.normal.dot(bv)             # <<<<<<<<<<<<<<
           *                         bpOnA =
           * aplane.normal.dot(bpoly.vertices[i].pos)
           *
           */
          __pyx_t_4 =
              __Pyx_PyObject_GetAttrStr(__pyx_v_aplane, __pyx_n_s_normal);
          if (unlikely(!__pyx_t_4))
            __PYX_ERR(0, 568, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          __pyx_t_3 =
              __Pyx_PyObject_GetAttrStr(__pyx_v_aplane, __pyx_n_s_normal);
          if (unlikely(!__pyx_t_3))
            __PYX_ERR(0, 568, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_dot);
          if (unlikely(!__pyx_t_13))
            __PYX_ERR(0, 568, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_13);
          __Pyx_DECREF(__pyx_t_3);
          __pyx_t_3 = 0;
          __pyx_t_3 = NULL;
          if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_13))) {
            __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_13);
            if (likely(__pyx_t_3)) {
              PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_13);
              __Pyx_INCREF(__pyx_t_3);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_13, function);
            }
          }
          __pyx_t_12 =
              (__pyx_t_3)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_3, __pyx_v_bv)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_v_bv);
          __Pyx_XDECREF(__pyx_t_3);
          __pyx_t_3 = 0;
          if (unlikely(!__pyx_t_12))
            __PYX_ERR(0, 568, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_12);
          __Pyx_DECREF(__pyx_t_13);
          __pyx_t_13 = 0;
          __pyx_t_13 = PyNumber_Multiply(__pyx_t_4, __pyx_t_12);
          if (unlikely(!__pyx_t_13))
            __PYX_ERR(0, 568, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_13);
          __Pyx_DECREF(__pyx_t_4);
          __pyx_t_4 = 0;
          __Pyx_DECREF(__pyx_t_12);
          __pyx_t_12 = 0;
          __pyx_t_12 = PyNumber_Subtract(__pyx_v_bv, __pyx_t_13);
          if (unlikely(!__pyx_t_12))
            __PYX_ERR(0, 568, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_12);
          __Pyx_DECREF(__pyx_t_13);
          __pyx_t_13 = 0;
          __Pyx_XDECREF_SET(__pyx_v_bvOnA, __pyx_t_12);
          __pyx_t_12 = 0;

          /* "pyg4ometry/pycsg/core.pyx":569
           *                         # project b edge (bv) onto apoly plane
           *                         bvOnA =
           * bv-aplane.normal*aplane.normal.dot(bv) bpOnA =
           * aplane.normal.dot(bpoly.vertices[i].pos)             #
           * <<<<<<<<<<<<<<
           *
           *                         for j in range(len(apoly.vertices)) :
           */
          __pyx_t_13 =
              __Pyx_PyObject_GetAttrStr(__pyx_v_aplane, __pyx_n_s_normal);
          if (unlikely(!__pyx_t_13))
            __PYX_ERR(0, 569, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_13);
          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_dot);
          if (unlikely(!__pyx_t_4))
            __PYX_ERR(0, 569, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          __Pyx_DECREF(__pyx_t_13);
          __pyx_t_13 = 0;
          __pyx_t_13 =
              __Pyx_PyObject_GetAttrStr(__pyx_v_bpoly, __pyx_n_s_vertices);
          if (unlikely(!__pyx_t_13))
            __PYX_ERR(0, 569, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_13);
          __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_13, __pyx_v_i);
          if (unlikely(!__pyx_t_3))
            __PYX_ERR(0, 569, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_DECREF(__pyx_t_13);
          __pyx_t_13 = 0;
          __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_pos);
          if (unlikely(!__pyx_t_13))
            __PYX_ERR(0, 569, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_13);
          __Pyx_DECREF(__pyx_t_3);
          __pyx_t_3 = 0;
          __pyx_t_3 = NULL;
          if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
            __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
            if (likely(__pyx_t_3)) {
              PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_4);
              __Pyx_INCREF(__pyx_t_3);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_4, function);
            }
          }
          __pyx_t_12 =
              (__pyx_t_3)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_13)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_13);
          __Pyx_XDECREF(__pyx_t_3);
          __pyx_t_3 = 0;
          __Pyx_DECREF(__pyx_t_13);
          __pyx_t_13 = 0;
          if (unlikely(!__pyx_t_12))
            __PYX_ERR(0, 569, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_12);
          __Pyx_DECREF(__pyx_t_4);
          __pyx_t_4 = 0;
          __Pyx_XDECREF_SET(__pyx_v_bpOnA, __pyx_t_12);
          __pyx_t_12 = 0;

          /* "pyg4ometry/pycsg/core.pyx":571
           *                         bpOnA =
           * aplane.normal.dot(bpoly.vertices[i].pos)
           *
           *                         for j in range(len(apoly.vertices)) : #
           * <<<<<<<<<<<<<< if j == len(apoly.vertices)-1 : av =
           * apoly.vertices[0].pos   - apoly.vertices[j].pos
           */
          __pyx_t_12 =
              __Pyx_PyObject_GetAttrStr(__pyx_v_apoly, __pyx_n_s_vertices);
          if (unlikely(!__pyx_t_12))
            __PYX_ERR(0, 571, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_12);
          __pyx_t_15 = PyObject_Length(__pyx_t_12);
          if (unlikely(__pyx_t_15 == ((Py_ssize_t)-1)))
            __PYX_ERR(0, 571, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_12);
          __pyx_t_12 = 0;
          __pyx_t_12 = PyInt_FromSsize_t(__pyx_t_15);
          if (unlikely(!__pyx_t_12))
            __PYX_ERR(0, 571, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_12);
          __pyx_t_4 =
              __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_12);
          if (unlikely(!__pyx_t_4))
            __PYX_ERR(0, 571, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          __Pyx_DECREF(__pyx_t_12);
          __pyx_t_12 = 0;
          if (likely(PyList_CheckExact(__pyx_t_4)) ||
              PyTuple_CheckExact(__pyx_t_4)) {
            __pyx_t_12 = __pyx_t_4;
            __Pyx_INCREF(__pyx_t_12);
            __pyx_t_15 = 0;
            __pyx_t_16 = NULL;
          } else {
            __pyx_t_15 = -1;
            __pyx_t_12 = PyObject_GetIter(__pyx_t_4);
            if (unlikely(!__pyx_t_12))
              __PYX_ERR(0, 571, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_12);
            __pyx_t_16 = Py_TYPE(__pyx_t_12)->tp_iternext;
            if (unlikely(!__pyx_t_16))
              __PYX_ERR(0, 571, __pyx_L1_error)
          }
          __Pyx_DECREF(__pyx_t_4);
          __pyx_t_4 = 0;
          for (;;) {
            if (likely(!__pyx_t_16)) {
              if (likely(PyList_CheckExact(__pyx_t_12))) {
                if (__pyx_t_15 >= PyList_GET_SIZE(__pyx_t_12))
                  break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
                __pyx_t_4 = PyList_GET_ITEM(__pyx_t_12, __pyx_t_15);
                __Pyx_INCREF(__pyx_t_4);
                __pyx_t_15++;
                if (unlikely(0 < 0))
                  __PYX_ERR(0, 571, __pyx_L1_error)
#else
                __pyx_t_4 = PySequence_ITEM(__pyx_t_12, __pyx_t_15);
                __pyx_t_15++;
                if (unlikely(!__pyx_t_4))
                  __PYX_ERR(0, 571, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_4);
#endif
              } else {
                if (__pyx_t_15 >= PyTuple_GET_SIZE(__pyx_t_12))
                  break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
                __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_12, __pyx_t_15);
                __Pyx_INCREF(__pyx_t_4);
                __pyx_t_15++;
                if (unlikely(0 < 0))
                  __PYX_ERR(0, 571, __pyx_L1_error)
#else
                __pyx_t_4 = PySequence_ITEM(__pyx_t_12, __pyx_t_15);
                __pyx_t_15++;
                if (unlikely(!__pyx_t_4))
                  __PYX_ERR(0, 571, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_4);
#endif
              }
            } else {
              __pyx_t_4 = __pyx_t_16(__pyx_t_12);
              if (unlikely(!__pyx_t_4)) {
                PyObject *exc_type = PyErr_Occurred();
                if (exc_type) {
                  if (likely(__Pyx_PyErr_GivenExceptionMatches(
                          exc_type, PyExc_StopIteration)))
                    PyErr_Clear();
                  else
                    __PYX_ERR(0, 571, __pyx_L1_error)
                }
                break;
              }
              __Pyx_GOTREF(__pyx_t_4);
            }
            __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_4);
            __pyx_t_4 = 0;

            /* "pyg4ometry/pycsg/core.pyx":572
             *
             *                         for j in range(len(apoly.vertices)) :
             *                             if j == len(apoly.vertices)-1 : #
             * <<<<<<<<<<<<<< av = apoly.vertices[0].pos   -
             * apoly.vertices[j].pos else :
             */
            __pyx_t_4 =
                __Pyx_PyObject_GetAttrStr(__pyx_v_apoly, __pyx_n_s_vertices);
            if (unlikely(!__pyx_t_4))
              __PYX_ERR(0, 572, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            __pyx_t_17 = PyObject_Length(__pyx_t_4);
            if (unlikely(__pyx_t_17 == ((Py_ssize_t)-1)))
              __PYX_ERR(0, 572, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_4);
            __pyx_t_4 = 0;
            __pyx_t_4 = PyInt_FromSsize_t((__pyx_t_17 - 1));
            if (unlikely(!__pyx_t_4))
              __PYX_ERR(0, 572, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            __pyx_t_13 = PyObject_RichCompare(__pyx_v_j, __pyx_t_4, Py_EQ);
            __Pyx_XGOTREF(__pyx_t_13);
            if (unlikely(!__pyx_t_13))
              __PYX_ERR(0, 572, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_4);
            __pyx_t_4 = 0;
            __pyx_t_14 = __Pyx_PyObject_IsTrue(__pyx_t_13);
            if (unlikely(__pyx_t_14 < 0))
              __PYX_ERR(0, 572, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_13);
            __pyx_t_13 = 0;
            if (__pyx_t_14) {

              /* "pyg4ometry/pycsg/core.pyx":573
               *                         for j in range(len(apoly.vertices)) :
               *                             if j == len(apoly.vertices)-1 :
               *                                 av = apoly.vertices[0].pos   -
               * apoly.vertices[j].pos             # <<<<<<<<<<<<<< else : av =
               * apoly.vertices[j+1].pos - apoly.vertices[j].pos
               */
              __pyx_t_13 =
                  __Pyx_PyObject_GetAttrStr(__pyx_v_apoly, __pyx_n_s_vertices);
              if (unlikely(!__pyx_t_13))
                __PYX_ERR(0, 573, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_13);
              __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_13, 0, long, 1,
                                           __Pyx_PyInt_From_long, 0, 0, 1);
              if (unlikely(!__pyx_t_4))
                __PYX_ERR(0, 573, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_4);
              __Pyx_DECREF(__pyx_t_13);
              __pyx_t_13 = 0;
              __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_pos);
              if (unlikely(!__pyx_t_13))
                __PYX_ERR(0, 573, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_13);
              __Pyx_DECREF(__pyx_t_4);
              __pyx_t_4 = 0;
              __pyx_t_4 =
                  __Pyx_PyObject_GetAttrStr(__pyx_v_apoly, __pyx_n_s_vertices);
              if (unlikely(!__pyx_t_4))
                __PYX_ERR(0, 573, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_4);
              __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_4, __pyx_v_j);
              if (unlikely(!__pyx_t_3))
                __PYX_ERR(0, 573, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              __Pyx_DECREF(__pyx_t_4);
              __pyx_t_4 = 0;
              __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_pos);
              if (unlikely(!__pyx_t_4))
                __PYX_ERR(0, 573, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_4);
              __Pyx_DECREF(__pyx_t_3);
              __pyx_t_3 = 0;
              __pyx_t_3 = PyNumber_Subtract(__pyx_t_13, __pyx_t_4);
              if (unlikely(!__pyx_t_3))
                __PYX_ERR(0, 573, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              __Pyx_DECREF(__pyx_t_13);
              __pyx_t_13 = 0;
              __Pyx_DECREF(__pyx_t_4);
              __pyx_t_4 = 0;
              __Pyx_XDECREF_SET(__pyx_v_av, __pyx_t_3);
              __pyx_t_3 = 0;

              /* "pyg4ometry/pycsg/core.pyx":572
               *
               *                         for j in range(len(apoly.vertices)) :
               *                             if j == len(apoly.vertices)-1 : #
               * <<<<<<<<<<<<<< av = apoly.vertices[0].pos   -
               * apoly.vertices[j].pos else :
               */
              goto __pyx_L16;
            }

            /* "pyg4ometry/pycsg/core.pyx":575
             *                                 av = apoly.vertices[0].pos   -
             * apoly.vertices[j].pos else : av = apoly.vertices[j+1].pos -
             * apoly.vertices[j].pos             # <<<<<<<<<<<<<< avunit  =
             * av.unit() anormal = aplane.normal.cross(avunit)
             */
            /*else*/ {
              __pyx_t_3 =
                  __Pyx_PyObject_GetAttrStr(__pyx_v_apoly, __pyx_n_s_vertices);
              if (unlikely(!__pyx_t_3))
                __PYX_ERR(0, 575, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_v_j, __pyx_int_1, 1, 0, 0);
              if (unlikely(!__pyx_t_4))
                __PYX_ERR(0, 575, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_4);
              __pyx_t_13 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_t_4);
              if (unlikely(!__pyx_t_13))
                __PYX_ERR(0, 575, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_13);
              __Pyx_DECREF(__pyx_t_3);
              __pyx_t_3 = 0;
              __Pyx_DECREF(__pyx_t_4);
              __pyx_t_4 = 0;
              __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_pos);
              if (unlikely(!__pyx_t_4))
                __PYX_ERR(0, 575, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_4);
              __Pyx_DECREF(__pyx_t_13);
              __pyx_t_13 = 0;
              __pyx_t_13 =
                  __Pyx_PyObject_GetAttrStr(__pyx_v_apoly, __pyx_n_s_vertices);
              if (unlikely(!__pyx_t_13))
                __PYX_ERR(0, 575, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_13);
              __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_13, __pyx_v_j);
              if (unlikely(!__pyx_t_3))
                __PYX_ERR(0, 575, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              __Pyx_DECREF(__pyx_t_13);
              __pyx_t_13 = 0;
              __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_pos);
              if (unlikely(!__pyx_t_13))
                __PYX_ERR(0, 575, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_13);
              __Pyx_DECREF(__pyx_t_3);
              __pyx_t_3 = 0;
              __pyx_t_3 = PyNumber_Subtract(__pyx_t_4, __pyx_t_13);
              if (unlikely(!__pyx_t_3))
                __PYX_ERR(0, 575, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              __Pyx_DECREF(__pyx_t_4);
              __pyx_t_4 = 0;
              __Pyx_DECREF(__pyx_t_13);
              __pyx_t_13 = 0;
              __Pyx_XDECREF_SET(__pyx_v_av, __pyx_t_3);
              __pyx_t_3 = 0;
            }
          __pyx_L16:;

            /* "pyg4ometry/pycsg/core.pyx":576
             *                             else :
             *                                 av = apoly.vertices[j+1].pos -
             * apoly.vertices[j].pos avunit  = av.unit()             #
             * <<<<<<<<<<<<<< anormal = aplane.normal.cross(avunit)
             *
             */
            __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_v_av, __pyx_n_s_unit);
            if (unlikely(!__pyx_t_13))
              __PYX_ERR(0, 576, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_13);
            __pyx_t_4 = NULL;
            if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_13))) {
              __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_13);
              if (likely(__pyx_t_4)) {
                PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_13);
                __Pyx_INCREF(__pyx_t_4);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_13, function);
              }
            }
            __pyx_t_3 = (__pyx_t_4)
                            ? __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_t_4)
                            : __Pyx_PyObject_CallNoArg(__pyx_t_13);
            __Pyx_XDECREF(__pyx_t_4);
            __pyx_t_4 = 0;
            if (unlikely(!__pyx_t_3))
              __PYX_ERR(0, 576, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __Pyx_DECREF(__pyx_t_13);
            __pyx_t_13 = 0;
            __Pyx_XDECREF_SET(__pyx_v_avunit, __pyx_t_3);
            __pyx_t_3 = 0;

            /* "pyg4ometry/pycsg/core.pyx":577
             *                                 av = apoly.vertices[j+1].pos -
             * apoly.vertices[j].pos avunit  = av.unit() anormal =
             * aplane.normal.cross(avunit)             # <<<<<<<<<<<<<<
             *
             *                             # distance inside place
             */
            __pyx_t_13 =
                __Pyx_PyObject_GetAttrStr(__pyx_v_aplane, __pyx_n_s_normal);
            if (unlikely(!__pyx_t_13))
              __PYX_ERR(0, 577, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_13);
            __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_cross);
            if (unlikely(!__pyx_t_4))
              __PYX_ERR(0, 577, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            __Pyx_DECREF(__pyx_t_13);
            __pyx_t_13 = 0;
            __pyx_t_13 = NULL;
            if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
              __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_4);
              if (likely(__pyx_t_13)) {
                PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_4);
                __Pyx_INCREF(__pyx_t_13);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_4, function);
              }
            }
            __pyx_t_3 =
                (__pyx_t_13)
                    ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_13,
                                               __pyx_v_avunit)
                    : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_avunit);
            __Pyx_XDECREF(__pyx_t_13);
            __pyx_t_13 = 0;
            if (unlikely(!__pyx_t_3))
              __PYX_ERR(0, 577, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __Pyx_DECREF(__pyx_t_4);
            __pyx_t_4 = 0;
            __Pyx_XDECREF_SET(__pyx_v_anormal, __pyx_t_3);
            __pyx_t_3 = 0;

            /* "pyg4ometry/pycsg/core.pyx":580
             *
             *                             # distance inside place
             *                             t  =
             * anormal.dot(bpoly.vertices[i].pos) -
             * apoly.vertices[j].pos.dot(anormal)             # <<<<<<<<<<<<<<
             *
             *                             # check if inside
             */
            __pyx_t_4 =
                __Pyx_PyObject_GetAttrStr(__pyx_v_anormal, __pyx_n_s_dot);
            if (unlikely(!__pyx_t_4))
              __PYX_ERR(0, 580, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            __pyx_t_13 =
                __Pyx_PyObject_GetAttrStr(__pyx_v_bpoly, __pyx_n_s_vertices);
            if (unlikely(!__pyx_t_13))
              __PYX_ERR(0, 580, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_13);
            __pyx_t_18 = __Pyx_PyObject_GetItem(__pyx_t_13, __pyx_v_i);
            if (unlikely(!__pyx_t_18))
              __PYX_ERR(0, 580, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_18);
            __Pyx_DECREF(__pyx_t_13);
            __pyx_t_13 = 0;
            __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_18, __pyx_n_s_pos);
            if (unlikely(!__pyx_t_13))
              __PYX_ERR(0, 580, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_13);
            __Pyx_DECREF(__pyx_t_18);
            __pyx_t_18 = 0;
            __pyx_t_18 = NULL;
            if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
              __pyx_t_18 = PyMethod_GET_SELF(__pyx_t_4);
              if (likely(__pyx_t_18)) {
                PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_4);
                __Pyx_INCREF(__pyx_t_18);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_4, function);
              }
            }
            __pyx_t_3 = (__pyx_t_18)
                            ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_18,
                                                       __pyx_t_13)
                            : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_13);
            __Pyx_XDECREF(__pyx_t_18);
            __pyx_t_18 = 0;
            __Pyx_DECREF(__pyx_t_13);
            __pyx_t_13 = 0;
            if (unlikely(!__pyx_t_3))
              __PYX_ERR(0, 580, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __Pyx_DECREF(__pyx_t_4);
            __pyx_t_4 = 0;
            __pyx_t_13 =
                __Pyx_PyObject_GetAttrStr(__pyx_v_apoly, __pyx_n_s_vertices);
            if (unlikely(!__pyx_t_13))
              __PYX_ERR(0, 580, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_13);
            __pyx_t_18 = __Pyx_PyObject_GetItem(__pyx_t_13, __pyx_v_j);
            if (unlikely(!__pyx_t_18))
              __PYX_ERR(0, 580, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_18);
            __Pyx_DECREF(__pyx_t_13);
            __pyx_t_13 = 0;
            __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_18, __pyx_n_s_pos);
            if (unlikely(!__pyx_t_13))
              __PYX_ERR(0, 580, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_13);
            __Pyx_DECREF(__pyx_t_18);
            __pyx_t_18 = 0;
            __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_dot);
            if (unlikely(!__pyx_t_18))
              __PYX_ERR(0, 580, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_18);
            __Pyx_DECREF(__pyx_t_13);
            __pyx_t_13 = 0;
            __pyx_t_13 = NULL;
            if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_18))) {
              __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_18);
              if (likely(__pyx_t_13)) {
                PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_18);
                __Pyx_INCREF(__pyx_t_13);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_18, function);
              }
            }
            __pyx_t_4 =
                (__pyx_t_13)
                    ? __Pyx_PyObject_Call2Args(__pyx_t_18, __pyx_t_13,
                                               __pyx_v_anormal)
                    : __Pyx_PyObject_CallOneArg(__pyx_t_18, __pyx_v_anormal);
            __Pyx_XDECREF(__pyx_t_13);
            __pyx_t_13 = 0;
            if (unlikely(!__pyx_t_4))
              __PYX_ERR(0, 580, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            __Pyx_DECREF(__pyx_t_18);
            __pyx_t_18 = 0;
            __pyx_t_18 = PyNumber_Subtract(__pyx_t_3, __pyx_t_4);
            if (unlikely(!__pyx_t_18))
              __PYX_ERR(0, 580, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_18);
            __Pyx_DECREF(__pyx_t_3);
            __pyx_t_3 = 0;
            __Pyx_DECREF(__pyx_t_4);
            __pyx_t_4 = 0;
            __Pyx_XDECREF_SET(__pyx_v_t, __pyx_t_18);
            __pyx_t_18 = 0;

            /* "pyg4ometry/pycsg/core.pyx":583
             *
             *                             # check if inside
             *                             if t >= 0 :             #
             * <<<<<<<<<<<<<< ploc += 1
             *
             */
            __pyx_t_18 = PyObject_RichCompare(__pyx_v_t, __pyx_int_0, Py_GE);
            __Pyx_XGOTREF(__pyx_t_18);
            if (unlikely(!__pyx_t_18))
              __PYX_ERR(0, 583, __pyx_L1_error)
            __pyx_t_14 = __Pyx_PyObject_IsTrue(__pyx_t_18);
            if (unlikely(__pyx_t_14 < 0))
              __PYX_ERR(0, 583, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_18);
            __pyx_t_18 = 0;
            if (__pyx_t_14) {

              /* "pyg4ometry/pycsg/core.pyx":584
               *                             # check if inside
               *                             if t >= 0 :
               *                                 ploc += 1             #
               * <<<<<<<<<<<<<<
               *
               *                             # test for intersection between
               * bvOnA and av
               */
              __pyx_t_18 =
                  __Pyx_PyInt_AddObjC(__pyx_v_ploc, __pyx_int_1, 1, 1, 0);
              if (unlikely(!__pyx_t_18))
                __PYX_ERR(0, 584, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_18);
              __Pyx_DECREF_SET(__pyx_v_ploc, __pyx_t_18);
              __pyx_t_18 = 0;

              /* "pyg4ometry/pycsg/core.pyx":583
               *
               *                             # check if inside
               *                             if t >= 0 :             #
               * <<<<<<<<<<<<<< ploc += 1
               *
               */
            }

            /* "pyg4ometry/pycsg/core.pyx":571
             *                         bpOnA =
             * aplane.normal.dot(bpoly.vertices[i].pos)
             *
             *                         for j in range(len(apoly.vertices)) : #
             * <<<<<<<<<<<<<< if j == len(apoly.vertices)-1 : av =
             * apoly.vertices[0].pos   - apoly.vertices[j].pos
             */
          }
          __Pyx_DECREF(__pyx_t_12);
          __pyx_t_12 = 0;

          /* "pyg4ometry/pycsg/core.pyx":593
           *                         # print 'ploc,
           * len',ploc,len(apoly.vertices)
           *
           *                         if ploc == len(apoly.vertices) : #
           * <<<<<<<<<<<<<< aAdd = True break
           */
          __pyx_t_12 =
              __Pyx_PyObject_GetAttrStr(__pyx_v_apoly, __pyx_n_s_vertices);
          if (unlikely(!__pyx_t_12))
            __PYX_ERR(0, 593, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_12);
          __pyx_t_15 = PyObject_Length(__pyx_t_12);
          if (unlikely(__pyx_t_15 == ((Py_ssize_t)-1)))
            __PYX_ERR(0, 593, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_12);
          __pyx_t_12 = 0;
          __pyx_t_12 = PyInt_FromSsize_t(__pyx_t_15);
          if (unlikely(!__pyx_t_12))
            __PYX_ERR(0, 593, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_12);
          __pyx_t_18 = PyObject_RichCompare(__pyx_v_ploc, __pyx_t_12, Py_EQ);
          __Pyx_XGOTREF(__pyx_t_18);
          if (unlikely(!__pyx_t_18))
            __PYX_ERR(0, 593, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_12);
          __pyx_t_12 = 0;
          __pyx_t_14 = __Pyx_PyObject_IsTrue(__pyx_t_18);
          if (unlikely(__pyx_t_14 < 0))
            __PYX_ERR(0, 593, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_18);
          __pyx_t_18 = 0;
          if (__pyx_t_14) {

            /* "pyg4ometry/pycsg/core.pyx":594
             *
             *                         if ploc == len(apoly.vertices) :
             *                             aAdd = True             #
             * <<<<<<<<<<<<<< break
             *
             */
            __pyx_v_aAdd = 1;

            /* "pyg4ometry/pycsg/core.pyx":595
             *                         if ploc == len(apoly.vertices) :
             *                             aAdd = True
             *                             break             # <<<<<<<<<<<<<<
             *
             *
             */
            goto __pyx_L12_break;

            /* "pyg4ometry/pycsg/core.pyx":593
             *                         # print 'ploc,
             * len',ploc,len(apoly.vertices)
             *
             *                         if ploc == len(apoly.vertices) : #
             * <<<<<<<<<<<<<< aAdd = True break
             */
          }

          /* "pyg4ometry/pycsg/core.pyx":558
           *                     aAdd = False
           *
           *                     for i in range(len(bpoly.vertices)) : #
           * <<<<<<<<<<<<<< ploc = 0
           *
           */
        }
      __pyx_L12_break:;
        __Pyx_DECREF(__pyx_t_5);
        __pyx_t_5 = 0;

        /* "pyg4ometry/pycsg/core.pyx":599
         *
         *
         *                     if aAdd:             # <<<<<<<<<<<<<<
         *                         # print 'adding'
         *                         a.append(bpoly)
         */
        __pyx_t_14 = (__pyx_v_aAdd != 0);
        if (__pyx_t_14) {

          /* "pyg4ometry/pycsg/core.pyx":601
           *                     if aAdd:
           *                         # print 'adding'
           *                         a.append(bpoly)             #
           * <<<<<<<<<<<<<<
           *
           *
           */
          __pyx_t_19 = __Pyx_PyList_Append(__pyx_v_a, __pyx_v_bpoly);
          if (unlikely(__pyx_t_19 == ((int)-1)))
            __PYX_ERR(0, 601, __pyx_L1_error)

          /* "pyg4ometry/pycsg/core.pyx":599
           *
           *
           *                     if aAdd:             # <<<<<<<<<<<<<<
           *                         # print 'adding'
           *                         a.append(bpoly)
           */
        }

        /* "pyg4ometry/pycsg/core.pyx":554
         *
         *                 # if coplanar do a interior/exterior check
         *                 if polygonType == COPLANAR :             #
         * <<<<<<<<<<<<<<
         *
         *                     aAdd = False
         */
      }

      /* "pyg4ometry/pycsg/core.pyx":536
       *         for apoly in apolygons :
       *             aplane = apoly.plane
       *             for bpoly in bpolygons :             # <<<<<<<<<<<<<<
       *                 bplane = bpoly.plane
       *
       */
    }
    __Pyx_DECREF(__pyx_t_2);
    __pyx_t_2 = 0;

    /* "pyg4ometry/pycsg/core.pyx":534
     *
     *         # loop over all A polygons
     *         for apoly in apolygons :             # <<<<<<<<<<<<<<
     *             aplane = apoly.plane
     *             for bpoly in bpolygons :
     */
  }
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":604
   *
   *
   *         return CSG.fromPolygons(a)             # <<<<<<<<<<<<<<
   *
   *     def __mul__(self, csg):
   */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_CSG);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 604, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_fromPolygons);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 604, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
    if (likely(__pyx_t_2)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_5, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_2, __pyx_v_a)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_a);
  __Pyx_XDECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 604, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":504
 *         return CSG.fromPolygons(polygons)
 *
 *     def coplanar(self, csg):             # <<<<<<<<<<<<<<
 *
 *         absp = BSPNode(self.clone().polygons)
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_XDECREF(__pyx_t_13);
  __Pyx_XDECREF(__pyx_t_18);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.coplanar", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XDECREF(__pyx_v_absp);
  __Pyx_XDECREF(__pyx_v_bbsp);
  __Pyx_XDECREF(__pyx_v_apolygons);
  __Pyx_XDECREF(__pyx_v_bpolygons);
  __Pyx_XDECREF(__pyx_v_a);
  __Pyx_XDECREF(__pyx_v_apoly);
  __Pyx_XDECREF(__pyx_v_aplane);
  __Pyx_XDECREF(__pyx_v_bpoly);
  __Pyx_XDECREF(__pyx_v_bplane);
  __Pyx_XDECREF(__pyx_v_polygonType);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XDECREF(__pyx_v_t);
  __Pyx_XDECREF(__pyx_v_loc);
  __Pyx_XDECREF(__pyx_v_ploc);
  __Pyx_XDECREF(__pyx_v_bv);
  __Pyx_XDECREF(__pyx_v_bvOnA);
  __Pyx_XDECREF(__pyx_v_bpOnA);
  __Pyx_XDECREF(__pyx_v_j);
  __Pyx_XDECREF(__pyx_v_av);
  __Pyx_XDECREF(__pyx_v_avunit);
  __Pyx_XDECREF(__pyx_v_anormal);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":606
 *         return CSG.fromPolygons(a)
 *
 *     def __mul__(self, csg):             # <<<<<<<<<<<<<<
 *         return self.intersect(csg)
 *
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_43__mul__(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_43__mul__ = {
    "__mul__",
    (PyCFunction)(void *)(PyCFunctionWithKeywords)
        __pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_43__mul__,
    METH_VARARGS | METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_43__mul__(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_self = 0;
  PyObject *__pyx_v_csg = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext("__mul__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self, &__pyx_n_s_csg, 0};
    PyObject *values[2] = {0, 0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
      case 2:
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
      case 1:
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
      case 0:
        break;
      default:
        goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
      case 0:
        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_self)) != 0))
          kw_args--;
        else
          goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
      case 1:
        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_csg)) != 0))
          kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("__mul__", 1, 2, 2, 1);
          __PYX_ERR(0, 606, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames,
                                                 0, values, pos_args,
                                                 "__mul__") < 0))
          __PYX_ERR(0, 606, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_self = values[0];
    __pyx_v_csg = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
__pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__mul__", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args));
  __PYX_ERR(0, 606, __pyx_L3_error)
__pyx_L3_error:;
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.__mul__", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
__pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_42__mul__(
      __pyx_self, __pyx_v_self, __pyx_v_csg);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_42__mul__(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self,
    PyObject *__pyx_v_csg) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__mul__", 0);

  /* "pyg4ometry/pycsg/core.pyx":607
   *
   *     def __mul__(self, csg):
   *         return self.intersect(csg)             # <<<<<<<<<<<<<<
   *
   *     def inverse(self):
   */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_intersect);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 607, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_csg)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_csg);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 607, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":606
 *         return CSG.fromPolygons(a)
 *
 *     def __mul__(self, csg):             # <<<<<<<<<<<<<<
 *         return self.intersect(csg)
 *
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.__mul__", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":609
 *         return self.intersect(csg)
 *
 *     def inverse(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return a new CSG solid with solid and empty space switched. This
 * solid is
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_45inverse(
    PyObject *__pyx_self, PyObject *__pyx_v_self); /*proto*/
static char __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_44inverse[] =
    "\n        Return a new CSG solid with solid and empty space switched. "
    "This solid is\n        not modified.\n        ";
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_45inverse = {
    "inverse", (PyCFunction)__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_45inverse,
    METH_O, __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_44inverse};
static PyObject *
__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_45inverse(PyObject *__pyx_self,
                                                  PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext("inverse (wrapper)", 0);
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_44inverse(
      __pyx_self, ((PyObject *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":615
 *         """
 *         csg = self.clone()
 *         list(map(lambda p: p.flip(), csg.polygons))             #
 * <<<<<<<<<<<<<< return csg
 *
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_7inverse_lambda(
    PyObject *__pyx_self, PyObject *__pyx_v_p); /*proto*/
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_7inverse_lambda = {
    "lambda",
    (PyCFunction)__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_7inverse_lambda,
    METH_O, 0};
static PyObject *
__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_7inverse_lambda(PyObject *__pyx_self,
                                                        PyObject *__pyx_v_p) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext("lambda (wrapper)", 0);
  __pyx_r = __pyx_lambda_funcdef_lambda(__pyx_self, ((PyObject *)__pyx_v_p));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_lambda_funcdef_lambda(CYTHON_UNUSED PyObject *__pyx_self,
                                             PyObject *__pyx_v_p) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("lambda", 0);
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_p, __pyx_n_s_flip);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 615, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 615, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.inverse.lambda", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":609
 *         return self.intersect(csg)
 *
 *     def inverse(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return a new CSG solid with solid and empty space switched. This
 * solid is
 */

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_44inverse(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
  PyObject *__pyx_v_csg = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("inverse", 0);

  /* "pyg4ometry/pycsg/core.pyx":614
   *         not modified.
   *         """
   *         csg = self.clone()             # <<<<<<<<<<<<<<
   *         list(map(lambda p: p.flip(), csg.polygons))
   *         return csg
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_clone);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 614, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 614, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_csg = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":615
   *         """
   *         csg = self.clone()
   *         list(map(lambda p: p.flip(), csg.polygons))             #
   * <<<<<<<<<<<<<< return csg
   *
   */
  __pyx_t_1 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_7inverse_lambda, 0,
      __pyx_n_s_CSG_inverse_locals_lambda, NULL,
      __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d, NULL);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 615, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_csg, __pyx_n_s_polygons);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 615, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyTuple_New(2);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 615, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_map, __pyx_t_3, NULL);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 615, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PySequence_List(__pyx_t_2);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 615, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;

  /* "pyg4ometry/pycsg/core.pyx":616
   *         csg = self.clone()
   *         list(map(lambda p: p.flip(), csg.polygons))
   *         return csg             # <<<<<<<<<<<<<<
   *
   *     def getNumberPolys(self):
   */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_csg);
  __pyx_r = __pyx_v_csg;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":609
 *         return self.intersect(csg)
 *
 *     def inverse(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return a new CSG solid with solid and empty space switched. This
 * solid is
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.inverse", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XDECREF(__pyx_v_csg);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":618
 *         return csg
 *
 *     def getNumberPolys(self):             # <<<<<<<<<<<<<<
 *         return len(self.polygons)
 *
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_47getNumberPolys(
    PyObject *__pyx_self, PyObject *__pyx_v_self); /*proto*/
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_47getNumberPolys =
    {"getNumberPolys",
     (PyCFunction)__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_47getNumberPolys,
     METH_O, 0};
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_47getNumberPolys(
    PyObject *__pyx_self, PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext(
      "getNumberPolys (wrapper)", 0);
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_46getNumberPolys(
      __pyx_self, ((PyObject *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_46getNumberPolys(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("getNumberPolys", 0);

  /* "pyg4ometry/pycsg/core.pyx":619
   *
   *     def getNumberPolys(self):
   *         return len(self.polygons)             # <<<<<<<<<<<<<<
   *
   *     @classmethod
   */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_polygons);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 619, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_Length(__pyx_t_1);
  if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1)))
    __PYX_ERR(0, 619, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_2);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 619, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":618
 *         return csg
 *
 *     def getNumberPolys(self):             # <<<<<<<<<<<<<<
 *         return len(self.polygons)
 *
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.getNumberPolys", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":622
 *
 *     @classmethod
 *     def cube(cls, center=[0,0,0], radius=[1,1,1]):             #
 * <<<<<<<<<<<<<<
 *         """
 *         Construct an axis-aligned solid cuboid. Optional parameters are
 * `center` and
 */

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_2__defaults__(
    CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__defaults__", 0);
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyTuple_New(2);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 622, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(
      __Pyx_CyFunction_Defaults(__pyx_defaults, __pyx_self)->__pyx_arg_center);
  __Pyx_GIVEREF(
      __Pyx_CyFunction_Defaults(__pyx_defaults, __pyx_self)->__pyx_arg_center);
  PyTuple_SET_ITEM(
      __pyx_t_1, 0,
      __Pyx_CyFunction_Defaults(__pyx_defaults, __pyx_self)->__pyx_arg_center);
  __Pyx_INCREF(
      __Pyx_CyFunction_Defaults(__pyx_defaults, __pyx_self)->__pyx_arg_radius);
  __Pyx_GIVEREF(
      __Pyx_CyFunction_Defaults(__pyx_defaults, __pyx_self)->__pyx_arg_radius);
  PyTuple_SET_ITEM(
      __pyx_t_1, 1,
      __Pyx_CyFunction_Defaults(__pyx_defaults, __pyx_self)->__pyx_arg_radius);
  __pyx_t_2 = PyTuple_New(2);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 622, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  PyTuple_SET_ITEM(__pyx_t_2, 1, Py_None);
  __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.__defaults__", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_49cube(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_48cube[] =
    "\n        Construct an axis-aligned solid cuboid. Optional parameters are "
    "`center` and\n        `radius`, which default to `[0, 0, 0]` and `[1, 1, "
    "1]`. The radius can be\n        specified using a single number or a list "
    "of three numbers, one for each axis.\n        \n        Example code::\n  "
    "      \n            cube = CSG.cube(\n              center=[0, 0, 0],\n   "
    "           radius=1\n            )\n        ";
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_49cube = {
    "cube",
    (PyCFunction)(void *)(PyCFunctionWithKeywords)
        __pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_49cube,
    METH_VARARGS | METH_KEYWORDS,
    __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_48cube};
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_49cube(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED PyObject *__pyx_v_cls = 0;
  PyObject *__pyx_v_center = 0;
  PyObject *__pyx_v_radius = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext("cube (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_cls, &__pyx_n_s_center,
                                            &__pyx_n_s_radius, 0};
    PyObject *values[3] = {0, 0, 0};
    __pyx_defaults *__pyx_dynamic_args =
        __Pyx_CyFunction_Defaults(__pyx_defaults, __pyx_self);
    values[1] = __pyx_dynamic_args->__pyx_arg_center;
    values[2] = __pyx_dynamic_args->__pyx_arg_radius;
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
      case 3:
        values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
      case 2:
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
      case 1:
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
      case 0:
        break;
      default:
        goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
      case 0:
        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_cls)) != 0))
          kw_args--;
        else
          goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
      case 1:
        if (kw_args > 0) {
          PyObject *value =
              __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_center);
          if (value) {
            values[1] = value;
            kw_args--;
          }
        }
        CYTHON_FALLTHROUGH;
      case 2:
        if (kw_args > 0) {
          PyObject *value =
              __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_radius);
          if (value) {
            values[2] = value;
            kw_args--;
          }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames,
                                                 0, values, pos_args,
                                                 "cube") < 0))
          __PYX_ERR(0, 622, __pyx_L3_error)
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
      case 3:
        values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
      case 2:
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
      case 1:
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        break;
      default:
        goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_cls = values[0];
    __pyx_v_center = values[1];
    __pyx_v_radius = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
__pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("cube", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args));
  __PYX_ERR(0, 622, __pyx_L3_error)
__pyx_L3_error:;
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.cube", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
__pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_48cube(
      __pyx_self, __pyx_v_cls, __pyx_v_center, __pyx_v_radius);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_48cube(
    CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_cls,
    PyObject *__pyx_v_center, PyObject *__pyx_v_radius) {
  PyObject *__pyx_v_c = NULL;
  PyObject *__pyx_v_r = NULL;
  PyObject *__pyx_v_polygons = NULL;
  PyObject *__pyx_8genexpr3__pyx_v_v = NULL;
  PyObject *__pyx_8genexpr4__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  int __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  PyObject *__pyx_t_10 = NULL;
  PyObject *__pyx_t_11 = NULL;
  Py_ssize_t __pyx_t_12;
  Py_ssize_t __pyx_t_13;
  PyObject *(*__pyx_t_14)(PyObject *);
  PyObject *__pyx_t_15 = NULL;
  PyObject *__pyx_t_16 = NULL;
  PyObject *__pyx_t_17 = NULL;
  PyObject *__pyx_t_18 = NULL;
  PyObject *__pyx_t_19 = NULL;
  PyObject *__pyx_t_20 = NULL;
  PyObject *__pyx_t_21 = NULL;
  int __pyx_t_22;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("cube", 0);

  /* "pyg4ometry/pycsg/core.pyx":635
   *             )
   *         """
   *         c = Vector(0, 0, 0)             # <<<<<<<<<<<<<<
   *         r = [1, 1, 1]
   *         if isinstance(center, list): c = Vector(center)
   */
  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_Vector);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 635, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__14, NULL);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 635, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_v_c = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":636
   *         """
   *         c = Vector(0, 0, 0)
   *         r = [1, 1, 1]             # <<<<<<<<<<<<<<
   *         if isinstance(center, list): c = Vector(center)
   *         if isinstance(radius, list): r = radius
   */
  __pyx_t_2 = PyList_New(3);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 636, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_int_1);
  __Pyx_GIVEREF(__pyx_int_1);
  PyList_SET_ITEM(__pyx_t_2, 0, __pyx_int_1);
  __Pyx_INCREF(__pyx_int_1);
  __Pyx_GIVEREF(__pyx_int_1);
  PyList_SET_ITEM(__pyx_t_2, 1, __pyx_int_1);
  __Pyx_INCREF(__pyx_int_1);
  __Pyx_GIVEREF(__pyx_int_1);
  PyList_SET_ITEM(__pyx_t_2, 2, __pyx_int_1);
  __pyx_v_r = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":637
   *         c = Vector(0, 0, 0)
   *         r = [1, 1, 1]
   *         if isinstance(center, list): c = Vector(center)             #
   * <<<<<<<<<<<<<< if isinstance(radius, list): r = radius else: r = [radius,
   * radius, radius]
   */
  __pyx_t_3 = PyList_Check(__pyx_v_center);
  __pyx_t_4 = (__pyx_t_3 != 0);
  if (__pyx_t_4) {
    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_Vector);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 637, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = NULL;
    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
      if (likely(__pyx_t_5)) {
        PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_1);
        __Pyx_INCREF(__pyx_t_5);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_1, function);
      }
    }
    __pyx_t_2 =
        (__pyx_t_5)
            ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_5, __pyx_v_center)
            : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_center);
    __Pyx_XDECREF(__pyx_t_5);
    __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 637, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __Pyx_DECREF_SET(__pyx_v_c, __pyx_t_2);
    __pyx_t_2 = 0;
  }

  /* "pyg4ometry/pycsg/core.pyx":638
   *         r = [1, 1, 1]
   *         if isinstance(center, list): c = Vector(center)
   *         if isinstance(radius, list): r = radius             #
   * <<<<<<<<<<<<<< else: r = [radius, radius, radius]
   *
   */
  __pyx_t_4 = PyList_Check(__pyx_v_radius);
  __pyx_t_3 = (__pyx_t_4 != 0);
  if (__pyx_t_3) {
    __Pyx_INCREF(__pyx_v_radius);
    __Pyx_DECREF_SET(__pyx_v_r, __pyx_v_radius);
    goto __pyx_L4;
  }

  /* "pyg4ometry/pycsg/core.pyx":639
   *         if isinstance(center, list): c = Vector(center)
   *         if isinstance(radius, list): r = radius
   *         else: r = [radius, radius, radius]             # <<<<<<<<<<<<<<
   *
   *         polygons = list([Polygon(
   */
  /*else*/ {
    __pyx_t_2 = PyList_New(3);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 639, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_INCREF(__pyx_v_radius);
    __Pyx_GIVEREF(__pyx_v_radius);
    PyList_SET_ITEM(__pyx_t_2, 0, __pyx_v_radius);
    __Pyx_INCREF(__pyx_v_radius);
    __Pyx_GIVEREF(__pyx_v_radius);
    PyList_SET_ITEM(__pyx_t_2, 1, __pyx_v_radius);
    __Pyx_INCREF(__pyx_v_radius);
    __Pyx_GIVEREF(__pyx_v_radius);
    PyList_SET_ITEM(__pyx_t_2, 2, __pyx_v_radius);
    __Pyx_DECREF_SET(__pyx_v_r, __pyx_t_2);
    __pyx_t_2 = 0;
  }
__pyx_L4:;

  /* "pyg4ometry/pycsg/core.pyx":641
   *         else: r = [radius, radius, radius]
   *
   *         polygons = list([Polygon(             # <<<<<<<<<<<<<<
   *                 list([Vertex(
   *                         Vector(
   */
  { /* enter inner scope */
    __pyx_t_2 = PyList_New(0);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 641, __pyx_L7_error)
    __Pyx_GOTREF(__pyx_t_2);

    /* "pyg4ometry/pycsg/core.pyx":650
     *                         None
     *                     ) for i in v[0]])) for v in [
     *                         [[0, 4, 6, 2], [-1, 0, 0]],             #
     * <<<<<<<<<<<<<<
     *                         [[1, 3, 7, 5], [+1, 0, 0]],
     *                         [[0, 1, 5, 4], [0, -1, 0]],
     */
    __pyx_t_1 = PyList_New(4);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 650, __pyx_L7_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_int_0);
    __Pyx_INCREF(__pyx_int_4);
    __Pyx_GIVEREF(__pyx_int_4);
    PyList_SET_ITEM(__pyx_t_1, 1, __pyx_int_4);
    __Pyx_INCREF(__pyx_int_6);
    __Pyx_GIVEREF(__pyx_int_6);
    PyList_SET_ITEM(__pyx_t_1, 2, __pyx_int_6);
    __Pyx_INCREF(__pyx_int_2);
    __Pyx_GIVEREF(__pyx_int_2);
    PyList_SET_ITEM(__pyx_t_1, 3, __pyx_int_2);
    __pyx_t_5 = PyList_New(3);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 650, __pyx_L7_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_INCREF(__pyx_int_neg_1);
    __Pyx_GIVEREF(__pyx_int_neg_1);
    PyList_SET_ITEM(__pyx_t_5, 0, __pyx_int_neg_1);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_5, 1, __pyx_int_0);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_5, 2, __pyx_int_0);
    __pyx_t_6 = PyList_New(2);
    if (unlikely(!__pyx_t_6))
      __PYX_ERR(0, 650, __pyx_L7_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_1);
    PyList_SET_ITEM(__pyx_t_6, 0, __pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_5);
    PyList_SET_ITEM(__pyx_t_6, 1, __pyx_t_5);
    __pyx_t_1 = 0;
    __pyx_t_5 = 0;

    /* "pyg4ometry/pycsg/core.pyx":651
     *                     ) for i in v[0]])) for v in [
     *                         [[0, 4, 6, 2], [-1, 0, 0]],
     *                         [[1, 3, 7, 5], [+1, 0, 0]],             #
     * <<<<<<<<<<<<<<
     *                         [[0, 1, 5, 4], [0, -1, 0]],
     *                         [[2, 6, 7, 3], [0, +1, 0]],
     */
    __pyx_t_5 = PyList_New(4);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 651, __pyx_L7_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_INCREF(__pyx_int_1);
    __Pyx_GIVEREF(__pyx_int_1);
    PyList_SET_ITEM(__pyx_t_5, 0, __pyx_int_1);
    __Pyx_INCREF(__pyx_int_3);
    __Pyx_GIVEREF(__pyx_int_3);
    PyList_SET_ITEM(__pyx_t_5, 1, __pyx_int_3);
    __Pyx_INCREF(__pyx_int_7);
    __Pyx_GIVEREF(__pyx_int_7);
    PyList_SET_ITEM(__pyx_t_5, 2, __pyx_int_7);
    __Pyx_INCREF(__pyx_int_5);
    __Pyx_GIVEREF(__pyx_int_5);
    PyList_SET_ITEM(__pyx_t_5, 3, __pyx_int_5);
    __pyx_t_1 = PyList_New(3);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 651, __pyx_L7_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_int_1);
    __Pyx_GIVEREF(__pyx_int_1);
    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_int_1);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_1, 1, __pyx_int_0);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_1, 2, __pyx_int_0);
    __pyx_t_7 = PyList_New(2);
    if (unlikely(!__pyx_t_7))
      __PYX_ERR(0, 651, __pyx_L7_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_GIVEREF(__pyx_t_5);
    PyList_SET_ITEM(__pyx_t_7, 0, __pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_1);
    PyList_SET_ITEM(__pyx_t_7, 1, __pyx_t_1);
    __pyx_t_5 = 0;
    __pyx_t_1 = 0;

    /* "pyg4ometry/pycsg/core.pyx":652
     *                         [[0, 4, 6, 2], [-1, 0, 0]],
     *                         [[1, 3, 7, 5], [+1, 0, 0]],
     *                         [[0, 1, 5, 4], [0, -1, 0]],             #
     * <<<<<<<<<<<<<<
     *                         [[2, 6, 7, 3], [0, +1, 0]],
     *                         [[0, 2, 3, 1], [0, 0, -1]],
     */
    __pyx_t_1 = PyList_New(4);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 652, __pyx_L7_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_int_0);
    __Pyx_INCREF(__pyx_int_1);
    __Pyx_GIVEREF(__pyx_int_1);
    PyList_SET_ITEM(__pyx_t_1, 1, __pyx_int_1);
    __Pyx_INCREF(__pyx_int_5);
    __Pyx_GIVEREF(__pyx_int_5);
    PyList_SET_ITEM(__pyx_t_1, 2, __pyx_int_5);
    __Pyx_INCREF(__pyx_int_4);
    __Pyx_GIVEREF(__pyx_int_4);
    PyList_SET_ITEM(__pyx_t_1, 3, __pyx_int_4);
    __pyx_t_5 = PyList_New(3);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 652, __pyx_L7_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_5, 0, __pyx_int_0);
    __Pyx_INCREF(__pyx_int_neg_1);
    __Pyx_GIVEREF(__pyx_int_neg_1);
    PyList_SET_ITEM(__pyx_t_5, 1, __pyx_int_neg_1);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_5, 2, __pyx_int_0);
    __pyx_t_8 = PyList_New(2);
    if (unlikely(!__pyx_t_8))
      __PYX_ERR(0, 652, __pyx_L7_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_GIVEREF(__pyx_t_1);
    PyList_SET_ITEM(__pyx_t_8, 0, __pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_5);
    PyList_SET_ITEM(__pyx_t_8, 1, __pyx_t_5);
    __pyx_t_1 = 0;
    __pyx_t_5 = 0;

    /* "pyg4ometry/pycsg/core.pyx":653
     *                         [[1, 3, 7, 5], [+1, 0, 0]],
     *                         [[0, 1, 5, 4], [0, -1, 0]],
     *                         [[2, 6, 7, 3], [0, +1, 0]],             #
     * <<<<<<<<<<<<<<
     *                         [[0, 2, 3, 1], [0, 0, -1]],
     *                         [[4, 5, 7, 6], [0, 0, +1]]
     */
    __pyx_t_5 = PyList_New(4);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 653, __pyx_L7_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_INCREF(__pyx_int_2);
    __Pyx_GIVEREF(__pyx_int_2);
    PyList_SET_ITEM(__pyx_t_5, 0, __pyx_int_2);
    __Pyx_INCREF(__pyx_int_6);
    __Pyx_GIVEREF(__pyx_int_6);
    PyList_SET_ITEM(__pyx_t_5, 1, __pyx_int_6);
    __Pyx_INCREF(__pyx_int_7);
    __Pyx_GIVEREF(__pyx_int_7);
    PyList_SET_ITEM(__pyx_t_5, 2, __pyx_int_7);
    __Pyx_INCREF(__pyx_int_3);
    __Pyx_GIVEREF(__pyx_int_3);
    PyList_SET_ITEM(__pyx_t_5, 3, __pyx_int_3);
    __pyx_t_1 = PyList_New(3);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 653, __pyx_L7_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_int_0);
    __Pyx_INCREF(__pyx_int_1);
    __Pyx_GIVEREF(__pyx_int_1);
    PyList_SET_ITEM(__pyx_t_1, 1, __pyx_int_1);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_1, 2, __pyx_int_0);
    __pyx_t_9 = PyList_New(2);
    if (unlikely(!__pyx_t_9))
      __PYX_ERR(0, 653, __pyx_L7_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_GIVEREF(__pyx_t_5);
    PyList_SET_ITEM(__pyx_t_9, 0, __pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_1);
    PyList_SET_ITEM(__pyx_t_9, 1, __pyx_t_1);
    __pyx_t_5 = 0;
    __pyx_t_1 = 0;

    /* "pyg4ometry/pycsg/core.pyx":654
     *                         [[0, 1, 5, 4], [0, -1, 0]],
     *                         [[2, 6, 7, 3], [0, +1, 0]],
     *                         [[0, 2, 3, 1], [0, 0, -1]],             #
     * <<<<<<<<<<<<<<
     *                         [[4, 5, 7, 6], [0, 0, +1]]
     *                     ]])
     */
    __pyx_t_1 = PyList_New(4);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 654, __pyx_L7_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_int_0);
    __Pyx_INCREF(__pyx_int_2);
    __Pyx_GIVEREF(__pyx_int_2);
    PyList_SET_ITEM(__pyx_t_1, 1, __pyx_int_2);
    __Pyx_INCREF(__pyx_int_3);
    __Pyx_GIVEREF(__pyx_int_3);
    PyList_SET_ITEM(__pyx_t_1, 2, __pyx_int_3);
    __Pyx_INCREF(__pyx_int_1);
    __Pyx_GIVEREF(__pyx_int_1);
    PyList_SET_ITEM(__pyx_t_1, 3, __pyx_int_1);
    __pyx_t_5 = PyList_New(3);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 654, __pyx_L7_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_5, 0, __pyx_int_0);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_5, 1, __pyx_int_0);
    __Pyx_INCREF(__pyx_int_neg_1);
    __Pyx_GIVEREF(__pyx_int_neg_1);
    PyList_SET_ITEM(__pyx_t_5, 2, __pyx_int_neg_1);
    __pyx_t_10 = PyList_New(2);
    if (unlikely(!__pyx_t_10))
      __PYX_ERR(0, 654, __pyx_L7_error)
    __Pyx_GOTREF(__pyx_t_10);
    __Pyx_GIVEREF(__pyx_t_1);
    PyList_SET_ITEM(__pyx_t_10, 0, __pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_5);
    PyList_SET_ITEM(__pyx_t_10, 1, __pyx_t_5);
    __pyx_t_1 = 0;
    __pyx_t_5 = 0;

    /* "pyg4ometry/pycsg/core.pyx":655
     *                         [[2, 6, 7, 3], [0, +1, 0]],
     *                         [[0, 2, 3, 1], [0, 0, -1]],
     *                         [[4, 5, 7, 6], [0, 0, +1]]             #
     * <<<<<<<<<<<<<<
     *                     ]])
     *         return CSG.fromPolygons(polygons)
     */
    __pyx_t_5 = PyList_New(4);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 655, __pyx_L7_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_INCREF(__pyx_int_4);
    __Pyx_GIVEREF(__pyx_int_4);
    PyList_SET_ITEM(__pyx_t_5, 0, __pyx_int_4);
    __Pyx_INCREF(__pyx_int_5);
    __Pyx_GIVEREF(__pyx_int_5);
    PyList_SET_ITEM(__pyx_t_5, 1, __pyx_int_5);
    __Pyx_INCREF(__pyx_int_7);
    __Pyx_GIVEREF(__pyx_int_7);
    PyList_SET_ITEM(__pyx_t_5, 2, __pyx_int_7);
    __Pyx_INCREF(__pyx_int_6);
    __Pyx_GIVEREF(__pyx_int_6);
    PyList_SET_ITEM(__pyx_t_5, 3, __pyx_int_6);
    __pyx_t_1 = PyList_New(3);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 655, __pyx_L7_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_int_0);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_1, 1, __pyx_int_0);
    __Pyx_INCREF(__pyx_int_1);
    __Pyx_GIVEREF(__pyx_int_1);
    PyList_SET_ITEM(__pyx_t_1, 2, __pyx_int_1);
    __pyx_t_11 = PyList_New(2);
    if (unlikely(!__pyx_t_11))
      __PYX_ERR(0, 655, __pyx_L7_error)
    __Pyx_GOTREF(__pyx_t_11);
    __Pyx_GIVEREF(__pyx_t_5);
    PyList_SET_ITEM(__pyx_t_11, 0, __pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_1);
    PyList_SET_ITEM(__pyx_t_11, 1, __pyx_t_1);
    __pyx_t_5 = 0;
    __pyx_t_1 = 0;

    /* "pyg4ometry/pycsg/core.pyx":649
     *                         ),
     *                         None
     *                     ) for i in v[0]])) for v in [             #
     * <<<<<<<<<<<<<<
     *                         [[0, 4, 6, 2], [-1, 0, 0]],
     *                         [[1, 3, 7, 5], [+1, 0, 0]],
     */
    __pyx_t_1 = PyTuple_New(6);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 649, __pyx_L7_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_6);
    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_7);
    PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_7);
    __Pyx_GIVEREF(__pyx_t_8);
    PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_t_8);
    __Pyx_GIVEREF(__pyx_t_9);
    PyTuple_SET_ITEM(__pyx_t_1, 3, __pyx_t_9);
    __Pyx_GIVEREF(__pyx_t_10);
    PyTuple_SET_ITEM(__pyx_t_1, 4, __pyx_t_10);
    __Pyx_GIVEREF(__pyx_t_11);
    PyTuple_SET_ITEM(__pyx_t_1, 5, __pyx_t_11);
    __pyx_t_6 = 0;
    __pyx_t_7 = 0;
    __pyx_t_8 = 0;
    __pyx_t_9 = 0;
    __pyx_t_10 = 0;
    __pyx_t_11 = 0;
    __pyx_t_11 = __pyx_t_1;
    __Pyx_INCREF(__pyx_t_11);
    __pyx_t_12 = 0;
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    for (;;) {
      if (__pyx_t_12 >= 6)
        break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
      __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_11, __pyx_t_12);
      __Pyx_INCREF(__pyx_t_1);
      __pyx_t_12++;
      if (unlikely(0 < 0))
        __PYX_ERR(0, 649, __pyx_L7_error)
#else
      __pyx_t_1 = PySequence_ITEM(__pyx_t_11, __pyx_t_12);
      __pyx_t_12++;
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 649, __pyx_L7_error)
      __Pyx_GOTREF(__pyx_t_1);
#endif
      __Pyx_XDECREF_SET(__pyx_8genexpr3__pyx_v_v, ((PyObject *)__pyx_t_1));
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":641
       *         else: r = [radius, radius, radius]
       *
       *         polygons = list([Polygon(             # <<<<<<<<<<<<<<
       *                 list([Vertex(
       *                         Vector(
       */
      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_Polygon);
      if (unlikely(!__pyx_t_10))
        __PYX_ERR(0, 641, __pyx_L7_error)
      __Pyx_GOTREF(__pyx_t_10);

      /* "pyg4ometry/pycsg/core.pyx":642
       *
       *         polygons = list([Polygon(
       *                 list([Vertex(             # <<<<<<<<<<<<<<
       *                         Vector(
       *                             c.x + r[0] * (2 * bool(i & 1) - 1),
       */
      { /* enter inner scope */
        __pyx_t_9 = PyList_New(0);
        if (unlikely(!__pyx_t_9))
          __PYX_ERR(0, 642, __pyx_L12_error)
        __Pyx_GOTREF(__pyx_t_9);

        /* "pyg4ometry/pycsg/core.pyx":649
         *                         ),
         *                         None
         *                     ) for i in v[0]])) for v in [             #
         * <<<<<<<<<<<<<<
         *                         [[0, 4, 6, 2], [-1, 0, 0]],
         *                         [[1, 3, 7, 5], [+1, 0, 0]],
         */
        if (unlikely(__pyx_8genexpr3__pyx_v_v == Py_None)) {
          PyErr_SetString(PyExc_TypeError,
                          "'NoneType' object is not subscriptable");
          __PYX_ERR(0, 649, __pyx_L12_error)
        }
        __pyx_t_8 = __Pyx_GetItemInt_List(__pyx_8genexpr3__pyx_v_v, 0, long, 1,
                                          __Pyx_PyInt_From_long, 1, 0, 1);
        if (unlikely(!__pyx_t_8))
          __PYX_ERR(0, 649, __pyx_L12_error)
        __Pyx_GOTREF(__pyx_t_8);
        if (likely(PyList_CheckExact(__pyx_t_8)) ||
            PyTuple_CheckExact(__pyx_t_8)) {
          __pyx_t_7 = __pyx_t_8;
          __Pyx_INCREF(__pyx_t_7);
          __pyx_t_13 = 0;
          __pyx_t_14 = NULL;
        } else {
          __pyx_t_13 = -1;
          __pyx_t_7 = PyObject_GetIter(__pyx_t_8);
          if (unlikely(!__pyx_t_7))
            __PYX_ERR(0, 649, __pyx_L12_error)
          __Pyx_GOTREF(__pyx_t_7);
          __pyx_t_14 = Py_TYPE(__pyx_t_7)->tp_iternext;
          if (unlikely(!__pyx_t_14))
            __PYX_ERR(0, 649, __pyx_L12_error)
        }
        __Pyx_DECREF(__pyx_t_8);
        __pyx_t_8 = 0;
        for (;;) {
          if (likely(!__pyx_t_14)) {
            if (likely(PyList_CheckExact(__pyx_t_7))) {
              if (__pyx_t_13 >= PyList_GET_SIZE(__pyx_t_7))
                break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
              __pyx_t_8 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_13);
              __Pyx_INCREF(__pyx_t_8);
              __pyx_t_13++;
              if (unlikely(0 < 0))
                __PYX_ERR(0, 649, __pyx_L12_error)
#else
              __pyx_t_8 = PySequence_ITEM(__pyx_t_7, __pyx_t_13);
              __pyx_t_13++;
              if (unlikely(!__pyx_t_8))
                __PYX_ERR(0, 649, __pyx_L12_error)
              __Pyx_GOTREF(__pyx_t_8);
#endif
            } else {
              if (__pyx_t_13 >= PyTuple_GET_SIZE(__pyx_t_7))
                break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
              __pyx_t_8 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_13);
              __Pyx_INCREF(__pyx_t_8);
              __pyx_t_13++;
              if (unlikely(0 < 0))
                __PYX_ERR(0, 649, __pyx_L12_error)
#else
              __pyx_t_8 = PySequence_ITEM(__pyx_t_7, __pyx_t_13);
              __pyx_t_13++;
              if (unlikely(!__pyx_t_8))
                __PYX_ERR(0, 649, __pyx_L12_error)
              __Pyx_GOTREF(__pyx_t_8);
#endif
            }
          } else {
            __pyx_t_8 = __pyx_t_14(__pyx_t_7);
            if (unlikely(!__pyx_t_8)) {
              PyObject *exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(__Pyx_PyErr_GivenExceptionMatches(
                        exc_type, PyExc_StopIteration)))
                  PyErr_Clear();
                else
                  __PYX_ERR(0, 649, __pyx_L12_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_8);
          }
          __Pyx_XDECREF_SET(__pyx_8genexpr4__pyx_v_i, __pyx_t_8);
          __pyx_t_8 = 0;

          /* "pyg4ometry/pycsg/core.pyx":642
           *
           *         polygons = list([Polygon(
           *                 list([Vertex(             # <<<<<<<<<<<<<<
           *                         Vector(
           *                             c.x + r[0] * (2 * bool(i & 1) - 1),
           */
          __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_Vertex);
          if (unlikely(!__pyx_t_6))
            __PYX_ERR(0, 642, __pyx_L12_error)
          __Pyx_GOTREF(__pyx_t_6);

          /* "pyg4ometry/pycsg/core.pyx":643
           *         polygons = list([Polygon(
           *                 list([Vertex(
           *                         Vector(             # <<<<<<<<<<<<<<
           *                             c.x + r[0] * (2 * bool(i & 1) - 1),
           *                             c.y + r[1] * (2 * bool(i & 2) - 1),
           */
          __Pyx_GetModuleGlobalName(__pyx_t_15, __pyx_n_s_Vector);
          if (unlikely(!__pyx_t_15))
            __PYX_ERR(0, 643, __pyx_L12_error)
          __Pyx_GOTREF(__pyx_t_15);

          /* "pyg4ometry/pycsg/core.pyx":644
           *                 list([Vertex(
           *                         Vector(
           *                             c.x + r[0] * (2 * bool(i & 1) - 1), #
           * <<<<<<<<<<<<<< c.y + r[1] * (2 * bool(i & 2) - 1), c.z + r[2] * (2
           * * bool(i & 4) - 1)
           */
          __pyx_t_16 = __Pyx_PyObject_GetAttrStr(__pyx_v_c, __pyx_n_s_x);
          if (unlikely(!__pyx_t_16))
            __PYX_ERR(0, 644, __pyx_L12_error)
          __Pyx_GOTREF(__pyx_t_16);
          __pyx_t_17 = __Pyx_GetItemInt(__pyx_v_r, 0, long, 1,
                                        __Pyx_PyInt_From_long, 0, 0, 1);
          if (unlikely(!__pyx_t_17))
            __PYX_ERR(0, 644, __pyx_L12_error)
          __Pyx_GOTREF(__pyx_t_17);
          __pyx_t_18 = __Pyx_PyInt_AndObjC(__pyx_8genexpr4__pyx_v_i,
                                           __pyx_int_1, 1, 0, 0);
          if (unlikely(!__pyx_t_18))
            __PYX_ERR(0, 644, __pyx_L12_error)
          __Pyx_GOTREF(__pyx_t_18);
          __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_18);
          if (unlikely(__pyx_t_3 < 0))
            __PYX_ERR(0, 644, __pyx_L12_error)
          __Pyx_DECREF(__pyx_t_18);
          __pyx_t_18 = 0;
          __pyx_t_18 = __Pyx_PyBool_FromLong((!(!__pyx_t_3)));
          if (unlikely(!__pyx_t_18))
            __PYX_ERR(0, 644, __pyx_L12_error)
          __Pyx_GOTREF(__pyx_t_18);
          __pyx_t_19 = PyNumber_Multiply(__pyx_int_2, __pyx_t_18);
          if (unlikely(!__pyx_t_19))
            __PYX_ERR(0, 644, __pyx_L12_error)
          __Pyx_GOTREF(__pyx_t_19);
          __Pyx_DECREF(__pyx_t_18);
          __pyx_t_18 = 0;
          __pyx_t_18 =
              __Pyx_PyInt_SubtractObjC(__pyx_t_19, __pyx_int_1, 1, 0, 0);
          if (unlikely(!__pyx_t_18))
            __PYX_ERR(0, 644, __pyx_L12_error)
          __Pyx_GOTREF(__pyx_t_18);
          __Pyx_DECREF(__pyx_t_19);
          __pyx_t_19 = 0;
          __pyx_t_19 = PyNumber_Multiply(__pyx_t_17, __pyx_t_18);
          if (unlikely(!__pyx_t_19))
            __PYX_ERR(0, 644, __pyx_L12_error)
          __Pyx_GOTREF(__pyx_t_19);
          __Pyx_DECREF(__pyx_t_17);
          __pyx_t_17 = 0;
          __Pyx_DECREF(__pyx_t_18);
          __pyx_t_18 = 0;
          __pyx_t_18 = PyNumber_Add(__pyx_t_16, __pyx_t_19);
          if (unlikely(!__pyx_t_18))
            __PYX_ERR(0, 644, __pyx_L12_error)
          __Pyx_GOTREF(__pyx_t_18);
          __Pyx_DECREF(__pyx_t_16);
          __pyx_t_16 = 0;
          __Pyx_DECREF(__pyx_t_19);
          __pyx_t_19 = 0;

          /* "pyg4ometry/pycsg/core.pyx":645
           *                         Vector(
           *                             c.x + r[0] * (2 * bool(i & 1) - 1),
           *                             c.y + r[1] * (2 * bool(i & 2) - 1), #
           * <<<<<<<<<<<<<< c.z + r[2] * (2 * bool(i & 4) - 1)
           *                         ),
           */
          __pyx_t_19 = __Pyx_PyObject_GetAttrStr(__pyx_v_c, __pyx_n_s_y);
          if (unlikely(!__pyx_t_19))
            __PYX_ERR(0, 645, __pyx_L12_error)
          __Pyx_GOTREF(__pyx_t_19);
          __pyx_t_16 = __Pyx_GetItemInt(__pyx_v_r, 1, long, 1,
                                        __Pyx_PyInt_From_long, 0, 0, 1);
          if (unlikely(!__pyx_t_16))
            __PYX_ERR(0, 645, __pyx_L12_error)
          __Pyx_GOTREF(__pyx_t_16);
          __pyx_t_17 = __Pyx_PyInt_AndObjC(__pyx_8genexpr4__pyx_v_i,
                                           __pyx_int_2, 2, 0, 0);
          if (unlikely(!__pyx_t_17))
            __PYX_ERR(0, 645, __pyx_L12_error)
          __Pyx_GOTREF(__pyx_t_17);
          __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_17);
          if (unlikely(__pyx_t_3 < 0))
            __PYX_ERR(0, 645, __pyx_L12_error)
          __Pyx_DECREF(__pyx_t_17);
          __pyx_t_17 = 0;
          __pyx_t_17 = __Pyx_PyBool_FromLong((!(!__pyx_t_3)));
          if (unlikely(!__pyx_t_17))
            __PYX_ERR(0, 645, __pyx_L12_error)
          __Pyx_GOTREF(__pyx_t_17);
          __pyx_t_20 = PyNumber_Multiply(__pyx_int_2, __pyx_t_17);
          if (unlikely(!__pyx_t_20))
            __PYX_ERR(0, 645, __pyx_L12_error)
          __Pyx_GOTREF(__pyx_t_20);
          __Pyx_DECREF(__pyx_t_17);
          __pyx_t_17 = 0;
          __pyx_t_17 =
              __Pyx_PyInt_SubtractObjC(__pyx_t_20, __pyx_int_1, 1, 0, 0);
          if (unlikely(!__pyx_t_17))
            __PYX_ERR(0, 645, __pyx_L12_error)
          __Pyx_GOTREF(__pyx_t_17);
          __Pyx_DECREF(__pyx_t_20);
          __pyx_t_20 = 0;
          __pyx_t_20 = PyNumber_Multiply(__pyx_t_16, __pyx_t_17);
          if (unlikely(!__pyx_t_20))
            __PYX_ERR(0, 645, __pyx_L12_error)
          __Pyx_GOTREF(__pyx_t_20);
          __Pyx_DECREF(__pyx_t_16);
          __pyx_t_16 = 0;
          __Pyx_DECREF(__pyx_t_17);
          __pyx_t_17 = 0;
          __pyx_t_17 = PyNumber_Add(__pyx_t_19, __pyx_t_20);
          if (unlikely(!__pyx_t_17))
            __PYX_ERR(0, 645, __pyx_L12_error)
          __Pyx_GOTREF(__pyx_t_17);
          __Pyx_DECREF(__pyx_t_19);
          __pyx_t_19 = 0;
          __Pyx_DECREF(__pyx_t_20);
          __pyx_t_20 = 0;

          /* "pyg4ometry/pycsg/core.pyx":646
           *                             c.x + r[0] * (2 * bool(i & 1) - 1),
           *                             c.y + r[1] * (2 * bool(i & 2) - 1),
           *                             c.z + r[2] * (2 * bool(i & 4) - 1) #
           * <<<<<<<<<<<<<<
           *                         ),
           *                         None
           */
          __pyx_t_20 = __Pyx_PyObject_GetAttrStr(__pyx_v_c, __pyx_n_s_z);
          if (unlikely(!__pyx_t_20))
            __PYX_ERR(0, 646, __pyx_L12_error)
          __Pyx_GOTREF(__pyx_t_20);
          __pyx_t_19 = __Pyx_GetItemInt(__pyx_v_r, 2, long, 1,
                                        __Pyx_PyInt_From_long, 0, 0, 1);
          if (unlikely(!__pyx_t_19))
            __PYX_ERR(0, 646, __pyx_L12_error)
          __Pyx_GOTREF(__pyx_t_19);
          __pyx_t_16 = __Pyx_PyInt_AndObjC(__pyx_8genexpr4__pyx_v_i,
                                           __pyx_int_4, 4, 0, 0);
          if (unlikely(!__pyx_t_16))
            __PYX_ERR(0, 646, __pyx_L12_error)
          __Pyx_GOTREF(__pyx_t_16);
          __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_16);
          if (unlikely(__pyx_t_3 < 0))
            __PYX_ERR(0, 646, __pyx_L12_error)
          __Pyx_DECREF(__pyx_t_16);
          __pyx_t_16 = 0;
          __pyx_t_16 = __Pyx_PyBool_FromLong((!(!__pyx_t_3)));
          if (unlikely(!__pyx_t_16))
            __PYX_ERR(0, 646, __pyx_L12_error)
          __Pyx_GOTREF(__pyx_t_16);
          __pyx_t_21 = PyNumber_Multiply(__pyx_int_2, __pyx_t_16);
          if (unlikely(!__pyx_t_21))
            __PYX_ERR(0, 646, __pyx_L12_error)
          __Pyx_GOTREF(__pyx_t_21);
          __Pyx_DECREF(__pyx_t_16);
          __pyx_t_16 = 0;
          __pyx_t_16 =
              __Pyx_PyInt_SubtractObjC(__pyx_t_21, __pyx_int_1, 1, 0, 0);
          if (unlikely(!__pyx_t_16))
            __PYX_ERR(0, 646, __pyx_L12_error)
          __Pyx_GOTREF(__pyx_t_16);
          __Pyx_DECREF(__pyx_t_21);
          __pyx_t_21 = 0;
          __pyx_t_21 = PyNumber_Multiply(__pyx_t_19, __pyx_t_16);
          if (unlikely(!__pyx_t_21))
            __PYX_ERR(0, 646, __pyx_L12_error)
          __Pyx_GOTREF(__pyx_t_21);
          __Pyx_DECREF(__pyx_t_19);
          __pyx_t_19 = 0;
          __Pyx_DECREF(__pyx_t_16);
          __pyx_t_16 = 0;
          __pyx_t_16 = PyNumber_Add(__pyx_t_20, __pyx_t_21);
          if (unlikely(!__pyx_t_16))
            __PYX_ERR(0, 646, __pyx_L12_error)
          __Pyx_GOTREF(__pyx_t_16);
          __Pyx_DECREF(__pyx_t_20);
          __pyx_t_20 = 0;
          __Pyx_DECREF(__pyx_t_21);
          __pyx_t_21 = 0;
          __pyx_t_21 = NULL;
          __pyx_t_22 = 0;
          if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_15))) {
            __pyx_t_21 = PyMethod_GET_SELF(__pyx_t_15);
            if (likely(__pyx_t_21)) {
              PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_15);
              __Pyx_INCREF(__pyx_t_21);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_15, function);
              __pyx_t_22 = 1;
            }
          }
#if CYTHON_FAST_PYCALL
          if (PyFunction_Check(__pyx_t_15)) {
            PyObject *__pyx_temp[4] = {__pyx_t_21, __pyx_t_18, __pyx_t_17,
                                       __pyx_t_16};
            __pyx_t_5 = __Pyx_PyFunction_FastCall(
                __pyx_t_15, __pyx_temp + 1 - __pyx_t_22, 3 + __pyx_t_22);
            if (unlikely(!__pyx_t_5))
              __PYX_ERR(0, 643, __pyx_L12_error)
            __Pyx_XDECREF(__pyx_t_21);
            __pyx_t_21 = 0;
            __Pyx_GOTREF(__pyx_t_5);
            __Pyx_DECREF(__pyx_t_18);
            __pyx_t_18 = 0;
            __Pyx_DECREF(__pyx_t_17);
            __pyx_t_17 = 0;
            __Pyx_DECREF(__pyx_t_16);
            __pyx_t_16 = 0;
          } else
#endif
#if CYTHON_FAST_PYCCALL
              if (__Pyx_PyFastCFunction_Check(__pyx_t_15)) {
            PyObject *__pyx_temp[4] = {__pyx_t_21, __pyx_t_18, __pyx_t_17,
                                       __pyx_t_16};
            __pyx_t_5 = __Pyx_PyCFunction_FastCall(
                __pyx_t_15, __pyx_temp + 1 - __pyx_t_22, 3 + __pyx_t_22);
            if (unlikely(!__pyx_t_5))
              __PYX_ERR(0, 643, __pyx_L12_error)
            __Pyx_XDECREF(__pyx_t_21);
            __pyx_t_21 = 0;
            __Pyx_GOTREF(__pyx_t_5);
            __Pyx_DECREF(__pyx_t_18);
            __pyx_t_18 = 0;
            __Pyx_DECREF(__pyx_t_17);
            __pyx_t_17 = 0;
            __Pyx_DECREF(__pyx_t_16);
            __pyx_t_16 = 0;
          } else
#endif
          {
            __pyx_t_20 = PyTuple_New(3 + __pyx_t_22);
            if (unlikely(!__pyx_t_20))
              __PYX_ERR(0, 643, __pyx_L12_error)
            __Pyx_GOTREF(__pyx_t_20);
            if (__pyx_t_21) {
              __Pyx_GIVEREF(__pyx_t_21);
              PyTuple_SET_ITEM(__pyx_t_20, 0, __pyx_t_21);
              __pyx_t_21 = NULL;
            }
            __Pyx_GIVEREF(__pyx_t_18);
            PyTuple_SET_ITEM(__pyx_t_20, 0 + __pyx_t_22, __pyx_t_18);
            __Pyx_GIVEREF(__pyx_t_17);
            PyTuple_SET_ITEM(__pyx_t_20, 1 + __pyx_t_22, __pyx_t_17);
            __Pyx_GIVEREF(__pyx_t_16);
            PyTuple_SET_ITEM(__pyx_t_20, 2 + __pyx_t_22, __pyx_t_16);
            __pyx_t_18 = 0;
            __pyx_t_17 = 0;
            __pyx_t_16 = 0;
            __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_15, __pyx_t_20, NULL);
            if (unlikely(!__pyx_t_5))
              __PYX_ERR(0, 643, __pyx_L12_error)
            __Pyx_GOTREF(__pyx_t_5);
            __Pyx_DECREF(__pyx_t_20);
            __pyx_t_20 = 0;
          }
          __Pyx_DECREF(__pyx_t_15);
          __pyx_t_15 = 0;

          /* "pyg4ometry/pycsg/core.pyx":648
           *                             c.z + r[2] * (2 * bool(i & 4) - 1)
           *                         ),
           *                         None             # <<<<<<<<<<<<<<
           *                     ) for i in v[0]])) for v in [
           *                         [[0, 4, 6, 2], [-1, 0, 0]],
           */
          __pyx_t_15 = NULL;
          __pyx_t_22 = 0;
          if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
            __pyx_t_15 = PyMethod_GET_SELF(__pyx_t_6);
            if (likely(__pyx_t_15)) {
              PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_6);
              __Pyx_INCREF(__pyx_t_15);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_6, function);
              __pyx_t_22 = 1;
            }
          }
#if CYTHON_FAST_PYCALL
          if (PyFunction_Check(__pyx_t_6)) {
            PyObject *__pyx_temp[3] = {__pyx_t_15, __pyx_t_5, Py_None};
            __pyx_t_8 = __Pyx_PyFunction_FastCall(
                __pyx_t_6, __pyx_temp + 1 - __pyx_t_22, 2 + __pyx_t_22);
            if (unlikely(!__pyx_t_8))
              __PYX_ERR(0, 642, __pyx_L12_error)
            __Pyx_XDECREF(__pyx_t_15);
            __pyx_t_15 = 0;
            __Pyx_GOTREF(__pyx_t_8);
            __Pyx_DECREF(__pyx_t_5);
            __pyx_t_5 = 0;
          } else
#endif
#if CYTHON_FAST_PYCCALL
              if (__Pyx_PyFastCFunction_Check(__pyx_t_6)) {
            PyObject *__pyx_temp[3] = {__pyx_t_15, __pyx_t_5, Py_None};
            __pyx_t_8 = __Pyx_PyCFunction_FastCall(
                __pyx_t_6, __pyx_temp + 1 - __pyx_t_22, 2 + __pyx_t_22);
            if (unlikely(!__pyx_t_8))
              __PYX_ERR(0, 642, __pyx_L12_error)
            __Pyx_XDECREF(__pyx_t_15);
            __pyx_t_15 = 0;
            __Pyx_GOTREF(__pyx_t_8);
            __Pyx_DECREF(__pyx_t_5);
            __pyx_t_5 = 0;
          } else
#endif
          {
            __pyx_t_20 = PyTuple_New(2 + __pyx_t_22);
            if (unlikely(!__pyx_t_20))
              __PYX_ERR(0, 642, __pyx_L12_error)
            __Pyx_GOTREF(__pyx_t_20);
            if (__pyx_t_15) {
              __Pyx_GIVEREF(__pyx_t_15);
              PyTuple_SET_ITEM(__pyx_t_20, 0, __pyx_t_15);
              __pyx_t_15 = NULL;
            }
            __Pyx_GIVEREF(__pyx_t_5);
            PyTuple_SET_ITEM(__pyx_t_20, 0 + __pyx_t_22, __pyx_t_5);
            __Pyx_INCREF(Py_None);
            __Pyx_GIVEREF(Py_None);
            PyTuple_SET_ITEM(__pyx_t_20, 1 + __pyx_t_22, Py_None);
            __pyx_t_5 = 0;
            __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_20, NULL);
            if (unlikely(!__pyx_t_8))
              __PYX_ERR(0, 642, __pyx_L12_error)
            __Pyx_GOTREF(__pyx_t_8);
            __Pyx_DECREF(__pyx_t_20);
            __pyx_t_20 = 0;
          }
          __Pyx_DECREF(__pyx_t_6);
          __pyx_t_6 = 0;
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_9, (PyObject *)__pyx_t_8)))
            __PYX_ERR(0, 642, __pyx_L12_error)
          __Pyx_DECREF(__pyx_t_8);
          __pyx_t_8 = 0;

          /* "pyg4ometry/pycsg/core.pyx":649
           *                         ),
           *                         None
           *                     ) for i in v[0]])) for v in [             #
           * <<<<<<<<<<<<<<
           *                         [[0, 4, 6, 2], [-1, 0, 0]],
           *                         [[1, 3, 7, 5], [+1, 0, 0]],
           */
        }
        __Pyx_DECREF(__pyx_t_7);
        __pyx_t_7 = 0;
        __Pyx_XDECREF(__pyx_8genexpr4__pyx_v_i);
        __pyx_8genexpr4__pyx_v_i = 0;
        goto __pyx_L15_exit_scope;
      __pyx_L12_error:;
        __Pyx_XDECREF(__pyx_8genexpr4__pyx_v_i);
        __pyx_8genexpr4__pyx_v_i = 0;
        goto __pyx_L7_error;
      __pyx_L15_exit_scope:;
      } /* exit inner scope */

      /* "pyg4ometry/pycsg/core.pyx":642
       *
       *         polygons = list([Polygon(
       *                 list([Vertex(             # <<<<<<<<<<<<<<
       *                         Vector(
       *                             c.x + r[0] * (2 * bool(i & 1) - 1),
       */
      __pyx_t_7 = PySequence_List(__pyx_t_9);
      if (unlikely(!__pyx_t_7))
        __PYX_ERR(0, 642, __pyx_L7_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      __pyx_t_9 = NULL;
      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_10))) {
        __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_10);
        if (likely(__pyx_t_9)) {
          PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_10);
          __Pyx_INCREF(__pyx_t_9);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_10, function);
        }
      }
      __pyx_t_1 =
          (__pyx_t_9)
              ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_9, __pyx_t_7)
              : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_7);
      __Pyx_XDECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      __Pyx_DECREF(__pyx_t_7);
      __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 641, __pyx_L7_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_10);
      __pyx_t_10 = 0;
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject *)__pyx_t_1)))
        __PYX_ERR(0, 641, __pyx_L7_error)
      __Pyx_DECREF(__pyx_t_1);
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":649
       *                         ),
       *                         None
       *                     ) for i in v[0]])) for v in [             #
       * <<<<<<<<<<<<<<
       *                         [[0, 4, 6, 2], [-1, 0, 0]],
       *                         [[1, 3, 7, 5], [+1, 0, 0]],
       */
    }
    __Pyx_DECREF(__pyx_t_11);
    __pyx_t_11 = 0;
    __Pyx_XDECREF(__pyx_8genexpr3__pyx_v_v);
    __pyx_8genexpr3__pyx_v_v = 0;
    goto __pyx_L16_exit_scope;
  __pyx_L7_error:;
    __Pyx_XDECREF(__pyx_8genexpr3__pyx_v_v);
    __pyx_8genexpr3__pyx_v_v = 0;
    goto __pyx_L1_error;
  __pyx_L16_exit_scope:;
  } /* exit inner scope */

  /* "pyg4ometry/pycsg/core.pyx":641
   *         else: r = [radius, radius, radius]
   *
   *         polygons = list([Polygon(             # <<<<<<<<<<<<<<
   *                 list([Vertex(
   *                         Vector(
   */
  __pyx_t_11 = PySequence_List(__pyx_t_2);
  if (unlikely(!__pyx_t_11))
    __PYX_ERR(0, 641, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_11);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_polygons = ((PyObject *)__pyx_t_11);
  __pyx_t_11 = 0;

  /* "pyg4ometry/pycsg/core.pyx":657
   *                         [[4, 5, 7, 6], [0, 0, +1]]
   *                     ]])
   *         return CSG.fromPolygons(polygons)             # <<<<<<<<<<<<<<
   *
   *     @classmethod
   */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_CSG);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 657, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_fromPolygons);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 657, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
    }
  }
  __pyx_t_11 =
      (__pyx_t_2)
          ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_2, __pyx_v_polygons)
          : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_polygons);
  __Pyx_XDECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_11))
    __PYX_ERR(0, 657, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_11);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_r = __pyx_t_11;
  __pyx_t_11 = 0;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":622
 *
 *     @classmethod
 *     def cube(cls, center=[0,0,0], radius=[1,1,1]):             #
 * <<<<<<<<<<<<<<
 *         """
 *         Construct an axis-aligned solid cuboid. Optional parameters are
 * `center` and
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_XDECREF(__pyx_t_15);
  __Pyx_XDECREF(__pyx_t_16);
  __Pyx_XDECREF(__pyx_t_17);
  __Pyx_XDECREF(__pyx_t_18);
  __Pyx_XDECREF(__pyx_t_19);
  __Pyx_XDECREF(__pyx_t_20);
  __Pyx_XDECREF(__pyx_t_21);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.cube", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XDECREF(__pyx_v_c);
  __Pyx_XDECREF(__pyx_v_r);
  __Pyx_XDECREF(__pyx_v_polygons);
  __Pyx_XDECREF(__pyx_8genexpr3__pyx_v_v);
  __Pyx_XDECREF(__pyx_8genexpr4__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":660
 *
 *     @classmethod
 *     def sphere(cls, **kwargs):             # <<<<<<<<<<<<<<
 *         """ Returns a sphere.
 *
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_51sphere(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_50sphere[] =
    " Returns a sphere.\n            \n            Kwargs:\n                "
    "center (list): Center of sphere, default [0, 0, 0].\n                \n   "
    "             radius (float): Radius of sphere, default 1.0.\n             "
    "   \n                slices (int): Number of slices, default 16.\n        "
    "        \n                stacks (int): Number of stacks, default 8.\n    "
    "    ";
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_51sphere = {
    "sphere",
    (PyCFunction)(void *)(PyCFunctionWithKeywords)
        __pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_51sphere,
    METH_VARARGS | METH_KEYWORDS,
    __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_50sphere};
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_51sphere(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED PyObject *__pyx_v_cls = 0;
  PyObject *__pyx_v_kwargs = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext("sphere (wrapper)", 0);
  __pyx_v_kwargs = PyDict_New();
  if (unlikely(!__pyx_v_kwargs))
    return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_cls, 0};
    PyObject *values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
      case 1:
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
      case 0:
        break;
      default:
        goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
      case 0:
        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_cls)) != 0))
          kw_args--;
        else
          goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames,
                                                 __pyx_v_kwargs, values,
                                                 pos_args, "sphere") < 0))
          __PYX_ERR(0, 660, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
    }
    __pyx_v_cls = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
__pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("sphere", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args));
  __PYX_ERR(0, 660, __pyx_L3_error)
__pyx_L3_error:;
  __Pyx_DECREF(__pyx_v_kwargs);
  __pyx_v_kwargs = 0;
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.sphere", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
__pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_50sphere(
      __pyx_self, __pyx_v_cls, __pyx_v_kwargs);

  /* function exit code */
  __Pyx_XDECREF(__pyx_v_kwargs);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":682
 *         stacks = kwargs.get('stacks', 8)
 *         polygons = []
 *         def appendVertex(vertices, theta, phi):             # <<<<<<<<<<<<<<
 *             d = Vector(
 *                 _np.cos(theta) * _np.sin(phi),
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_6sphere_1appendVertex(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef
    __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_6sphere_1appendVertex = {
        "appendVertex",
        (PyCFunction)(void *)(PyCFunctionWithKeywords)
            __pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_6sphere_1appendVertex,
        METH_VARARGS | METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_6sphere_1appendVertex(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_vertices = 0;
  PyObject *__pyx_v_theta = 0;
  PyObject *__pyx_v_phi = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext(
      "appendVertex (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {
        &__pyx_n_s_vertices, &__pyx_n_s_theta, &__pyx_n_s_phi, 0};
    PyObject *values[3] = {0, 0, 0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
      case 3:
        values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
      case 2:
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
      case 1:
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
      case 0:
        break;
      default:
        goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
      case 0:
        if (likely((values[0] = __Pyx_PyDict_GetItemStr(
                        __pyx_kwds, __pyx_n_s_vertices)) != 0))
          kw_args--;
        else
          goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
      case 1:
        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_theta)) != 0))
          kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("appendVertex", 1, 3, 3, 1);
          __PYX_ERR(0, 682, __pyx_L3_error)
        }
        CYTHON_FALLTHROUGH;
      case 2:
        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_phi)) != 0))
          kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("appendVertex", 1, 3, 3, 2);
          __PYX_ERR(0, 682, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames,
                                                 0, values, pos_args,
                                                 "appendVertex") < 0))
          __PYX_ERR(0, 682, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
    }
    __pyx_v_vertices = values[0];
    __pyx_v_theta = values[1];
    __pyx_v_phi = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
__pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("appendVertex", 1, 3, 3,
                             PyTuple_GET_SIZE(__pyx_args));
  __PYX_ERR(0, 682, __pyx_L3_error)
__pyx_L3_error:;
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.sphere.appendVertex",
                     __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
__pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6sphere_appendVertex(
      __pyx_self, __pyx_v_vertices, __pyx_v_theta, __pyx_v_phi);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6sphere_appendVertex(
    PyObject *__pyx_self, PyObject *__pyx_v_vertices, PyObject *__pyx_v_theta,
    PyObject *__pyx_v_phi) {
  struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere
      *__pyx_cur_scope;
  struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere
      *__pyx_outer_scope;
  PyObject *__pyx_v_d = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  int __pyx_t_9;
  int __pyx_t_10;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("appendVertex", 0);
  __pyx_outer_scope =
      (struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere *)
          __Pyx_CyFunction_GetClosure(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;

  /* "pyg4ometry/pycsg/core.pyx":683
   *         polygons = []
   *         def appendVertex(vertices, theta, phi):
   *             d = Vector(             # <<<<<<<<<<<<<<
   *                 _np.cos(theta) * _np.sin(phi),
   *                 _np.cos(phi),
   */
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_Vector);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 683, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);

  /* "pyg4ometry/pycsg/core.pyx":684
   *         def appendVertex(vertices, theta, phi):
   *             d = Vector(
   *                 _np.cos(theta) * _np.sin(phi),             # <<<<<<<<<<<<<<
   *                 _np.cos(phi),
   *                 _np.sin(theta) * _np.sin(phi))
   */
  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 684, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_cos);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 684, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_5, function);
    }
  }
  __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_4,
                                                     __pyx_v_theta)
                          : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_theta);
  __Pyx_XDECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 684, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 684, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_sin);
  if (unlikely(!__pyx_t_6))
    __PYX_ERR(0, 684, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_6);
    if (likely(__pyx_t_4)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_6, function);
    }
  }
  __pyx_t_5 = (__pyx_t_4)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_4, __pyx_v_phi)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_phi);
  __Pyx_XDECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 684, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyNumber_Multiply(__pyx_t_3, __pyx_t_5);
  if (unlikely(!__pyx_t_6))
    __PYX_ERR(0, 684, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_5);
  __pyx_t_5 = 0;

  /* "pyg4ometry/pycsg/core.pyx":685
   *             d = Vector(
   *                 _np.cos(theta) * _np.sin(phi),
   *                 _np.cos(phi),             # <<<<<<<<<<<<<<
   *                 _np.sin(theta) * _np.sin(phi))
   *             vertices.append(Vertex(c.plus(d.times(r)), d))
   */
  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 685, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_cos);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 685, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  __pyx_t_5 = (__pyx_t_3)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_phi)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_phi);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 685, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;

  /* "pyg4ometry/pycsg/core.pyx":686
   *                 _np.cos(theta) * _np.sin(phi),
   *                 _np.cos(phi),
   *                 _np.sin(theta) * _np.sin(phi))             # <<<<<<<<<<<<<<
   *             vertices.append(Vertex(c.plus(d.times(r)), d))
   *
   */
  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 686, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_sin);
  if (unlikely(!__pyx_t_7))
    __PYX_ERR(0, 686, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_7);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_7, function);
    }
  }
  __pyx_t_4 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_3,
                                                     __pyx_v_theta)
                          : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_v_theta);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 686, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_7);
  __pyx_t_7 = 0;
  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 686, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_sin);
  if (unlikely(!__pyx_t_8))
    __PYX_ERR(0, 686, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_8);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_8);
    if (likely(__pyx_t_3)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_8);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_8, function);
    }
  }
  __pyx_t_7 = (__pyx_t_3)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_3, __pyx_v_phi)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_v_phi);
  __Pyx_XDECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_7))
    __PYX_ERR(0, 686, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = PyNumber_Multiply(__pyx_t_4, __pyx_t_7);
  if (unlikely(!__pyx_t_8))
    __PYX_ERR(0, 686, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_8);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_7);
  __pyx_t_7 = 0;
  __pyx_t_7 = NULL;
  __pyx_t_9 = 0;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_7)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_7);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_9 = 1;
    }
  }
#if CYTHON_FAST_PYCALL
  if (PyFunction_Check(__pyx_t_2)) {
    PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_t_6, __pyx_t_5, __pyx_t_8};
    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp + 1 - __pyx_t_9,
                                          3 + __pyx_t_9);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 683, __pyx_L1_error)
    __Pyx_XDECREF(__pyx_t_7);
    __pyx_t_7 = 0;
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_6);
    __pyx_t_6 = 0;
    __Pyx_DECREF(__pyx_t_5);
    __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_t_8);
    __pyx_t_8 = 0;
  } else
#endif
#if CYTHON_FAST_PYCCALL
      if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
    PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_t_6, __pyx_t_5, __pyx_t_8};
    __pyx_t_1 = __Pyx_PyCFunction_FastCall(
        __pyx_t_2, __pyx_temp + 1 - __pyx_t_9, 3 + __pyx_t_9);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 683, __pyx_L1_error)
    __Pyx_XDECREF(__pyx_t_7);
    __pyx_t_7 = 0;
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_6);
    __pyx_t_6 = 0;
    __Pyx_DECREF(__pyx_t_5);
    __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_t_8);
    __pyx_t_8 = 0;
  } else
#endif
  {
    __pyx_t_4 = PyTuple_New(3 + __pyx_t_9);
    if (unlikely(!__pyx_t_4))
      __PYX_ERR(0, 683, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    if (__pyx_t_7) {
      __Pyx_GIVEREF(__pyx_t_7);
      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_7);
      __pyx_t_7 = NULL;
    }
    __Pyx_GIVEREF(__pyx_t_6);
    PyTuple_SET_ITEM(__pyx_t_4, 0 + __pyx_t_9, __pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_4, 1 + __pyx_t_9, __pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_8);
    PyTuple_SET_ITEM(__pyx_t_4, 2 + __pyx_t_9, __pyx_t_8);
    __pyx_t_6 = 0;
    __pyx_t_5 = 0;
    __pyx_t_8 = 0;
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 683, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_4);
    __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_d = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":687
   *                 _np.cos(phi),
   *                 _np.sin(theta) * _np.sin(phi))
   *             vertices.append(Vertex(c.plus(d.times(r)), d))             #
   * <<<<<<<<<<<<<<
   *
   *         dTheta = _np.pi * 2.0 / float(slices)
   */
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_Vertex);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 687, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (unlikely(!__pyx_cur_scope->__pyx_v_c)) {
    __Pyx_RaiseClosureNameError("c");
    __PYX_ERR(0, 687, __pyx_L1_error)
  }
  __pyx_t_8 =
      __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_c, __pyx_n_s_plus);
  if (unlikely(!__pyx_t_8))
    __PYX_ERR(0, 687, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_8);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_d, __pyx_n_s_times);
  if (unlikely(!__pyx_t_6))
    __PYX_ERR(0, 687, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (unlikely(!__pyx_cur_scope->__pyx_v_r)) {
    __Pyx_RaiseClosureNameError("r");
    __PYX_ERR(0, 687, __pyx_L1_error)
  }
  __pyx_t_7 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
    __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
    if (likely(__pyx_t_7)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_7);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_6, function);
    }
  }
  __pyx_t_5 =
      (__pyx_t_7)
          ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_7,
                                     __pyx_cur_scope->__pyx_v_r)
          : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_cur_scope->__pyx_v_r);
  __Pyx_XDECREF(__pyx_t_7);
  __pyx_t_7 = 0;
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 687, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_8))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_8);
    if (likely(__pyx_t_6)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_8);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_8, function);
    }
  }
  __pyx_t_4 = (__pyx_t_6)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_6, __pyx_t_5)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 687, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = NULL;
  __pyx_t_9 = 0;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_8)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_8);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_9 = 1;
    }
  }
#if CYTHON_FAST_PYCALL
  if (PyFunction_Check(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_8, __pyx_t_4, __pyx_v_d};
    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp + 1 - __pyx_t_9,
                                          2 + __pyx_t_9);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 687, __pyx_L1_error)
    __Pyx_XDECREF(__pyx_t_8);
    __pyx_t_8 = 0;
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_4);
    __pyx_t_4 = 0;
  } else
#endif
#if CYTHON_FAST_PYCCALL
      if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_8, __pyx_t_4, __pyx_v_d};
    __pyx_t_1 = __Pyx_PyCFunction_FastCall(
        __pyx_t_2, __pyx_temp + 1 - __pyx_t_9, 2 + __pyx_t_9);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 687, __pyx_L1_error)
    __Pyx_XDECREF(__pyx_t_8);
    __pyx_t_8 = 0;
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_4);
    __pyx_t_4 = 0;
  } else
#endif
  {
    __pyx_t_5 = PyTuple_New(2 + __pyx_t_9);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 687, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    if (__pyx_t_8) {
      __Pyx_GIVEREF(__pyx_t_8);
      PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_8);
      __pyx_t_8 = NULL;
    }
    __Pyx_GIVEREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_5, 0 + __pyx_t_9, __pyx_t_4);
    __Pyx_INCREF(__pyx_v_d);
    __Pyx_GIVEREF(__pyx_v_d);
    PyTuple_SET_ITEM(__pyx_t_5, 1 + __pyx_t_9, __pyx_v_d);
    __pyx_t_4 = 0;
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_5, NULL);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 687, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_5);
    __pyx_t_5 = 0;
  }
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_10 = __Pyx_PyObject_Append(__pyx_v_vertices, __pyx_t_1);
  if (unlikely(__pyx_t_10 == ((int)-1)))
    __PYX_ERR(0, 687, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":682
   *         stacks = kwargs.get('stacks', 8)
   *         polygons = []
   *         def appendVertex(vertices, theta, phi):             #
   * <<<<<<<<<<<<<< d = Vector( _np.cos(theta) * _np.sin(phi),
   */

  /* function exit code */
  __pyx_r = Py_None;
  __Pyx_INCREF(Py_None);
  goto __pyx_L0;
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.sphere.appendVertex",
                     __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XDECREF(__pyx_v_d);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":660
 *
 *     @classmethod
 *     def sphere(cls, **kwargs):             # <<<<<<<<<<<<<<
 *         """ Returns a sphere.
 *
 */

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_50sphere(
    CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_cls,
    PyObject *__pyx_v_kwargs) {
  struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere
      *__pyx_cur_scope;
  PyObject *__pyx_v_center = NULL;
  PyObject *__pyx_v_slices = NULL;
  PyObject *__pyx_v_stacks = NULL;
  PyObject *__pyx_v_polygons = NULL;
  PyObject *__pyx_v_appendVertex = 0;
  PyObject *__pyx_v_dTheta = NULL;
  PyObject *__pyx_v_dPhi = NULL;
  PyObject *__pyx_v_j0 = NULL;
  PyObject *__pyx_v_j1 = NULL;
  PyObject *__pyx_v_i0 = NULL;
  PyObject *__pyx_v_i1 = NULL;
  PyObject *__pyx_v_vertices = NULL;
  PyObject *__pyx_v_j2 = NULL;
  PyObject *__pyx_v_i2 = NULL;
  PyObject *__pyx_v_verticesN = NULL;
  PyObject *__pyx_v_verticesS = NULL;
  PyObject *__pyx_v_verticesW = NULL;
  PyObject *__pyx_v_verticesE = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  int __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  Py_ssize_t __pyx_t_7;
  PyObject *(*__pyx_t_8)(PyObject *);
  PyObject *__pyx_t_9 = NULL;
  int __pyx_t_10;
  Py_ssize_t __pyx_t_11;
  PyObject *(*__pyx_t_12)(PyObject *);
  PyObject *__pyx_t_13 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("sphere", 0);
  __pyx_cur_scope =
      (struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere *)
          __pyx_tp_new_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere(
              __pyx_ptype_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere,
              __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope =
        ((struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere
              *)Py_None);
    __Pyx_INCREF(Py_None);
    __PYX_ERR(0, 660, __pyx_L1_error)
  } else {
    __Pyx_GOTREF(__pyx_cur_scope);
  }

  /* "pyg4ometry/pycsg/core.pyx":672
   *                 stacks (int): Number of stacks, default 8.
   *         """
   *         center = kwargs.get('center', [0.0, 0.0, 0.0])             #
   * <<<<<<<<<<<<<< if isinstance(center, float): center = [center, center,
   * center]
   */
  __pyx_t_1 = PyList_New(3);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 672, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_float_0_0);
  __Pyx_GIVEREF(__pyx_float_0_0);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_float_0_0);
  __Pyx_INCREF(__pyx_float_0_0);
  __Pyx_GIVEREF(__pyx_float_0_0);
  PyList_SET_ITEM(__pyx_t_1, 1, __pyx_float_0_0);
  __Pyx_INCREF(__pyx_float_0_0);
  __Pyx_GIVEREF(__pyx_float_0_0);
  PyList_SET_ITEM(__pyx_t_1, 2, __pyx_float_0_0);
  __pyx_t_2 =
      __Pyx_PyDict_GetItemDefault(__pyx_v_kwargs, __pyx_n_u_center, __pyx_t_1);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 672, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_v_center = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":673
   *         """
   *         center = kwargs.get('center', [0.0, 0.0, 0.0])
   *         if isinstance(center, float):             # <<<<<<<<<<<<<<
   *             center = [center, center, center]
   *         c = Vector(center)
   */
  __pyx_t_3 = PyFloat_Check(__pyx_v_center);
  __pyx_t_4 = (__pyx_t_3 != 0);
  if (__pyx_t_4) {

    /* "pyg4ometry/pycsg/core.pyx":674
     *         center = kwargs.get('center', [0.0, 0.0, 0.0])
     *         if isinstance(center, float):
     *             center = [center, center, center]             #
     * <<<<<<<<<<<<<< c = Vector(center) r = kwargs.get('radius', 1.0)
     */
    __pyx_t_2 = PyList_New(3);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 674, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_INCREF(__pyx_v_center);
    __Pyx_GIVEREF(__pyx_v_center);
    PyList_SET_ITEM(__pyx_t_2, 0, __pyx_v_center);
    __Pyx_INCREF(__pyx_v_center);
    __Pyx_GIVEREF(__pyx_v_center);
    PyList_SET_ITEM(__pyx_t_2, 1, __pyx_v_center);
    __Pyx_INCREF(__pyx_v_center);
    __Pyx_GIVEREF(__pyx_v_center);
    PyList_SET_ITEM(__pyx_t_2, 2, __pyx_v_center);
    __Pyx_DECREF_SET(__pyx_v_center, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "pyg4ometry/pycsg/core.pyx":673
     *         """
     *         center = kwargs.get('center', [0.0, 0.0, 0.0])
     *         if isinstance(center, float):             # <<<<<<<<<<<<<<
     *             center = [center, center, center]
     *         c = Vector(center)
     */
  }

  /* "pyg4ometry/pycsg/core.pyx":675
   *         if isinstance(center, float):
   *             center = [center, center, center]
   *         c = Vector(center)             # <<<<<<<<<<<<<<
   *         r = kwargs.get('radius', 1.0)
   *         if isinstance(r, list) and len(r) > 2:
   */
  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_Vector);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 675, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
    }
  }
  __pyx_t_2 =
      (__pyx_t_5)
          ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_5, __pyx_v_center)
          : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_center);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 675, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __Pyx_GIVEREF(__pyx_t_2);
  __pyx_cur_scope->__pyx_v_c = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":676
   *             center = [center, center, center]
   *         c = Vector(center)
   *         r = kwargs.get('radius', 1.0)             # <<<<<<<<<<<<<<
   *         if isinstance(r, list) and len(r) > 2:
   *             r = r[0]
   */
  __pyx_t_2 = __Pyx_PyDict_GetItemDefault(__pyx_v_kwargs, __pyx_n_u_radius,
                                          __pyx_float_1_0);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 676, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __pyx_cur_scope->__pyx_v_r = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":677
   *         c = Vector(center)
   *         r = kwargs.get('radius', 1.0)
   *         if isinstance(r, list) and len(r) > 2:             # <<<<<<<<<<<<<<
   *             r = r[0]
   *         slices = kwargs.get('slices', 16)
   */
  __pyx_t_2 = __pyx_cur_scope->__pyx_v_r;
  __Pyx_INCREF(__pyx_t_2);
  __pyx_t_3 = PyList_Check(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_6 = (__pyx_t_3 != 0);
  if (__pyx_t_6) {
  } else {
    __pyx_t_4 = __pyx_t_6;
    goto __pyx_L5_bool_binop_done;
  }
  __pyx_t_2 = __pyx_cur_scope->__pyx_v_r;
  __Pyx_INCREF(__pyx_t_2);
  __pyx_t_7 = PyObject_Length(__pyx_t_2);
  if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1)))
    __PYX_ERR(0, 677, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_6 = ((__pyx_t_7 > 2) != 0);
  __pyx_t_4 = __pyx_t_6;
__pyx_L5_bool_binop_done:;
  if (__pyx_t_4) {

    /* "pyg4ometry/pycsg/core.pyx":678
     *         r = kwargs.get('radius', 1.0)
     *         if isinstance(r, list) and len(r) > 2:
     *             r = r[0]             # <<<<<<<<<<<<<<
     *         slices = kwargs.get('slices', 16)
     *         stacks = kwargs.get('stacks', 8)
     */
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_cur_scope->__pyx_v_r, 0, long, 1,
                                 __Pyx_PyInt_From_long, 0, 0, 1);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 678, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_GOTREF(__pyx_cur_scope->__pyx_v_r);
    __Pyx_DECREF_SET(__pyx_cur_scope->__pyx_v_r, __pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_2);
    __pyx_t_2 = 0;

    /* "pyg4ometry/pycsg/core.pyx":677
     *         c = Vector(center)
     *         r = kwargs.get('radius', 1.0)
     *         if isinstance(r, list) and len(r) > 2:             #
     * <<<<<<<<<<<<<< r = r[0] slices = kwargs.get('slices', 16)
     */
  }

  /* "pyg4ometry/pycsg/core.pyx":679
   *         if isinstance(r, list) and len(r) > 2:
   *             r = r[0]
   *         slices = kwargs.get('slices', 16)             # <<<<<<<<<<<<<<
   *         stacks = kwargs.get('stacks', 8)
   *         polygons = []
   */
  __pyx_t_2 = __Pyx_PyDict_GetItemDefault(__pyx_v_kwargs, __pyx_n_u_slices,
                                          __pyx_int_16);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 679, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_v_slices = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":680
   *             r = r[0]
   *         slices = kwargs.get('slices', 16)
   *         stacks = kwargs.get('stacks', 8)             # <<<<<<<<<<<<<<
   *         polygons = []
   *         def appendVertex(vertices, theta, phi):
   */
  __pyx_t_2 = __Pyx_PyDict_GetItemDefault(__pyx_v_kwargs, __pyx_n_u_stacks,
                                          __pyx_int_8);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 680, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_v_stacks = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":681
   *         slices = kwargs.get('slices', 16)
   *         stacks = kwargs.get('stacks', 8)
   *         polygons = []             # <<<<<<<<<<<<<<
   *         def appendVertex(vertices, theta, phi):
   *             d = Vector(
   */
  __pyx_t_2 = PyList_New(0);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 681, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_v_polygons = ((PyObject *)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":682
   *         stacks = kwargs.get('stacks', 8)
   *         polygons = []
   *         def appendVertex(vertices, theta, phi):             #
   * <<<<<<<<<<<<<< d = Vector( _np.cos(theta) * _np.sin(phi),
   */
  __pyx_t_2 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_6sphere_1appendVertex, 0,
      __pyx_n_s_CSG_sphere_locals_appendVertex, ((PyObject *)__pyx_cur_scope),
      __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
      ((PyObject *)__pyx_codeobj__16));
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 682, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_v_appendVertex = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":689
   *             vertices.append(Vertex(c.plus(d.times(r)), d))
   *
   *         dTheta = _np.pi * 2.0 / float(slices)             # <<<<<<<<<<<<<<
   *         dPhi = _np.pi / float(stacks)
   *
   */
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 689, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_pi);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 689, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = PyNumber_Multiply(__pyx_t_1, __pyx_float_2_0);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 689, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyNumber_Float(__pyx_v_slices);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 689, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_PyNumber_Divide(__pyx_t_2, __pyx_t_1);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 689, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_v_dTheta = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "pyg4ometry/pycsg/core.pyx":690
   *
   *         dTheta = _np.pi * 2.0 / float(slices)
   *         dPhi = _np.pi / float(stacks)             # <<<<<<<<<<<<<<
   *
   *         j0 = 0
   */
  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 690, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_pi);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 690, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyNumber_Float(__pyx_v_stacks);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 690, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_2 = __Pyx_PyNumber_Divide(__pyx_t_1, __pyx_t_5);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 690, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_v_dPhi = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":692
   *         dPhi = _np.pi / float(stacks)
   *
   *         j0 = 0             # <<<<<<<<<<<<<<
   *         j1 = j0 + 1
   *         for i0 in range(0, slices):
   */
  __Pyx_INCREF(__pyx_int_0);
  __pyx_v_j0 = __pyx_int_0;

  /* "pyg4ometry/pycsg/core.pyx":693
   *
   *         j0 = 0
   *         j1 = j0 + 1             # <<<<<<<<<<<<<<
   *         for i0 in range(0, slices):
   *             i1 = i0 + 1
   */
  __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_j0, __pyx_int_1, 1, 0, 0);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 693, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_v_j1 = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":694
   *         j0 = 0
   *         j1 = j0 + 1
   *         for i0 in range(0, slices):             # <<<<<<<<<<<<<<
   *             i1 = i0 + 1
   *             #  +--+
   */
  __pyx_t_2 = PyTuple_New(2);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 694, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_0);
  __Pyx_INCREF(__pyx_v_slices);
  __Pyx_GIVEREF(__pyx_v_slices);
  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_slices);
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_2, NULL);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 694, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  if (likely(PyList_CheckExact(__pyx_t_5)) || PyTuple_CheckExact(__pyx_t_5)) {
    __pyx_t_2 = __pyx_t_5;
    __Pyx_INCREF(__pyx_t_2);
    __pyx_t_7 = 0;
    __pyx_t_8 = NULL;
  } else {
    __pyx_t_7 = -1;
    __pyx_t_2 = PyObject_GetIter(__pyx_t_5);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 694, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_8 = Py_TYPE(__pyx_t_2)->tp_iternext;
    if (unlikely(!__pyx_t_8))
      __PYX_ERR(0, 694, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  for (;;) {
    if (likely(!__pyx_t_8)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_7 >= PyList_GET_SIZE(__pyx_t_2))
          break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_7);
        __Pyx_INCREF(__pyx_t_5);
        __pyx_t_7++;
        if (unlikely(0 < 0))
          __PYX_ERR(0, 694, __pyx_L1_error)
#else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_7);
        __pyx_t_7++;
        if (unlikely(!__pyx_t_5))
          __PYX_ERR(0, 694, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
#endif
      } else {
        if (__pyx_t_7 >= PyTuple_GET_SIZE(__pyx_t_2))
          break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_7);
        __Pyx_INCREF(__pyx_t_5);
        __pyx_t_7++;
        if (unlikely(0 < 0))
          __PYX_ERR(0, 694, __pyx_L1_error)
#else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_7);
        __pyx_t_7++;
        if (unlikely(!__pyx_t_5))
          __PYX_ERR(0, 694, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
#endif
      }
    } else {
      __pyx_t_5 = __pyx_t_8(__pyx_t_2);
      if (unlikely(!__pyx_t_5)) {
        PyObject *exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type,
                                                       PyExc_StopIteration)))
            PyErr_Clear();
          else
            __PYX_ERR(0, 694, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_5);
    }
    __Pyx_XDECREF_SET(__pyx_v_i0, __pyx_t_5);
    __pyx_t_5 = 0;

    /* "pyg4ometry/pycsg/core.pyx":695
     *         j1 = j0 + 1
     *         for i0 in range(0, slices):
     *             i1 = i0 + 1             # <<<<<<<<<<<<<<
     *             #  +--+
     *             #  | /
     */
    __pyx_t_5 = __Pyx_PyInt_AddObjC(__pyx_v_i0, __pyx_int_1, 1, 0, 0);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 695, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_XDECREF_SET(__pyx_v_i1, __pyx_t_5);
    __pyx_t_5 = 0;

    /* "pyg4ometry/pycsg/core.pyx":700
     *             #  |/
     *             #  +
     *             vertices = []             # <<<<<<<<<<<<<<
     *             appendVertex(vertices, i0 * dTheta, j0 * dPhi)
     *             appendVertex(vertices, i1 * dTheta, j1 * dPhi)
     */
    __pyx_t_5 = PyList_New(0);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 700, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_XDECREF_SET(__pyx_v_vertices, ((PyObject *)__pyx_t_5));
    __pyx_t_5 = 0;

    /* "pyg4ometry/pycsg/core.pyx":701
     *             #  +
     *             vertices = []
     *             appendVertex(vertices, i0 * dTheta, j0 * dPhi)             #
     * <<<<<<<<<<<<<< appendVertex(vertices, i1 * dTheta, j1 * dPhi)
     *             appendVertex(vertices, i0 * dTheta, j1 * dPhi)
     */
    __pyx_t_5 = PyNumber_Multiply(__pyx_v_i0, __pyx_v_dTheta);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 701, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_1 = PyNumber_Multiply(__pyx_v_j0, __pyx_v_dPhi);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 701, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_9 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6sphere_appendVertex(
        __pyx_v_appendVertex, __pyx_v_vertices, __pyx_t_5, __pyx_t_1);
    if (unlikely(!__pyx_t_9))
      __PYX_ERR(0, 701, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(__pyx_t_5);
    __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_9);
    __pyx_t_9 = 0;

    /* "pyg4ometry/pycsg/core.pyx":702
     *             vertices = []
     *             appendVertex(vertices, i0 * dTheta, j0 * dPhi)
     *             appendVertex(vertices, i1 * dTheta, j1 * dPhi)             #
     * <<<<<<<<<<<<<< appendVertex(vertices, i0 * dTheta, j1 * dPhi)
     *             polygons.append(Polygon(vertices))
     */
    __pyx_t_9 = PyNumber_Multiply(__pyx_v_i1, __pyx_v_dTheta);
    if (unlikely(!__pyx_t_9))
      __PYX_ERR(0, 702, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __pyx_t_1 = PyNumber_Multiply(__pyx_v_j1, __pyx_v_dPhi);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 702, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6sphere_appendVertex(
        __pyx_v_appendVertex, __pyx_v_vertices, __pyx_t_9, __pyx_t_1);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 702, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_9);
    __pyx_t_9 = 0;
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_5);
    __pyx_t_5 = 0;

    /* "pyg4ometry/pycsg/core.pyx":703
     *             appendVertex(vertices, i0 * dTheta, j0 * dPhi)
     *             appendVertex(vertices, i1 * dTheta, j1 * dPhi)
     *             appendVertex(vertices, i0 * dTheta, j1 * dPhi)             #
     * <<<<<<<<<<<<<< polygons.append(Polygon(vertices))
     *
     */
    __pyx_t_5 = PyNumber_Multiply(__pyx_v_i0, __pyx_v_dTheta);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 703, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_1 = PyNumber_Multiply(__pyx_v_j1, __pyx_v_dPhi);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 703, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_9 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6sphere_appendVertex(
        __pyx_v_appendVertex, __pyx_v_vertices, __pyx_t_5, __pyx_t_1);
    if (unlikely(!__pyx_t_9))
      __PYX_ERR(0, 703, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(__pyx_t_5);
    __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_9);
    __pyx_t_9 = 0;

    /* "pyg4ometry/pycsg/core.pyx":704
     *             appendVertex(vertices, i1 * dTheta, j1 * dPhi)
     *             appendVertex(vertices, i0 * dTheta, j1 * dPhi)
     *             polygons.append(Polygon(vertices))             #
     * <<<<<<<<<<<<<<
     *
     *         j0 = stacks - 1
     */
    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_Polygon);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 704, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = NULL;
    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
      if (likely(__pyx_t_5)) {
        PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_1);
        __Pyx_INCREF(__pyx_t_5);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_1, function);
      }
    }
    __pyx_t_9 =
        (__pyx_t_5)
            ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_5, __pyx_v_vertices)
            : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_vertices);
    __Pyx_XDECREF(__pyx_t_5);
    __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_9))
      __PYX_ERR(0, 704, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_polygons, __pyx_t_9);
    if (unlikely(__pyx_t_10 == ((int)-1)))
      __PYX_ERR(0, 704, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_9);
    __pyx_t_9 = 0;

    /* "pyg4ometry/pycsg/core.pyx":694
     *         j0 = 0
     *         j1 = j0 + 1
     *         for i0 in range(0, slices):             # <<<<<<<<<<<<<<
     *             i1 = i0 + 1
     *             #  +--+
     */
  }
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":706
   *             polygons.append(Polygon(vertices))
   *
   *         j0 = stacks - 1             # <<<<<<<<<<<<<<
   *         j1 = j0 + 1
   *         for i0 in range(0, slices):
   */
  __pyx_t_2 = __Pyx_PyInt_SubtractObjC(__pyx_v_stacks, __pyx_int_1, 1, 0, 0);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 706, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF_SET(__pyx_v_j0, __pyx_t_2);
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":707
   *
   *         j0 = stacks - 1
   *         j1 = j0 + 1             # <<<<<<<<<<<<<<
   *         for i0 in range(0, slices):
   *             i1 = i0 + 1
   */
  __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_j0, __pyx_int_1, 1, 0, 0);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 707, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF_SET(__pyx_v_j1, __pyx_t_2);
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":708
   *         j0 = stacks - 1
   *         j1 = j0 + 1
   *         for i0 in range(0, slices):             # <<<<<<<<<<<<<<
   *             i1 = i0 + 1
   *             #  +
   */
  __pyx_t_2 = PyTuple_New(2);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 708, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_0);
  __Pyx_INCREF(__pyx_v_slices);
  __Pyx_GIVEREF(__pyx_v_slices);
  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_slices);
  __pyx_t_9 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_2, NULL);
  if (unlikely(!__pyx_t_9))
    __PYX_ERR(0, 708, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_9);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  if (likely(PyList_CheckExact(__pyx_t_9)) || PyTuple_CheckExact(__pyx_t_9)) {
    __pyx_t_2 = __pyx_t_9;
    __Pyx_INCREF(__pyx_t_2);
    __pyx_t_7 = 0;
    __pyx_t_8 = NULL;
  } else {
    __pyx_t_7 = -1;
    __pyx_t_2 = PyObject_GetIter(__pyx_t_9);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 708, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_8 = Py_TYPE(__pyx_t_2)->tp_iternext;
    if (unlikely(!__pyx_t_8))
      __PYX_ERR(0, 708, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_9);
  __pyx_t_9 = 0;
  for (;;) {
    if (likely(!__pyx_t_8)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_7 >= PyList_GET_SIZE(__pyx_t_2))
          break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_9 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_7);
        __Pyx_INCREF(__pyx_t_9);
        __pyx_t_7++;
        if (unlikely(0 < 0))
          __PYX_ERR(0, 708, __pyx_L1_error)
#else
        __pyx_t_9 = PySequence_ITEM(__pyx_t_2, __pyx_t_7);
        __pyx_t_7++;
        if (unlikely(!__pyx_t_9))
          __PYX_ERR(0, 708, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
#endif
      } else {
        if (__pyx_t_7 >= PyTuple_GET_SIZE(__pyx_t_2))
          break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_9 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_7);
        __Pyx_INCREF(__pyx_t_9);
        __pyx_t_7++;
        if (unlikely(0 < 0))
          __PYX_ERR(0, 708, __pyx_L1_error)
#else
        __pyx_t_9 = PySequence_ITEM(__pyx_t_2, __pyx_t_7);
        __pyx_t_7++;
        if (unlikely(!__pyx_t_9))
          __PYX_ERR(0, 708, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
#endif
      }
    } else {
      __pyx_t_9 = __pyx_t_8(__pyx_t_2);
      if (unlikely(!__pyx_t_9)) {
        PyObject *exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type,
                                                       PyExc_StopIteration)))
            PyErr_Clear();
          else
            __PYX_ERR(0, 708, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_9);
    }
    __Pyx_XDECREF_SET(__pyx_v_i0, __pyx_t_9);
    __pyx_t_9 = 0;

    /* "pyg4ometry/pycsg/core.pyx":709
     *         j1 = j0 + 1
     *         for i0 in range(0, slices):
     *             i1 = i0 + 1             # <<<<<<<<<<<<<<
     *             #  +
     *             #  |\
     */
    __pyx_t_9 = __Pyx_PyInt_AddObjC(__pyx_v_i0, __pyx_int_1, 1, 0, 0);
    if (unlikely(!__pyx_t_9))
      __PYX_ERR(0, 709, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_XDECREF_SET(__pyx_v_i1, __pyx_t_9);
    __pyx_t_9 = 0;

    /* "pyg4ometry/pycsg/core.pyx":714
     *             #  | \
     *             #  +--+
     *             vertices = []             # <<<<<<<<<<<<<<
     *             appendVertex(vertices, i0 * dTheta, j0 * dPhi)
     *             appendVertex(vertices, i1 * dTheta, j0 * dPhi)
     */
    __pyx_t_9 = PyList_New(0);
    if (unlikely(!__pyx_t_9))
      __PYX_ERR(0, 714, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_XDECREF_SET(__pyx_v_vertices, ((PyObject *)__pyx_t_9));
    __pyx_t_9 = 0;

    /* "pyg4ometry/pycsg/core.pyx":715
     *             #  +--+
     *             vertices = []
     *             appendVertex(vertices, i0 * dTheta, j0 * dPhi)             #
     * <<<<<<<<<<<<<< appendVertex(vertices, i1 * dTheta, j0 * dPhi)
     *             appendVertex(vertices, i0 * dTheta, j1 * dPhi)
     */
    __pyx_t_9 = PyNumber_Multiply(__pyx_v_i0, __pyx_v_dTheta);
    if (unlikely(!__pyx_t_9))
      __PYX_ERR(0, 715, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __pyx_t_1 = PyNumber_Multiply(__pyx_v_j0, __pyx_v_dPhi);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 715, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6sphere_appendVertex(
        __pyx_v_appendVertex, __pyx_v_vertices, __pyx_t_9, __pyx_t_1);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 715, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_9);
    __pyx_t_9 = 0;
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_5);
    __pyx_t_5 = 0;

    /* "pyg4ometry/pycsg/core.pyx":716
     *             vertices = []
     *             appendVertex(vertices, i0 * dTheta, j0 * dPhi)
     *             appendVertex(vertices, i1 * dTheta, j0 * dPhi)             #
     * <<<<<<<<<<<<<< appendVertex(vertices, i0 * dTheta, j1 * dPhi)
     *             polygons.append(Polygon(vertices))
     */
    __pyx_t_5 = PyNumber_Multiply(__pyx_v_i1, __pyx_v_dTheta);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 716, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_1 = PyNumber_Multiply(__pyx_v_j0, __pyx_v_dPhi);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 716, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_9 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6sphere_appendVertex(
        __pyx_v_appendVertex, __pyx_v_vertices, __pyx_t_5, __pyx_t_1);
    if (unlikely(!__pyx_t_9))
      __PYX_ERR(0, 716, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(__pyx_t_5);
    __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_9);
    __pyx_t_9 = 0;

    /* "pyg4ometry/pycsg/core.pyx":717
     *             appendVertex(vertices, i0 * dTheta, j0 * dPhi)
     *             appendVertex(vertices, i1 * dTheta, j0 * dPhi)
     *             appendVertex(vertices, i0 * dTheta, j1 * dPhi)             #
     * <<<<<<<<<<<<<< polygons.append(Polygon(vertices))
     *
     */
    __pyx_t_9 = PyNumber_Multiply(__pyx_v_i0, __pyx_v_dTheta);
    if (unlikely(!__pyx_t_9))
      __PYX_ERR(0, 717, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __pyx_t_1 = PyNumber_Multiply(__pyx_v_j1, __pyx_v_dPhi);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 717, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6sphere_appendVertex(
        __pyx_v_appendVertex, __pyx_v_vertices, __pyx_t_9, __pyx_t_1);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 717, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_9);
    __pyx_t_9 = 0;
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_5);
    __pyx_t_5 = 0;

    /* "pyg4ometry/pycsg/core.pyx":718
     *             appendVertex(vertices, i1 * dTheta, j0 * dPhi)
     *             appendVertex(vertices, i0 * dTheta, j1 * dPhi)
     *             polygons.append(Polygon(vertices))             #
     * <<<<<<<<<<<<<<
     *
     *         for j0 in range(1, stacks - 1):
     */
    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_Polygon);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 718, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_9 = NULL;
    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
      __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_1);
      if (likely(__pyx_t_9)) {
        PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_1);
        __Pyx_INCREF(__pyx_t_9);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_1, function);
      }
    }
    __pyx_t_5 =
        (__pyx_t_9)
            ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_9, __pyx_v_vertices)
            : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_vertices);
    __Pyx_XDECREF(__pyx_t_9);
    __pyx_t_9 = 0;
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 718, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_polygons, __pyx_t_5);
    if (unlikely(__pyx_t_10 == ((int)-1)))
      __PYX_ERR(0, 718, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5);
    __pyx_t_5 = 0;

    /* "pyg4ometry/pycsg/core.pyx":708
     *         j0 = stacks - 1
     *         j1 = j0 + 1
     *         for i0 in range(0, slices):             # <<<<<<<<<<<<<<
     *             i1 = i0 + 1
     *             #  +
     */
  }
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":720
   *             polygons.append(Polygon(vertices))
   *
   *         for j0 in range(1, stacks - 1):             # <<<<<<<<<<<<<<
   *             j1 = j0 + 0.5
   *             j2 = j0 + 1
   */
  __pyx_t_2 = __Pyx_PyInt_SubtractObjC(__pyx_v_stacks, __pyx_int_1, 1, 0, 0);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 720, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = PyTuple_New(2);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 720, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_INCREF(__pyx_int_1);
  __Pyx_GIVEREF(__pyx_int_1);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_int_1);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_5, NULL);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 720, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
    __pyx_t_5 = __pyx_t_2;
    __Pyx_INCREF(__pyx_t_5);
    __pyx_t_7 = 0;
    __pyx_t_8 = NULL;
  } else {
    __pyx_t_7 = -1;
    __pyx_t_5 = PyObject_GetIter(__pyx_t_2);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 720, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_8 = Py_TYPE(__pyx_t_5)->tp_iternext;
    if (unlikely(!__pyx_t_8))
      __PYX_ERR(0, 720, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  for (;;) {
    if (likely(!__pyx_t_8)) {
      if (likely(PyList_CheckExact(__pyx_t_5))) {
        if (__pyx_t_7 >= PyList_GET_SIZE(__pyx_t_5))
          break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_7);
        __Pyx_INCREF(__pyx_t_2);
        __pyx_t_7++;
        if (unlikely(0 < 0))
          __PYX_ERR(0, 720, __pyx_L1_error)
#else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_5, __pyx_t_7);
        __pyx_t_7++;
        if (unlikely(!__pyx_t_2))
          __PYX_ERR(0, 720, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
#endif
      } else {
        if (__pyx_t_7 >= PyTuple_GET_SIZE(__pyx_t_5))
          break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_7);
        __Pyx_INCREF(__pyx_t_2);
        __pyx_t_7++;
        if (unlikely(0 < 0))
          __PYX_ERR(0, 720, __pyx_L1_error)
#else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_5, __pyx_t_7);
        __pyx_t_7++;
        if (unlikely(!__pyx_t_2))
          __PYX_ERR(0, 720, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
#endif
      }
    } else {
      __pyx_t_2 = __pyx_t_8(__pyx_t_5);
      if (unlikely(!__pyx_t_2)) {
        PyObject *exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type,
                                                       PyExc_StopIteration)))
            PyErr_Clear();
          else
            __PYX_ERR(0, 720, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_DECREF_SET(__pyx_v_j0, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "pyg4ometry/pycsg/core.pyx":721
     *
     *         for j0 in range(1, stacks - 1):
     *             j1 = j0 + 0.5             # <<<<<<<<<<<<<<
     *             j2 = j0 + 1
     *             for i0 in range(0, slices):
     */
    __pyx_t_2 = __Pyx_PyFloat_AddObjC(__pyx_v_j0, __pyx_float_0_5, 0.5, 0, 0);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 721, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF_SET(__pyx_v_j1, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "pyg4ometry/pycsg/core.pyx":722
     *         for j0 in range(1, stacks - 1):
     *             j1 = j0 + 0.5
     *             j2 = j0 + 1             # <<<<<<<<<<<<<<
     *             for i0 in range(0, slices):
     *                 i1 = i0 + 0.5
     */
    __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_j0, __pyx_int_1, 1, 0, 0);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 722, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_XDECREF_SET(__pyx_v_j2, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "pyg4ometry/pycsg/core.pyx":723
     *             j1 = j0 + 0.5
     *             j2 = j0 + 1
     *             for i0 in range(0, slices):             # <<<<<<<<<<<<<<
     *                 i1 = i0 + 0.5
     *                 i2 = i0 + 1
     */
    __pyx_t_2 = PyTuple_New(2);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 723, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_0);
    __Pyx_INCREF(__pyx_v_slices);
    __Pyx_GIVEREF(__pyx_v_slices);
    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_slices);
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_2, NULL);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 723, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2);
    __pyx_t_2 = 0;
    if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
      __pyx_t_2 = __pyx_t_1;
      __Pyx_INCREF(__pyx_t_2);
      __pyx_t_11 = 0;
      __pyx_t_12 = NULL;
    } else {
      __pyx_t_11 = -1;
      __pyx_t_2 = PyObject_GetIter(__pyx_t_1);
      if (unlikely(!__pyx_t_2))
        __PYX_ERR(0, 723, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_12 = Py_TYPE(__pyx_t_2)->tp_iternext;
      if (unlikely(!__pyx_t_12))
        __PYX_ERR(0, 723, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_12)) {
        if (likely(PyList_CheckExact(__pyx_t_2))) {
          if (__pyx_t_11 >= PyList_GET_SIZE(__pyx_t_2))
            break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_11);
          __Pyx_INCREF(__pyx_t_1);
          __pyx_t_11++;
          if (unlikely(0 < 0))
            __PYX_ERR(0, 723, __pyx_L1_error)
#else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_11);
          __pyx_t_11++;
          if (unlikely(!__pyx_t_1))
            __PYX_ERR(0, 723, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
#endif
        } else {
          if (__pyx_t_11 >= PyTuple_GET_SIZE(__pyx_t_2))
            break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_11);
          __Pyx_INCREF(__pyx_t_1);
          __pyx_t_11++;
          if (unlikely(0 < 0))
            __PYX_ERR(0, 723, __pyx_L1_error)
#else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_11);
          __pyx_t_11++;
          if (unlikely(!__pyx_t_1))
            __PYX_ERR(0, 723, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
#endif
        }
      } else {
        __pyx_t_1 = __pyx_t_12(__pyx_t_2);
        if (unlikely(!__pyx_t_1)) {
          PyObject *exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type,
                                                         PyExc_StopIteration)))
              PyErr_Clear();
            else
              __PYX_ERR(0, 723, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_1);
      }
      __Pyx_XDECREF_SET(__pyx_v_i0, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":724
       *             j2 = j0 + 1
       *             for i0 in range(0, slices):
       *                 i1 = i0 + 0.5             # <<<<<<<<<<<<<<
       *                 i2 = i0 + 1
       *                 #  +---+
       */
      __pyx_t_1 = __Pyx_PyFloat_AddObjC(__pyx_v_i0, __pyx_float_0_5, 0.5, 0, 0);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 724, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_XDECREF_SET(__pyx_v_i1, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":725
       *             for i0 in range(0, slices):
       *                 i1 = i0 + 0.5
       *                 i2 = i0 + 1             # <<<<<<<<<<<<<<
       *                 #  +---+
       *                 #  |\ /|
       */
      __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_v_i0, __pyx_int_1, 1, 0, 0);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 725, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_XDECREF_SET(__pyx_v_i2, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":731
       *                 #  |/ \|
       *                 #  +---+
       *                 verticesN = []             # <<<<<<<<<<<<<<
       *                 appendVertex(verticesN, i1 * dTheta, j1 * dPhi)
       *                 appendVertex(verticesN, i2 * dTheta, j2 * dPhi)
       */
      __pyx_t_1 = PyList_New(0);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 731, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_XDECREF_SET(__pyx_v_verticesN, ((PyObject *)__pyx_t_1));
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":732
       *                 #  +---+
       *                 verticesN = []
       *                 appendVertex(verticesN, i1 * dTheta, j1 * dPhi) #
       * <<<<<<<<<<<<<< appendVertex(verticesN, i2 * dTheta, j2 * dPhi)
       *                 appendVertex(verticesN, i0 * dTheta, j2 * dPhi)
       */
      __pyx_t_1 = PyNumber_Multiply(__pyx_v_i1, __pyx_v_dTheta);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 732, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_9 = PyNumber_Multiply(__pyx_v_j1, __pyx_v_dPhi);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 732, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_13 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6sphere_appendVertex(
          __pyx_v_appendVertex, __pyx_v_verticesN, __pyx_t_1, __pyx_t_9);
      if (unlikely(!__pyx_t_13))
        __PYX_ERR(0, 732, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_13);
      __Pyx_DECREF(__pyx_t_1);
      __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      __Pyx_DECREF(__pyx_t_13);
      __pyx_t_13 = 0;

      /* "pyg4ometry/pycsg/core.pyx":733
       *                 verticesN = []
       *                 appendVertex(verticesN, i1 * dTheta, j1 * dPhi)
       *                 appendVertex(verticesN, i2 * dTheta, j2 * dPhi) #
       * <<<<<<<<<<<<<< appendVertex(verticesN, i0 * dTheta, j2 * dPhi)
       *                 polygons.append(Polygon(verticesN))
       */
      __pyx_t_13 = PyNumber_Multiply(__pyx_v_i2, __pyx_v_dTheta);
      if (unlikely(!__pyx_t_13))
        __PYX_ERR(0, 733, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_13);
      __pyx_t_9 = PyNumber_Multiply(__pyx_v_j2, __pyx_v_dPhi);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 733, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_1 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6sphere_appendVertex(
          __pyx_v_appendVertex, __pyx_v_verticesN, __pyx_t_13, __pyx_t_9);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 733, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_13);
      __pyx_t_13 = 0;
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      __Pyx_DECREF(__pyx_t_1);
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":734
       *                 appendVertex(verticesN, i1 * dTheta, j1 * dPhi)
       *                 appendVertex(verticesN, i2 * dTheta, j2 * dPhi)
       *                 appendVertex(verticesN, i0 * dTheta, j2 * dPhi) #
       * <<<<<<<<<<<<<< polygons.append(Polygon(verticesN)) verticesS = []
       */
      __pyx_t_1 = PyNumber_Multiply(__pyx_v_i0, __pyx_v_dTheta);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 734, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_9 = PyNumber_Multiply(__pyx_v_j2, __pyx_v_dPhi);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 734, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_13 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6sphere_appendVertex(
          __pyx_v_appendVertex, __pyx_v_verticesN, __pyx_t_1, __pyx_t_9);
      if (unlikely(!__pyx_t_13))
        __PYX_ERR(0, 734, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_13);
      __Pyx_DECREF(__pyx_t_1);
      __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      __Pyx_DECREF(__pyx_t_13);
      __pyx_t_13 = 0;

      /* "pyg4ometry/pycsg/core.pyx":735
       *                 appendVertex(verticesN, i2 * dTheta, j2 * dPhi)
       *                 appendVertex(verticesN, i0 * dTheta, j2 * dPhi)
       *                 polygons.append(Polygon(verticesN))             #
       * <<<<<<<<<<<<<< verticesS = [] appendVertex(verticesS, i1 * dTheta, j1 *
       * dPhi)
       */
      __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_Polygon);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 735, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_1 = NULL;
      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
        __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_9);
        if (likely(__pyx_t_1)) {
          PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_9);
          __Pyx_INCREF(__pyx_t_1);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_9, function);
        }
      }
      __pyx_t_13 =
          (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_1,
                                                 __pyx_v_verticesN)
                      : __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_v_verticesN);
      __Pyx_XDECREF(__pyx_t_1);
      __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_13))
        __PYX_ERR(0, 735, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_13);
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_polygons, __pyx_t_13);
      if (unlikely(__pyx_t_10 == ((int)-1)))
        __PYX_ERR(0, 735, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_13);
      __pyx_t_13 = 0;

      /* "pyg4ometry/pycsg/core.pyx":736
       *                 appendVertex(verticesN, i0 * dTheta, j2 * dPhi)
       *                 polygons.append(Polygon(verticesN))
       *                 verticesS = []             # <<<<<<<<<<<<<<
       *                 appendVertex(verticesS, i1 * dTheta, j1 * dPhi)
       *                 appendVertex(verticesS, i0 * dTheta, j0 * dPhi)
       */
      __pyx_t_13 = PyList_New(0);
      if (unlikely(!__pyx_t_13))
        __PYX_ERR(0, 736, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_13);
      __Pyx_XDECREF_SET(__pyx_v_verticesS, ((PyObject *)__pyx_t_13));
      __pyx_t_13 = 0;

      /* "pyg4ometry/pycsg/core.pyx":737
       *                 polygons.append(Polygon(verticesN))
       *                 verticesS = []
       *                 appendVertex(verticesS, i1 * dTheta, j1 * dPhi) #
       * <<<<<<<<<<<<<< appendVertex(verticesS, i0 * dTheta, j0 * dPhi)
       *                 appendVertex(verticesS, i2 * dTheta, j0 * dPhi)
       */
      __pyx_t_13 = PyNumber_Multiply(__pyx_v_i1, __pyx_v_dTheta);
      if (unlikely(!__pyx_t_13))
        __PYX_ERR(0, 737, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_13);
      __pyx_t_9 = PyNumber_Multiply(__pyx_v_j1, __pyx_v_dPhi);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 737, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_1 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6sphere_appendVertex(
          __pyx_v_appendVertex, __pyx_v_verticesS, __pyx_t_13, __pyx_t_9);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 737, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_13);
      __pyx_t_13 = 0;
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      __Pyx_DECREF(__pyx_t_1);
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":738
       *                 verticesS = []
       *                 appendVertex(verticesS, i1 * dTheta, j1 * dPhi)
       *                 appendVertex(verticesS, i0 * dTheta, j0 * dPhi) #
       * <<<<<<<<<<<<<< appendVertex(verticesS, i2 * dTheta, j0 * dPhi)
       *                 polygons.append(Polygon(verticesS))
       */
      __pyx_t_1 = PyNumber_Multiply(__pyx_v_i0, __pyx_v_dTheta);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 738, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_9 = PyNumber_Multiply(__pyx_v_j0, __pyx_v_dPhi);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 738, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_13 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6sphere_appendVertex(
          __pyx_v_appendVertex, __pyx_v_verticesS, __pyx_t_1, __pyx_t_9);
      if (unlikely(!__pyx_t_13))
        __PYX_ERR(0, 738, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_13);
      __Pyx_DECREF(__pyx_t_1);
      __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      __Pyx_DECREF(__pyx_t_13);
      __pyx_t_13 = 0;

      /* "pyg4ometry/pycsg/core.pyx":739
       *                 appendVertex(verticesS, i1 * dTheta, j1 * dPhi)
       *                 appendVertex(verticesS, i0 * dTheta, j0 * dPhi)
       *                 appendVertex(verticesS, i2 * dTheta, j0 * dPhi) #
       * <<<<<<<<<<<<<< polygons.append(Polygon(verticesS)) verticesW = []
       */
      __pyx_t_13 = PyNumber_Multiply(__pyx_v_i2, __pyx_v_dTheta);
      if (unlikely(!__pyx_t_13))
        __PYX_ERR(0, 739, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_13);
      __pyx_t_9 = PyNumber_Multiply(__pyx_v_j0, __pyx_v_dPhi);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 739, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_1 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6sphere_appendVertex(
          __pyx_v_appendVertex, __pyx_v_verticesS, __pyx_t_13, __pyx_t_9);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 739, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_13);
      __pyx_t_13 = 0;
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      __Pyx_DECREF(__pyx_t_1);
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":740
       *                 appendVertex(verticesS, i0 * dTheta, j0 * dPhi)
       *                 appendVertex(verticesS, i2 * dTheta, j0 * dPhi)
       *                 polygons.append(Polygon(verticesS))             #
       * <<<<<<<<<<<<<< verticesW = [] appendVertex(verticesW, i1 * dTheta, j1 *
       * dPhi)
       */
      __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_Polygon);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 740, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_13 = NULL;
      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
        __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_9);
        if (likely(__pyx_t_13)) {
          PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_9);
          __Pyx_INCREF(__pyx_t_13);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_9, function);
        }
      }
      __pyx_t_1 = (__pyx_t_13)
                      ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_13,
                                                 __pyx_v_verticesS)
                      : __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_v_verticesS);
      __Pyx_XDECREF(__pyx_t_13);
      __pyx_t_13 = 0;
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 740, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_polygons, __pyx_t_1);
      if (unlikely(__pyx_t_10 == ((int)-1)))
        __PYX_ERR(0, 740, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1);
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":741
       *                 appendVertex(verticesS, i2 * dTheta, j0 * dPhi)
       *                 polygons.append(Polygon(verticesS))
       *                 verticesW = []             # <<<<<<<<<<<<<<
       *                 appendVertex(verticesW, i1 * dTheta, j1 * dPhi)
       *                 appendVertex(verticesW, i0 * dTheta, j2 * dPhi)
       */
      __pyx_t_1 = PyList_New(0);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 741, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_XDECREF_SET(__pyx_v_verticesW, ((PyObject *)__pyx_t_1));
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":742
       *                 polygons.append(Polygon(verticesS))
       *                 verticesW = []
       *                 appendVertex(verticesW, i1 * dTheta, j1 * dPhi) #
       * <<<<<<<<<<<<<< appendVertex(verticesW, i0 * dTheta, j2 * dPhi)
       *                 appendVertex(verticesW, i0 * dTheta, j0 * dPhi)
       */
      __pyx_t_1 = PyNumber_Multiply(__pyx_v_i1, __pyx_v_dTheta);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 742, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_9 = PyNumber_Multiply(__pyx_v_j1, __pyx_v_dPhi);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 742, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_13 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6sphere_appendVertex(
          __pyx_v_appendVertex, __pyx_v_verticesW, __pyx_t_1, __pyx_t_9);
      if (unlikely(!__pyx_t_13))
        __PYX_ERR(0, 742, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_13);
      __Pyx_DECREF(__pyx_t_1);
      __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      __Pyx_DECREF(__pyx_t_13);
      __pyx_t_13 = 0;

      /* "pyg4ometry/pycsg/core.pyx":743
       *                 verticesW = []
       *                 appendVertex(verticesW, i1 * dTheta, j1 * dPhi)
       *                 appendVertex(verticesW, i0 * dTheta, j2 * dPhi) #
       * <<<<<<<<<<<<<< appendVertex(verticesW, i0 * dTheta, j0 * dPhi)
       *                 polygons.append(Polygon(verticesW))
       */
      __pyx_t_13 = PyNumber_Multiply(__pyx_v_i0, __pyx_v_dTheta);
      if (unlikely(!__pyx_t_13))
        __PYX_ERR(0, 743, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_13);
      __pyx_t_9 = PyNumber_Multiply(__pyx_v_j2, __pyx_v_dPhi);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 743, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_1 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6sphere_appendVertex(
          __pyx_v_appendVertex, __pyx_v_verticesW, __pyx_t_13, __pyx_t_9);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 743, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_13);
      __pyx_t_13 = 0;
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      __Pyx_DECREF(__pyx_t_1);
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":744
       *                 appendVertex(verticesW, i1 * dTheta, j1 * dPhi)
       *                 appendVertex(verticesW, i0 * dTheta, j2 * dPhi)
       *                 appendVertex(verticesW, i0 * dTheta, j0 * dPhi) #
       * <<<<<<<<<<<<<< polygons.append(Polygon(verticesW)) verticesE = []
       */
      __pyx_t_1 = PyNumber_Multiply(__pyx_v_i0, __pyx_v_dTheta);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 744, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_9 = PyNumber_Multiply(__pyx_v_j0, __pyx_v_dPhi);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 744, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_13 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6sphere_appendVertex(
          __pyx_v_appendVertex, __pyx_v_verticesW, __pyx_t_1, __pyx_t_9);
      if (unlikely(!__pyx_t_13))
        __PYX_ERR(0, 744, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_13);
      __Pyx_DECREF(__pyx_t_1);
      __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      __Pyx_DECREF(__pyx_t_13);
      __pyx_t_13 = 0;

      /* "pyg4ometry/pycsg/core.pyx":745
       *                 appendVertex(verticesW, i0 * dTheta, j2 * dPhi)
       *                 appendVertex(verticesW, i0 * dTheta, j0 * dPhi)
       *                 polygons.append(Polygon(verticesW))             #
       * <<<<<<<<<<<<<< verticesE = [] appendVertex(verticesE, i1 * dTheta, j1 *
       * dPhi)
       */
      __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_Polygon);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 745, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_1 = NULL;
      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
        __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_9);
        if (likely(__pyx_t_1)) {
          PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_9);
          __Pyx_INCREF(__pyx_t_1);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_9, function);
        }
      }
      __pyx_t_13 =
          (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_1,
                                                 __pyx_v_verticesW)
                      : __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_v_verticesW);
      __Pyx_XDECREF(__pyx_t_1);
      __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_13))
        __PYX_ERR(0, 745, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_13);
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_polygons, __pyx_t_13);
      if (unlikely(__pyx_t_10 == ((int)-1)))
        __PYX_ERR(0, 745, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_13);
      __pyx_t_13 = 0;

      /* "pyg4ometry/pycsg/core.pyx":746
       *                 appendVertex(verticesW, i0 * dTheta, j0 * dPhi)
       *                 polygons.append(Polygon(verticesW))
       *                 verticesE = []             # <<<<<<<<<<<<<<
       *                 appendVertex(verticesE, i1 * dTheta, j1 * dPhi)
       *                 appendVertex(verticesE, i2 * dTheta, j0 * dPhi)
       */
      __pyx_t_13 = PyList_New(0);
      if (unlikely(!__pyx_t_13))
        __PYX_ERR(0, 746, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_13);
      __Pyx_XDECREF_SET(__pyx_v_verticesE, ((PyObject *)__pyx_t_13));
      __pyx_t_13 = 0;

      /* "pyg4ometry/pycsg/core.pyx":747
       *                 polygons.append(Polygon(verticesW))
       *                 verticesE = []
       *                 appendVertex(verticesE, i1 * dTheta, j1 * dPhi) #
       * <<<<<<<<<<<<<< appendVertex(verticesE, i2 * dTheta, j0 * dPhi)
       *                 appendVertex(verticesE, i2 * dTheta, j2 * dPhi)
       */
      __pyx_t_13 = PyNumber_Multiply(__pyx_v_i1, __pyx_v_dTheta);
      if (unlikely(!__pyx_t_13))
        __PYX_ERR(0, 747, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_13);
      __pyx_t_9 = PyNumber_Multiply(__pyx_v_j1, __pyx_v_dPhi);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 747, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_1 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6sphere_appendVertex(
          __pyx_v_appendVertex, __pyx_v_verticesE, __pyx_t_13, __pyx_t_9);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 747, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_13);
      __pyx_t_13 = 0;
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      __Pyx_DECREF(__pyx_t_1);
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":748
       *                 verticesE = []
       *                 appendVertex(verticesE, i1 * dTheta, j1 * dPhi)
       *                 appendVertex(verticesE, i2 * dTheta, j0 * dPhi) #
       * <<<<<<<<<<<<<< appendVertex(verticesE, i2 * dTheta, j2 * dPhi)
       *                 polygons.append(Polygon(verticesE))
       */
      __pyx_t_1 = PyNumber_Multiply(__pyx_v_i2, __pyx_v_dTheta);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 748, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_9 = PyNumber_Multiply(__pyx_v_j0, __pyx_v_dPhi);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 748, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_13 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6sphere_appendVertex(
          __pyx_v_appendVertex, __pyx_v_verticesE, __pyx_t_1, __pyx_t_9);
      if (unlikely(!__pyx_t_13))
        __PYX_ERR(0, 748, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_13);
      __Pyx_DECREF(__pyx_t_1);
      __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      __Pyx_DECREF(__pyx_t_13);
      __pyx_t_13 = 0;

      /* "pyg4ometry/pycsg/core.pyx":749
       *                 appendVertex(verticesE, i1 * dTheta, j1 * dPhi)
       *                 appendVertex(verticesE, i2 * dTheta, j0 * dPhi)
       *                 appendVertex(verticesE, i2 * dTheta, j2 * dPhi) #
       * <<<<<<<<<<<<<< polygons.append(Polygon(verticesE))
       *
       */
      __pyx_t_13 = PyNumber_Multiply(__pyx_v_i2, __pyx_v_dTheta);
      if (unlikely(!__pyx_t_13))
        __PYX_ERR(0, 749, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_13);
      __pyx_t_9 = PyNumber_Multiply(__pyx_v_j2, __pyx_v_dPhi);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 749, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_1 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_6sphere_appendVertex(
          __pyx_v_appendVertex, __pyx_v_verticesE, __pyx_t_13, __pyx_t_9);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 749, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_13);
      __pyx_t_13 = 0;
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      __Pyx_DECREF(__pyx_t_1);
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":750
       *                 appendVertex(verticesE, i2 * dTheta, j0 * dPhi)
       *                 appendVertex(verticesE, i2 * dTheta, j2 * dPhi)
       *                 polygons.append(Polygon(verticesE))             #
       * <<<<<<<<<<<<<<
       *
       *         return CSG.fromPolygons(polygons)
       */
      __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_Polygon);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 750, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_13 = NULL;
      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
        __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_9);
        if (likely(__pyx_t_13)) {
          PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_9);
          __Pyx_INCREF(__pyx_t_13);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_9, function);
        }
      }
      __pyx_t_1 = (__pyx_t_13)
                      ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_13,
                                                 __pyx_v_verticesE)
                      : __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_v_verticesE);
      __Pyx_XDECREF(__pyx_t_13);
      __pyx_t_13 = 0;
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 750, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
      __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_polygons, __pyx_t_1);
      if (unlikely(__pyx_t_10 == ((int)-1)))
        __PYX_ERR(0, 750, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1);
      __pyx_t_1 = 0;

      /* "pyg4ometry/pycsg/core.pyx":723
       *             j1 = j0 + 0.5
       *             j2 = j0 + 1
       *             for i0 in range(0, slices):             # <<<<<<<<<<<<<<
       *                 i1 = i0 + 0.5
       *                 i2 = i0 + 1
       */
    }
    __Pyx_DECREF(__pyx_t_2);
    __pyx_t_2 = 0;

    /* "pyg4ometry/pycsg/core.pyx":720
     *             polygons.append(Polygon(vertices))
     *
     *         for j0 in range(1, stacks - 1):             # <<<<<<<<<<<<<<
     *             j1 = j0 + 0.5
     *             j2 = j0 + 1
     */
  }
  __Pyx_DECREF(__pyx_t_5);
  __pyx_t_5 = 0;

  /* "pyg4ometry/pycsg/core.pyx":752
   *                 polygons.append(Polygon(verticesE))
   *
   *         return CSG.fromPolygons(polygons)             # <<<<<<<<<<<<<<
   *
   *     @classmethod
   */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_CSG);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 752, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_fromPolygons);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 752, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
    }
  }
  __pyx_t_5 =
      (__pyx_t_2)
          ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_2, __pyx_v_polygons)
          : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_polygons);
  __Pyx_XDECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 752, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":660
 *
 *     @classmethod
 *     def sphere(cls, **kwargs):             # <<<<<<<<<<<<<<
 *         """ Returns a sphere.
 *
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_13);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.sphere", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XDECREF(__pyx_v_center);
  __Pyx_XDECREF(__pyx_v_slices);
  __Pyx_XDECREF(__pyx_v_stacks);
  __Pyx_XDECREF(__pyx_v_polygons);
  __Pyx_XDECREF(__pyx_v_appendVertex);
  __Pyx_XDECREF(__pyx_v_dTheta);
  __Pyx_XDECREF(__pyx_v_dPhi);
  __Pyx_XDECREF(__pyx_v_j0);
  __Pyx_XDECREF(__pyx_v_j1);
  __Pyx_XDECREF(__pyx_v_i0);
  __Pyx_XDECREF(__pyx_v_i1);
  __Pyx_XDECREF(__pyx_v_vertices);
  __Pyx_XDECREF(__pyx_v_j2);
  __Pyx_XDECREF(__pyx_v_i2);
  __Pyx_XDECREF(__pyx_v_verticesN);
  __Pyx_XDECREF(__pyx_v_verticesS);
  __Pyx_XDECREF(__pyx_v_verticesW);
  __Pyx_XDECREF(__pyx_v_verticesE);
  __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":755
 *
 *     @classmethod
 *     def cylinder(cls, **kwargs):             # <<<<<<<<<<<<<<
 *         """ Returns a cylinder.
 *
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_53cylinder(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_52cylinder[] =
    " Returns a cylinder.\n            \n            Kwargs:\n                "
    "start (list): Start of cylinder, default [0, -1, 0].\n                \n  "
    "              end (list): End of cylinder, default [0, 1, 0].\n           "
    "     \n                radius (float): Radius of cylinder, default 1.0.\n "
    "               \n                slices (int): Number of slices, default "
    "16.\n        ";
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_53cylinder = {
    "cylinder",
    (PyCFunction)(void *)(PyCFunctionWithKeywords)
        __pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_53cylinder,
    METH_VARARGS | METH_KEYWORDS,
    __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_52cylinder};
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_53cylinder(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED PyObject *__pyx_v_cls = 0;
  PyObject *__pyx_v_kwargs = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext("cylinder (wrapper)",
                                                        0);
  __pyx_v_kwargs = PyDict_New();
  if (unlikely(!__pyx_v_kwargs))
    return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_cls, 0};
    PyObject *values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
      case 1:
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
      case 0:
        break;
      default:
        goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
      case 0:
        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_cls)) != 0))
          kw_args--;
        else
          goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames,
                                                 __pyx_v_kwargs, values,
                                                 pos_args, "cylinder") < 0))
          __PYX_ERR(0, 755, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
    }
    __pyx_v_cls = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
__pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("cylinder", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args));
  __PYX_ERR(0, 755, __pyx_L3_error)
__pyx_L3_error:;
  __Pyx_DECREF(__pyx_v_kwargs);
  __pyx_v_kwargs = 0;
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.cylinder", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
__pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_52cylinder(
      __pyx_self, __pyx_v_cls, __pyx_v_kwargs);

  /* function exit code */
  __Pyx_XDECREF(__pyx_v_kwargs);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":785
 *         polygons = []
 *
 *         def point(stack, angle, normalBlend):             # <<<<<<<<<<<<<<
 *             out = axisX.times(_np.cos(angle)).plus(
 *                 axisY.times(_np.sin(angle)))
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_8cylinder_1point(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_8cylinder_1point =
    {"point",
     (PyCFunction)(void *)(PyCFunctionWithKeywords)
         __pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_8cylinder_1point,
     METH_VARARGS | METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_8cylinder_1point(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_stack = 0;
  PyObject *__pyx_v_angle = 0;
  PyObject *__pyx_v_normalBlend = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext("point (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_stack, &__pyx_n_s_angle,
                                            &__pyx_n_s_normalBlend, 0};
    PyObject *values[3] = {0, 0, 0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
      case 3:
        values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
      case 2:
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
      case 1:
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
      case 0:
        break;
      default:
        goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
      case 0:
        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_stack)) != 0))
          kw_args--;
        else
          goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
      case 1:
        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_angle)) != 0))
          kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("point", 1, 3, 3, 1);
          __PYX_ERR(0, 785, __pyx_L3_error)
        }
        CYTHON_FALLTHROUGH;
      case 2:
        if (likely((values[2] = __Pyx_PyDict_GetItemStr(
                        __pyx_kwds, __pyx_n_s_normalBlend)) != 0))
          kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("point", 1, 3, 3, 2);
          __PYX_ERR(0, 785, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames,
                                                 0, values, pos_args,
                                                 "point") < 0))
          __PYX_ERR(0, 785, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
    }
    __pyx_v_stack = values[0];
    __pyx_v_angle = values[1];
    __pyx_v_normalBlend = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
__pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("point", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args));
  __PYX_ERR(0, 785, __pyx_L3_error)
__pyx_L3_error:;
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.cylinder.point", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
__pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_8cylinder_point(
      __pyx_self, __pyx_v_stack, __pyx_v_angle, __pyx_v_normalBlend);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_8cylinder_point(
    PyObject *__pyx_self, PyObject *__pyx_v_stack, PyObject *__pyx_v_angle,
    PyObject *__pyx_v_normalBlend) {
  struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder
      *__pyx_cur_scope;
  struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder
      *__pyx_outer_scope;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_pos = NULL;
  PyObject *__pyx_v_normal = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_t_8;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("point", 0);
  __pyx_outer_scope =
      (struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder
           *)__Pyx_CyFunction_GetClosure(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;

  /* "pyg4ometry/pycsg/core.pyx":786
   *
   *         def point(stack, angle, normalBlend):
   *             out = axisX.times(_np.cos(angle)).plus(             #
   * <<<<<<<<<<<<<< axisY.times(_np.sin(angle))) pos =
   * s.plus(ray.times(stack)).plus(out.times(r))
   */
  if (unlikely(!__pyx_cur_scope->__pyx_v_axisX)) {
    __Pyx_RaiseClosureNameError("axisX");
    __PYX_ERR(0, 786, __pyx_L1_error)
  }
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_axisX,
                                        __pyx_n_s_times);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 786, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 786, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_cos);
  if (unlikely(!__pyx_t_6))
    __PYX_ERR(0, 786, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_6, function);
    }
  }
  __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5,
                                                     __pyx_v_angle)
                          : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_angle);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 786, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_6)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  __pyx_t_2 = (__pyx_t_6)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_6, __pyx_t_4)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4);
  __Pyx_XDECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 786, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_plus);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 786, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":787
   *         def point(stack, angle, normalBlend):
   *             out = axisX.times(_np.cos(angle)).plus(
   *                 axisY.times(_np.sin(angle)))             # <<<<<<<<<<<<<<
   *             pos = s.plus(ray.times(stack)).plus(out.times(r))
   *             normal = out.times(1.0 - _np.fabs(normalBlend)).plus(
   */
  if (unlikely(!__pyx_cur_scope->__pyx_v_axisY)) {
    __Pyx_RaiseClosureNameError("axisY");
    __PYX_ERR(0, 787, __pyx_L1_error)
  }
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_axisY,
                                        __pyx_n_s_times);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 787, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 787, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_sin);
  if (unlikely(!__pyx_t_7))
    __PYX_ERR(0, 787, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_7);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_7, function);
    }
  }
  __pyx_t_6 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_5,
                                                     __pyx_v_angle)
                          : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_v_angle);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_6))
    __PYX_ERR(0, 787, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_7);
  __pyx_t_7 = 0;
  __pyx_t_7 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_7)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_7);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  __pyx_t_2 = (__pyx_t_7)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_7, __pyx_t_6)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __pyx_t_7 = 0;
  __Pyx_DECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 787, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_4)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
  __Pyx_XDECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 786, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_v_out = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":788
   *             out = axisX.times(_np.cos(angle)).plus(
   *                 axisY.times(_np.sin(angle)))
   *             pos = s.plus(ray.times(stack)).plus(out.times(r))             #
   * <<<<<<<<<<<<<< normal = out.times(1.0 - _np.fabs(normalBlend)).plus(
   *                 axisZ.times(normalBlend))
   */
  if (unlikely(!__pyx_cur_scope->__pyx_v_s)) {
    __Pyx_RaiseClosureNameError("s");
    __PYX_ERR(0, 788, __pyx_L1_error)
  }
  __pyx_t_2 =
      __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_s, __pyx_n_s_plus);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 788, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (unlikely(!__pyx_cur_scope->__pyx_v_ray)) {
    __Pyx_RaiseClosureNameError("ray");
    __PYX_ERR(0, 788, __pyx_L1_error)
  }
  __pyx_t_6 =
      __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_ray, __pyx_n_s_times);
  if (unlikely(!__pyx_t_6))
    __PYX_ERR(0, 788, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_7 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
    __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
    if (likely(__pyx_t_7)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_7);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_6, function);
    }
  }
  __pyx_t_4 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_7,
                                                     __pyx_v_stack)
                          : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_stack);
  __Pyx_XDECREF(__pyx_t_7);
  __pyx_t_7 = 0;
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 788, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_6)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_3 = (__pyx_t_6)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_6, __pyx_t_4)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
  __Pyx_XDECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 788, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_plus);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 788, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_out, __pyx_n_s_times);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 788, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (unlikely(!__pyx_cur_scope->__pyx_v_r)) {
    __Pyx_RaiseClosureNameError("r");
    __PYX_ERR(0, 788, __pyx_L1_error)
  }
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_6)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  __pyx_t_3 =
      (__pyx_t_6)
          ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_6,
                                     __pyx_cur_scope->__pyx_v_r)
          : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_cur_scope->__pyx_v_r);
  __Pyx_XDECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 788, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_4)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 788, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_pos = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":789
   *                 axisY.times(_np.sin(angle)))
   *             pos = s.plus(ray.times(stack)).plus(out.times(r))
   *             normal = out.times(1.0 - _np.fabs(normalBlend)).plus( #
   * <<<<<<<<<<<<<< axisZ.times(normalBlend)) return Vertex(pos, normal)
   */
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_out, __pyx_n_s_times);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 789, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np);
  if (unlikely(!__pyx_t_6))
    __PYX_ERR(0, 789, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_fabs);
  if (unlikely(!__pyx_t_7))
    __PYX_ERR(0, 789, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_7);
    if (likely(__pyx_t_6)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_7, function);
    }
  }
  __pyx_t_4 =
      (__pyx_t_6)
          ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_6, __pyx_v_normalBlend)
          : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_v_normalBlend);
  __Pyx_XDECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 789, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_7);
  __pyx_t_7 = 0;
  __pyx_t_7 = __Pyx_PyFloat_SubtractCObj(__pyx_float_1_0, __pyx_t_4, 1.0, 0, 0);
  if (unlikely(!__pyx_t_7))
    __PYX_ERR(0, 789, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  __pyx_t_2 = (__pyx_t_4)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_7)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_7);
  __Pyx_XDECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_7);
  __pyx_t_7 = 0;
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 789, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_plus);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 789, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":790
   *             pos = s.plus(ray.times(stack)).plus(out.times(r))
   *             normal = out.times(1.0 - _np.fabs(normalBlend)).plus(
   *                 axisZ.times(normalBlend))             # <<<<<<<<<<<<<<
   *             return Vertex(pos, normal)
   *
   */
  if (unlikely(!__pyx_cur_scope->__pyx_v_axisZ)) {
    __Pyx_RaiseClosureNameError("axisZ");
    __PYX_ERR(0, 790, __pyx_L1_error)
  }
  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_axisZ,
                                        __pyx_n_s_times);
  if (unlikely(!__pyx_t_7))
    __PYX_ERR(0, 790, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_7))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_7);
    if (likely(__pyx_t_4)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_7, function);
    }
  }
  __pyx_t_2 =
      (__pyx_t_4)
          ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_4, __pyx_v_normalBlend)
          : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_v_normalBlend);
  __Pyx_XDECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 790, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_7);
  __pyx_t_7 = 0;
  __pyx_t_7 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_7)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_7);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_7)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_7, __pyx_t_2)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
  __Pyx_XDECREF(__pyx_t_7);
  __pyx_t_7 = 0;
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 789, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_v_normal = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":791
   *             normal = out.times(1.0 - _np.fabs(normalBlend)).plus(
   *                 axisZ.times(normalBlend))
   *             return Vertex(pos, normal)             # <<<<<<<<<<<<<<
   *
   *         dt = _np.pi * 2.0 / float(slices)
   */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_Vertex);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 791, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_2 = NULL;
  __pyx_t_8 = 0;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
      __pyx_t_8 = 1;
    }
  }
#if CYTHON_FAST_PYCALL
  if (PyFunction_Check(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_v_pos, __pyx_v_normal};
    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp + 1 - __pyx_t_8,
                                          2 + __pyx_t_8);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 791, __pyx_L1_error)
    __Pyx_XDECREF(__pyx_t_2);
    __pyx_t_2 = 0;
    __Pyx_GOTREF(__pyx_t_1);
  } else
#endif
#if CYTHON_FAST_PYCCALL
      if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_v_pos, __pyx_v_normal};
    __pyx_t_1 = __Pyx_PyCFunction_FastCall(
        __pyx_t_3, __pyx_temp + 1 - __pyx_t_8, 2 + __pyx_t_8);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 791, __pyx_L1_error)
    __Pyx_XDECREF(__pyx_t_2);
    __pyx_t_2 = 0;
    __Pyx_GOTREF(__pyx_t_1);
  } else
#endif
  {
    __pyx_t_7 = PyTuple_New(2 + __pyx_t_8);
    if (unlikely(!__pyx_t_7))
      __PYX_ERR(0, 791, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    if (__pyx_t_2) {
      __Pyx_GIVEREF(__pyx_t_2);
      PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_2);
      __pyx_t_2 = NULL;
    }
    __Pyx_INCREF(__pyx_v_pos);
    __Pyx_GIVEREF(__pyx_v_pos);
    PyTuple_SET_ITEM(__pyx_t_7, 0 + __pyx_t_8, __pyx_v_pos);
    __Pyx_INCREF(__pyx_v_normal);
    __Pyx_GIVEREF(__pyx_v_normal);
    PyTuple_SET_ITEM(__pyx_t_7, 1 + __pyx_t_8, __pyx_v_normal);
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_7, NULL);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 791, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_7);
    __pyx_t_7 = 0;
  }
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":785
 *         polygons = []
 *
 *         def point(stack, angle, normalBlend):             # <<<<<<<<<<<<<<
 *             out = axisX.times(_np.cos(angle)).plus(
 *                 axisY.times(_np.sin(angle)))
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.cylinder.point", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_pos);
  __Pyx_XDECREF(__pyx_v_normal);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":755
 *
 *     @classmethod
 *     def cylinder(cls, **kwargs):             # <<<<<<<<<<<<<<
 *         """ Returns a cylinder.
 *
 */

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_52cylinder(
    CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_cls,
    PyObject *__pyx_v_kwargs) {
  struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder
      *__pyx_cur_scope;
  PyObject *__pyx_v_e = NULL;
  PyObject *__pyx_v_slices = NULL;
  PyObject *__pyx_v_isY = NULL;
  PyObject *__pyx_v_start = NULL;
  PyObject *__pyx_v_end = NULL;
  PyObject *__pyx_v_polygons = NULL;
  PyObject *__pyx_v_point = 0;
  PyObject *__pyx_v_dt = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_t0 = NULL;
  PyObject *__pyx_v_i1 = NULL;
  PyObject *__pyx_v_t1 = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  int __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  int __pyx_t_10;
  PyObject *__pyx_t_11 = NULL;
  Py_ssize_t __pyx_t_12;
  PyObject *(*__pyx_t_13)(PyObject *);
  int __pyx_t_14;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("cylinder", 0);
  __pyx_cur_scope =
      (struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder
           *)
          __pyx_tp_new_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder(
              __pyx_ptype_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder,
              __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((
        struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder
            *)Py_None);
    __Pyx_INCREF(Py_None);
    __PYX_ERR(0, 755, __pyx_L1_error)
  } else {
    __Pyx_GOTREF(__pyx_cur_scope);
  }

  /* "pyg4ometry/pycsg/core.pyx":767
   *                 slices (int): Number of slices, default 16.
   *         """
   *         s = kwargs.get('start', Vector(0.0, -1.0, 0.0))             #
   * <<<<<<<<<<<<<< e = kwargs.get('end', Vector(0.0, 1.0, 0.0)) if
   * isinstance(s, list):
   */
  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_Vector);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 767, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__17, NULL);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 767, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 =
      __Pyx_PyDict_GetItemDefault(__pyx_v_kwargs, __pyx_n_u_start, __pyx_t_2);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 767, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_cur_scope->__pyx_v_s = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":768
   *         """
   *         s = kwargs.get('start', Vector(0.0, -1.0, 0.0))
   *         e = kwargs.get('end', Vector(0.0, 1.0, 0.0))             #
   * <<<<<<<<<<<<<< if isinstance(s, list): s = Vector(*s)
   */
  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_Vector);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 768, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__18, NULL);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 768, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 =
      __Pyx_PyDict_GetItemDefault(__pyx_v_kwargs, __pyx_n_u_end, __pyx_t_2);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 768, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_e = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":769
   *         s = kwargs.get('start', Vector(0.0, -1.0, 0.0))
   *         e = kwargs.get('end', Vector(0.0, 1.0, 0.0))
   *         if isinstance(s, list):             # <<<<<<<<<<<<<<
   *             s = Vector(*s)
   *         if isinstance(e, list):
   */
  __pyx_t_1 = __pyx_cur_scope->__pyx_v_s;
  __Pyx_INCREF(__pyx_t_1);
  __pyx_t_3 = PyList_Check(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_4 = (__pyx_t_3 != 0);
  if (__pyx_t_4) {

    /* "pyg4ometry/pycsg/core.pyx":770
     *         e = kwargs.get('end', Vector(0.0, 1.0, 0.0))
     *         if isinstance(s, list):
     *             s = Vector(*s)             # <<<<<<<<<<<<<<
     *         if isinstance(e, list):
     *             e = Vector(*e)
     */
    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_Vector);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 770, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = __Pyx_PySequence_Tuple(__pyx_cur_scope->__pyx_v_s);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 770, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, NULL);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 770, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_2);
    __pyx_t_2 = 0;
    __Pyx_GOTREF(__pyx_cur_scope->__pyx_v_s);
    __Pyx_DECREF_SET(__pyx_cur_scope->__pyx_v_s, __pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_5);
    __pyx_t_5 = 0;

    /* "pyg4ometry/pycsg/core.pyx":769
     *         s = kwargs.get('start', Vector(0.0, -1.0, 0.0))
     *         e = kwargs.get('end', Vector(0.0, 1.0, 0.0))
     *         if isinstance(s, list):             # <<<<<<<<<<<<<<
     *             s = Vector(*s)
     *         if isinstance(e, list):
     */
  }

  /* "pyg4ometry/pycsg/core.pyx":771
   *         if isinstance(s, list):
   *             s = Vector(*s)
   *         if isinstance(e, list):             # <<<<<<<<<<<<<<
   *             e = Vector(*e)
   *         r = kwargs.get('radius', 1.0)
   */
  __pyx_t_4 = PyList_Check(__pyx_v_e);
  __pyx_t_3 = (__pyx_t_4 != 0);
  if (__pyx_t_3) {

    /* "pyg4ometry/pycsg/core.pyx":772
     *             s = Vector(*s)
     *         if isinstance(e, list):
     *             e = Vector(*e)             # <<<<<<<<<<<<<<
     *         r = kwargs.get('radius', 1.0)
     *         slices = kwargs.get('slices', 16)
     */
    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_Vector);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 772, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_2 = __Pyx_PySequence_Tuple(__pyx_v_e);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 772, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_2, NULL);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 772, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_5);
    __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_t_2);
    __pyx_t_2 = 0;
    __Pyx_DECREF_SET(__pyx_v_e, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "pyg4ometry/pycsg/core.pyx":771
     *         if isinstance(s, list):
     *             s = Vector(*s)
     *         if isinstance(e, list):             # <<<<<<<<<<<<<<
     *             e = Vector(*e)
     *         r = kwargs.get('radius', 1.0)
     */
  }

  /* "pyg4ometry/pycsg/core.pyx":773
   *         if isinstance(e, list):
   *             e = Vector(*e)
   *         r = kwargs.get('radius', 1.0)             # <<<<<<<<<<<<<<
   *         slices = kwargs.get('slices', 16)
   *         ray = e.minus(s)
   */
  __pyx_t_1 = __Pyx_PyDict_GetItemDefault(__pyx_v_kwargs, __pyx_n_u_radius,
                                          __pyx_float_1_0);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 773, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_cur_scope->__pyx_v_r = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":774
   *             e = Vector(*e)
   *         r = kwargs.get('radius', 1.0)
   *         slices = kwargs.get('slices', 16)             # <<<<<<<<<<<<<<
   *         ray = e.minus(s)
   *
   */
  __pyx_t_1 = __Pyx_PyDict_GetItemDefault(__pyx_v_kwargs, __pyx_n_u_slices,
                                          __pyx_int_16);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 774, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_slices = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":775
   *         r = kwargs.get('radius', 1.0)
   *         slices = kwargs.get('slices', 16)
   *         ray = e.minus(s)             # <<<<<<<<<<<<<<
   *
   *         axisZ = ray.unit()
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_e, __pyx_n_s_minus);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 775, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 =
      (__pyx_t_5)
          ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_5,
                                     __pyx_cur_scope->__pyx_v_s)
          : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_cur_scope->__pyx_v_s);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 775, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_cur_scope->__pyx_v_ray = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":777
   *         ray = e.minus(s)
   *
   *         axisZ = ray.unit()             # <<<<<<<<<<<<<<
   *         isY = (_np.fabs(axisZ.y) > 0.5)
   *         axisX = Vector(float(isY), float(not isY), 0).cross(axisZ).unit()
   */
  __pyx_t_2 =
      __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_ray, __pyx_n_s_unit);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 777, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_5)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 777, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_cur_scope->__pyx_v_axisZ = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":778
   *
   *         axisZ = ray.unit()
   *         isY = (_np.fabs(axisZ.y) > 0.5)             # <<<<<<<<<<<<<<
   *         axisX = Vector(float(isY), float(not isY), 0).cross(axisZ).unit()
   *         axisY = axisX.cross(axisZ).unit()
   */
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 778, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_fabs);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 778, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 =
      __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_axisZ, __pyx_n_s_y);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 778, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
    if (likely(__pyx_t_6)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_5, function);
    }
  }
  __pyx_t_1 = (__pyx_t_6)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
  __Pyx_XDECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 778, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyObject_RichCompare(__pyx_t_1, __pyx_float_0_5, Py_GT);
  __Pyx_XGOTREF(__pyx_t_5);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 778, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_v_isY = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "pyg4ometry/pycsg/core.pyx":779
   *         axisZ = ray.unit()
   *         isY = (_np.fabs(axisZ.y) > 0.5)
   *         axisX = Vector(float(isY), float(not isY), 0).cross(axisZ).unit()
   * # <<<<<<<<<<<<<< axisY = axisX.cross(axisZ).unit() start = Vertex(s,
   * axisZ.negated())
   */
  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_Vector);
  if (unlikely(!__pyx_t_6))
    __PYX_ERR(0, 779, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_7 = __Pyx_PyNumber_Float(__pyx_v_isY);
  if (unlikely(!__pyx_t_7))
    __PYX_ERR(0, 779, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_isY);
  if (unlikely(__pyx_t_3 < 0))
    __PYX_ERR(0, 779, __pyx_L1_error)
  __pyx_t_8 = PyFloat_FromDouble(((double)(!__pyx_t_3)));
  if (unlikely(!__pyx_t_8))
    __PYX_ERR(0, 779, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_8);
  __pyx_t_9 = NULL;
  __pyx_t_10 = 0;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
    __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_6);
    if (likely(__pyx_t_9)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_9);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_6, function);
      __pyx_t_10 = 1;
    }
  }
#if CYTHON_FAST_PYCALL
  if (PyFunction_Check(__pyx_t_6)) {
    PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_t_7, __pyx_t_8, __pyx_int_0};
    __pyx_t_2 = __Pyx_PyFunction_FastCall(
        __pyx_t_6, __pyx_temp + 1 - __pyx_t_10, 3 + __pyx_t_10);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 779, __pyx_L1_error)
    __Pyx_XDECREF(__pyx_t_9);
    __pyx_t_9 = 0;
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_7);
    __pyx_t_7 = 0;
    __Pyx_DECREF(__pyx_t_8);
    __pyx_t_8 = 0;
  } else
#endif
#if CYTHON_FAST_PYCCALL
      if (__Pyx_PyFastCFunction_Check(__pyx_t_6)) {
    PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_t_7, __pyx_t_8, __pyx_int_0};
    __pyx_t_2 = __Pyx_PyCFunction_FastCall(
        __pyx_t_6, __pyx_temp + 1 - __pyx_t_10, 3 + __pyx_t_10);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 779, __pyx_L1_error)
    __Pyx_XDECREF(__pyx_t_9);
    __pyx_t_9 = 0;
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_7);
    __pyx_t_7 = 0;
    __Pyx_DECREF(__pyx_t_8);
    __pyx_t_8 = 0;
  } else
#endif
  {
    __pyx_t_11 = PyTuple_New(3 + __pyx_t_10);
    if (unlikely(!__pyx_t_11))
      __PYX_ERR(0, 779, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    if (__pyx_t_9) {
      __Pyx_GIVEREF(__pyx_t_9);
      PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_9);
      __pyx_t_9 = NULL;
    }
    __Pyx_GIVEREF(__pyx_t_7);
    PyTuple_SET_ITEM(__pyx_t_11, 0 + __pyx_t_10, __pyx_t_7);
    __Pyx_GIVEREF(__pyx_t_8);
    PyTuple_SET_ITEM(__pyx_t_11, 1 + __pyx_t_10, __pyx_t_8);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyTuple_SET_ITEM(__pyx_t_11, 2 + __pyx_t_10, __pyx_int_0);
    __pyx_t_7 = 0;
    __pyx_t_8 = 0;
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_11, NULL);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 779, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_11);
    __pyx_t_11 = 0;
  }
  __Pyx_DECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_cross);
  if (unlikely(!__pyx_t_6))
    __PYX_ERR(0, 779, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_6);
    if (likely(__pyx_t_2)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_6, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_2,
                                             __pyx_cur_scope->__pyx_v_axisZ)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_6,
                                              __pyx_cur_scope->__pyx_v_axisZ);
  __Pyx_XDECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 779, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_unit);
  if (unlikely(!__pyx_t_6))
    __PYX_ERR(0, 779, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_6);
    if (likely(__pyx_t_1)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_6, function);
    }
  }
  __pyx_t_5 = (__pyx_t_1) ? __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_1)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 779, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  __Pyx_GIVEREF(__pyx_t_5);
  __pyx_cur_scope->__pyx_v_axisX = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "pyg4ometry/pycsg/core.pyx":780
   *         isY = (_np.fabs(axisZ.y) > 0.5)
   *         axisX = Vector(float(isY), float(not isY), 0).cross(axisZ).unit()
   *         axisY = axisX.cross(axisZ).unit()             # <<<<<<<<<<<<<<
   *         start = Vertex(s, axisZ.negated())
   *         end = Vertex(e, axisZ.unit())
   */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_axisX,
                                        __pyx_n_s_cross);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 780, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
    }
  }
  __pyx_t_6 = (__pyx_t_2)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_2,
                                             __pyx_cur_scope->__pyx_v_axisZ)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_1,
                                              __pyx_cur_scope->__pyx_v_axisZ);
  __Pyx_XDECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_6))
    __PYX_ERR(0, 780, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_unit);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 780, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_6)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
    }
  }
  __pyx_t_5 = (__pyx_t_6) ? __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_6)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 780, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __Pyx_GIVEREF(__pyx_t_5);
  __pyx_cur_scope->__pyx_v_axisY = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "pyg4ometry/pycsg/core.pyx":781
   *         axisX = Vector(float(isY), float(not isY), 0).cross(axisZ).unit()
   *         axisY = axisX.cross(axisZ).unit()
   *         start = Vertex(s, axisZ.negated())             # <<<<<<<<<<<<<<
   *         end = Vertex(e, axisZ.unit())
   *         polygons = []
   */
  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_Vertex);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 781, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_axisZ,
                                        __pyx_n_s_negated);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 781, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_11 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_11)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_11);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_6 = (__pyx_t_11) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_11)
                           : __Pyx_PyObject_CallNoArg(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_11);
  __pyx_t_11 = 0;
  if (unlikely(!__pyx_t_6))
    __PYX_ERR(0, 781, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_10 = 0;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
      __pyx_t_10 = 1;
    }
  }
#if CYTHON_FAST_PYCALL
  if (PyFunction_Check(__pyx_t_1)) {
    PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_cur_scope->__pyx_v_s,
                               __pyx_t_6};
    __pyx_t_5 = __Pyx_PyFunction_FastCall(
        __pyx_t_1, __pyx_temp + 1 - __pyx_t_10, 2 + __pyx_t_10);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 781, __pyx_L1_error)
    __Pyx_XDECREF(__pyx_t_2);
    __pyx_t_2 = 0;
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_6);
    __pyx_t_6 = 0;
  } else
#endif
#if CYTHON_FAST_PYCCALL
      if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
    PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_cur_scope->__pyx_v_s,
                               __pyx_t_6};
    __pyx_t_5 = __Pyx_PyCFunction_FastCall(
        __pyx_t_1, __pyx_temp + 1 - __pyx_t_10, 2 + __pyx_t_10);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 781, __pyx_L1_error)
    __Pyx_XDECREF(__pyx_t_2);
    __pyx_t_2 = 0;
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_6);
    __pyx_t_6 = 0;
  } else
#endif
  {
    __pyx_t_11 = PyTuple_New(2 + __pyx_t_10);
    if (unlikely(!__pyx_t_11))
      __PYX_ERR(0, 781, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    if (__pyx_t_2) {
      __Pyx_GIVEREF(__pyx_t_2);
      PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_2);
      __pyx_t_2 = NULL;
    }
    __Pyx_INCREF(__pyx_cur_scope->__pyx_v_s);
    __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_s);
    PyTuple_SET_ITEM(__pyx_t_11, 0 + __pyx_t_10, __pyx_cur_scope->__pyx_v_s);
    __Pyx_GIVEREF(__pyx_t_6);
    PyTuple_SET_ITEM(__pyx_t_11, 1 + __pyx_t_10, __pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_11, NULL);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 781, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_11);
    __pyx_t_11 = 0;
  }
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_v_start = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "pyg4ometry/pycsg/core.pyx":782
   *         axisY = axisX.cross(axisZ).unit()
   *         start = Vertex(s, axisZ.negated())
   *         end = Vertex(e, axisZ.unit())             # <<<<<<<<<<<<<<
   *         polygons = []
   *
   */
  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_Vertex);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 782, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 =
      __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_axisZ, __pyx_n_s_unit);
  if (unlikely(!__pyx_t_6))
    __PYX_ERR(0, 782, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_6);
    if (likely(__pyx_t_2)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_6, function);
    }
  }
  __pyx_t_11 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_2)
                           : __Pyx_PyObject_CallNoArg(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_11))
    __PYX_ERR(0, 782, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_11);
  __Pyx_DECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  __pyx_t_10 = 0;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_6)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
      __pyx_t_10 = 1;
    }
  }
#if CYTHON_FAST_PYCALL
  if (PyFunction_Check(__pyx_t_1)) {
    PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_v_e, __pyx_t_11};
    __pyx_t_5 = __Pyx_PyFunction_FastCall(
        __pyx_t_1, __pyx_temp + 1 - __pyx_t_10, 2 + __pyx_t_10);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 782, __pyx_L1_error)
    __Pyx_XDECREF(__pyx_t_6);
    __pyx_t_6 = 0;
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_11);
    __pyx_t_11 = 0;
  } else
#endif
#if CYTHON_FAST_PYCCALL
      if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
    PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_v_e, __pyx_t_11};
    __pyx_t_5 = __Pyx_PyCFunction_FastCall(
        __pyx_t_1, __pyx_temp + 1 - __pyx_t_10, 2 + __pyx_t_10);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 782, __pyx_L1_error)
    __Pyx_XDECREF(__pyx_t_6);
    __pyx_t_6 = 0;
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_11);
    __pyx_t_11 = 0;
  } else
#endif
  {
    __pyx_t_2 = PyTuple_New(2 + __pyx_t_10);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 782, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    if (__pyx_t_6) {
      __Pyx_GIVEREF(__pyx_t_6);
      PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_6);
      __pyx_t_6 = NULL;
    }
    __Pyx_INCREF(__pyx_v_e);
    __Pyx_GIVEREF(__pyx_v_e);
    PyTuple_SET_ITEM(__pyx_t_2, 0 + __pyx_t_10, __pyx_v_e);
    __Pyx_GIVEREF(__pyx_t_11);
    PyTuple_SET_ITEM(__pyx_t_2, 1 + __pyx_t_10, __pyx_t_11);
    __pyx_t_11 = 0;
    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, NULL);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 782, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_2);
    __pyx_t_2 = 0;
  }
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_v_end = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "pyg4ometry/pycsg/core.pyx":783
   *         start = Vertex(s, axisZ.negated())
   *         end = Vertex(e, axisZ.unit())
   *         polygons = []             # <<<<<<<<<<<<<<
   *
   *         def point(stack, angle, normalBlend):
   */
  __pyx_t_5 = PyList_New(0);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 783, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_v_polygons = ((PyObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "pyg4ometry/pycsg/core.pyx":785
   *         polygons = []
   *
   *         def point(stack, angle, normalBlend):             # <<<<<<<<<<<<<<
   *             out = axisX.times(_np.cos(angle)).plus(
   *                 axisY.times(_np.sin(angle)))
   */
  __pyx_t_5 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_8cylinder_1point, 0,
      __pyx_n_s_CSG_cylinder_locals_point, ((PyObject *)__pyx_cur_scope),
      __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
      ((PyObject *)__pyx_codeobj__20));
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 785, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_v_point = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "pyg4ometry/pycsg/core.pyx":793
   *             return Vertex(pos, normal)
   *
   *         dt = _np.pi * 2.0 / float(slices)             # <<<<<<<<<<<<<<
   *         for i in range(0, slices):
   *             t0 = i * dt
   */
  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 793, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_pi);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 793, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyNumber_Multiply(__pyx_t_1, __pyx_float_2_0);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 793, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyNumber_Float(__pyx_v_slices);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 793, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyNumber_Divide(__pyx_t_5, __pyx_t_1);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 793, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_v_dt = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":794
   *
   *         dt = _np.pi * 2.0 / float(slices)
   *         for i in range(0, slices):             # <<<<<<<<<<<<<<
   *             t0 = i * dt
   *             i1 = (i + 1) % slices
   */
  __pyx_t_2 = PyTuple_New(2);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 794, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_0);
  __Pyx_INCREF(__pyx_v_slices);
  __Pyx_GIVEREF(__pyx_v_slices);
  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_slices);
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_2, NULL);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 794, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1;
    __Pyx_INCREF(__pyx_t_2);
    __pyx_t_12 = 0;
    __pyx_t_13 = NULL;
  } else {
    __pyx_t_12 = -1;
    __pyx_t_2 = PyObject_GetIter(__pyx_t_1);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 794, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_13 = Py_TYPE(__pyx_t_2)->tp_iternext;
    if (unlikely(!__pyx_t_13))
      __PYX_ERR(0, 794, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_13)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_12 >= PyList_GET_SIZE(__pyx_t_2))
          break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_12);
        __Pyx_INCREF(__pyx_t_1);
        __pyx_t_12++;
        if (unlikely(0 < 0))
          __PYX_ERR(0, 794, __pyx_L1_error)
#else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_12);
        __pyx_t_12++;
        if (unlikely(!__pyx_t_1))
          __PYX_ERR(0, 794, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
#endif
      } else {
        if (__pyx_t_12 >= PyTuple_GET_SIZE(__pyx_t_2))
          break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_12);
        __Pyx_INCREF(__pyx_t_1);
        __pyx_t_12++;
        if (unlikely(0 < 0))
          __PYX_ERR(0, 794, __pyx_L1_error)
#else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_12);
        __pyx_t_12++;
        if (unlikely(!__pyx_t_1))
          __PYX_ERR(0, 794, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
#endif
      }
    } else {
      __pyx_t_1 = __pyx_t_13(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject *exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type,
                                                       PyExc_StopIteration)))
            PyErr_Clear();
          else
            __PYX_ERR(0, 794, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "pyg4ometry/pycsg/core.pyx":795
     *         dt = _np.pi * 2.0 / float(slices)
     *         for i in range(0, slices):
     *             t0 = i * dt             # <<<<<<<<<<<<<<
     *             i1 = (i + 1) % slices
     *             t1 = i1 * dt
     */
    __pyx_t_1 = PyNumber_Multiply(__pyx_v_i, __pyx_v_dt);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 795, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_XDECREF_SET(__pyx_v_t0, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "pyg4ometry/pycsg/core.pyx":796
     *         for i in range(0, slices):
     *             t0 = i * dt
     *             i1 = (i + 1) % slices             # <<<<<<<<<<<<<<
     *             t1 = i1 * dt
     *             polygons.append(Polygon([start.clone(),
     */
    __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_1, 1, 0, 0);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 796, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = PyNumber_Remainder(__pyx_t_1, __pyx_v_slices);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 796, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __Pyx_XDECREF_SET(__pyx_v_i1, __pyx_t_5);
    __pyx_t_5 = 0;

    /* "pyg4ometry/pycsg/core.pyx":797
     *             t0 = i * dt
     *             i1 = (i + 1) % slices
     *             t1 = i1 * dt             # <<<<<<<<<<<<<<
     *             polygons.append(Polygon([start.clone(),
     *                                      point(0., t0, -1.),
     */
    __pyx_t_5 = PyNumber_Multiply(__pyx_v_i1, __pyx_v_dt);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 797, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_XDECREF_SET(__pyx_v_t1, __pyx_t_5);
    __pyx_t_5 = 0;

    /* "pyg4ometry/pycsg/core.pyx":798
     *             i1 = (i + 1) % slices
     *             t1 = i1 * dt
     *             polygons.append(Polygon([start.clone(),             #
     * <<<<<<<<<<<<<< point(0., t0, -1.), point(0., t1, -1.)]))
     */
    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_Polygon);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 798, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_start, __pyx_n_s_clone);
    if (unlikely(!__pyx_t_6))
      __PYX_ERR(0, 798, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_8 = NULL;
    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
      __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_6);
      if (likely(__pyx_t_8)) {
        PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_6);
        __Pyx_INCREF(__pyx_t_8);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_6, function);
      }
    }
    __pyx_t_11 = (__pyx_t_8) ? __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_8)
                             : __Pyx_PyObject_CallNoArg(__pyx_t_6);
    __Pyx_XDECREF(__pyx_t_8);
    __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_11))
      __PYX_ERR(0, 798, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __Pyx_DECREF(__pyx_t_6);
    __pyx_t_6 = 0;

    /* "pyg4ometry/pycsg/core.pyx":799
     *             t1 = i1 * dt
     *             polygons.append(Polygon([start.clone(),
     *                                      point(0., t0, -1.),             #
     * <<<<<<<<<<<<<< point(0., t1, -1.)])) polygons.append(Polygon([point(0.,
     * t1, 0.),
     */
    __pyx_t_6 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_8cylinder_point(
        __pyx_v_point, __pyx_float_0_, __pyx_v_t0, __pyx_float_neg_1_);
    if (unlikely(!__pyx_t_6))
      __PYX_ERR(0, 799, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);

    /* "pyg4ometry/pycsg/core.pyx":800
     *             polygons.append(Polygon([start.clone(),
     *                                      point(0., t0, -1.),
     *                                      point(0., t1, -1.)]))             #
     * <<<<<<<<<<<<<< polygons.append(Polygon([point(0., t1, 0.), point(0., t0,
     * 0.),
     */
    __pyx_t_8 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_8cylinder_point(
        __pyx_v_point, __pyx_float_0_, __pyx_v_t1, __pyx_float_neg_1_);
    if (unlikely(!__pyx_t_8))
      __PYX_ERR(0, 800, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);

    /* "pyg4ometry/pycsg/core.pyx":798
     *             i1 = (i + 1) % slices
     *             t1 = i1 * dt
     *             polygons.append(Polygon([start.clone(),             #
     * <<<<<<<<<<<<<< point(0., t0, -1.), point(0., t1, -1.)]))
     */
    __pyx_t_7 = PyList_New(3);
    if (unlikely(!__pyx_t_7))
      __PYX_ERR(0, 798, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_GIVEREF(__pyx_t_11);
    PyList_SET_ITEM(__pyx_t_7, 0, __pyx_t_11);
    __Pyx_GIVEREF(__pyx_t_6);
    PyList_SET_ITEM(__pyx_t_7, 1, __pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_8);
    PyList_SET_ITEM(__pyx_t_7, 2, __pyx_t_8);
    __pyx_t_11 = 0;
    __pyx_t_6 = 0;
    __pyx_t_8 = 0;
    __pyx_t_8 = NULL;
    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
      __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_1);
      if (likely(__pyx_t_8)) {
        PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_1);
        __Pyx_INCREF(__pyx_t_8);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_1, function);
      }
    }
    __pyx_t_5 = (__pyx_t_8)
                    ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_8, __pyx_t_7)
                    : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_7);
    __Pyx_XDECREF(__pyx_t_8);
    __pyx_t_8 = 0;
    __Pyx_DECREF(__pyx_t_7);
    __pyx_t_7 = 0;
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 798, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_14 = __Pyx_PyList_Append(__pyx_v_polygons, __pyx_t_5);
    if (unlikely(__pyx_t_14 == ((int)-1)))
      __PYX_ERR(0, 798, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5);
    __pyx_t_5 = 0;

    /* "pyg4ometry/pycsg/core.pyx":801
     *                                      point(0., t0, -1.),
     *                                      point(0., t1, -1.)]))
     *             polygons.append(Polygon([point(0., t1, 0.),             #
     * <<<<<<<<<<<<<< point(0., t0, 0.), point(1., t0, 0.),
     */
    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_Polygon);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 801, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_7 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_8cylinder_point(
        __pyx_v_point, __pyx_float_0_, __pyx_v_t1, __pyx_float_0_);
    if (unlikely(!__pyx_t_7))
      __PYX_ERR(0, 801, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);

    /* "pyg4ometry/pycsg/core.pyx":802
     *                                      point(0., t1, -1.)]))
     *             polygons.append(Polygon([point(0., t1, 0.),
     *                                      point(0., t0, 0.),             #
     * <<<<<<<<<<<<<< point(1., t0, 0.), point(1., t1, 0.)]))
     */
    __pyx_t_8 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_8cylinder_point(
        __pyx_v_point, __pyx_float_0_, __pyx_v_t0, __pyx_float_0_);
    if (unlikely(!__pyx_t_8))
      __PYX_ERR(0, 802, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);

    /* "pyg4ometry/pycsg/core.pyx":803
     *             polygons.append(Polygon([point(0., t1, 0.),
     *                                      point(0., t0, 0.),
     *                                      point(1., t0, 0.),             #
     * <<<<<<<<<<<<<< point(1., t1, 0.)])) polygons.append(Polygon([end.clone(),
     */
    __pyx_t_6 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_8cylinder_point(
        __pyx_v_point, __pyx_float_1_, __pyx_v_t0, __pyx_float_0_);
    if (unlikely(!__pyx_t_6))
      __PYX_ERR(0, 803, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);

    /* "pyg4ometry/pycsg/core.pyx":804
     *                                      point(0., t0, 0.),
     *                                      point(1., t0, 0.),
     *                                      point(1., t1, 0.)]))             #
     * <<<<<<<<<<<<<< polygons.append(Polygon([end.clone(), point(1., t1, 1.),
     */
    __pyx_t_11 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_8cylinder_point(
        __pyx_v_point, __pyx_float_1_, __pyx_v_t1, __pyx_float_0_);
    if (unlikely(!__pyx_t_11))
      __PYX_ERR(0, 804, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);

    /* "pyg4ometry/pycsg/core.pyx":801
     *                                      point(0., t0, -1.),
     *                                      point(0., t1, -1.)]))
     *             polygons.append(Polygon([point(0., t1, 0.),             #
     * <<<<<<<<<<<<<< point(0., t0, 0.), point(1., t0, 0.),
     */
    __pyx_t_9 = PyList_New(4);
    if (unlikely(!__pyx_t_9))
      __PYX_ERR(0, 801, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_GIVEREF(__pyx_t_7);
    PyList_SET_ITEM(__pyx_t_9, 0, __pyx_t_7);
    __Pyx_GIVEREF(__pyx_t_8);
    PyList_SET_ITEM(__pyx_t_9, 1, __pyx_t_8);
    __Pyx_GIVEREF(__pyx_t_6);
    PyList_SET_ITEM(__pyx_t_9, 2, __pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_11);
    PyList_SET_ITEM(__pyx_t_9, 3, __pyx_t_11);
    __pyx_t_7 = 0;
    __pyx_t_8 = 0;
    __pyx_t_6 = 0;
    __pyx_t_11 = 0;
    __pyx_t_11 = NULL;
    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
      __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_1);
      if (likely(__pyx_t_11)) {
        PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_1);
        __Pyx_INCREF(__pyx_t_11);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_1, function);
      }
    }
    __pyx_t_5 = (__pyx_t_11)
                    ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_11, __pyx_t_9)
                    : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_9);
    __Pyx_XDECREF(__pyx_t_11);
    __pyx_t_11 = 0;
    __Pyx_DECREF(__pyx_t_9);
    __pyx_t_9 = 0;
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 801, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_14 = __Pyx_PyList_Append(__pyx_v_polygons, __pyx_t_5);
    if (unlikely(__pyx_t_14 == ((int)-1)))
      __PYX_ERR(0, 801, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5);
    __pyx_t_5 = 0;

    /* "pyg4ometry/pycsg/core.pyx":805
     *                                      point(1., t0, 0.),
     *                                      point(1., t1, 0.)]))
     *             polygons.append(Polygon([end.clone(),             #
     * <<<<<<<<<<<<<< point(1., t1, 1.), point(1., t0, 1.)]))
     */
    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_Polygon);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 805, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_end, __pyx_n_s_clone);
    if (unlikely(!__pyx_t_11))
      __PYX_ERR(0, 805, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __pyx_t_6 = NULL;
    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_11);
      if (likely(__pyx_t_6)) {
        PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_11);
        __Pyx_INCREF(__pyx_t_6);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_11, function);
      }
    }
    __pyx_t_9 = (__pyx_t_6) ? __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_6)
                            : __Pyx_PyObject_CallNoArg(__pyx_t_11);
    __Pyx_XDECREF(__pyx_t_6);
    __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_9))
      __PYX_ERR(0, 805, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(__pyx_t_11);
    __pyx_t_11 = 0;

    /* "pyg4ometry/pycsg/core.pyx":806
     *                                      point(1., t1, 0.)]))
     *             polygons.append(Polygon([end.clone(),
     *                                      point(1., t1, 1.),             #
     * <<<<<<<<<<<<<< point(1., t0, 1.)]))
     *
     */
    __pyx_t_11 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_8cylinder_point(
        __pyx_v_point, __pyx_float_1_, __pyx_v_t1, __pyx_float_1_);
    if (unlikely(!__pyx_t_11))
      __PYX_ERR(0, 806, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);

    /* "pyg4ometry/pycsg/core.pyx":807
     *             polygons.append(Polygon([end.clone(),
     *                                      point(1., t1, 1.),
     *                                      point(1., t0, 1.)]))             #
     * <<<<<<<<<<<<<<
     *
     *         return CSG.fromPolygons(polygons)
     */
    __pyx_t_6 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_8cylinder_point(
        __pyx_v_point, __pyx_float_1_, __pyx_v_t0, __pyx_float_1_);
    if (unlikely(!__pyx_t_6))
      __PYX_ERR(0, 807, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);

    /* "pyg4ometry/pycsg/core.pyx":805
     *                                      point(1., t0, 0.),
     *                                      point(1., t1, 0.)]))
     *             polygons.append(Polygon([end.clone(),             #
     * <<<<<<<<<<<<<< point(1., t1, 1.), point(1., t0, 1.)]))
     */
    __pyx_t_8 = PyList_New(3);
    if (unlikely(!__pyx_t_8))
      __PYX_ERR(0, 805, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_GIVEREF(__pyx_t_9);
    PyList_SET_ITEM(__pyx_t_8, 0, __pyx_t_9);
    __Pyx_GIVEREF(__pyx_t_11);
    PyList_SET_ITEM(__pyx_t_8, 1, __pyx_t_11);
    __Pyx_GIVEREF(__pyx_t_6);
    PyList_SET_ITEM(__pyx_t_8, 2, __pyx_t_6);
    __pyx_t_9 = 0;
    __pyx_t_11 = 0;
    __pyx_t_6 = 0;
    __pyx_t_6 = NULL;
    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
      if (likely(__pyx_t_6)) {
        PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_1);
        __Pyx_INCREF(__pyx_t_6);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_1, function);
      }
    }
    __pyx_t_5 = (__pyx_t_6)
                    ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_6, __pyx_t_8)
                    : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_8);
    __Pyx_XDECREF(__pyx_t_6);
    __pyx_t_6 = 0;
    __Pyx_DECREF(__pyx_t_8);
    __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 805, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_14 = __Pyx_PyList_Append(__pyx_v_polygons, __pyx_t_5);
    if (unlikely(__pyx_t_14 == ((int)-1)))
      __PYX_ERR(0, 805, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5);
    __pyx_t_5 = 0;

    /* "pyg4ometry/pycsg/core.pyx":794
     *
     *         dt = _np.pi * 2.0 / float(slices)
     *         for i in range(0, slices):             # <<<<<<<<<<<<<<
     *             t0 = i * dt
     *             i1 = (i + 1) % slices
     */
  }
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":809
   *                                      point(1., t0, 1.)]))
   *
   *         return CSG.fromPolygons(polygons)             # <<<<<<<<<<<<<<
   *
   *     @classmethod
   */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_CSG);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 809, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_fromPolygons);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 809, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
    }
  }
  __pyx_t_2 =
      (__pyx_t_5)
          ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_5, __pyx_v_polygons)
          : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_polygons);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 809, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":755
 *
 *     @classmethod
 *     def cylinder(cls, **kwargs):             # <<<<<<<<<<<<<<
 *         """ Returns a cylinder.
 *
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.cylinder", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XDECREF(__pyx_v_e);
  __Pyx_XDECREF(__pyx_v_slices);
  __Pyx_XDECREF(__pyx_v_isY);
  __Pyx_XDECREF(__pyx_v_start);
  __Pyx_XDECREF(__pyx_v_end);
  __Pyx_XDECREF(__pyx_v_polygons);
  __Pyx_XDECREF(__pyx_v_point);
  __Pyx_XDECREF(__pyx_v_dt);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XDECREF(__pyx_v_t0);
  __Pyx_XDECREF(__pyx_v_i1);
  __Pyx_XDECREF(__pyx_v_t1);
  __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":812
 *
 *     @classmethod
 *     def cone(cls, **kwargs):             # <<<<<<<<<<<<<<
 *         """ Returns a cone.
 *
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_55cone(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_54cone[] =
    " Returns a cone.\n            \n            Kwargs:\n                "
    "start (list): Start of cone, default [0, -1, 0].\n                \n      "
    "          end (list): End of cone, default [0, 1, 0].\n                \n "
    "               radius (float): Maximum radius of cone at start, default "
    "1.0.\n                \n                slices (int): Number of slices, "
    "default 16.\n        ";
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_55cone = {
    "cone",
    (PyCFunction)(void *)(PyCFunctionWithKeywords)
        __pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_55cone,
    METH_VARARGS | METH_KEYWORDS,
    __pyx_doc_10pyg4ometry_5pycsg_4core_3CSG_54cone};
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_55cone(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED PyObject *__pyx_v_cls = 0;
  PyObject *__pyx_v_kwargs = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext("cone (wrapper)", 0);
  __pyx_v_kwargs = PyDict_New();
  if (unlikely(!__pyx_v_kwargs))
    return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_cls, 0};
    PyObject *values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
      case 1:
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
      case 0:
        break;
      default:
        goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
      case 0:
        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_cls)) != 0))
          kw_args--;
        else
          goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames,
                                                 __pyx_v_kwargs, values,
                                                 pos_args, "cone") < 0))
          __PYX_ERR(0, 812, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
    }
    __pyx_v_cls = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
__pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("cone", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args));
  __PYX_ERR(0, 812, __pyx_L3_error)
__pyx_L3_error:;
  __Pyx_DECREF(__pyx_v_kwargs);
  __pyx_v_kwargs = 0;
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.cone", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
__pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_54cone(
      __pyx_self, __pyx_v_cls, __pyx_v_kwargs);

  /* function exit code */
  __Pyx_XDECREF(__pyx_v_kwargs);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":845
 *         sinTaperAngle = _np.sin(taperAngle)
 *         cosTaperAngle = _np.cos(taperAngle)
 *         def point(angle):             # <<<<<<<<<<<<<<
 *             # radial direction pointing out
 *             out = axisX.times(_np.cos(angle)).plus(
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_4cone_1point(
    PyObject *__pyx_self, PyObject *__pyx_v_angle); /*proto*/
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_4cone_1point = {
    "point", (PyCFunction)__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_4cone_1point,
    METH_O, 0};
static PyObject *
__pyx_pw_10pyg4ometry_5pycsg_4core_3CSG_4cone_1point(PyObject *__pyx_self,
                                                     PyObject *__pyx_v_angle) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext("point (wrapper)", 0);
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_4cone_point(
      __pyx_self, ((PyObject *)__pyx_v_angle));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *
__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_4cone_point(PyObject *__pyx_self,
                                                    PyObject *__pyx_v_angle) {
  struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone
      *__pyx_cur_scope;
  struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone
      *__pyx_outer_scope;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_pos = NULL;
  PyObject *__pyx_v_normal = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("point", 0);
  __pyx_outer_scope =
      (struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone *)
          __Pyx_CyFunction_GetClosure(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;

  /* "pyg4ometry/pycsg/core.pyx":847
   *         def point(angle):
   *             # radial direction pointing out
   *             out = axisX.times(_np.cos(angle)).plus(             #
   * <<<<<<<<<<<<<< axisY.times(_np.sin(angle))) pos = s.plus(out.times(r))
   */
  if (unlikely(!__pyx_cur_scope->__pyx_v_axisX)) {
    __Pyx_RaiseClosureNameError("axisX");
    __PYX_ERR(0, 847, __pyx_L1_error)
  }
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_axisX,
                                        __pyx_n_s_times);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 847, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 847, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_cos);
  if (unlikely(!__pyx_t_6))
    __PYX_ERR(0, 847, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_6, function);
    }
  }
  __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5,
                                                     __pyx_v_angle)
                          : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_angle);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 847, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_6)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  __pyx_t_2 = (__pyx_t_6)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_6, __pyx_t_4)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4);
  __Pyx_XDECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 847, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_plus);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 847, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":848
   *             # radial direction pointing out
   *             out = axisX.times(_np.cos(angle)).plus(
   *                 axisY.times(_np.sin(angle)))             # <<<<<<<<<<<<<<
   *             pos = s.plus(out.times(r))
   *             # normal taking into account the tapering of the cone
   */
  if (unlikely(!__pyx_cur_scope->__pyx_v_axisY)) {
    __Pyx_RaiseClosureNameError("axisY");
    __PYX_ERR(0, 848, __pyx_L1_error)
  }
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_axisY,
                                        __pyx_n_s_times);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 848, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 848, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_sin);
  if (unlikely(!__pyx_t_7))
    __PYX_ERR(0, 848, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_7);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_7, function);
    }
  }
  __pyx_t_6 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_5,
                                                     __pyx_v_angle)
                          : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_v_angle);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_6))
    __PYX_ERR(0, 848, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_7);
  __pyx_t_7 = 0;
  __pyx_t_7 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_7)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_7);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  __pyx_t_2 = (__pyx_t_7)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_7, __pyx_t_6)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __pyx_t_7 = 0;
  __Pyx_DECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 848, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_4)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
  __Pyx_XDECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 847, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_v_out = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":849
   *             out = axisX.times(_np.cos(angle)).plus(
   *                 axisY.times(_np.sin(angle)))
   *             pos = s.plus(out.times(r))             # <<<<<<<<<<<<<<
   *             # normal taking into account the tapering of the cone
   *             normal =
   * out.times(cosTaperAngle).plus(axisZ.times(sinTaperAngle))
   */
  if (unlikely(!__pyx_cur_scope->__pyx_v_s)) {
    __Pyx_RaiseClosureNameError("s");
    __PYX_ERR(0, 849, __pyx_L1_error)
  }
  __pyx_t_3 =
      __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_s, __pyx_n_s_plus);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 849, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_out, __pyx_n_s_times);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 849, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (unlikely(!__pyx_cur_scope->__pyx_v_r)) {
    __Pyx_RaiseClosureNameError("r");
    __PYX_ERR(0, 849, __pyx_L1_error)
  }
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_6)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  __pyx_t_2 =
      (__pyx_t_6)
          ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_6,
                                     __pyx_cur_scope->__pyx_v_r)
          : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_cur_scope->__pyx_v_r);
  __Pyx_XDECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 849, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_4)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
  __Pyx_XDECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 849, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_v_pos = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":851
   *             pos = s.plus(out.times(r))
   *             # normal taking into account the tapering of the cone
   *             normal =
   * out.times(cosTaperAngle).plus(axisZ.times(sinTaperAngle))             #
   * <<<<<<<<<<<<<< return pos, normal
   *
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_out, __pyx_n_s_times);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 851, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (unlikely(!__pyx_cur_scope->__pyx_v_cosTaperAngle)) {
    __Pyx_RaiseClosureNameError("cosTaperAngle");
    __PYX_ERR(0, 851, __pyx_L1_error)
  }
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_3 =
      (__pyx_t_4)
          ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4,
                                     __pyx_cur_scope->__pyx_v_cosTaperAngle)
          : __Pyx_PyObject_CallOneArg(__pyx_t_2,
                                      __pyx_cur_scope->__pyx_v_cosTaperAngle);
  __Pyx_XDECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 851, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_plus);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 851, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_cur_scope->__pyx_v_axisZ)) {
    __Pyx_RaiseClosureNameError("axisZ");
    __PYX_ERR(0, 851, __pyx_L1_error)
  }
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_axisZ,
                                        __pyx_n_s_times);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 851, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (unlikely(!__pyx_cur_scope->__pyx_v_sinTaperAngle)) {
    __Pyx_RaiseClosureNameError("sinTaperAngle");
    __PYX_ERR(0, 851, __pyx_L1_error)
  }
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_6)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  __pyx_t_3 =
      (__pyx_t_6)
          ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_6,
                                     __pyx_cur_scope->__pyx_v_sinTaperAngle)
          : __Pyx_PyObject_CallOneArg(__pyx_t_4,
                                      __pyx_cur_scope->__pyx_v_sinTaperAngle);
  __Pyx_XDECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 851, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_4)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 851, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_normal = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":852
   *             # normal taking into account the tapering of the cone
   *             normal =
   * out.times(cosTaperAngle).plus(axisZ.times(sinTaperAngle)) return pos,
   * normal             # <<<<<<<<<<<<<<
   *
   *         dt = _np.pi * 2.0 / float(slices)
   */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyTuple_New(2);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 852, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_v_pos);
  __Pyx_GIVEREF(__pyx_v_pos);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_pos);
  __Pyx_INCREF(__pyx_v_normal);
  __Pyx_GIVEREF(__pyx_v_normal);
  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_normal);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":845
 *         sinTaperAngle = _np.sin(taperAngle)
 *         cosTaperAngle = _np.cos(taperAngle)
 *         def point(angle):             # <<<<<<<<<<<<<<
 *             # radial direction pointing out
 *             out = axisX.times(_np.cos(angle)).plus(
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.cone.point", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_pos);
  __Pyx_XDECREF(__pyx_v_normal);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":812
 *
 *     @classmethod
 *     def cone(cls, **kwargs):             # <<<<<<<<<<<<<<
 *         """ Returns a cone.
 *
 */

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_54cone(
    CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_cls,
    PyObject *__pyx_v_kwargs) {
  struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone
      *__pyx_cur_scope;
  PyObject *__pyx_v_e = NULL;
  PyObject *__pyx_v_slices = NULL;
  PyObject *__pyx_v_ray = NULL;
  PyObject *__pyx_v_isY = NULL;
  PyObject *__pyx_v_startNormal = NULL;
  PyObject *__pyx_v_start = NULL;
  PyObject *__pyx_v_polygons = NULL;
  PyObject *__pyx_v_taperAngle = NULL;
  PyObject *__pyx_v_point = 0;
  PyObject *__pyx_v_dt = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_t0 = NULL;
  PyObject *__pyx_v_i1 = NULL;
  PyObject *__pyx_v_t1 = NULL;
  PyObject *__pyx_v_p0 = NULL;
  PyObject *__pyx_v_n0 = NULL;
  PyObject *__pyx_v_p1 = NULL;
  PyObject *__pyx_v_n1 = NULL;
  PyObject *__pyx_v_nAvg = NULL;
  PyObject *__pyx_v_polyStart = NULL;
  PyObject *__pyx_v_polySide = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  int __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  int __pyx_t_10;
  PyObject *__pyx_t_11 = NULL;
  Py_ssize_t __pyx_t_12;
  PyObject *(*__pyx_t_13)(PyObject *);
  PyObject *(*__pyx_t_14)(PyObject *);
  PyObject *__pyx_t_15 = NULL;
  int __pyx_t_16;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("cone", 0);
  __pyx_cur_scope =
      (struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone *)
          __pyx_tp_new_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone(
              __pyx_ptype_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone,
              __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((
        struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone *)
                           Py_None);
    __Pyx_INCREF(Py_None);
    __PYX_ERR(0, 812, __pyx_L1_error)
  } else {
    __Pyx_GOTREF(__pyx_cur_scope);
  }

  /* "pyg4ometry/pycsg/core.pyx":824
   *                 slices (int): Number of slices, default 16.
   *         """
   *         s = kwargs.get('start', Vector(0.0, -1.0, 0.0))             #
   * <<<<<<<<<<<<<< e = kwargs.get('end', Vector(0.0, 1.0, 0.0)) if
   * isinstance(s, list):
   */
  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_Vector);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 824, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__17, NULL);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 824, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 =
      __Pyx_PyDict_GetItemDefault(__pyx_v_kwargs, __pyx_n_u_start, __pyx_t_2);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 824, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_cur_scope->__pyx_v_s = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":825
   *         """
   *         s = kwargs.get('start', Vector(0.0, -1.0, 0.0))
   *         e = kwargs.get('end', Vector(0.0, 1.0, 0.0))             #
   * <<<<<<<<<<<<<< if isinstance(s, list): s = Vector(*s)
   */
  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_Vector);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 825, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__18, NULL);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 825, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 =
      __Pyx_PyDict_GetItemDefault(__pyx_v_kwargs, __pyx_n_u_end, __pyx_t_2);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 825, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_e = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":826
   *         s = kwargs.get('start', Vector(0.0, -1.0, 0.0))
   *         e = kwargs.get('end', Vector(0.0, 1.0, 0.0))
   *         if isinstance(s, list):             # <<<<<<<<<<<<<<
   *             s = Vector(*s)
   *         if isinstance(e, list):
   */
  __pyx_t_1 = __pyx_cur_scope->__pyx_v_s;
  __Pyx_INCREF(__pyx_t_1);
  __pyx_t_3 = PyList_Check(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_4 = (__pyx_t_3 != 0);
  if (__pyx_t_4) {

    /* "pyg4ometry/pycsg/core.pyx":827
     *         e = kwargs.get('end', Vector(0.0, 1.0, 0.0))
     *         if isinstance(s, list):
     *             s = Vector(*s)             # <<<<<<<<<<<<<<
     *         if isinstance(e, list):
     *             e = Vector(*e)
     */
    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_Vector);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 827, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = __Pyx_PySequence_Tuple(__pyx_cur_scope->__pyx_v_s);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 827, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, NULL);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 827, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_2);
    __pyx_t_2 = 0;
    __Pyx_GOTREF(__pyx_cur_scope->__pyx_v_s);
    __Pyx_DECREF_SET(__pyx_cur_scope->__pyx_v_s, __pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_5);
    __pyx_t_5 = 0;

    /* "pyg4ometry/pycsg/core.pyx":826
     *         s = kwargs.get('start', Vector(0.0, -1.0, 0.0))
     *         e = kwargs.get('end', Vector(0.0, 1.0, 0.0))
     *         if isinstance(s, list):             # <<<<<<<<<<<<<<
     *             s = Vector(*s)
     *         if isinstance(e, list):
     */
  }

  /* "pyg4ometry/pycsg/core.pyx":828
   *         if isinstance(s, list):
   *             s = Vector(*s)
   *         if isinstance(e, list):             # <<<<<<<<<<<<<<
   *             e = Vector(*e)
   *         r = kwargs.get('radius', 1.0)
   */
  __pyx_t_4 = PyList_Check(__pyx_v_e);
  __pyx_t_3 = (__pyx_t_4 != 0);
  if (__pyx_t_3) {

    /* "pyg4ometry/pycsg/core.pyx":829
     *             s = Vector(*s)
     *         if isinstance(e, list):
     *             e = Vector(*e)             # <<<<<<<<<<<<<<
     *         r = kwargs.get('radius', 1.0)
     *         slices = kwargs.get('slices', 16)
     */
    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_Vector);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 829, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_2 = __Pyx_PySequence_Tuple(__pyx_v_e);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 829, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_2, NULL);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 829, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_5);
    __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_t_2);
    __pyx_t_2 = 0;
    __Pyx_DECREF_SET(__pyx_v_e, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "pyg4ometry/pycsg/core.pyx":828
     *         if isinstance(s, list):
     *             s = Vector(*s)
     *         if isinstance(e, list):             # <<<<<<<<<<<<<<
     *             e = Vector(*e)
     *         r = kwargs.get('radius', 1.0)
     */
  }

  /* "pyg4ometry/pycsg/core.pyx":830
   *         if isinstance(e, list):
   *             e = Vector(*e)
   *         r = kwargs.get('radius', 1.0)             # <<<<<<<<<<<<<<
   *         slices = kwargs.get('slices', 16)
   *         ray = e.minus(s)
   */
  __pyx_t_1 = __Pyx_PyDict_GetItemDefault(__pyx_v_kwargs, __pyx_n_u_radius,
                                          __pyx_float_1_0);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 830, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_cur_scope->__pyx_v_r = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":831
   *             e = Vector(*e)
   *         r = kwargs.get('radius', 1.0)
   *         slices = kwargs.get('slices', 16)             # <<<<<<<<<<<<<<
   *         ray = e.minus(s)
   *
   */
  __pyx_t_1 = __Pyx_PyDict_GetItemDefault(__pyx_v_kwargs, __pyx_n_u_slices,
                                          __pyx_int_16);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 831, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_slices = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":832
   *         r = kwargs.get('radius', 1.0)
   *         slices = kwargs.get('slices', 16)
   *         ray = e.minus(s)             # <<<<<<<<<<<<<<
   *
   *         axisZ = ray.unit()
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_e, __pyx_n_s_minus);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 832, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 =
      (__pyx_t_5)
          ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_5,
                                     __pyx_cur_scope->__pyx_v_s)
          : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_cur_scope->__pyx_v_s);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 832, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_ray = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":834
   *         ray = e.minus(s)
   *
   *         axisZ = ray.unit()             # <<<<<<<<<<<<<<
   *         isY = (_np.fabs(axisZ.y) > 0.5)
   *         axisX = Vector(float(isY), float(not isY), 0).cross(axisZ).unit()
   */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_ray, __pyx_n_s_unit);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 834, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_5)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 834, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_cur_scope->__pyx_v_axisZ = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":835
   *
   *         axisZ = ray.unit()
   *         isY = (_np.fabs(axisZ.y) > 0.5)             # <<<<<<<<<<<<<<
   *         axisX = Vector(float(isY), float(not isY), 0).cross(axisZ).unit()
   *         axisY = axisX.cross(axisZ).unit()
   */
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 835, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_fabs);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 835, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 =
      __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_axisZ, __pyx_n_s_y);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 835, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
    if (likely(__pyx_t_6)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_5, function);
    }
  }
  __pyx_t_1 = (__pyx_t_6)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
  __Pyx_XDECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 835, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyObject_RichCompare(__pyx_t_1, __pyx_float_0_5, Py_GT);
  __Pyx_XGOTREF(__pyx_t_5);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 835, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_v_isY = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "pyg4ometry/pycsg/core.pyx":836
   *         axisZ = ray.unit()
   *         isY = (_np.fabs(axisZ.y) > 0.5)
   *         axisX = Vector(float(isY), float(not isY), 0).cross(axisZ).unit()
   * # <<<<<<<<<<<<<< axisY = axisX.cross(axisZ).unit() startNormal =
   * axisZ.negated()
   */
  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_Vector);
  if (unlikely(!__pyx_t_6))
    __PYX_ERR(0, 836, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_7 = __Pyx_PyNumber_Float(__pyx_v_isY);
  if (unlikely(!__pyx_t_7))
    __PYX_ERR(0, 836, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_isY);
  if (unlikely(__pyx_t_3 < 0))
    __PYX_ERR(0, 836, __pyx_L1_error)
  __pyx_t_8 = PyFloat_FromDouble(((double)(!__pyx_t_3)));
  if (unlikely(!__pyx_t_8))
    __PYX_ERR(0, 836, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_8);
  __pyx_t_9 = NULL;
  __pyx_t_10 = 0;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
    __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_6);
    if (likely(__pyx_t_9)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_9);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_6, function);
      __pyx_t_10 = 1;
    }
  }
#if CYTHON_FAST_PYCALL
  if (PyFunction_Check(__pyx_t_6)) {
    PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_t_7, __pyx_t_8, __pyx_int_0};
    __pyx_t_2 = __Pyx_PyFunction_FastCall(
        __pyx_t_6, __pyx_temp + 1 - __pyx_t_10, 3 + __pyx_t_10);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 836, __pyx_L1_error)
    __Pyx_XDECREF(__pyx_t_9);
    __pyx_t_9 = 0;
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_7);
    __pyx_t_7 = 0;
    __Pyx_DECREF(__pyx_t_8);
    __pyx_t_8 = 0;
  } else
#endif
#if CYTHON_FAST_PYCCALL
      if (__Pyx_PyFastCFunction_Check(__pyx_t_6)) {
    PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_t_7, __pyx_t_8, __pyx_int_0};
    __pyx_t_2 = __Pyx_PyCFunction_FastCall(
        __pyx_t_6, __pyx_temp + 1 - __pyx_t_10, 3 + __pyx_t_10);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 836, __pyx_L1_error)
    __Pyx_XDECREF(__pyx_t_9);
    __pyx_t_9 = 0;
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_7);
    __pyx_t_7 = 0;
    __Pyx_DECREF(__pyx_t_8);
    __pyx_t_8 = 0;
  } else
#endif
  {
    __pyx_t_11 = PyTuple_New(3 + __pyx_t_10);
    if (unlikely(!__pyx_t_11))
      __PYX_ERR(0, 836, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    if (__pyx_t_9) {
      __Pyx_GIVEREF(__pyx_t_9);
      PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_9);
      __pyx_t_9 = NULL;
    }
    __Pyx_GIVEREF(__pyx_t_7);
    PyTuple_SET_ITEM(__pyx_t_11, 0 + __pyx_t_10, __pyx_t_7);
    __Pyx_GIVEREF(__pyx_t_8);
    PyTuple_SET_ITEM(__pyx_t_11, 1 + __pyx_t_10, __pyx_t_8);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyTuple_SET_ITEM(__pyx_t_11, 2 + __pyx_t_10, __pyx_int_0);
    __pyx_t_7 = 0;
    __pyx_t_8 = 0;
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_11, NULL);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 836, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_11);
    __pyx_t_11 = 0;
  }
  __Pyx_DECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_cross);
  if (unlikely(!__pyx_t_6))
    __PYX_ERR(0, 836, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_6);
    if (likely(__pyx_t_2)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_6, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_2,
                                             __pyx_cur_scope->__pyx_v_axisZ)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_6,
                                              __pyx_cur_scope->__pyx_v_axisZ);
  __Pyx_XDECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 836, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_unit);
  if (unlikely(!__pyx_t_6))
    __PYX_ERR(0, 836, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_6);
    if (likely(__pyx_t_1)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_6, function);
    }
  }
  __pyx_t_5 = (__pyx_t_1) ? __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_1)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 836, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  __Pyx_GIVEREF(__pyx_t_5);
  __pyx_cur_scope->__pyx_v_axisX = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "pyg4ometry/pycsg/core.pyx":837
   *         isY = (_np.fabs(axisZ.y) > 0.5)
   *         axisX = Vector(float(isY), float(not isY), 0).cross(axisZ).unit()
   *         axisY = axisX.cross(axisZ).unit()             # <<<<<<<<<<<<<<
   *         startNormal = axisZ.negated()
   *         start = Vertex(s, startNormal)
   */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_axisX,
                                        __pyx_n_s_cross);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 837, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
    }
  }
  __pyx_t_6 = (__pyx_t_2)
                  ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_2,
                                             __pyx_cur_scope->__pyx_v_axisZ)
                  : __Pyx_PyObject_CallOneArg(__pyx_t_1,
                                              __pyx_cur_scope->__pyx_v_axisZ);
  __Pyx_XDECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_6))
    __PYX_ERR(0, 837, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_unit);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 837, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_6)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
    }
  }
  __pyx_t_5 = (__pyx_t_6) ? __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_6)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 837, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __Pyx_GIVEREF(__pyx_t_5);
  __pyx_cur_scope->__pyx_v_axisY = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "pyg4ometry/pycsg/core.pyx":838
   *         axisX = Vector(float(isY), float(not isY), 0).cross(axisZ).unit()
   *         axisY = axisX.cross(axisZ).unit()
   *         startNormal = axisZ.negated()             # <<<<<<<<<<<<<<
   *         start = Vertex(s, startNormal)
   *         polygons = []
   */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_axisZ,
                                        __pyx_n_s_negated);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 838, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_6)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
    }
  }
  __pyx_t_5 = (__pyx_t_6) ? __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_6)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 838, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_v_startNormal = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "pyg4ometry/pycsg/core.pyx":839
   *         axisY = axisX.cross(axisZ).unit()
   *         startNormal = axisZ.negated()
   *         start = Vertex(s, startNormal)             # <<<<<<<<<<<<<<
   *         polygons = []
   *
   */
  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_Vertex);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 839, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = NULL;
  __pyx_t_10 = 0;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_6)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
      __pyx_t_10 = 1;
    }
  }
#if CYTHON_FAST_PYCALL
  if (PyFunction_Check(__pyx_t_1)) {
    PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_cur_scope->__pyx_v_s,
                               __pyx_v_startNormal};
    __pyx_t_5 = __Pyx_PyFunction_FastCall(
        __pyx_t_1, __pyx_temp + 1 - __pyx_t_10, 2 + __pyx_t_10);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 839, __pyx_L1_error)
    __Pyx_XDECREF(__pyx_t_6);
    __pyx_t_6 = 0;
    __Pyx_GOTREF(__pyx_t_5);
  } else
#endif
#if CYTHON_FAST_PYCCALL
      if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
    PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_cur_scope->__pyx_v_s,
                               __pyx_v_startNormal};
    __pyx_t_5 = __Pyx_PyCFunction_FastCall(
        __pyx_t_1, __pyx_temp + 1 - __pyx_t_10, 2 + __pyx_t_10);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 839, __pyx_L1_error)
    __Pyx_XDECREF(__pyx_t_6);
    __pyx_t_6 = 0;
    __Pyx_GOTREF(__pyx_t_5);
  } else
#endif
  {
    __pyx_t_2 = PyTuple_New(2 + __pyx_t_10);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 839, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    if (__pyx_t_6) {
      __Pyx_GIVEREF(__pyx_t_6);
      PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_6);
      __pyx_t_6 = NULL;
    }
    __Pyx_INCREF(__pyx_cur_scope->__pyx_v_s);
    __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_s);
    PyTuple_SET_ITEM(__pyx_t_2, 0 + __pyx_t_10, __pyx_cur_scope->__pyx_v_s);
    __Pyx_INCREF(__pyx_v_startNormal);
    __Pyx_GIVEREF(__pyx_v_startNormal);
    PyTuple_SET_ITEM(__pyx_t_2, 1 + __pyx_t_10, __pyx_v_startNormal);
    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, NULL);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 839, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_2);
    __pyx_t_2 = 0;
  }
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_v_start = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "pyg4ometry/pycsg/core.pyx":840
   *         startNormal = axisZ.negated()
   *         start = Vertex(s, startNormal)
   *         polygons = []             # <<<<<<<<<<<<<<
   *
   *         taperAngle = _np.atan2(r, ray.length())
   */
  __pyx_t_5 = PyList_New(0);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 840, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_v_polygons = ((PyObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "pyg4ometry/pycsg/core.pyx":842
   *         polygons = []
   *
   *         taperAngle = _np.atan2(r, ray.length())             #
   * <<<<<<<<<<<<<< sinTaperAngle = _np.sin(taperAngle) cosTaperAngle =
   * _np.cos(taperAngle)
   */
  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 842, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_atan2);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 842, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_ray, __pyx_n_s_length);
  if (unlikely(!__pyx_t_6))
    __PYX_ERR(0, 842, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_11 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
    __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_6);
    if (likely(__pyx_t_11)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_11);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_6, function);
    }
  }
  __pyx_t_1 = (__pyx_t_11) ? __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_11)
                           : __Pyx_PyObject_CallNoArg(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_11);
  __pyx_t_11 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 842, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  __pyx_t_10 = 0;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_6)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_10 = 1;
    }
  }
#if CYTHON_FAST_PYCALL
  if (PyFunction_Check(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_cur_scope->__pyx_v_r,
                               __pyx_t_1};
    __pyx_t_5 = __Pyx_PyFunction_FastCall(
        __pyx_t_2, __pyx_temp + 1 - __pyx_t_10, 2 + __pyx_t_10);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 842, __pyx_L1_error)
    __Pyx_XDECREF(__pyx_t_6);
    __pyx_t_6 = 0;
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
  } else
#endif
#if CYTHON_FAST_PYCCALL
      if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_cur_scope->__pyx_v_r,
                               __pyx_t_1};
    __pyx_t_5 = __Pyx_PyCFunction_FastCall(
        __pyx_t_2, __pyx_temp + 1 - __pyx_t_10, 2 + __pyx_t_10);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 842, __pyx_L1_error)
    __Pyx_XDECREF(__pyx_t_6);
    __pyx_t_6 = 0;
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
  } else
#endif
  {
    __pyx_t_11 = PyTuple_New(2 + __pyx_t_10);
    if (unlikely(!__pyx_t_11))
      __PYX_ERR(0, 842, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    if (__pyx_t_6) {
      __Pyx_GIVEREF(__pyx_t_6);
      PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_6);
      __pyx_t_6 = NULL;
    }
    __Pyx_INCREF(__pyx_cur_scope->__pyx_v_r);
    __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_r);
    PyTuple_SET_ITEM(__pyx_t_11, 0 + __pyx_t_10, __pyx_cur_scope->__pyx_v_r);
    __Pyx_GIVEREF(__pyx_t_1);
    PyTuple_SET_ITEM(__pyx_t_11, 1 + __pyx_t_10, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_11, NULL);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 842, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_11);
    __pyx_t_11 = 0;
  }
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_taperAngle = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "pyg4ometry/pycsg/core.pyx":843
   *
   *         taperAngle = _np.atan2(r, ray.length())
   *         sinTaperAngle = _np.sin(taperAngle)             # <<<<<<<<<<<<<<
   *         cosTaperAngle = _np.cos(taperAngle)
   *         def point(angle):
   */
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 843, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_sin);
  if (unlikely(!__pyx_t_11))
    __PYX_ERR(0, 843, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_11);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_11);
    if (likely(__pyx_t_2)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_11);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_11, function);
    }
  }
  __pyx_t_5 =
      (__pyx_t_2)
          ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_2, __pyx_v_taperAngle)
          : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_v_taperAngle);
  __Pyx_XDECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 843, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_11);
  __pyx_t_11 = 0;
  __Pyx_GIVEREF(__pyx_t_5);
  __pyx_cur_scope->__pyx_v_sinTaperAngle = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "pyg4ometry/pycsg/core.pyx":844
   *         taperAngle = _np.atan2(r, ray.length())
   *         sinTaperAngle = _np.sin(taperAngle)
   *         cosTaperAngle = _np.cos(taperAngle)             # <<<<<<<<<<<<<<
   *         def point(angle):
   *             # radial direction pointing out
   */
  __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np);
  if (unlikely(!__pyx_t_11))
    __PYX_ERR(0, 844, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_11);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_cos);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 844, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_11);
  __pyx_t_11 = 0;
  __pyx_t_11 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_11)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_11);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  __pyx_t_5 =
      (__pyx_t_11)
          ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_11, __pyx_v_taperAngle)
          : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_taperAngle);
  __Pyx_XDECREF(__pyx_t_11);
  __pyx_t_11 = 0;
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 844, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_GIVEREF(__pyx_t_5);
  __pyx_cur_scope->__pyx_v_cosTaperAngle = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "pyg4ometry/pycsg/core.pyx":845
   *         sinTaperAngle = _np.sin(taperAngle)
   *         cosTaperAngle = _np.cos(taperAngle)
   *         def point(angle):             # <<<<<<<<<<<<<<
   *             # radial direction pointing out
   *             out = axisX.times(_np.cos(angle)).plus(
   */
  __pyx_t_5 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_4cone_1point, 0,
      __pyx_n_s_CSG_cone_locals_point, ((PyObject *)__pyx_cur_scope),
      __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
      ((PyObject *)__pyx_codeobj__22));
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 845, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_v_point = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "pyg4ometry/pycsg/core.pyx":854
   *             return pos, normal
   *
   *         dt = _np.pi * 2.0 / float(slices)             # <<<<<<<<<<<<<<
   *         for i in range(0, slices):
   *             t0 = i * dt
   */
  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 854, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_pi);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 854, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyNumber_Multiply(__pyx_t_2, __pyx_float_2_0);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 854, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyNumber_Float(__pyx_v_slices);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 854, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_11 = __Pyx_PyNumber_Divide(__pyx_t_5, __pyx_t_2);
  if (unlikely(!__pyx_t_11))
    __PYX_ERR(0, 854, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_11);
  __Pyx_DECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_dt = __pyx_t_11;
  __pyx_t_11 = 0;

  /* "pyg4ometry/pycsg/core.pyx":855
   *
   *         dt = _np.pi * 2.0 / float(slices)
   *         for i in range(0, slices):             # <<<<<<<<<<<<<<
   *             t0 = i * dt
   *             i1 = (i + 1) % slices
   */
  __pyx_t_11 = PyTuple_New(2);
  if (unlikely(!__pyx_t_11))
    __PYX_ERR(0, 855, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_11);
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_int_0);
  __Pyx_INCREF(__pyx_v_slices);
  __Pyx_GIVEREF(__pyx_v_slices);
  PyTuple_SET_ITEM(__pyx_t_11, 1, __pyx_v_slices);
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_11, NULL);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 855, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_11);
  __pyx_t_11 = 0;
  if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
    __pyx_t_11 = __pyx_t_2;
    __Pyx_INCREF(__pyx_t_11);
    __pyx_t_12 = 0;
    __pyx_t_13 = NULL;
  } else {
    __pyx_t_12 = -1;
    __pyx_t_11 = PyObject_GetIter(__pyx_t_2);
    if (unlikely(!__pyx_t_11))
      __PYX_ERR(0, 855, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __pyx_t_13 = Py_TYPE(__pyx_t_11)->tp_iternext;
    if (unlikely(!__pyx_t_13))
      __PYX_ERR(0, 855, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  for (;;) {
    if (likely(!__pyx_t_13)) {
      if (likely(PyList_CheckExact(__pyx_t_11))) {
        if (__pyx_t_12 >= PyList_GET_SIZE(__pyx_t_11))
          break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_11, __pyx_t_12);
        __Pyx_INCREF(__pyx_t_2);
        __pyx_t_12++;
        if (unlikely(0 < 0))
          __PYX_ERR(0, 855, __pyx_L1_error)
#else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_11, __pyx_t_12);
        __pyx_t_12++;
        if (unlikely(!__pyx_t_2))
          __PYX_ERR(0, 855, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
#endif
      } else {
        if (__pyx_t_12 >= PyTuple_GET_SIZE(__pyx_t_11))
          break;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_11, __pyx_t_12);
        __Pyx_INCREF(__pyx_t_2);
        __pyx_t_12++;
        if (unlikely(0 < 0))
          __PYX_ERR(0, 855, __pyx_L1_error)
#else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_11, __pyx_t_12);
        __pyx_t_12++;
        if (unlikely(!__pyx_t_2))
          __PYX_ERR(0, 855, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
#endif
      }
    } else {
      __pyx_t_2 = __pyx_t_13(__pyx_t_11);
      if (unlikely(!__pyx_t_2)) {
        PyObject *exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type,
                                                       PyExc_StopIteration)))
            PyErr_Clear();
          else
            __PYX_ERR(0, 855, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "pyg4ometry/pycsg/core.pyx":856
     *         dt = _np.pi * 2.0 / float(slices)
     *         for i in range(0, slices):
     *             t0 = i * dt             # <<<<<<<<<<<<<<
     *             i1 = (i + 1) % slices
     *             t1 = i1 * dt
     */
    __pyx_t_2 = PyNumber_Multiply(__pyx_v_i, __pyx_v_dt);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 856, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_XDECREF_SET(__pyx_v_t0, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "pyg4ometry/pycsg/core.pyx":857
     *         for i in range(0, slices):
     *             t0 = i * dt
     *             i1 = (i + 1) % slices             # <<<<<<<<<<<<<<
     *             t1 = i1 * dt
     *             # coordinates and associated normal pointing outwards of the
     * cone's
     */
    __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_1, 1, 0, 0);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 857, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_5 = PyNumber_Remainder(__pyx_t_2, __pyx_v_slices);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 857, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_2);
    __pyx_t_2 = 0;
    __Pyx_XDECREF_SET(__pyx_v_i1, __pyx_t_5);
    __pyx_t_5 = 0;

    /* "pyg4ometry/pycsg/core.pyx":858
     *             t0 = i * dt
     *             i1 = (i + 1) % slices
     *             t1 = i1 * dt             # <<<<<<<<<<<<<<
     *             # coordinates and associated normal pointing outwards of the
     * cone's # side
     */
    __pyx_t_5 = PyNumber_Multiply(__pyx_v_i1, __pyx_v_dt);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 858, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_XDECREF_SET(__pyx_v_t1, __pyx_t_5);
    __pyx_t_5 = 0;

    /* "pyg4ometry/pycsg/core.pyx":861
     *             # coordinates and associated normal pointing outwards of the
     * cone's # side p0, n0 = point(t0)             # <<<<<<<<<<<<<< p1, n1 =
     * point(t1) # average normal for the tip
     */
    __pyx_t_5 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_4cone_point(
        __pyx_v_point, __pyx_v_t0);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 861, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    if ((likely(PyTuple_CheckExact(__pyx_t_5))) ||
        (PyList_CheckExact(__pyx_t_5))) {
      PyObject *sequence = __pyx_t_5;
      Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
      if (unlikely(size != 2)) {
        if (size > 2)
          __Pyx_RaiseTooManyValuesError(2);
        else if (size >= 0)
          __Pyx_RaiseNeedMoreValuesError(size);
        __PYX_ERR(0, 861, __pyx_L1_error)
      }
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
      if (likely(PyTuple_CheckExact(sequence))) {
        __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0);
        __pyx_t_1 = PyTuple_GET_ITEM(sequence, 1);
      } else {
        __pyx_t_2 = PyList_GET_ITEM(sequence, 0);
        __pyx_t_1 = PyList_GET_ITEM(sequence, 1);
      }
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_1);
#else
      __pyx_t_2 = PySequence_ITEM(sequence, 0);
      if (unlikely(!__pyx_t_2))
        __PYX_ERR(0, 861, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_1 = PySequence_ITEM(sequence, 1);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 861, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
#endif
      __Pyx_DECREF(__pyx_t_5);
      __pyx_t_5 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_6 = PyObject_GetIter(__pyx_t_5);
      if (unlikely(!__pyx_t_6))
        __PYX_ERR(0, 861, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_5);
      __pyx_t_5 = 0;
      __pyx_t_14 = Py_TYPE(__pyx_t_6)->tp_iternext;
      index = 0;
      __pyx_t_2 = __pyx_t_14(__pyx_t_6);
      if (unlikely(!__pyx_t_2))
        goto __pyx_L7_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_2);
      index = 1;
      __pyx_t_1 = __pyx_t_14(__pyx_t_6);
      if (unlikely(!__pyx_t_1))
        goto __pyx_L7_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_1);
      if (__Pyx_IternextUnpackEndCheck(__pyx_t_14(__pyx_t_6), 2) < 0)
        __PYX_ERR(0, 861, __pyx_L1_error)
      __pyx_t_14 = NULL;
      __Pyx_DECREF(__pyx_t_6);
      __pyx_t_6 = 0;
      goto __pyx_L8_unpacking_done;
    __pyx_L7_unpacking_failed:;
      __Pyx_DECREF(__pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_14 = NULL;
      if (__Pyx_IterFinish() == 0)
        __Pyx_RaiseNeedMoreValuesError(index);
      __PYX_ERR(0, 861, __pyx_L1_error)
    __pyx_L8_unpacking_done:;
    }
    __Pyx_XDECREF_SET(__pyx_v_p0, __pyx_t_2);
    __pyx_t_2 = 0;
    __Pyx_XDECREF_SET(__pyx_v_n0, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "pyg4ometry/pycsg/core.pyx":862
     *             # side
     *             p0, n0 = point(t0)
     *             p1, n1 = point(t1)             # <<<<<<<<<<<<<<
     *             # average normal for the tip
     *             nAvg = n0.plus(n1).times(0.5)
     */
    __pyx_t_5 = __pyx_pf_10pyg4ometry_5pycsg_4core_3CSG_4cone_point(
        __pyx_v_point, __pyx_v_t1);
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 862, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    if ((likely(PyTuple_CheckExact(__pyx_t_5))) ||
        (PyList_CheckExact(__pyx_t_5))) {
      PyObject *sequence = __pyx_t_5;
      Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
      if (unlikely(size != 2)) {
        if (size > 2)
          __Pyx_RaiseTooManyValuesError(2);
        else if (size >= 0)
          __Pyx_RaiseNeedMoreValuesError(size);
        __PYX_ERR(0, 862, __pyx_L1_error)
      }
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
      if (likely(PyTuple_CheckExact(sequence))) {
        __pyx_t_1 = PyTuple_GET_ITEM(sequence, 0);
        __pyx_t_2 = PyTuple_GET_ITEM(sequence, 1);
      } else {
        __pyx_t_1 = PyList_GET_ITEM(sequence, 0);
        __pyx_t_2 = PyList_GET_ITEM(sequence, 1);
      }
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_2);
#else
      __pyx_t_1 = PySequence_ITEM(sequence, 0);
      if (unlikely(!__pyx_t_1))
        __PYX_ERR(0, 862, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_2 = PySequence_ITEM(sequence, 1);
      if (unlikely(!__pyx_t_2))
        __PYX_ERR(0, 862, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
#endif
      __Pyx_DECREF(__pyx_t_5);
      __pyx_t_5 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_6 = PyObject_GetIter(__pyx_t_5);
      if (unlikely(!__pyx_t_6))
        __PYX_ERR(0, 862, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_5);
      __pyx_t_5 = 0;
      __pyx_t_14 = Py_TYPE(__pyx_t_6)->tp_iternext;
      index = 0;
      __pyx_t_1 = __pyx_t_14(__pyx_t_6);
      if (unlikely(!__pyx_t_1))
        goto __pyx_L9_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_1);
      index = 1;
      __pyx_t_2 = __pyx_t_14(__pyx_t_6);
      if (unlikely(!__pyx_t_2))
        goto __pyx_L9_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_2);
      if (__Pyx_IternextUnpackEndCheck(__pyx_t_14(__pyx_t_6), 2) < 0)
        __PYX_ERR(0, 862, __pyx_L1_error)
      __pyx_t_14 = NULL;
      __Pyx_DECREF(__pyx_t_6);
      __pyx_t_6 = 0;
      goto __pyx_L10_unpacking_done;
    __pyx_L9_unpacking_failed:;
      __Pyx_DECREF(__pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_14 = NULL;
      if (__Pyx_IterFinish() == 0)
        __Pyx_RaiseNeedMoreValuesError(index);
      __PYX_ERR(0, 862, __pyx_L1_error)
    __pyx_L10_unpacking_done:;
    }
    __Pyx_XDECREF_SET(__pyx_v_p1, __pyx_t_1);
    __pyx_t_1 = 0;
    __Pyx_XDECREF_SET(__pyx_v_n1, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "pyg4ometry/pycsg/core.pyx":864
     *             p1, n1 = point(t1)
     *             # average normal for the tip
     *             nAvg = n0.plus(n1).times(0.5)             # <<<<<<<<<<<<<<
     *             # polygon on the low side (disk sector)
     *             polyStart = Polygon([start.clone(),
     */
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_n0, __pyx_n_s_plus);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 864, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_6 = NULL;
    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
      if (likely(__pyx_t_6)) {
        PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_1);
        __Pyx_INCREF(__pyx_t_6);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_1, function);
      }
    }
    __pyx_t_2 = (__pyx_t_6)
                    ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_6, __pyx_v_n1)
                    : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_n1);
    __Pyx_XDECREF(__pyx_t_6);
    __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 864, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_times);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 864, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
      if (likely(__pyx_t_2)) {
        PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_1);
        __Pyx_INCREF(__pyx_t_2);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_1, function);
      }
    }
    __pyx_t_5 =
        (__pyx_t_2)
            ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_2, __pyx_float_0_5)
            : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_float_0_5);
    __Pyx_XDECREF(__pyx_t_2);
    __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 864, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __Pyx_XDECREF_SET(__pyx_v_nAvg, __pyx_t_5);
    __pyx_t_5 = 0;

    /* "pyg4ometry/pycsg/core.pyx":866
     *             nAvg = n0.plus(n1).times(0.5)
     *             # polygon on the low side (disk sector)
     *             polyStart = Polygon([start.clone(),             #
     * <<<<<<<<<<<<<< Vertex(p0, startNormal), Vertex(p1, startNormal)])
     */
    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_Polygon);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 866, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_start, __pyx_n_s_clone);
    if (unlikely(!__pyx_t_6))
      __PYX_ERR(0, 866, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_8 = NULL;
    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
      __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_6);
      if (likely(__pyx_t_8)) {
        PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_6);
        __Pyx_INCREF(__pyx_t_8);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_6, function);
      }
    }
    __pyx_t_2 = (__pyx_t_8) ? __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_8)
                            : __Pyx_PyObject_CallNoArg(__pyx_t_6);
    __Pyx_XDECREF(__pyx_t_8);
    __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 866, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_6);
    __pyx_t_6 = 0;

    /* "pyg4ometry/pycsg/core.pyx":867
     *             # polygon on the low side (disk sector)
     *             polyStart = Polygon([start.clone(),
     *                                  Vertex(p0, startNormal),             #
     * <<<<<<<<<<<<<< Vertex(p1, startNormal)]) polygons.append(polyStart)
     */
    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_Vertex);
    if (unlikely(!__pyx_t_8))
      __PYX_ERR(0, 867, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __pyx_t_7 = NULL;
    __pyx_t_10 = 0;
    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_8);
      if (likely(__pyx_t_7)) {
        PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_8);
        __Pyx_INCREF(__pyx_t_7);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_8, function);
        __pyx_t_10 = 1;
      }
    }
#if CYTHON_FAST_PYCALL
    if (PyFunction_Check(__pyx_t_8)) {
      PyObject *__pyx_temp[3] = {__pyx_t_7, __pyx_v_p0, __pyx_v_startNormal};
      __pyx_t_6 = __Pyx_PyFunction_FastCall(
          __pyx_t_8, __pyx_temp + 1 - __pyx_t_10, 2 + __pyx_t_10);
      if (unlikely(!__pyx_t_6))
        __PYX_ERR(0, 867, __pyx_L1_error)
      __Pyx_XDECREF(__pyx_t_7);
      __pyx_t_7 = 0;
      __Pyx_GOTREF(__pyx_t_6);
    } else
#endif
#if CYTHON_FAST_PYCCALL
        if (__Pyx_PyFastCFunction_Check(__pyx_t_8)) {
      PyObject *__pyx_temp[3] = {__pyx_t_7, __pyx_v_p0, __pyx_v_startNormal};
      __pyx_t_6 = __Pyx_PyCFunction_FastCall(
          __pyx_t_8, __pyx_temp + 1 - __pyx_t_10, 2 + __pyx_t_10);
      if (unlikely(!__pyx_t_6))
        __PYX_ERR(0, 867, __pyx_L1_error)
      __Pyx_XDECREF(__pyx_t_7);
      __pyx_t_7 = 0;
      __Pyx_GOTREF(__pyx_t_6);
    } else
#endif
    {
      __pyx_t_9 = PyTuple_New(2 + __pyx_t_10);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 867, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      if (__pyx_t_7) {
        __Pyx_GIVEREF(__pyx_t_7);
        PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_7);
        __pyx_t_7 = NULL;
      }
      __Pyx_INCREF(__pyx_v_p0);
      __Pyx_GIVEREF(__pyx_v_p0);
      PyTuple_SET_ITEM(__pyx_t_9, 0 + __pyx_t_10, __pyx_v_p0);
      __Pyx_INCREF(__pyx_v_startNormal);
      __Pyx_GIVEREF(__pyx_v_startNormal);
      PyTuple_SET_ITEM(__pyx_t_9, 1 + __pyx_t_10, __pyx_v_startNormal);
      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_9, NULL);
      if (unlikely(!__pyx_t_6))
        __PYX_ERR(0, 867, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_9);
      __pyx_t_9 = 0;
    }
    __Pyx_DECREF(__pyx_t_8);
    __pyx_t_8 = 0;

    /* "pyg4ometry/pycsg/core.pyx":868
     *             polyStart = Polygon([start.clone(),
     *                                  Vertex(p0, startNormal),
     *                                  Vertex(p1, startNormal)])             #
     * <<<<<<<<<<<<<< polygons.append(polyStart) # polygon extending from the
     * low side to the tip
     */
    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_Vertex);
    if (unlikely(!__pyx_t_9))
      __PYX_ERR(0, 868, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __pyx_t_7 = NULL;
    __pyx_t_10 = 0;
    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_9);
      if (likely(__pyx_t_7)) {
        PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_9);
        __Pyx_INCREF(__pyx_t_7);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_9, function);
        __pyx_t_10 = 1;
      }
    }
#if CYTHON_FAST_PYCALL
    if (PyFunction_Check(__pyx_t_9)) {
      PyObject *__pyx_temp[3] = {__pyx_t_7, __pyx_v_p1, __pyx_v_startNormal};
      __pyx_t_8 = __Pyx_PyFunction_FastCall(
          __pyx_t_9, __pyx_temp + 1 - __pyx_t_10, 2 + __pyx_t_10);
      if (unlikely(!__pyx_t_8))
        __PYX_ERR(0, 868, __pyx_L1_error)
      __Pyx_XDECREF(__pyx_t_7);
      __pyx_t_7 = 0;
      __Pyx_GOTREF(__pyx_t_8);
    } else
#endif
#if CYTHON_FAST_PYCCALL
        if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
      PyObject *__pyx_temp[3] = {__pyx_t_7, __pyx_v_p1, __pyx_v_startNormal};
      __pyx_t_8 = __Pyx_PyCFunction_FastCall(
          __pyx_t_9, __pyx_temp + 1 - __pyx_t_10, 2 + __pyx_t_10);
      if (unlikely(!__pyx_t_8))
        __PYX_ERR(0, 868, __pyx_L1_error)
      __Pyx_XDECREF(__pyx_t_7);
      __pyx_t_7 = 0;
      __Pyx_GOTREF(__pyx_t_8);
    } else
#endif
    {
      __pyx_t_15 = PyTuple_New(2 + __pyx_t_10);
      if (unlikely(!__pyx_t_15))
        __PYX_ERR(0, 868, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_15);
      if (__pyx_t_7) {
        __Pyx_GIVEREF(__pyx_t_7);
        PyTuple_SET_ITEM(__pyx_t_15, 0, __pyx_t_7);
        __pyx_t_7 = NULL;
      }
      __Pyx_INCREF(__pyx_v_p1);
      __Pyx_GIVEREF(__pyx_v_p1);
      PyTuple_SET_ITEM(__pyx_t_15, 0 + __pyx_t_10, __pyx_v_p1);
      __Pyx_INCREF(__pyx_v_startNormal);
      __Pyx_GIVEREF(__pyx_v_startNormal);
      PyTuple_SET_ITEM(__pyx_t_15, 1 + __pyx_t_10, __pyx_v_startNormal);
      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_15, NULL);
      if (unlikely(!__pyx_t_8))
        __PYX_ERR(0, 868, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_15);
      __pyx_t_15 = 0;
    }
    __Pyx_DECREF(__pyx_t_9);
    __pyx_t_9 = 0;

    /* "pyg4ometry/pycsg/core.pyx":866
     *             nAvg = n0.plus(n1).times(0.5)
     *             # polygon on the low side (disk sector)
     *             polyStart = Polygon([start.clone(),             #
     * <<<<<<<<<<<<<< Vertex(p0, startNormal), Vertex(p1, startNormal)])
     */
    __pyx_t_9 = PyList_New(3);
    if (unlikely(!__pyx_t_9))
      __PYX_ERR(0, 866, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_GIVEREF(__pyx_t_2);
    PyList_SET_ITEM(__pyx_t_9, 0, __pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_6);
    PyList_SET_ITEM(__pyx_t_9, 1, __pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_8);
    PyList_SET_ITEM(__pyx_t_9, 2, __pyx_t_8);
    __pyx_t_2 = 0;
    __pyx_t_6 = 0;
    __pyx_t_8 = 0;
    __pyx_t_8 = NULL;
    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
      __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_1);
      if (likely(__pyx_t_8)) {
        PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_1);
        __Pyx_INCREF(__pyx_t_8);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_1, function);
      }
    }
    __pyx_t_5 = (__pyx_t_8)
                    ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_8, __pyx_t_9)
                    : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_9);
    __Pyx_XDECREF(__pyx_t_8);
    __pyx_t_8 = 0;
    __Pyx_DECREF(__pyx_t_9);
    __pyx_t_9 = 0;
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 866, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __Pyx_XDECREF_SET(__pyx_v_polyStart, __pyx_t_5);
    __pyx_t_5 = 0;

    /* "pyg4ometry/pycsg/core.pyx":869
     *                                  Vertex(p0, startNormal),
     *                                  Vertex(p1, startNormal)])
     *             polygons.append(polyStart)             # <<<<<<<<<<<<<<
     *             # polygon extending from the low side to the tip
     *             polySide = Polygon([Vertex(p0, n0), Vertex(e, nAvg),
     * Vertex(p1, n1)])
     */
    __pyx_t_16 = __Pyx_PyList_Append(__pyx_v_polygons, __pyx_v_polyStart);
    if (unlikely(__pyx_t_16 == ((int)-1)))
      __PYX_ERR(0, 869, __pyx_L1_error)

    /* "pyg4ometry/pycsg/core.pyx":871
     *             polygons.append(polyStart)
     *             # polygon extending from the low side to the tip
     *             polySide = Polygon([Vertex(p0, n0), Vertex(e, nAvg),
     * Vertex(p1, n1)])             # <<<<<<<<<<<<<< polygons.append(polySide)
     *
     */
    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_Polygon);
    if (unlikely(!__pyx_t_1))
      __PYX_ERR(0, 871, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_Vertex);
    if (unlikely(!__pyx_t_8))
      __PYX_ERR(0, 871, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __pyx_t_6 = NULL;
    __pyx_t_10 = 0;
    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_8);
      if (likely(__pyx_t_6)) {
        PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_8);
        __Pyx_INCREF(__pyx_t_6);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_8, function);
        __pyx_t_10 = 1;
      }
    }
#if CYTHON_FAST_PYCALL
    if (PyFunction_Check(__pyx_t_8)) {
      PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_v_p0, __pyx_v_n0};
      __pyx_t_9 = __Pyx_PyFunction_FastCall(
          __pyx_t_8, __pyx_temp + 1 - __pyx_t_10, 2 + __pyx_t_10);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 871, __pyx_L1_error)
      __Pyx_XDECREF(__pyx_t_6);
      __pyx_t_6 = 0;
      __Pyx_GOTREF(__pyx_t_9);
    } else
#endif
#if CYTHON_FAST_PYCCALL
        if (__Pyx_PyFastCFunction_Check(__pyx_t_8)) {
      PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_v_p0, __pyx_v_n0};
      __pyx_t_9 = __Pyx_PyCFunction_FastCall(
          __pyx_t_8, __pyx_temp + 1 - __pyx_t_10, 2 + __pyx_t_10);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 871, __pyx_L1_error)
      __Pyx_XDECREF(__pyx_t_6);
      __pyx_t_6 = 0;
      __Pyx_GOTREF(__pyx_t_9);
    } else
#endif
    {
      __pyx_t_2 = PyTuple_New(2 + __pyx_t_10);
      if (unlikely(!__pyx_t_2))
        __PYX_ERR(0, 871, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      if (__pyx_t_6) {
        __Pyx_GIVEREF(__pyx_t_6);
        PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_6);
        __pyx_t_6 = NULL;
      }
      __Pyx_INCREF(__pyx_v_p0);
      __Pyx_GIVEREF(__pyx_v_p0);
      PyTuple_SET_ITEM(__pyx_t_2, 0 + __pyx_t_10, __pyx_v_p0);
      __Pyx_INCREF(__pyx_v_n0);
      __Pyx_GIVEREF(__pyx_v_n0);
      PyTuple_SET_ITEM(__pyx_t_2, 1 + __pyx_t_10, __pyx_v_n0);
      __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_2, NULL);
      if (unlikely(!__pyx_t_9))
        __PYX_ERR(0, 871, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_2);
      __pyx_t_2 = 0;
    }
    __Pyx_DECREF(__pyx_t_8);
    __pyx_t_8 = 0;
    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_Vertex);
    if (unlikely(!__pyx_t_2))
      __PYX_ERR(0, 871, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_6 = NULL;
    __pyx_t_10 = 0;
    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_6)) {
        PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_6);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
        __pyx_t_10 = 1;
      }
    }
#if CYTHON_FAST_PYCALL
    if (PyFunction_Check(__pyx_t_2)) {
      PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_v_e, __pyx_v_nAvg};
      __pyx_t_8 = __Pyx_PyFunction_FastCall(
          __pyx_t_2, __pyx_temp + 1 - __pyx_t_10, 2 + __pyx_t_10);
      if (unlikely(!__pyx_t_8))
        __PYX_ERR(0, 871, __pyx_L1_error)
      __Pyx_XDECREF(__pyx_t_6);
      __pyx_t_6 = 0;
      __Pyx_GOTREF(__pyx_t_8);
    } else
#endif
#if CYTHON_FAST_PYCCALL
        if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
      PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_v_e, __pyx_v_nAvg};
      __pyx_t_8 = __Pyx_PyCFunction_FastCall(
          __pyx_t_2, __pyx_temp + 1 - __pyx_t_10, 2 + __pyx_t_10);
      if (unlikely(!__pyx_t_8))
        __PYX_ERR(0, 871, __pyx_L1_error)
      __Pyx_XDECREF(__pyx_t_6);
      __pyx_t_6 = 0;
      __Pyx_GOTREF(__pyx_t_8);
    } else
#endif
    {
      __pyx_t_15 = PyTuple_New(2 + __pyx_t_10);
      if (unlikely(!__pyx_t_15))
        __PYX_ERR(0, 871, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_15);
      if (__pyx_t_6) {
        __Pyx_GIVEREF(__pyx_t_6);
        PyTuple_SET_ITEM(__pyx_t_15, 0, __pyx_t_6);
        __pyx_t_6 = NULL;
      }
      __Pyx_INCREF(__pyx_v_e);
      __Pyx_GIVEREF(__pyx_v_e);
      PyTuple_SET_ITEM(__pyx_t_15, 0 + __pyx_t_10, __pyx_v_e);
      __Pyx_INCREF(__pyx_v_nAvg);
      __Pyx_GIVEREF(__pyx_v_nAvg);
      PyTuple_SET_ITEM(__pyx_t_15, 1 + __pyx_t_10, __pyx_v_nAvg);
      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_15, NULL);
      if (unlikely(!__pyx_t_8))
        __PYX_ERR(0, 871, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_15);
      __pyx_t_15 = 0;
    }
    __Pyx_DECREF(__pyx_t_2);
    __pyx_t_2 = 0;
    __Pyx_GetModuleGlobalName(__pyx_t_15, __pyx_n_s_Vertex);
    if (unlikely(!__pyx_t_15))
      __PYX_ERR(0, 871, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_15);
    __pyx_t_6 = NULL;
    __pyx_t_10 = 0;
    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_15))) {
      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_15);
      if (likely(__pyx_t_6)) {
        PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_15);
        __Pyx_INCREF(__pyx_t_6);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_15, function);
        __pyx_t_10 = 1;
      }
    }
#if CYTHON_FAST_PYCALL
    if (PyFunction_Check(__pyx_t_15)) {
      PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_v_p1, __pyx_v_n1};
      __pyx_t_2 = __Pyx_PyFunction_FastCall(
          __pyx_t_15, __pyx_temp + 1 - __pyx_t_10, 2 + __pyx_t_10);
      if (unlikely(!__pyx_t_2))
        __PYX_ERR(0, 871, __pyx_L1_error)
      __Pyx_XDECREF(__pyx_t_6);
      __pyx_t_6 = 0;
      __Pyx_GOTREF(__pyx_t_2);
    } else
#endif
#if CYTHON_FAST_PYCCALL
        if (__Pyx_PyFastCFunction_Check(__pyx_t_15)) {
      PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_v_p1, __pyx_v_n1};
      __pyx_t_2 = __Pyx_PyCFunction_FastCall(
          __pyx_t_15, __pyx_temp + 1 - __pyx_t_10, 2 + __pyx_t_10);
      if (unlikely(!__pyx_t_2))
        __PYX_ERR(0, 871, __pyx_L1_error)
      __Pyx_XDECREF(__pyx_t_6);
      __pyx_t_6 = 0;
      __Pyx_GOTREF(__pyx_t_2);
    } else
#endif
    {
      __pyx_t_7 = PyTuple_New(2 + __pyx_t_10);
      if (unlikely(!__pyx_t_7))
        __PYX_ERR(0, 871, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      if (__pyx_t_6) {
        __Pyx_GIVEREF(__pyx_t_6);
        PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_6);
        __pyx_t_6 = NULL;
      }
      __Pyx_INCREF(__pyx_v_p1);
      __Pyx_GIVEREF(__pyx_v_p1);
      PyTuple_SET_ITEM(__pyx_t_7, 0 + __pyx_t_10, __pyx_v_p1);
      __Pyx_INCREF(__pyx_v_n1);
      __Pyx_GIVEREF(__pyx_v_n1);
      PyTuple_SET_ITEM(__pyx_t_7, 1 + __pyx_t_10, __pyx_v_n1);
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_15, __pyx_t_7, NULL);
      if (unlikely(!__pyx_t_2))
        __PYX_ERR(0, 871, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_7);
      __pyx_t_7 = 0;
    }
    __Pyx_DECREF(__pyx_t_15);
    __pyx_t_15 = 0;
    __pyx_t_15 = PyList_New(3);
    if (unlikely(!__pyx_t_15))
      __PYX_ERR(0, 871, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_15);
    __Pyx_GIVEREF(__pyx_t_9);
    PyList_SET_ITEM(__pyx_t_15, 0, __pyx_t_9);
    __Pyx_GIVEREF(__pyx_t_8);
    PyList_SET_ITEM(__pyx_t_15, 1, __pyx_t_8);
    __Pyx_GIVEREF(__pyx_t_2);
    PyList_SET_ITEM(__pyx_t_15, 2, __pyx_t_2);
    __pyx_t_9 = 0;
    __pyx_t_8 = 0;
    __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
      if (likely(__pyx_t_2)) {
        PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_1);
        __Pyx_INCREF(__pyx_t_2);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_1, function);
      }
    }
    __pyx_t_5 = (__pyx_t_2)
                    ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_2, __pyx_t_15)
                    : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_15);
    __Pyx_XDECREF(__pyx_t_2);
    __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_15);
    __pyx_t_15 = 0;
    if (unlikely(!__pyx_t_5))
      __PYX_ERR(0, 871, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __Pyx_XDECREF_SET(__pyx_v_polySide, __pyx_t_5);
    __pyx_t_5 = 0;

    /* "pyg4ometry/pycsg/core.pyx":872
     *             # polygon extending from the low side to the tip
     *             polySide = Polygon([Vertex(p0, n0), Vertex(e, nAvg),
     * Vertex(p1, n1)]) polygons.append(polySide)             # <<<<<<<<<<<<<<
     *
     *         return CSG.fromPolygons(polygons)
     */
    __pyx_t_16 = __Pyx_PyList_Append(__pyx_v_polygons, __pyx_v_polySide);
    if (unlikely(__pyx_t_16 == ((int)-1)))
      __PYX_ERR(0, 872, __pyx_L1_error)

    /* "pyg4ometry/pycsg/core.pyx":855
     *
     *         dt = _np.pi * 2.0 / float(slices)
     *         for i in range(0, slices):             # <<<<<<<<<<<<<<
     *             t0 = i * dt
     *             i1 = (i + 1) % slices
     */
  }
  __Pyx_DECREF(__pyx_t_11);
  __pyx_t_11 = 0;

  /* "pyg4ometry/pycsg/core.pyx":874
   *             polygons.append(polySide)
   *
   *         return CSG.fromPolygons(polygons)             # <<<<<<<<<<<<<<
   *
   * def do_intersect(first, second):
   */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_CSG);
  if (unlikely(!__pyx_t_5))
    __PYX_ERR(0, 874, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_fromPolygons);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 874, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_5)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
    }
  }
  __pyx_t_11 =
      (__pyx_t_5)
          ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_5, __pyx_v_polygons)
          : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_polygons);
  __Pyx_XDECREF(__pyx_t_5);
  __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_11))
    __PYX_ERR(0, 874, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_11);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_r = __pyx_t_11;
  __pyx_t_11 = 0;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":812
 *
 *     @classmethod
 *     def cone(cls, **kwargs):             # <<<<<<<<<<<<<<
 *         """ Returns a cone.
 *
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_XDECREF(__pyx_t_15);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.CSG.cone", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XDECREF(__pyx_v_e);
  __Pyx_XDECREF(__pyx_v_slices);
  __Pyx_XDECREF(__pyx_v_ray);
  __Pyx_XDECREF(__pyx_v_isY);
  __Pyx_XDECREF(__pyx_v_startNormal);
  __Pyx_XDECREF(__pyx_v_start);
  __Pyx_XDECREF(__pyx_v_polygons);
  __Pyx_XDECREF(__pyx_v_taperAngle);
  __Pyx_XDECREF(__pyx_v_point);
  __Pyx_XDECREF(__pyx_v_dt);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XDECREF(__pyx_v_t0);
  __Pyx_XDECREF(__pyx_v_i1);
  __Pyx_XDECREF(__pyx_v_t1);
  __Pyx_XDECREF(__pyx_v_p0);
  __Pyx_XDECREF(__pyx_v_n0);
  __Pyx_XDECREF(__pyx_v_p1);
  __Pyx_XDECREF(__pyx_v_n1);
  __Pyx_XDECREF(__pyx_v_nAvg);
  __Pyx_XDECREF(__pyx_v_polyStart);
  __Pyx_XDECREF(__pyx_v_polySide);
  __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "pyg4ometry/pycsg/core.pyx":876
 *         return CSG.fromPolygons(polygons)
 *
 * def do_intersect(first, second):             # <<<<<<<<<<<<<<
 *     return not first.intersect(second).isNull()
 */

/* Python wrapper */
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_1do_intersect(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10pyg4ometry_5pycsg_4core_1do_intersect = {
    "do_intersect",
    (PyCFunction)(void *)(PyCFunctionWithKeywords)
        __pyx_pw_10pyg4ometry_5pycsg_4core_1do_intersect,
    METH_VARARGS | METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10pyg4ometry_5pycsg_4core_1do_intersect(
    PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_first = 0;
  PyObject *__pyx_v_second = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext(
      "do_intersect (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_first, &__pyx_n_s_second,
                                            0};
    PyObject *values[2] = {0, 0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
      case 2:
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
      case 1:
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
      case 0:
        break;
      default:
        goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
      case 0:
        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds,
                                                        __pyx_n_s_first)) != 0))
          kw_args--;
        else
          goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
      case 1:
        if (likely((values[1] = __Pyx_PyDict_GetItemStr(
                        __pyx_kwds, __pyx_n_s_second)) != 0))
          kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("do_intersect", 1, 2, 2, 1);
          __PYX_ERR(0, 876, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames,
                                                 0, values, pos_args,
                                                 "do_intersect") < 0))
          __PYX_ERR(0, 876, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_first = values[0];
    __pyx_v_second = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
__pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("do_intersect", 1, 2, 2,
                             PyTuple_GET_SIZE(__pyx_args));
  __PYX_ERR(0, 876, __pyx_L3_error)
__pyx_L3_error:;
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.do_intersect", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
__pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10pyg4ometry_5pycsg_4core_do_intersect(
      __pyx_self, __pyx_v_first, __pyx_v_second);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10pyg4ometry_5pycsg_4core_do_intersect(
    CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_first,
    PyObject *__pyx_v_second) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("do_intersect", 0);

  /* "pyg4ometry/pycsg/core.pyx":877
   *
   * def do_intersect(first, second):
   *     return not first.intersect(second).isNull()             #
   * <<<<<<<<<<<<<<
   */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_first, __pyx_n_s_intersect);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 877, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  __pyx_t_2 =
      (__pyx_t_4)
          ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_v_second)
          : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_second);
  __Pyx_XDECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 877, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_isNull);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 877, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject *function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2)
                          : __Pyx_PyObject_CallNoArg(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 877, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1);
  if (unlikely(__pyx_t_5 < 0))
    __PYX_ERR(0, 877, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyBool_FromLong((!__pyx_t_5));
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 877, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

/* "pyg4ometry/pycsg/core.pyx":876
 *         return CSG.fromPolygons(polygons)
 *
 * def do_intersect(first, second):             # <<<<<<<<<<<<<<
 *     return not first.intersect(second).isNull()
 */

/* function exit code */
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("pyg4ometry.pycsg.core.do_intersect", __pyx_clineno,
                     __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
__pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate
    *__pyx_freelist_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate[8];
static int
    __pyx_freecount_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate = 0;

static PyObject *
__pyx_tp_new_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate(
    PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
  PyObject *o;
  if (CYTHON_COMPILING_IN_CPYTHON &&
      likely(
          (__pyx_freecount_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate >
           0) &
          (t->tp_basicsize ==
           sizeof(
               struct
               __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate)))) {
    o = (PyObject
             *)__pyx_freelist_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate
        [--__pyx_freecount_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate];
    memset(
        o, 0,
        sizeof(struct
               __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate));
    (void)PyObject_INIT(o, t);
    PyObject_GC_Track(o);
  } else {
    o = (*t->tp_alloc)(t, 0);
    if (unlikely(!o))
      return 0;
  }
  return o;
}

static void
__pyx_tp_dealloc_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate(
    PyObject *o) {
  struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate *p =
      (struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate *)
          o;
  PyObject_GC_UnTrack(o);
  Py_CLEAR(p->__pyx_v_ax);
  Py_CLEAR(p->__pyx_v_cosAngle);
  Py_CLEAR(p->__pyx_v_sinAngle);
  if (CYTHON_COMPILING_IN_CPYTHON &&
      ((__pyx_freecount_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate <
        8) &
       (Py_TYPE(o)->tp_basicsize ==
        sizeof(
            struct
            __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate)))) {
    __pyx_freelist_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate
        [__pyx_freecount_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate++] =
            ((struct
              __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate *)
                 o);
  } else {
    (*Py_TYPE(o)->tp_free)(o);
  }
}

static int
__pyx_tp_traverse_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate(
    PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate *p =
      (struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate *)
          o;
  if (p->__pyx_v_ax) {
    e = (*v)(p->__pyx_v_ax, a);
    if (e)
      return e;
  }
  if (p->__pyx_v_cosAngle) {
    e = (*v)(p->__pyx_v_cosAngle, a);
    if (e)
      return e;
  }
  if (p->__pyx_v_sinAngle) {
    e = (*v)(p->__pyx_v_sinAngle, a);
    if (e)
      return e;
  }
  return 0;
}

static int __pyx_tp_clear_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate(
    PyObject *o) {
  PyObject *tmp;
  struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate *p =
      (struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate *)
          o;
  tmp = ((PyObject *)p->__pyx_v_ax);
  p->__pyx_v_ax = Py_None;
  Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject *)p->__pyx_v_cosAngle);
  p->__pyx_v_cosAngle = Py_None;
  Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject *)p->__pyx_v_sinAngle);
  p->__pyx_v_sinAngle = Py_None;
  Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  return 0;
}

static PyTypeObject __pyx_type_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate = {
    PyVarObject_HEAD_INIT(
        0, 0) "pyg4ometry.pycsg.core.__pyx_scope_struct__rotate", /*tp_name*/
    sizeof(
        struct
        __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate), /*tp_basicsize*/
    0, /*tp_itemsize*/
    __pyx_tp_dealloc_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate, /*tp_dealloc*/
#if PY_VERSION_HEX < 0x030800b4
    0, /*tp_print*/
#endif
#if PY_VERSION_HEX >= 0x030800b4
    0, /*tp_vectorcall_offset*/
#endif
    0, /*tp_getattr*/
    0, /*tp_setattr*/
#if PY_MAJOR_VERSION < 3
    0, /*tp_compare*/
#endif
#if PY_MAJOR_VERSION >= 3
    0, /*tp_as_async*/
#endif
    0, /*tp_repr*/
    0, /*tp_as_number*/
    0, /*tp_as_sequence*/
    0, /*tp_as_mapping*/
    0, /*tp_hash*/
    0, /*tp_call*/
    0, /*tp_str*/
    0, /*tp_getattro*/
    0, /*tp_setattro*/
    0, /*tp_as_buffer*/
    Py_TPFLAGS_DEFAULT | Py_TPFLAGS_HAVE_VERSION_TAG | Py_TPFLAGS_CHECKTYPES |
        Py_TPFLAGS_HAVE_NEWBUFFER | Py_TPFLAGS_HAVE_GC, /*tp_flags*/
    0,                                                  /*tp_doc*/
    __pyx_tp_traverse_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate, /*tp_traverse*/
    __pyx_tp_clear_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate, /*tp_clear*/
    0, /*tp_richcompare*/
    0, /*tp_weaklistoffset*/
    0, /*tp_iter*/
    0, /*tp_iternext*/
    0, /*tp_methods*/
    0, /*tp_members*/
    0, /*tp_getset*/
    0, /*tp_base*/
    0, /*tp_dict*/
    0, /*tp_descr_get*/
    0, /*tp_descr_set*/
    0, /*tp_dictoffset*/
    0, /*tp_init*/
    0, /*tp_alloc*/
    __pyx_tp_new_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate, /*tp_new*/
    0, /*tp_free*/
    0, /*tp_is_gc*/
    0, /*tp_bases*/
    0, /*tp_mro*/
    0, /*tp_cache*/
    0, /*tp_subclasses*/
    0, /*tp_weaklist*/
    0, /*tp_del*/
    0, /*tp_version_tag*/
#if PY_VERSION_HEX >= 0x030400a1
    0, /*tp_finalize*/
#endif
#if PY_VERSION_HEX >= 0x030800b1 &&                                            \
    (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
    0, /*tp_vectorcall*/
#endif
#if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
    0, /*tp_print*/
#endif
#if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000
    0, /*tp_pypy_flags*/
#endif
};

static struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere
    *__pyx_freelist_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere[8];
static int
    __pyx_freecount_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere = 0;

static PyObject *
__pyx_tp_new_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere(
    PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
  PyObject *o;
  if (CYTHON_COMPILING_IN_CPYTHON &&
      likely(
          (__pyx_freecount_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere >
           0) &
          (t->tp_basicsize ==
           sizeof(
               struct
               __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere)))) {
    o = (PyObject
             *)__pyx_freelist_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere
        [--__pyx_freecount_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere];
    memset(
        o, 0,
        sizeof(
            struct
            __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere));
    (void)PyObject_INIT(o, t);
    PyObject_GC_Track(o);
  } else {
    o = (*t->tp_alloc)(t, 0);
    if (unlikely(!o))
      return 0;
  }
  return o;
}

static void
__pyx_tp_dealloc_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere(
    PyObject *o) {
  struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere *p =
      (struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere *)
          o;
  PyObject_GC_UnTrack(o);
  Py_CLEAR(p->__pyx_v_c);
  Py_CLEAR(p->__pyx_v_r);
  if (CYTHON_COMPILING_IN_CPYTHON &&
      ((__pyx_freecount_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere <
        8) &
       (Py_TYPE(o)->tp_basicsize ==
        sizeof(
            struct
            __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere)))) {
    __pyx_freelist_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere
        [__pyx_freecount_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere++] =
            ((struct
              __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere *)
                 o);
  } else {
    (*Py_TYPE(o)->tp_free)(o);
  }
}

static int
__pyx_tp_traverse_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere(
    PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere *p =
      (struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere *)
          o;
  if (p->__pyx_v_c) {
    e = (*v)(p->__pyx_v_c, a);
    if (e)
      return e;
  }
  if (p->__pyx_v_r) {
    e = (*v)(p->__pyx_v_r, a);
    if (e)
      return e;
  }
  return 0;
}

static int __pyx_tp_clear_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere(
    PyObject *o) {
  PyObject *tmp;
  struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere *p =
      (struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere *)
          o;
  tmp = ((PyObject *)p->__pyx_v_c);
  p->__pyx_v_c = Py_None;
  Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject *)p->__pyx_v_r);
  p->__pyx_v_r = Py_None;
  Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  return 0;
}

static PyTypeObject __pyx_type_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere = {
    PyVarObject_HEAD_INIT(
        0, 0) "pyg4ometry.pycsg.core.__pyx_scope_struct_1_sphere", /*tp_name*/
    sizeof(
        struct
        __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere), /*tp_basicsize*/
    0, /*tp_itemsize*/
    __pyx_tp_dealloc_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere, /*tp_dealloc*/
#if PY_VERSION_HEX < 0x030800b4
    0, /*tp_print*/
#endif
#if PY_VERSION_HEX >= 0x030800b4
    0, /*tp_vectorcall_offset*/
#endif
    0, /*tp_getattr*/
    0, /*tp_setattr*/
#if PY_MAJOR_VERSION < 3
    0, /*tp_compare*/
#endif
#if PY_MAJOR_VERSION >= 3
    0, /*tp_as_async*/
#endif
    0, /*tp_repr*/
    0, /*tp_as_number*/
    0, /*tp_as_sequence*/
    0, /*tp_as_mapping*/
    0, /*tp_hash*/
    0, /*tp_call*/
    0, /*tp_str*/
    0, /*tp_getattro*/
    0, /*tp_setattro*/
    0, /*tp_as_buffer*/
    Py_TPFLAGS_DEFAULT | Py_TPFLAGS_HAVE_VERSION_TAG | Py_TPFLAGS_CHECKTYPES |
        Py_TPFLAGS_HAVE_NEWBUFFER | Py_TPFLAGS_HAVE_GC, /*tp_flags*/
    0,                                                  /*tp_doc*/
    __pyx_tp_traverse_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere, /*tp_traverse*/
    __pyx_tp_clear_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere, /*tp_clear*/
    0, /*tp_richcompare*/
    0, /*tp_weaklistoffset*/
    0, /*tp_iter*/
    0, /*tp_iternext*/
    0, /*tp_methods*/
    0, /*tp_members*/
    0, /*tp_getset*/
    0, /*tp_base*/
    0, /*tp_dict*/
    0, /*tp_descr_get*/
    0, /*tp_descr_set*/
    0, /*tp_dictoffset*/
    0, /*tp_init*/
    0, /*tp_alloc*/
    __pyx_tp_new_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere, /*tp_new*/
    0, /*tp_free*/
    0, /*tp_is_gc*/
    0, /*tp_bases*/
    0, /*tp_mro*/
    0, /*tp_cache*/
    0, /*tp_subclasses*/
    0, /*tp_weaklist*/
    0, /*tp_del*/
    0, /*tp_version_tag*/
#if PY_VERSION_HEX >= 0x030400a1
    0, /*tp_finalize*/
#endif
#if PY_VERSION_HEX >= 0x030800b1 &&                                            \
    (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
    0, /*tp_vectorcall*/
#endif
#if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
    0, /*tp_print*/
#endif
#if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000
    0, /*tp_pypy_flags*/
#endif
};

static struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder
    *__pyx_freelist_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder[8];
static int
    __pyx_freecount_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder = 0;

static PyObject *
__pyx_tp_new_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder(
    PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
  PyObject *o;
  if (CYTHON_COMPILING_IN_CPYTHON &&
      likely(
          (__pyx_freecount_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder >
           0) &
          (t->tp_basicsize ==
           sizeof(
               struct
               __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder)))) {
    o = (PyObject
             *)__pyx_freelist_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder
        [--__pyx_freecount_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder];
    memset(
        o, 0,
        sizeof(
            struct
            __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder));
    (void)PyObject_INIT(o, t);
    PyObject_GC_Track(o);
  } else {
    o = (*t->tp_alloc)(t, 0);
    if (unlikely(!o))
      return 0;
  }
  return o;
}

static void
__pyx_tp_dealloc_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder(
    PyObject *o) {
  struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder *p =
      (struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder
           *)o;
  PyObject_GC_UnTrack(o);
  Py_CLEAR(p->__pyx_v_axisX);
  Py_CLEAR(p->__pyx_v_axisY);
  Py_CLEAR(p->__pyx_v_axisZ);
  Py_CLEAR(p->__pyx_v_r);
  Py_CLEAR(p->__pyx_v_ray);
  Py_CLEAR(p->__pyx_v_s);
  if (CYTHON_COMPILING_IN_CPYTHON &&
      ((__pyx_freecount_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder <
        8) &
       (Py_TYPE(o)->tp_basicsize ==
        sizeof(
            struct
            __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder)))) {
    __pyx_freelist_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder
        [__pyx_freecount_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder++] =
            ((struct
              __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder
                  *)o);
  } else {
    (*Py_TYPE(o)->tp_free)(o);
  }
}

static int
__pyx_tp_traverse_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder(
    PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder *p =
      (struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder
           *)o;
  if (p->__pyx_v_axisX) {
    e = (*v)(p->__pyx_v_axisX, a);
    if (e)
      return e;
  }
  if (p->__pyx_v_axisY) {
    e = (*v)(p->__pyx_v_axisY, a);
    if (e)
      return e;
  }
  if (p->__pyx_v_axisZ) {
    e = (*v)(p->__pyx_v_axisZ, a);
    if (e)
      return e;
  }
  if (p->__pyx_v_r) {
    e = (*v)(p->__pyx_v_r, a);
    if (e)
      return e;
  }
  if (p->__pyx_v_ray) {
    e = (*v)(p->__pyx_v_ray, a);
    if (e)
      return e;
  }
  if (p->__pyx_v_s) {
    e = (*v)(p->__pyx_v_s, a);
    if (e)
      return e;
  }
  return 0;
}

static int
__pyx_tp_clear_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder(
    PyObject *o) {
  PyObject *tmp;
  struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder *p =
      (struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder
           *)o;
  tmp = ((PyObject *)p->__pyx_v_axisX);
  p->__pyx_v_axisX = Py_None;
  Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject *)p->__pyx_v_axisY);
  p->__pyx_v_axisY = Py_None;
  Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject *)p->__pyx_v_axisZ);
  p->__pyx_v_axisZ = Py_None;
  Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject *)p->__pyx_v_r);
  p->__pyx_v_r = Py_None;
  Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject *)p->__pyx_v_ray);
  p->__pyx_v_ray = Py_None;
  Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject *)p->__pyx_v_s);
  p->__pyx_v_s = Py_None;
  Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  return 0;
}

static PyTypeObject __pyx_type_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder = {
    PyVarObject_HEAD_INIT(
        0, 0) "pyg4ometry.pycsg.core.__pyx_scope_struct_2_cylinder", /*tp_name*/
    sizeof(
        struct
        __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder), /*tp_basicsize*/
    0, /*tp_itemsize*/
    __pyx_tp_dealloc_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder, /*tp_dealloc*/
#if PY_VERSION_HEX < 0x030800b4
    0, /*tp_print*/
#endif
#if PY_VERSION_HEX >= 0x030800b4
    0, /*tp_vectorcall_offset*/
#endif
    0, /*tp_getattr*/
    0, /*tp_setattr*/
#if PY_MAJOR_VERSION < 3
    0, /*tp_compare*/
#endif
#if PY_MAJOR_VERSION >= 3
    0, /*tp_as_async*/
#endif
    0, /*tp_repr*/
    0, /*tp_as_number*/
    0, /*tp_as_sequence*/
    0, /*tp_as_mapping*/
    0, /*tp_hash*/
    0, /*tp_call*/
    0, /*tp_str*/
    0, /*tp_getattro*/
    0, /*tp_setattro*/
    0, /*tp_as_buffer*/
    Py_TPFLAGS_DEFAULT | Py_TPFLAGS_HAVE_VERSION_TAG | Py_TPFLAGS_CHECKTYPES |
        Py_TPFLAGS_HAVE_NEWBUFFER | Py_TPFLAGS_HAVE_GC, /*tp_flags*/
    0,                                                  /*tp_doc*/
    __pyx_tp_traverse_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder, /*tp_traverse*/
    __pyx_tp_clear_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder, /*tp_clear*/
    0, /*tp_richcompare*/
    0, /*tp_weaklistoffset*/
    0, /*tp_iter*/
    0, /*tp_iternext*/
    0, /*tp_methods*/
    0, /*tp_members*/
    0, /*tp_getset*/
    0, /*tp_base*/
    0, /*tp_dict*/
    0, /*tp_descr_get*/
    0, /*tp_descr_set*/
    0, /*tp_dictoffset*/
    0, /*tp_init*/
    0, /*tp_alloc*/
    __pyx_tp_new_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder, /*tp_new*/
    0, /*tp_free*/
    0, /*tp_is_gc*/
    0, /*tp_bases*/
    0, /*tp_mro*/
    0, /*tp_cache*/
    0, /*tp_subclasses*/
    0, /*tp_weaklist*/
    0, /*tp_del*/
    0, /*tp_version_tag*/
#if PY_VERSION_HEX >= 0x030400a1
    0, /*tp_finalize*/
#endif
#if PY_VERSION_HEX >= 0x030800b1 &&                                            \
    (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
    0, /*tp_vectorcall*/
#endif
#if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
    0, /*tp_print*/
#endif
#if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000
    0, /*tp_pypy_flags*/
#endif
};

static struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone
    *__pyx_freelist_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone[8];
static int __pyx_freecount_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone =
    0;

static PyObject *
__pyx_tp_new_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone(
    PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
  PyObject *o;
  if (CYTHON_COMPILING_IN_CPYTHON &&
      likely(
          (__pyx_freecount_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone >
           0) &
          (t->tp_basicsize ==
           sizeof(
               struct
               __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone)))) {
    o = (PyObject
             *)__pyx_freelist_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone
        [--__pyx_freecount_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone];
    memset(
        o, 0,
        sizeof(struct
               __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone));
    (void)PyObject_INIT(o, t);
    PyObject_GC_Track(o);
  } else {
    o = (*t->tp_alloc)(t, 0);
    if (unlikely(!o))
      return 0;
  }
  return o;
}

static void
__pyx_tp_dealloc_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone(
    PyObject *o) {
  struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone *p =
      (struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone *)o;
  PyObject_GC_UnTrack(o);
  Py_CLEAR(p->__pyx_v_axisX);
  Py_CLEAR(p->__pyx_v_axisY);
  Py_CLEAR(p->__pyx_v_axisZ);
  Py_CLEAR(p->__pyx_v_cosTaperAngle);
  Py_CLEAR(p->__pyx_v_r);
  Py_CLEAR(p->__pyx_v_s);
  Py_CLEAR(p->__pyx_v_sinTaperAngle);
  if (CYTHON_COMPILING_IN_CPYTHON &&
      ((__pyx_freecount_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone <
        8) &
       (Py_TYPE(o)->tp_basicsize ==
        sizeof(
            struct
            __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone)))) {
    __pyx_freelist_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone
        [__pyx_freecount_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone++] =
            ((struct
              __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone *)
                 o);
  } else {
    (*Py_TYPE(o)->tp_free)(o);
  }
}

static int
__pyx_tp_traverse_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone(
    PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone *p =
      (struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone *)o;
  if (p->__pyx_v_axisX) {
    e = (*v)(p->__pyx_v_axisX, a);
    if (e)
      return e;
  }
  if (p->__pyx_v_axisY) {
    e = (*v)(p->__pyx_v_axisY, a);
    if (e)
      return e;
  }
  if (p->__pyx_v_axisZ) {
    e = (*v)(p->__pyx_v_axisZ, a);
    if (e)
      return e;
  }
  if (p->__pyx_v_cosTaperAngle) {
    e = (*v)(p->__pyx_v_cosTaperAngle, a);
    if (e)
      return e;
  }
  if (p->__pyx_v_r) {
    e = (*v)(p->__pyx_v_r, a);
    if (e)
      return e;
  }
  if (p->__pyx_v_s) {
    e = (*v)(p->__pyx_v_s, a);
    if (e)
      return e;
  }
  if (p->__pyx_v_sinTaperAngle) {
    e = (*v)(p->__pyx_v_sinTaperAngle, a);
    if (e)
      return e;
  }
  return 0;
}

static int __pyx_tp_clear_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone(
    PyObject *o) {
  PyObject *tmp;
  struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone *p =
      (struct __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone *)o;
  tmp = ((PyObject *)p->__pyx_v_axisX);
  p->__pyx_v_axisX = Py_None;
  Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject *)p->__pyx_v_axisY);
  p->__pyx_v_axisY = Py_None;
  Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject *)p->__pyx_v_axisZ);
  p->__pyx_v_axisZ = Py_None;
  Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject *)p->__pyx_v_cosTaperAngle);
  p->__pyx_v_cosTaperAngle = Py_None;
  Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject *)p->__pyx_v_r);
  p->__pyx_v_r = Py_None;
  Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject *)p->__pyx_v_s);
  p->__pyx_v_s = Py_None;
  Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject *)p->__pyx_v_sinTaperAngle);
  p->__pyx_v_sinTaperAngle = Py_None;
  Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  return 0;
}

static PyTypeObject __pyx_type_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone = {
    PyVarObject_HEAD_INIT(
        0, 0) "pyg4ometry.pycsg.core.__pyx_scope_struct_3_cone", /*tp_name*/
    sizeof(
        struct
        __pyx_obj_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone), /*tp_basicsize*/
    0, /*tp_itemsize*/
    __pyx_tp_dealloc_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone, /*tp_dealloc*/
#if PY_VERSION_HEX < 0x030800b4
    0, /*tp_print*/
#endif
#if PY_VERSION_HEX >= 0x030800b4
    0, /*tp_vectorcall_offset*/
#endif
    0, /*tp_getattr*/
    0, /*tp_setattr*/
#if PY_MAJOR_VERSION < 3
    0, /*tp_compare*/
#endif
#if PY_MAJOR_VERSION >= 3
    0, /*tp_as_async*/
#endif
    0, /*tp_repr*/
    0, /*tp_as_number*/
    0, /*tp_as_sequence*/
    0, /*tp_as_mapping*/
    0, /*tp_hash*/
    0, /*tp_call*/
    0, /*tp_str*/
    0, /*tp_getattro*/
    0, /*tp_setattro*/
    0, /*tp_as_buffer*/
    Py_TPFLAGS_DEFAULT | Py_TPFLAGS_HAVE_VERSION_TAG | Py_TPFLAGS_CHECKTYPES |
        Py_TPFLAGS_HAVE_NEWBUFFER | Py_TPFLAGS_HAVE_GC, /*tp_flags*/
    0,                                                  /*tp_doc*/
    __pyx_tp_traverse_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone, /*tp_traverse*/
    __pyx_tp_clear_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone, /*tp_clear*/
    0, /*tp_richcompare*/
    0, /*tp_weaklistoffset*/
    0, /*tp_iter*/
    0, /*tp_iternext*/
    0, /*tp_methods*/
    0, /*tp_members*/
    0, /*tp_getset*/
    0, /*tp_base*/
    0, /*tp_dict*/
    0, /*tp_descr_get*/
    0, /*tp_descr_set*/
    0, /*tp_dictoffset*/
    0, /*tp_init*/
    0, /*tp_alloc*/
    __pyx_tp_new_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone, /*tp_new*/
    0, /*tp_free*/
    0, /*tp_is_gc*/
    0, /*tp_bases*/
    0, /*tp_mro*/
    0, /*tp_cache*/
    0, /*tp_subclasses*/
    0, /*tp_weaklist*/
    0, /*tp_del*/
    0, /*tp_version_tag*/
#if PY_VERSION_HEX >= 0x030400a1
    0, /*tp_finalize*/
#endif
#if PY_VERSION_HEX >= 0x030800b1 &&                                            \
    (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
    0, /*tp_vectorcall*/
#endif
#if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
    0, /*tp_print*/
#endif
#if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000
    0, /*tp_pypy_flags*/
#endif
};

static PyMethodDef __pyx_methods[] = {{0, 0, 0, 0}};

static int __pyx_import_star_set(PyObject *o, PyObject *py_name, char *name) {
  static const char *internal_type_names[] = {
      "__pyx_ctuple_Py_ssize_t",
      "__pyx_ctuple_Py_ssize_t_struct",
      "__pyx_ctuple_double",
      "__pyx_ctuple_double__and_double__and_double",
      "__pyx_ctuple_double__and_double__and_double_struct",
      "__pyx_ctuple_double__and_double__and_long",
      "__pyx_ctuple_double__and_double__and_long_struct",
      "__pyx_ctuple_double_struct",
      "__pyx_ctuple_int",
      "__pyx_ctuple_int_struct",
      "__pyx_ctuple_long",
      "__pyx_ctuple_long__and_Py_ssize_t__and_long",
      "__pyx_ctuple_long__and_Py_ssize_t__and_long_struct",
      "__pyx_ctuple_long__and_long__and_long",
      "__pyx_ctuple_long__and_long__and_long_struct",
      "__pyx_ctuple_long_struct",
      "__pyx_scope_struct_1_sphere",
      "__pyx_scope_struct_2_cylinder",
      "__pyx_scope_struct_3_cone",
      "__pyx_scope_struct__rotate",
      0};
  const char **type_name = internal_type_names;
  while (*type_name) {
    if (__Pyx_StrEq(name, *type_name)) {
      PyErr_Format(PyExc_TypeError, "Cannot overwrite C type %s", name);
      goto bad;
    }
    type_name++;
  }
  if (0)
    ;
  else {
    if (PyObject_SetAttr(__pyx_m, py_name, o) < 0)
      goto bad;
  }
  return 0;
bad:
  return -1;
}

static int __Pyx_import_all_from(PyObject *locals, PyObject *v) {
  PyObject *all = PyObject_GetAttrString(v, "__all__");
  PyObject *dict, *name, *value;
  int skip_leading_underscores = 0;
  int pos, err;
  if (all == NULL) {
    if (!PyErr_ExceptionMatches(PyExc_AttributeError))
      return -1;
    PyErr_Clear();
    dict = PyObject_GetAttrString(v, "__dict__");
    if (dict == NULL) {
      if (!PyErr_ExceptionMatches(PyExc_AttributeError))
        return -1;
      PyErr_SetString(PyExc_ImportError,
                      "from-import-* object has no __dict__ and no __all__");
      return -1;
    }
#if PY_MAJOR_VERSION < 3
    all = PyObject_CallMethod(dict, (char *)"keys", NULL);
#else
    all = PyMapping_Keys(dict);
#endif
    Py_DECREF(dict);
    if (all == NULL)
      return -1;
    skip_leading_underscores = 1;
  }
  for (pos = 0, err = 0;; pos++) {
    name = PySequence_GetItem(all, pos);
    if (name == NULL) {
      if (!PyErr_ExceptionMatches(PyExc_IndexError))
        err = -1;
      else
        PyErr_Clear();
      break;
    }
    if (skip_leading_underscores &&
#if PY_MAJOR_VERSION < 3
        likely(PyString_Check(name)) && PyString_AS_STRING(name)[0] == '_')
#else
        likely(PyUnicode_Check(name)) &&
        likely(__Pyx_PyUnicode_GET_LENGTH(name)) &&
        __Pyx_PyUnicode_READ_CHAR(name, 0) == '_')
#endif
    {
      Py_DECREF(name);
      continue;
    }
    value = PyObject_GetAttr(v, name);
    if (value == NULL)
      err = -1;
    else if (PyDict_CheckExact(locals))
      err = PyDict_SetItem(locals, name, value);
    else
      err = PyObject_SetItem(locals, name, value);
    Py_DECREF(name);
    Py_XDECREF(value);
    if (err != 0)
      break;
  }
  Py_DECREF(all);
  return err;
}
static int __pyx_import_star(PyObject *m) {
  int i;
  int ret = -1;
  char *s;
  PyObject *locals = 0;
  PyObject *list = 0;
#if PY_MAJOR_VERSION >= 3
  PyObject *utf8_name = 0;
#endif
  PyObject *name;
  PyObject *item;
  locals = PyDict_New();
  if (!locals)
    goto bad;
  if (__Pyx_import_all_from(locals, m) < 0)
    goto bad;
  list = PyDict_Items(locals);
  if (!list)
    goto bad;
  for (i = 0; i < PyList_GET_SIZE(list); i++) {
    name = PyTuple_GET_ITEM(PyList_GET_ITEM(list, i), 0);
    item = PyTuple_GET_ITEM(PyList_GET_ITEM(list, i), 1);
#if PY_MAJOR_VERSION >= 3
    utf8_name = PyUnicode_AsUTF8String(name);
    if (!utf8_name)
      goto bad;
    s = PyBytes_AS_STRING(utf8_name);
    if (__pyx_import_star_set(item, name, s) < 0)
      goto bad;
    Py_DECREF(utf8_name);
    utf8_name = 0;
#else
    s = PyString_AsString(name);
    if (!s)
      goto bad;
    if (__pyx_import_star_set(item, name, s) < 0)
      goto bad;
#endif
  }
  ret = 0;
bad:
  Py_XDECREF(locals);
  Py_XDECREF(list);
#if PY_MAJOR_VERSION >= 3
  Py_XDECREF(utf8_name);
#endif
  return ret;
}

#if PY_MAJOR_VERSION >= 3
#if CYTHON_PEP489_MULTI_PHASE_INIT
static PyObject *__pyx_pymod_create(PyObject *spec, PyModuleDef *def); /*proto*/
static int __pyx_pymod_exec_core(PyObject *module);                    /*proto*/
static PyModuleDef_Slot __pyx_moduledef_slots[] = {
    {Py_mod_create, (void *)__pyx_pymod_create},
    {Py_mod_exec, (void *)__pyx_pymod_exec_core},
    {0, NULL}};
#endif

static struct PyModuleDef __pyx_moduledef = {
    PyModuleDef_HEAD_INIT,
    "core",
    0, /* m_doc */
#if CYTHON_PEP489_MULTI_PHASE_INIT
    0, /* m_size */
#else
    -1, /* m_size */
#endif
    __pyx_methods /* m_methods */,
#if CYTHON_PEP489_MULTI_PHASE_INIT
    __pyx_moduledef_slots, /* m_slots */
#else
    NULL, /* m_reload */
#endif
    NULL, /* m_traverse */
    NULL, /* m_clear */
    NULL  /* m_free */
};
#endif
#ifndef CYTHON_SMALL_CODE
#if defined(__clang__)
#define CYTHON_SMALL_CODE
#elif defined(__GNUC__) &&                                                     \
    (__GNUC__ > 4 || (__GNUC__ == 4 && __GNUC_MINOR__ >= 3))
#define CYTHON_SMALL_CODE __attribute__((cold))
#else
#define CYTHON_SMALL_CODE
#endif
#endif

static __Pyx_StringTabEntry __pyx_string_tab[] = {
    {&__pyx_kp_u_0, __pyx_k_0, sizeof(__pyx_k_0), 0, 1, 0, 0},
    {&__pyx_kp_u_0_1_2, __pyx_k_0_1_2, sizeof(__pyx_k_0_1_2), 0, 1, 0, 0},
    {&__pyx_kp_u_10e_10e_10e, __pyx_k_10e_10e_10e, sizeof(__pyx_k_10e_10e_10e),
     0, 1, 0, 0},
    {&__pyx_n_u_ASCII, __pyx_k_ASCII, sizeof(__pyx_k_ASCII), 0, 1, 0, 1},
    {&__pyx_n_s_BACK, __pyx_k_BACK, sizeof(__pyx_k_BACK), 0, 0, 1, 1},
    {&__pyx_n_s_BSPNode, __pyx_k_BSPNode, sizeof(__pyx_k_BSPNode), 0, 0, 1, 1},
    {&__pyx_n_s_COPLANAR, __pyx_k_COPLANAR, sizeof(__pyx_k_COPLANAR), 0, 0, 1,
     1},
    {&__pyx_n_s_CSG, __pyx_k_CSG, sizeof(__pyx_k_CSG), 0, 0, 1, 1},
    {&__pyx_n_s_CSG___add, __pyx_k_CSG___add, sizeof(__pyx_k_CSG___add), 0, 0,
     1, 1},
    {&__pyx_n_s_CSG___hash, __pyx_k_CSG___hash, sizeof(__pyx_k_CSG___hash), 0,
     0, 1, 1},
    {&__pyx_n_s_CSG___init, __pyx_k_CSG___init, sizeof(__pyx_k_CSG___init), 0,
     0, 1, 1},
    {&__pyx_n_s_CSG___mul, __pyx_k_CSG___mul, sizeof(__pyx_k_CSG___mul), 0, 0,
     1, 1},
    {&__pyx_n_s_CSG___sub, __pyx_k_CSG___sub, sizeof(__pyx_k_CSG___sub), 0, 0,
     1, 1},
    {&__pyx_n_s_CSG_clone, __pyx_k_CSG_clone, sizeof(__pyx_k_CSG_clone), 0, 0,
     1, 1},
    {&__pyx_n_s_CSG_cone, __pyx_k_CSG_cone, sizeof(__pyx_k_CSG_cone), 0, 0, 1,
     1},
    {&__pyx_n_s_CSG_cone_locals_point, __pyx_k_CSG_cone_locals_point,
     sizeof(__pyx_k_CSG_cone_locals_point), 0, 0, 1, 1},
    {&__pyx_n_s_CSG_coplanar, __pyx_k_CSG_coplanar,
     sizeof(__pyx_k_CSG_coplanar), 0, 0, 1, 1},
    {&__pyx_n_s_CSG_coplanarIntersection, __pyx_k_CSG_coplanarIntersection,
     sizeof(__pyx_k_CSG_coplanarIntersection), 0, 0, 1, 1},
    {&__pyx_n_s_CSG_coplanarIntersection_locals,
     __pyx_k_CSG_coplanarIntersection_locals,
     sizeof(__pyx_k_CSG_coplanarIntersection_locals), 0, 0, 1, 1},
    {&__pyx_n_s_CSG_coplanarIntersection_locals_2,
     __pyx_k_CSG_coplanarIntersection_locals_2,
     sizeof(__pyx_k_CSG_coplanarIntersection_locals_2), 0, 0, 1, 1},
    {&__pyx_n_s_CSG_coplanarIntersection_locals_3,
     __pyx_k_CSG_coplanarIntersection_locals_3,
     sizeof(__pyx_k_CSG_coplanarIntersection_locals_3), 0, 0, 1, 1},
    {&__pyx_n_s_CSG_coplanarIntersection_locals_4,
     __pyx_k_CSG_coplanarIntersection_locals_4,
     sizeof(__pyx_k_CSG_coplanarIntersection_locals_4), 0, 0, 1, 1},
    {&__pyx_n_s_CSG_cube, __pyx_k_CSG_cube, sizeof(__pyx_k_CSG_cube), 0, 0, 1,
     1},
    {&__pyx_n_s_CSG_cylinder, __pyx_k_CSG_cylinder,
     sizeof(__pyx_k_CSG_cylinder), 0, 0, 1, 1},
    {&__pyx_n_s_CSG_cylinder_locals_point, __pyx_k_CSG_cylinder_locals_point,
     sizeof(__pyx_k_CSG_cylinder_locals_point), 0, 0, 1, 1},
    {&__pyx_n_s_CSG_fromPolygons, __pyx_k_CSG_fromPolygons,
     sizeof(__pyx_k_CSG_fromPolygons), 0, 0, 1, 1},
    {&__pyx_n_s_CSG_getNumberPolys, __pyx_k_CSG_getNumberPolys,
     sizeof(__pyx_k_CSG_getNumberPolys), 0, 0, 1, 1},
    {&__pyx_n_s_CSG_intersect, __pyx_k_CSG_intersect,
     sizeof(__pyx_k_CSG_intersect), 0, 0, 1, 1},
    {&__pyx_n_s_CSG_inverse, __pyx_k_CSG_inverse, sizeof(__pyx_k_CSG_inverse),
     0, 0, 1, 1},
    {&__pyx_n_s_CSG_inverse_locals_lambda, __pyx_k_CSG_inverse_locals_lambda,
     sizeof(__pyx_k_CSG_inverse_locals_lambda), 0, 0, 1, 1},
    {&__pyx_n_s_CSG_isNull, __pyx_k_CSG_isNull, sizeof(__pyx_k_CSG_isNull), 0,
     0, 1, 1},
    {&__pyx_n_s_CSG_polygonCount, __pyx_k_CSG_polygonCount,
     sizeof(__pyx_k_CSG_polygonCount), 0, 0, 1, 1},
    {&__pyx_n_s_CSG_refine, __pyx_k_CSG_refine, sizeof(__pyx_k_CSG_refine), 0,
     0, 1, 1},
    {&__pyx_n_s_CSG_rotate, __pyx_k_CSG_rotate, sizeof(__pyx_k_CSG_rotate), 0,
     0, 1, 1},
    {&__pyx_n_s_CSG_rotate_locals_newVector,
     __pyx_k_CSG_rotate_locals_newVector,
     sizeof(__pyx_k_CSG_rotate_locals_newVector), 0, 0, 1, 1},
    {&__pyx_n_s_CSG_saveVTK, __pyx_k_CSG_saveVTK, sizeof(__pyx_k_CSG_saveVTK),
     0, 0, 1, 1},
    {&__pyx_n_s_CSG_scale, __pyx_k_CSG_scale, sizeof(__pyx_k_CSG_scale), 0, 0,
     1, 1},
    {&__pyx_n_s_CSG_sphere, __pyx_k_CSG_sphere, sizeof(__pyx_k_CSG_sphere), 0,
     0, 1, 1},
    {&__pyx_n_s_CSG_sphere_locals_appendVertex,
     __pyx_k_CSG_sphere_locals_appendVertex,
     sizeof(__pyx_k_CSG_sphere_locals_appendVertex), 0, 0, 1, 1},
    {&__pyx_n_s_CSG_subtract, __pyx_k_CSG_subtract,
     sizeof(__pyx_k_CSG_subtract), 0, 0, 1, 1},
    {&__pyx_n_s_CSG_toPolygons, __pyx_k_CSG_toPolygons,
     sizeof(__pyx_k_CSG_toPolygons), 0, 0, 1, 1},
    {&__pyx_n_s_CSG_toVerticesAndPolygons, __pyx_k_CSG_toVerticesAndPolygons,
     sizeof(__pyx_k_CSG_toVerticesAndPolygons), 0, 0, 1, 1},
    {&__pyx_n_s_CSG_translate, __pyx_k_CSG_translate,
     sizeof(__pyx_k_CSG_translate), 0, 0, 1, 1},
    {&__pyx_n_s_CSG_union, __pyx_k_CSG_union, sizeof(__pyx_k_CSG_union), 0, 0,
     1, 1},
    {&__pyx_n_s_CSG_vertexCount, __pyx_k_CSG_vertexCount,
     sizeof(__pyx_k_CSG_vertexCount), 0, 0, 1, 1},
    {&__pyx_kp_s_Constructive_Solid_Geometry_CSG,
     __pyx_k_Constructive_Solid_Geometry_CSG,
     sizeof(__pyx_k_Constructive_Solid_Geometry_CSG), 0, 0, 1, 0},
    {&__pyx_kp_u_DATASET_POLYDATA, __pyx_k_DATASET_POLYDATA,
     sizeof(__pyx_k_DATASET_POLYDATA), 0, 1, 0, 0},
    {&__pyx_n_s_FRONT, __pyx_k_FRONT, sizeof(__pyx_k_FRONT), 0, 0, 1, 1},
    {&__pyx_kp_u_POINTS_0_float, __pyx_k_POINTS_0_float,
     sizeof(__pyx_k_POINTS_0_float), 0, 1, 0, 0},
    {&__pyx_kp_u_POLYGONS_0_1, __pyx_k_POLYGONS_0_1,
     sizeof(__pyx_k_POLYGONS_0_1), 0, 1, 0, 0},
    {&__pyx_n_s_Polygon, __pyx_k_Polygon, sizeof(__pyx_k_Polygon), 0, 0, 1, 1},
    {&__pyx_n_s_Vector, __pyx_k_Vector, sizeof(__pyx_k_Vector), 0, 0, 1, 1},
    {&__pyx_n_s_Vector_2, __pyx_k_Vector_2, sizeof(__pyx_k_Vector_2), 0, 0, 1,
     1},
    {&__pyx_n_s_Vertex, __pyx_k_Vertex, sizeof(__pyx_k_Vertex), 0, 0, 1, 1},
    {&__pyx_n_s_Vertex_2, __pyx_k_Vertex_2, sizeof(__pyx_k_Vertex_2), 0, 0, 1,
     1},
    {&__pyx_n_s_ZeroDivisionError, __pyx_k_ZeroDivisionError,
     sizeof(__pyx_k_ZeroDivisionError), 0, 0, 1, 1},
    {&__pyx_n_s__23, __pyx_k__23, sizeof(__pyx_k__23), 0, 0, 1, 1},
    {&__pyx_kp_u__3, __pyx_k__3, sizeof(__pyx_k__3), 0, 1, 0, 0},
    {&__pyx_kp_u__4, __pyx_k__4, sizeof(__pyx_k__4), 0, 1, 0, 0},
    {&__pyx_n_s_a, __pyx_k_a, sizeof(__pyx_k_a), 0, 0, 1, 1},
    {&__pyx_n_s_a0, __pyx_k_a0, sizeof(__pyx_k_a0), 0, 0, 1, 1},
    {&__pyx_n_s_aAdd, __pyx_k_aAdd, sizeof(__pyx_k_aAdd), 0, 0, 1, 1},
    {&__pyx_n_s_aInsideB, __pyx_k_aInsideB, sizeof(__pyx_k_aInsideB), 0, 0, 1,
     1},
    {&__pyx_n_s_aInterB, __pyx_k_aInterB, sizeof(__pyx_k_aInterB), 0, 0, 1, 1},
    {&__pyx_n_s_aPlaneNormal, __pyx_k_aPlaneNormal,
     sizeof(__pyx_k_aPlaneNormal), 0, 0, 1, 1},
    {&__pyx_n_s_absp, __pyx_k_absp, sizeof(__pyx_k_absp), 0, 0, 1, 1},
    {&__pyx_n_s_add, __pyx_k_add, sizeof(__pyx_k_add), 0, 0, 1, 1},
    {&__pyx_n_s_add_2, __pyx_k_add_2, sizeof(__pyx_k_add_2), 0, 0, 1, 1},
    {&__pyx_n_s_adist, __pyx_k_adist, sizeof(__pyx_k_adist), 0, 0, 1, 1},
    {&__pyx_n_s_allPolygons, __pyx_k_allPolygons, sizeof(__pyx_k_allPolygons),
     0, 0, 1, 1},
    {&__pyx_n_s_andist, __pyx_k_andist, sizeof(__pyx_k_andist), 0, 0, 1, 1},
    {&__pyx_n_s_angle, __pyx_k_angle, sizeof(__pyx_k_angle), 0, 0, 1, 1},
    {&__pyx_n_s_angleDeg, __pyx_k_angleDeg, sizeof(__pyx_k_angleDeg), 0, 0, 1,
     1},
    {&__pyx_n_s_anormal, __pyx_k_anormal, sizeof(__pyx_k_anormal), 0, 0, 1, 1},
    {&__pyx_n_s_aplane, __pyx_k_aplane, sizeof(__pyx_k_aplane), 0, 0, 1, 1},
    {&__pyx_n_s_apoly, __pyx_k_apoly, sizeof(__pyx_k_apoly), 0, 0, 1, 1},
    {&__pyx_n_s_apolygons, __pyx_k_apolygons, sizeof(__pyx_k_apolygons), 0, 0,
     1, 1},
    {&__pyx_n_s_append, __pyx_k_append, sizeof(__pyx_k_append), 0, 0, 1, 1},
    {&__pyx_n_s_appendVertex, __pyx_k_appendVertex,
     sizeof(__pyx_k_appendVertex), 0, 0, 1, 1},
    {&__pyx_n_s_array, __pyx_k_array, sizeof(__pyx_k_array), 0, 0, 1, 1},
    {&__pyx_n_s_array2string, __pyx_k_array2string,
     sizeof(__pyx_k_array2string), 0, 0, 1, 1},
    {&__pyx_n_s_as_string, __pyx_k_as_string, sizeof(__pyx_k_as_string), 0, 0,
     1, 1},
    {&__pyx_n_s_atan2, __pyx_k_atan2, sizeof(__pyx_k_atan2), 0, 0, 1, 1},
    {&__pyx_n_s_av, __pyx_k_av, sizeof(__pyx_k_av), 0, 0, 1, 1},
    {&__pyx_n_s_avunit, __pyx_k_avunit, sizeof(__pyx_k_avunit), 0, 0, 1, 1},
    {&__pyx_n_s_ax, __pyx_k_ax, sizeof(__pyx_k_ax), 0, 0, 1, 1},
    {&__pyx_n_s_axis, __pyx_k_axis, sizeof(__pyx_k_axis), 0, 0, 1, 1},
    {&__pyx_n_s_axisX, __pyx_k_axisX, sizeof(__pyx_k_axisX), 0, 0, 1, 1},
    {&__pyx_n_s_axisY, __pyx_k_axisY, sizeof(__pyx_k_axisY), 0, 0, 1, 1},
    {&__pyx_n_s_axisZ, __pyx_k_axisZ, sizeof(__pyx_k_axisZ), 0, 0, 1, 1},
    {&__pyx_n_s_b, __pyx_k_b, sizeof(__pyx_k_b), 0, 0, 1, 1},
    {&__pyx_n_s_b0, __pyx_k_b0, sizeof(__pyx_k_b0), 0, 0, 1, 1},
    {&__pyx_n_s_bInsideA, __pyx_k_bInsideA, sizeof(__pyx_k_bInsideA), 0, 0, 1,
     1},
    {&__pyx_n_s_bbsp, __pyx_k_bbsp, sizeof(__pyx_k_bbsp), 0, 0, 1, 1},
    {&__pyx_n_s_bdist, __pyx_k_bdist, sizeof(__pyx_k_bdist), 0, 0, 1, 1},
    {&__pyx_n_s_bpOnA, __pyx_k_bpOnA, sizeof(__pyx_k_bpOnA), 0, 0, 1, 1},
    {&__pyx_n_s_bplane, __pyx_k_bplane, sizeof(__pyx_k_bplane), 0, 0, 1, 1},
    {&__pyx_n_s_bpoly, __pyx_k_bpoly, sizeof(__pyx_k_bpoly), 0, 0, 1, 1},
    {&__pyx_n_s_bpolygons, __pyx_k_bpolygons, sizeof(__pyx_k_bpolygons), 0, 0,
     1, 1},
    {&__pyx_n_s_build, __pyx_k_build, sizeof(__pyx_k_build), 0, 0, 1, 1},
    {&__pyx_n_s_bv, __pyx_k_bv, sizeof(__pyx_k_bv), 0, 0, 1, 1},
    {&__pyx_n_s_bvOnA, __pyx_k_bvOnA, sizeof(__pyx_k_bvOnA), 0, 0, 1, 1},
    {&__pyx_n_s_bvunit, __pyx_k_bvunit, sizeof(__pyx_k_bvunit), 0, 0, 1, 1},
    {&__pyx_n_s_c, __pyx_k_c, sizeof(__pyx_k_c), 0, 0, 1, 1},
    {&__pyx_n_s_cell, __pyx_k_cell, sizeof(__pyx_k_cell), 0, 0, 1, 1},
    {&__pyx_n_s_cells, __pyx_k_cells, sizeof(__pyx_k_cells), 0, 0, 1, 1},
    {&__pyx_n_s_center, __pyx_k_center, sizeof(__pyx_k_center), 0, 0, 1, 1},
    {&__pyx_n_u_center, __pyx_k_center, sizeof(__pyx_k_center), 0, 1, 0, 1},
    {&__pyx_n_s_checksum, __pyx_k_checksum, sizeof(__pyx_k_checksum), 0, 0, 1,
     1},
    {&__pyx_n_s_cline_in_traceback, __pyx_k_cline_in_traceback,
     sizeof(__pyx_k_cline_in_traceback), 0, 0, 1, 1},
    {&__pyx_n_s_clipTo, __pyx_k_clipTo, sizeof(__pyx_k_clipTo), 0, 0, 1, 1},
    {&__pyx_n_s_clone, __pyx_k_clone, sizeof(__pyx_k_clone), 0, 0, 1, 1},
    {&__pyx_n_s_cls, __pyx_k_cls, sizeof(__pyx_k_cls), 0, 0, 1, 1},
    {&__pyx_n_s_cone, __pyx_k_cone, sizeof(__pyx_k_cone), 0, 0, 1, 1},
    {&__pyx_n_s_convexHull, __pyx_k_convexHull, sizeof(__pyx_k_convexHull), 0,
     0, 1, 1},
    {&__pyx_n_s_copl, __pyx_k_copl, sizeof(__pyx_k_copl), 0, 0, 1, 1},
    {&__pyx_n_s_coplanar, __pyx_k_coplanar, sizeof(__pyx_k_coplanar), 0, 0, 1,
     1},
    {&__pyx_n_s_coplanarIntersection, __pyx_k_coplanarIntersection,
     sizeof(__pyx_k_coplanarIntersection), 0, 0, 1, 1},
    {&__pyx_n_s_coplanarPolys, __pyx_k_coplanarPolys,
     sizeof(__pyx_k_coplanarPolys), 0, 0, 1, 1},
    {&__pyx_n_s_cos, __pyx_k_cos, sizeof(__pyx_k_cos), 0, 0, 1, 1},
    {&__pyx_n_s_cosAngle, __pyx_k_cosAngle, sizeof(__pyx_k_cosAngle), 0, 0, 1,
     1},
    {&__pyx_n_s_cosTaperAngle, __pyx_k_cosTaperAngle,
     sizeof(__pyx_k_cosTaperAngle), 0, 0, 1, 1},
    {&__pyx_n_s_count, __pyx_k_count, sizeof(__pyx_k_count), 0, 0, 1, 1},
    {&__pyx_n_s_cross, __pyx_k_cross, sizeof(__pyx_k_cross), 0, 0, 1, 1},
    {&__pyx_n_s_csg, __pyx_k_csg, sizeof(__pyx_k_csg), 0, 0, 1, 1},
    {&__pyx_n_s_cube, __pyx_k_cube, sizeof(__pyx_k_cube), 0, 0, 1, 1},
    {&__pyx_n_s_cylinder, __pyx_k_cylinder, sizeof(__pyx_k_cylinder), 0, 0, 1,
     1},
    {&__pyx_n_s_d, __pyx_k_d, sizeof(__pyx_k_d), 0, 0, 1, 1},
    {&__pyx_n_s_dPhi, __pyx_k_dPhi, sizeof(__pyx_k_dPhi), 0, 0, 1, 1},
    {&__pyx_n_s_dTheta, __pyx_k_dTheta, sizeof(__pyx_k_dTheta), 0, 0, 1, 1},
    {&__pyx_n_s_denom, __pyx_k_denom, sizeof(__pyx_k_denom), 0, 0, 1, 1},
    {&__pyx_n_s_disp, __pyx_k_disp, sizeof(__pyx_k_disp), 0, 0, 1, 1},
    {&__pyx_n_s_do_intersect, __pyx_k_do_intersect,
     sizeof(__pyx_k_do_intersect), 0, 0, 1, 1},
    {&__pyx_n_s_doc, __pyx_k_doc, sizeof(__pyx_k_doc), 0, 0, 1, 1},
    {&__pyx_n_s_dot, __pyx_k_dot, sizeof(__pyx_k_dot), 0, 0, 1, 1},
    {&__pyx_n_s_dt, __pyx_k_dt, sizeof(__pyx_k_dt), 0, 0, 1, 1},
    {&__pyx_n_s_e, __pyx_k_e, sizeof(__pyx_k_e), 0, 0, 1, 1},
    {&__pyx_n_s_encode, __pyx_k_encode, sizeof(__pyx_k_encode), 0, 0, 1, 1},
    {&__pyx_n_s_end, __pyx_k_end, sizeof(__pyx_k_end), 0, 0, 1, 1},
    {&__pyx_n_u_end, __pyx_k_end, sizeof(__pyx_k_end), 0, 1, 0, 1},
    {&__pyx_n_s_enter, __pyx_k_enter, sizeof(__pyx_k_enter), 0, 0, 1, 1},
    {&__pyx_n_s_exit, __pyx_k_exit, sizeof(__pyx_k_exit), 0, 0, 1, 1},
    {&__pyx_n_s_f, __pyx_k_f, sizeof(__pyx_k_f), 0, 0, 1, 1},
    {&__pyx_n_s_fabs, __pyx_k_fabs, sizeof(__pyx_k_fabs), 0, 0, 1, 1},
    {&__pyx_n_s_filename, __pyx_k_filename, sizeof(__pyx_k_filename), 0, 0, 1,
     1},
    {&__pyx_n_s_first, __pyx_k_first, sizeof(__pyx_k_first), 0, 0, 1, 1},
    {&__pyx_n_s_flip, __pyx_k_flip, sizeof(__pyx_k_flip), 0, 0, 1, 1},
    {&__pyx_n_s_format, __pyx_k_format, sizeof(__pyx_k_format), 0, 0, 1, 1},
    {&__pyx_n_s_fromPolygons, __pyx_k_fromPolygons,
     sizeof(__pyx_k_fromPolygons), 0, 0, 1, 1},
    {&__pyx_n_s_functools, __pyx_k_functools, sizeof(__pyx_k_functools), 0, 0,
     1, 1},
    {&__pyx_n_s_geom, __pyx_k_geom, sizeof(__pyx_k_geom), 0, 0, 1, 1},
    {&__pyx_n_s_get, __pyx_k_get, sizeof(__pyx_k_get), 0, 0, 1, 1},
    {&__pyx_n_s_getNumberPolys, __pyx_k_getNumberPolys,
     sizeof(__pyx_k_getNumberPolys), 0, 0, 1, 1},
    {&__pyx_n_s_hash, __pyx_k_hash, sizeof(__pyx_k_hash), 0, 0, 1, 1},
    {&__pyx_n_s_hashlib, __pyx_k_hashlib, sizeof(__pyx_k_hashlib), 0, 0, 1, 1},
    {&__pyx_n_s_hexdigest, __pyx_k_hexdigest, sizeof(__pyx_k_hexdigest), 0, 0,
     1, 1},
    {&__pyx_n_s_hull, __pyx_k_hull, sizeof(__pyx_k_hull), 0, 0, 1, 1},
    {&__pyx_n_s_i, __pyx_k_i, sizeof(__pyx_k_i), 0, 0, 1, 1},
    {&__pyx_n_s_i0, __pyx_k_i0, sizeof(__pyx_k_i0), 0, 0, 1, 1},
    {&__pyx_n_s_i1, __pyx_k_i1, sizeof(__pyx_k_i1), 0, 0, 1, 1},
    {&__pyx_n_s_i2, __pyx_k_i2, sizeof(__pyx_k_i2), 0, 0, 1, 1},
    {&__pyx_n_s_import, __pyx_k_import, sizeof(__pyx_k_import), 0, 0, 1, 1},
    {&__pyx_n_s_index, __pyx_k_index, sizeof(__pyx_k_index), 0, 0, 1, 1},
    {&__pyx_n_s_init, __pyx_k_init, sizeof(__pyx_k_init), 0, 0, 1, 1},
    {&__pyx_n_s_inter, __pyx_k_inter, sizeof(__pyx_k_inter), 0, 0, 1, 1},
    {&__pyx_n_s_interpolate, __pyx_k_interpolate, sizeof(__pyx_k_interpolate),
     0, 0, 1, 1},
    {&__pyx_n_s_intersect, __pyx_k_intersect, sizeof(__pyx_k_intersect), 0, 0,
     1, 1},
    {&__pyx_n_s_inverse, __pyx_k_inverse, sizeof(__pyx_k_inverse), 0, 0, 1, 1},
    {&__pyx_n_s_invert, __pyx_k_invert, sizeof(__pyx_k_invert), 0, 0, 1, 1},
    {&__pyx_n_s_isNull, __pyx_k_isNull, sizeof(__pyx_k_isNull), 0, 0, 1, 1},
    {&__pyx_n_s_isY, __pyx_k_isY, sizeof(__pyx_k_isY), 0, 0, 1, 1},
    {&__pyx_n_s_itemgetter, __pyx_k_itemgetter, sizeof(__pyx_k_itemgetter), 0,
     0, 1, 1},
    {&__pyx_n_s_items, __pyx_k_items, sizeof(__pyx_k_items), 0, 0, 1, 1},
    {&__pyx_n_s_j, __pyx_k_j, sizeof(__pyx_k_j), 0, 0, 1, 1},
    {&__pyx_n_s_j0, __pyx_k_j0, sizeof(__pyx_k_j0), 0, 0, 1, 1},
    {&__pyx_n_s_j1, __pyx_k_j1, sizeof(__pyx_k_j1), 0, 0, 1, 1},
    {&__pyx_n_s_j2, __pyx_k_j2, sizeof(__pyx_k_j2), 0, 0, 1, 1},
    {&__pyx_n_s_key, __pyx_k_key, sizeof(__pyx_k_key), 0, 0, 1, 1},
    {&__pyx_n_s_kwargs, __pyx_k_kwargs, sizeof(__pyx_k_kwargs), 0, 0, 1, 1},
    {&__pyx_n_s_length, __pyx_k_length, sizeof(__pyx_k_length), 0, 0, 1, 1},
    {&__pyx_n_s_loc, __pyx_k_loc, sizeof(__pyx_k_loc), 0, 0, 1, 1},
    {&__pyx_n_s_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 0, 1, 1},
    {&__pyx_n_s_map, __pyx_k_map, sizeof(__pyx_k_map), 0, 0, 1, 1},
    {&__pyx_n_s_md5, __pyx_k_md5, sizeof(__pyx_k_md5), 0, 0, 1, 1},
    {&__pyx_n_s_md5_2, __pyx_k_md5_2, sizeof(__pyx_k_md5_2), 0, 0, 1, 1},
    {&__pyx_n_s_metaclass, __pyx_k_metaclass, sizeof(__pyx_k_metaclass), 0, 0,
     1, 1},
    {&__pyx_n_s_midNormal, __pyx_k_midNormal, sizeof(__pyx_k_midNormal), 0, 0,
     1, 1},
    {&__pyx_n_s_midPos, __pyx_k_midPos, sizeof(__pyx_k_midPos), 0, 0, 1, 1},
    {&__pyx_n_s_midVert, __pyx_k_midVert, sizeof(__pyx_k_midVert), 0, 0, 1, 1},
    {&__pyx_n_s_minus, __pyx_k_minus, sizeof(__pyx_k_minus), 0, 0, 1, 1},
    {&__pyx_n_s_module, __pyx_k_module, sizeof(__pyx_k_module), 0, 0, 1, 1},
    {&__pyx_n_s_mul, __pyx_k_mul, sizeof(__pyx_k_mul), 0, 0, 1, 1},
    {&__pyx_n_s_n0, __pyx_k_n0, sizeof(__pyx_k_n0), 0, 0, 1, 1},
    {&__pyx_n_s_n1, __pyx_k_n1, sizeof(__pyx_k_n1), 0, 0, 1, 1},
    {&__pyx_n_s_nAvg, __pyx_k_nAvg, sizeof(__pyx_k_nAvg), 0, 0, 1, 1},
    {&__pyx_n_s_name, __pyx_k_name, sizeof(__pyx_k_name), 0, 0, 1, 1},
    {&__pyx_n_s_negated, __pyx_k_negated, sizeof(__pyx_k_negated), 0, 0, 1, 1},
    {&__pyx_n_s_newCSG, __pyx_k_newCSG, sizeof(__pyx_k_newCSG), 0, 0, 1, 1},
    {&__pyx_n_s_newPoly, __pyx_k_newPoly, sizeof(__pyx_k_newPoly), 0, 0, 1, 1},
    {&__pyx_n_s_newVector, __pyx_k_newVector, sizeof(__pyx_k_newVector), 0, 0,
     1, 1},
    {&__pyx_n_s_newVerts, __pyx_k_newVerts, sizeof(__pyx_k_newVerts), 0, 0, 1,
     1},
    {&__pyx_n_s_nhull, __pyx_k_nhull, sizeof(__pyx_k_nhull), 0, 0, 1, 1},
    {&__pyx_n_s_normal, __pyx_k_normal, sizeof(__pyx_k_normal), 0, 0, 1, 1},
    {&__pyx_n_s_normalBlend, __pyx_k_normalBlend, sizeof(__pyx_k_normalBlend),
     0, 0, 1, 1},
    {&__pyx_n_s_np, __pyx_k_np, sizeof(__pyx_k_np), 0, 0, 1, 1},
    {&__pyx_n_s_numCells, __pyx_k_numCells, sizeof(__pyx_k_numCells), 0, 0, 1,
     1},
    {&__pyx_n_s_numVerts, __pyx_k_numVerts, sizeof(__pyx_k_numVerts), 0, 0, 1,
     1},
    {&__pyx_n_s_numpy, __pyx_k_numpy, sizeof(__pyx_k_numpy), 0, 0, 1, 1},
    {&__pyx_n_s_object, __pyx_k_object, sizeof(__pyx_k_object), 0, 0, 1, 1},
    {&__pyx_n_s_offset, __pyx_k_offset, sizeof(__pyx_k_offset), 0, 0, 1, 1},
    {&__pyx_n_s_open, __pyx_k_open, sizeof(__pyx_k_open), 0, 0, 1, 1},
    {&__pyx_n_s_operator, __pyx_k_operator, sizeof(__pyx_k_operator), 0, 0, 1,
     1},
    {&__pyx_n_s_out, __pyx_k_out, sizeof(__pyx_k_out), 0, 0, 1, 1},
    {&__pyx_n_s_p, __pyx_k_p, sizeof(__pyx_k_p), 0, 0, 1, 1},
    {&__pyx_n_s_p0, __pyx_k_p0, sizeof(__pyx_k_p0), 0, 0, 1, 1},
    {&__pyx_n_s_p1, __pyx_k_p1, sizeof(__pyx_k_p1), 0, 0, 1, 1},
    {&__pyx_n_s_p2, __pyx_k_p2, sizeof(__pyx_k_p2), 0, 0, 1, 1},
    {&__pyx_n_s_phi, __pyx_k_phi, sizeof(__pyx_k_phi), 0, 0, 1, 1},
    {&__pyx_n_s_pi, __pyx_k_pi, sizeof(__pyx_k_pi), 0, 0, 1, 1},
    {&__pyx_n_s_plane, __pyx_k_plane, sizeof(__pyx_k_plane), 0, 0, 1, 1},
    {&__pyx_n_s_ploc, __pyx_k_ploc, sizeof(__pyx_k_ploc), 0, 0, 1, 1},
    {&__pyx_n_s_plus, __pyx_k_plus, sizeof(__pyx_k_plus), 0, 0, 1, 1},
    {&__pyx_n_s_point, __pyx_k_point, sizeof(__pyx_k_point), 0, 0, 1, 1},
    {&__pyx_n_s_points, __pyx_k_points, sizeof(__pyx_k_points), 0, 0, 1, 1},
    {&__pyx_n_s_poly, __pyx_k_poly, sizeof(__pyx_k_poly), 0, 0, 1, 1},
    {&__pyx_n_s_polyEdgeIntersection, __pyx_k_polyEdgeIntersection,
     sizeof(__pyx_k_polyEdgeIntersection), 0, 0, 1, 1},
    {&__pyx_n_s_polySide, __pyx_k_polySide, sizeof(__pyx_k_polySide), 0, 0, 1,
     1},
    {&__pyx_n_s_polyStart, __pyx_k_polyStart, sizeof(__pyx_k_polyStart), 0, 0,
     1, 1},
    {&__pyx_n_s_polyVertsInside, __pyx_k_polyVertsInside,
     sizeof(__pyx_k_polyVertsInside), 0, 0, 1, 1},
    {&__pyx_n_s_polygon, __pyx_k_polygon, sizeof(__pyx_k_polygon), 0, 0, 1, 1},
    {&__pyx_n_s_polygonCount, __pyx_k_polygonCount,
     sizeof(__pyx_k_polygonCount), 0, 0, 1, 1},
    {&__pyx_n_s_polygonType, __pyx_k_polygonType, sizeof(__pyx_k_polygonType),
     0, 0, 1, 1},
    {&__pyx_n_s_polygons, __pyx_k_polygons, sizeof(__pyx_k_polygons), 0, 0, 1,
     1},
    {&__pyx_n_s_polys, __pyx_k_polys, sizeof(__pyx_k_polys), 0, 0, 1, 1},
    {&__pyx_n_s_pos, __pyx_k_pos, sizeof(__pyx_k_pos), 0, 0, 1, 1},
    {&__pyx_n_s_positions, __pyx_k_positions, sizeof(__pyx_k_positions), 0, 0,
     1, 1},
    {&__pyx_n_s_prepare, __pyx_k_prepare, sizeof(__pyx_k_prepare), 0, 0, 1, 1},
    {&__pyx_kp_u_pycsg_output, __pyx_k_pycsg_output,
     sizeof(__pyx_k_pycsg_output), 0, 1, 0, 0},
    {&__pyx_n_s_pyg4ometry_pycsg_core, __pyx_k_pyg4ometry_pycsg_core,
     sizeof(__pyx_k_pyg4ometry_pycsg_core), 0, 0, 1, 1},
    {&__pyx_n_s_q_next, __pyx_k_q_next, sizeof(__pyx_k_q_next), 0, 0, 1, 1},
    {&__pyx_n_s_q_now, __pyx_k_q_now, sizeof(__pyx_k_q_now), 0, 0, 1, 1},
    {&__pyx_n_s_qualname, __pyx_k_qualname, sizeof(__pyx_k_qualname), 0, 0, 1,
     1},
    {&__pyx_n_s_r, __pyx_k_r, sizeof(__pyx_k_r), 0, 0, 1, 1},
    {&__pyx_n_s_radius, __pyx_k_radius, sizeof(__pyx_k_radius), 0, 0, 1, 1},
    {&__pyx_n_u_radius, __pyx_k_radius, sizeof(__pyx_k_radius), 0, 1, 0, 1},
    {&__pyx_n_s_range, __pyx_k_range, sizeof(__pyx_k_range), 0, 0, 1, 1},
    {&__pyx_n_s_ray, __pyx_k_ray, sizeof(__pyx_k_ray), 0, 0, 1, 1},
    {&__pyx_n_s_reduce, __pyx_k_reduce, sizeof(__pyx_k_reduce), 0, 0, 1, 1},
    {&__pyx_n_s_refine, __pyx_k_refine, sizeof(__pyx_k_refine), 0, 0, 1, 1},
    {&__pyx_n_s_rotate, __pyx_k_rotate, sizeof(__pyx_k_rotate), 0, 0, 1, 1},
    {&__pyx_n_s_s, __pyx_k_s, sizeof(__pyx_k_s), 0, 0, 1, 1},
    {&__pyx_n_s_saveVTK, __pyx_k_saveVTK, sizeof(__pyx_k_saveVTK), 0, 0, 1, 1},
    {&__pyx_n_s_scale, __pyx_k_scale, sizeof(__pyx_k_scale), 0, 0, 1, 1},
    {&__pyx_n_s_second, __pyx_k_second, sizeof(__pyx_k_second), 0, 0, 1, 1},
    {&__pyx_n_s_self, __pyx_k_self, sizeof(__pyx_k_self), 0, 0, 1, 1},
    {&__pyx_n_s_shared, __pyx_k_shared, sizeof(__pyx_k_shared), 0, 0, 1, 1},
    {&__pyx_n_s_sin, __pyx_k_sin, sizeof(__pyx_k_sin), 0, 0, 1, 1},
    {&__pyx_n_s_sinAngle, __pyx_k_sinAngle, sizeof(__pyx_k_sinAngle), 0, 0, 1,
     1},
    {&__pyx_n_s_sinTaperAngle, __pyx_k_sinTaperAngle,
     sizeof(__pyx_k_sinTaperAngle), 0, 0, 1, 1},
    {&__pyx_n_s_slices, __pyx_k_slices, sizeof(__pyx_k_slices), 0, 0, 1, 1},
    {&__pyx_n_u_slices, __pyx_k_slices, sizeof(__pyx_k_slices), 0, 1, 0, 1},
    {&__pyx_n_s_soln, __pyx_k_soln, sizeof(__pyx_k_soln), 0, 0, 1, 1},
    {&__pyx_n_s_sorted, __pyx_k_sorted, sizeof(__pyx_k_sorted), 0, 0, 1, 1},
    {&__pyx_n_s_sortedVertexIndex, __pyx_k_sortedVertexIndex,
     sizeof(__pyx_k_sortedVertexIndex), 0, 0, 1, 1},
    {&__pyx_n_s_sphere, __pyx_k_sphere, sizeof(__pyx_k_sphere), 0, 0, 1, 1},
    {&__pyx_n_s_split, __pyx_k_split, sizeof(__pyx_k_split), 0, 0, 1, 1},
    {&__pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
     __pyx_k_src_pyg4ometry_pycsg_core_pyx,
     sizeof(__pyx_k_src_pyg4ometry_pycsg_core_pyx), 0, 0, 1, 0},
    {&__pyx_n_s_stack, __pyx_k_stack, sizeof(__pyx_k_stack), 0, 0, 1, 1},
    {&__pyx_n_s_stacks, __pyx_k_stacks, sizeof(__pyx_k_stacks), 0, 0, 1, 1},
    {&__pyx_n_u_stacks, __pyx_k_stacks, sizeof(__pyx_k_stacks), 0, 1, 0, 1},
    {&__pyx_n_s_start, __pyx_k_start, sizeof(__pyx_k_start), 0, 0, 1, 1},
    {&__pyx_n_u_start, __pyx_k_start, sizeof(__pyx_k_start), 0, 1, 0, 1},
    {&__pyx_n_s_startNormal, __pyx_k_startNormal, sizeof(__pyx_k_startNormal),
     0, 0, 1, 1},
    {&__pyx_n_s_sub, __pyx_k_sub, sizeof(__pyx_k_sub), 0, 0, 1, 1},
    {&__pyx_n_s_subtract, __pyx_k_subtract, sizeof(__pyx_k_subtract), 0, 0, 1,
     1},
    {&__pyx_n_s_t, __pyx_k_t, sizeof(__pyx_k_t), 0, 0, 1, 1},
    {&__pyx_n_s_t0, __pyx_k_t0, sizeof(__pyx_k_t0), 0, 0, 1, 1},
    {&__pyx_n_s_t1, __pyx_k_t1, sizeof(__pyx_k_t1), 0, 0, 1, 1},
    {&__pyx_n_s_taperAngle, __pyx_k_taperAngle, sizeof(__pyx_k_taperAngle), 0,
     0, 1, 1},
    {&__pyx_n_s_test, __pyx_k_test, sizeof(__pyx_k_test), 0, 0, 1, 1},
    {&__pyx_n_s_testGeom, __pyx_k_testGeom, sizeof(__pyx_k_testGeom), 0, 0, 1,
     1},
    {&__pyx_n_s_theta, __pyx_k_theta, sizeof(__pyx_k_theta), 0, 0, 1, 1},
    {&__pyx_n_s_times, __pyx_k_times, sizeof(__pyx_k_times), 0, 0, 1, 1},
    {&__pyx_n_s_toPolygons, __pyx_k_toPolygons, sizeof(__pyx_k_toPolygons), 0,
     0, 1, 1},
    {&__pyx_n_s_toVerticesAndPolygons, __pyx_k_toVerticesAndPolygons,
     sizeof(__pyx_k_toVerticesAndPolygons), 0, 0, 1, 1},
    {&__pyx_n_s_translate, __pyx_k_translate, sizeof(__pyx_k_translate), 0, 0,
     1, 1},
    {&__pyx_n_s_u1, __pyx_k_u1, sizeof(__pyx_k_u1), 0, 0, 1, 1},
    {&__pyx_n_s_u2, __pyx_k_u2, sizeof(__pyx_k_u2), 0, 0, 1, 1},
    {&__pyx_n_s_union, __pyx_k_union, sizeof(__pyx_k_union), 0, 0, 1, 1},
    {&__pyx_n_s_unit, __pyx_k_unit, sizeof(__pyx_k_unit), 0, 0, 1, 1},
    {&__pyx_n_s_v, __pyx_k_v, sizeof(__pyx_k_v), 0, 0, 1, 1},
    {&__pyx_n_s_vA, __pyx_k_vA, sizeof(__pyx_k_vA), 0, 0, 1, 1},
    {&__pyx_n_s_vCosA, __pyx_k_vCosA, sizeof(__pyx_k_vCosA), 0, 0, 1, 1},
    {&__pyx_n_s_vCount, __pyx_k_vCount, sizeof(__pyx_k_vCount), 0, 0, 1, 1},
    {&__pyx_n_s_vKey, __pyx_k_vKey, sizeof(__pyx_k_vKey), 0, 0, 1, 1},
    {&__pyx_n_s_vPerp, __pyx_k_vPerp, sizeof(__pyx_k_vPerp), 0, 0, 1, 1},
    {&__pyx_n_s_vPerpLen, __pyx_k_vPerpLen, sizeof(__pyx_k_vPerpLen), 0, 0, 1,
     1},
    {&__pyx_n_s_vSinA, __pyx_k_vSinA, sizeof(__pyx_k_vSinA), 0, 0, 1, 1},
    {&__pyx_n_s_vert, __pyx_k_vert, sizeof(__pyx_k_vert), 0, 0, 1, 1},
    {&__pyx_n_s_vertexCount, __pyx_k_vertexCount, sizeof(__pyx_k_vertexCount),
     0, 0, 1, 1},
    {&__pyx_n_s_vertexIndexMap, __pyx_k_vertexIndexMap,
     sizeof(__pyx_k_vertexIndexMap), 0, 0, 1, 1},
    {&__pyx_n_s_vertices, __pyx_k_vertices, sizeof(__pyx_k_vertices), 0, 0, 1,
     1},
    {&__pyx_n_s_verticesE, __pyx_k_verticesE, sizeof(__pyx_k_verticesE), 0, 0,
     1, 1},
    {&__pyx_n_s_verticesN, __pyx_k_verticesN, sizeof(__pyx_k_verticesN), 0, 0,
     1, 1},
    {&__pyx_n_s_verticesS, __pyx_k_verticesS, sizeof(__pyx_k_verticesS), 0, 0,
     1, 1},
    {&__pyx_n_s_verticesW, __pyx_k_verticesW, sizeof(__pyx_k_verticesW), 0, 0,
     1, 1},
    {&__pyx_n_s_verts, __pyx_k_verts, sizeof(__pyx_k_verts), 0, 0, 1, 1},
    {&__pyx_n_s_vertsInside, __pyx_k_vertsInside, sizeof(__pyx_k_vertsInside),
     0, 0, 1, 1},
    {&__pyx_n_s_vertsInter, __pyx_k_vertsInter, sizeof(__pyx_k_vertsInter), 0,
     0, 1, 1},
    {&__pyx_n_s_vs, __pyx_k_vs, sizeof(__pyx_k_vs), 0, 0, 1, 1},
    {&__pyx_kp_u_vtk_DataFile_Version_3_0, __pyx_k_vtk_DataFile_Version_3_0,
     sizeof(__pyx_k_vtk_DataFile_Version_3_0), 0, 1, 0, 0},
    {&__pyx_n_s_w, __pyx_k_w, sizeof(__pyx_k_w), 0, 0, 1, 1},
    {&__pyx_n_u_w, __pyx_k_w, sizeof(__pyx_k_w), 0, 1, 0, 1},
    {&__pyx_n_s_write, __pyx_k_write, sizeof(__pyx_k_write), 0, 0, 1, 1},
    {&__pyx_n_s_x, __pyx_k_x, sizeof(__pyx_k_x), 0, 0, 1, 1},
    {&__pyx_n_s_y, __pyx_k_y, sizeof(__pyx_k_y), 0, 0, 1, 1},
    {&__pyx_n_s_z, __pyx_k_z, sizeof(__pyx_k_z), 0, 0, 1, 1},
    {0, 0, 0, 0, 0, 0, 0}};
static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
  __pyx_builtin_object = __Pyx_GetBuiltinName(__pyx_n_s_object);
  if (!__pyx_builtin_object)
    __PYX_ERR(0, 12, __pyx_L1_error)
  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range);
  if (!__pyx_builtin_range)
    __PYX_ERR(0, 134, __pyx_L1_error)
  __pyx_builtin_sorted = __Pyx_GetBuiltinName(__pyx_n_s_sorted);
  if (!__pyx_builtin_sorted)
    __PYX_ERR(0, 225, __pyx_L1_error)
  __pyx_builtin_open = __Pyx_GetBuiltinName(__pyx_n_s_open);
  if (!__pyx_builtin_open)
    __PYX_ERR(0, 239, __pyx_L1_error)
  __pyx_builtin_ZeroDivisionError =
      __Pyx_GetBuiltinName(__pyx_n_s_ZeroDivisionError);
  if (!__pyx_builtin_ZeroDivisionError)
    __PYX_ERR(0, 453, __pyx_L1_error)
  __pyx_builtin_map = __Pyx_GetBuiltinName(__pyx_n_s_map);
  if (!__pyx_builtin_map)
    __PYX_ERR(0, 615, __pyx_L1_error)
  return 0;
__pyx_L1_error:;
  return -1;
}

static CYTHON_SMALL_CODE int __Pyx_InitCachedConstants(void) {
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext(
      "__Pyx_InitCachedConstants", 0);

  /* "pyg4ometry/pycsg/core.pyx":174
   *         sinAngle = _np.sin(_np.pi * angleDeg / 180.)
   *
   *         def newVector(v):             # <<<<<<<<<<<<<<
   *             vA = v.dot(ax)
   *             vPerp = v.minus(ax.times(vA))
   */
  __pyx_tuple_ = PyTuple_Pack(8, __pyx_n_s_v, __pyx_n_s_vA, __pyx_n_s_vPerp,
                              __pyx_n_s_vPerpLen, __pyx_n_s_u1, __pyx_n_s_u2,
                              __pyx_n_s_vCosA, __pyx_n_s_vSinA);
  if (unlikely(!__pyx_tuple_))
    __PYX_ERR(0, 174, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple_);
  __Pyx_GIVEREF(__pyx_tuple_);
  __pyx_codeobj__2 = (PyObject *)__Pyx_PyCode_New(
      1, 0, 8, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple_, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_newVector, 174, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__2))
    __PYX_ERR(0, 174, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":239
   *         Save polygons in VTK file.
   *         """
   *         with open(filename, 'w') as f:             # <<<<<<<<<<<<<<
   *             f.write('# vtk DataFile Version 3.0\n')
   *             f.write('pycsg output\n')
   */
  __pyx_tuple__5 = PyTuple_Pack(3, Py_None, Py_None, Py_None);
  if (unlikely(!__pyx_tuple__5))
    __PYX_ERR(0, 239, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__5);
  __Pyx_GIVEREF(__pyx_tuple__5);

  /* "pyg4ometry/pycsg/core.pyx":356
   *         polygons = []
   *
   *         def coplanarPolys(apoly,bpoly) :             # <<<<<<<<<<<<<<
   *             COPLANAR = 0  # all the vertices are within EPSILON distance
   * from plane FRONT = 1  # all the vertices are in front of the plane
   */
  __pyx_tuple__6 = PyTuple_Pack(
      7, __pyx_n_s_apoly, __pyx_n_s_bpoly, __pyx_n_s_COPLANAR, __pyx_n_s_FRONT,
      __pyx_n_s_BACK, __pyx_n_s_aplane, __pyx_n_s_bplane);
  if (unlikely(!__pyx_tuple__6))
    __PYX_ERR(0, 356, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__6);
  __Pyx_GIVEREF(__pyx_tuple__6);
  __pyx_codeobj__7 = (PyObject *)__Pyx_PyCode_New(
      2, 0, 7, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__6, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_coplanarPolys, 356, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__7))
    __PYX_ERR(0, 356, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":371
   *                 return False
   *
   *         def polyVertsInside(apoly, bpoly):             # <<<<<<<<<<<<<<
   *
   *             aplane = apoly.plane
   */
  __pyx_tuple__8 = PyTuple_Pack(
      11, __pyx_n_s_apoly, __pyx_n_s_bpoly, __pyx_n_s_aplane,
      __pyx_n_s_vertsInside, __pyx_n_s_i, __pyx_n_s_ploc, __pyx_n_s_j,
      __pyx_n_s_av, __pyx_n_s_avunit, __pyx_n_s_anormal, __pyx_n_s_t);
  if (unlikely(!__pyx_tuple__8))
    __PYX_ERR(0, 371, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__8);
  __Pyx_GIVEREF(__pyx_tuple__8);
  __pyx_codeobj__9 = (PyObject *)__Pyx_PyCode_New(
      2, 0, 11, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__8, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_polyVertsInside, 371, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__9))
    __PYX_ERR(0, 371, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":399
   *             return vertsInside
   *
   *         def polyEdgeIntersection(apoly, bpoly) :             #
   * <<<<<<<<<<<<<<
   *
   *             vertsInter = []
   */
  __pyx_tuple__10 = PyTuple_Pack(
      18, __pyx_n_s_apoly, __pyx_n_s_bpoly, __pyx_n_s_vertsInter, __pyx_n_s_i,
      __pyx_n_s_bv, __pyx_n_s_bvunit, __pyx_n_s_b0, __pyx_n_s_j, __pyx_n_s_av,
      __pyx_n_s_avunit, __pyx_n_s_a0, __pyx_n_s_aPlaneNormal, __pyx_n_s_denom,
      __pyx_n_s_soln, __pyx_n_s_inter, __pyx_n_s_adist, __pyx_n_s_bdist,
      __pyx_n_s_andist);
  if (unlikely(!__pyx_tuple__10))
    __PYX_ERR(0, 399, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__10);
  __Pyx_GIVEREF(__pyx_tuple__10);
  __pyx_codeobj__11 = (PyObject *)__Pyx_PyCode_New(
      2, 0, 18, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__10, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_polyEdgeIntersection, 399, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__11))
    __PYX_ERR(0, 399, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":434
   *             return vertsInter
   *
   *         def convexHull(positions,normal) :             # <<<<<<<<<<<<<<
   *
   *             if len(positions) < 3 :
   */
  __pyx_tuple__12 =
      PyTuple_Pack(10, __pyx_n_s_positions, __pyx_n_s_normal, __pyx_n_s_hull,
                   __pyx_n_s_q_now, __pyx_n_s_q_next, __pyx_n_s_nhull,
                   __pyx_n_s_p, __pyx_n_s_p1, __pyx_n_s_p2, __pyx_n_s_v);
  if (unlikely(!__pyx_tuple__12))
    __PYX_ERR(0, 434, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__12);
  __Pyx_GIVEREF(__pyx_tuple__12);
  __pyx_codeobj__13 = (PyObject *)__Pyx_PyCode_New(
      2, 0, 10, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__12, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_convexHull, 434, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__13))
    __PYX_ERR(0, 434, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":635
   *             )
   *         """
   *         c = Vector(0, 0, 0)             # <<<<<<<<<<<<<<
   *         r = [1, 1, 1]
   *         if isinstance(center, list): c = Vector(center)
   */
  __pyx_tuple__14 = PyTuple_Pack(3, __pyx_int_0, __pyx_int_0, __pyx_int_0);
  if (unlikely(!__pyx_tuple__14))
    __PYX_ERR(0, 635, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__14);
  __Pyx_GIVEREF(__pyx_tuple__14);

  /* "pyg4ometry/pycsg/core.pyx":682
   *         stacks = kwargs.get('stacks', 8)
   *         polygons = []
   *         def appendVertex(vertices, theta, phi):             #
   * <<<<<<<<<<<<<< d = Vector( _np.cos(theta) * _np.sin(phi),
   */
  __pyx_tuple__15 = PyTuple_Pack(4, __pyx_n_s_vertices, __pyx_n_s_theta,
                                 __pyx_n_s_phi, __pyx_n_s_d);
  if (unlikely(!__pyx_tuple__15))
    __PYX_ERR(0, 682, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__15);
  __Pyx_GIVEREF(__pyx_tuple__15);
  __pyx_codeobj__16 = (PyObject *)__Pyx_PyCode_New(
      3, 0, 4, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__15, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_appendVertex, 682, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__16))
    __PYX_ERR(0, 682, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":767
   *                 slices (int): Number of slices, default 16.
   *         """
   *         s = kwargs.get('start', Vector(0.0, -1.0, 0.0))             #
   * <<<<<<<<<<<<<< e = kwargs.get('end', Vector(0.0, 1.0, 0.0)) if
   * isinstance(s, list):
   */
  __pyx_tuple__17 =
      PyTuple_Pack(3, __pyx_float_0_0, __pyx_float_neg_1_0, __pyx_float_0_0);
  if (unlikely(!__pyx_tuple__17))
    __PYX_ERR(0, 767, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__17);
  __Pyx_GIVEREF(__pyx_tuple__17);

  /* "pyg4ometry/pycsg/core.pyx":768
   *         """
   *         s = kwargs.get('start', Vector(0.0, -1.0, 0.0))
   *         e = kwargs.get('end', Vector(0.0, 1.0, 0.0))             #
   * <<<<<<<<<<<<<< if isinstance(s, list): s = Vector(*s)
   */
  __pyx_tuple__18 =
      PyTuple_Pack(3, __pyx_float_0_0, __pyx_float_1_0, __pyx_float_0_0);
  if (unlikely(!__pyx_tuple__18))
    __PYX_ERR(0, 768, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__18);
  __Pyx_GIVEREF(__pyx_tuple__18);

  /* "pyg4ometry/pycsg/core.pyx":785
   *         polygons = []
   *
   *         def point(stack, angle, normalBlend):             # <<<<<<<<<<<<<<
   *             out = axisX.times(_np.cos(angle)).plus(
   *                 axisY.times(_np.sin(angle)))
   */
  __pyx_tuple__19 =
      PyTuple_Pack(6, __pyx_n_s_stack, __pyx_n_s_angle, __pyx_n_s_normalBlend,
                   __pyx_n_s_out, __pyx_n_s_pos, __pyx_n_s_normal);
  if (unlikely(!__pyx_tuple__19))
    __PYX_ERR(0, 785, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__19);
  __Pyx_GIVEREF(__pyx_tuple__19);
  __pyx_codeobj__20 = (PyObject *)__Pyx_PyCode_New(
      3, 0, 6, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__19, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_point, 785, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__20))
    __PYX_ERR(0, 785, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":845
   *         sinTaperAngle = _np.sin(taperAngle)
   *         cosTaperAngle = _np.cos(taperAngle)
   *         def point(angle):             # <<<<<<<<<<<<<<
   *             # radial direction pointing out
   *             out = axisX.times(_np.cos(angle)).plus(
   */
  __pyx_tuple__21 = PyTuple_Pack(4, __pyx_n_s_angle, __pyx_n_s_out,
                                 __pyx_n_s_pos, __pyx_n_s_normal);
  if (unlikely(!__pyx_tuple__21))
    __PYX_ERR(0, 845, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__21);
  __Pyx_GIVEREF(__pyx_tuple__21);
  __pyx_codeobj__22 = (PyObject *)__Pyx_PyCode_New(
      1, 0, 4, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__21, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_point, 845, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__22))
    __PYX_ERR(0, 845, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":12
   * from .geom import Vector as _Vector
   *
   * class CSG(object):             # <<<<<<<<<<<<<<
   *     """
   *     Constructive Solid Geometry (CSG) is a modeling technique that uses
   * Boolean
   */
  __pyx_tuple__24 = PyTuple_Pack(1, __pyx_builtin_object);
  if (unlikely(!__pyx_tuple__24))
    __PYX_ERR(0, 12, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__24);
  __Pyx_GIVEREF(__pyx_tuple__24);

  /* "pyg4ometry/pycsg/core.pyx":64
   *     Additions by Alex Pletzer (Pennsylvania State University)
   *     """
   *     def __init__(self):             # <<<<<<<<<<<<<<
   *         self.polygons = []
   *
   */
  __pyx_tuple__25 = PyTuple_Pack(1, __pyx_n_s_self);
  if (unlikely(!__pyx_tuple__25))
    __PYX_ERR(0, 64, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__25);
  __Pyx_GIVEREF(__pyx_tuple__25);
  __pyx_codeobj__26 = (PyObject *)__Pyx_PyCode_New(
      1, 0, 1, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__25, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_init, 64, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__26))
    __PYX_ERR(0, 64, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":67
   *         self.polygons = []
   *
   *     def __hash__(self):             # <<<<<<<<<<<<<<
   *         verts = _np.array(self.toVerticesAndPolygons()[0])
   *         as_string = _np.array2string(verts)
   */
  __pyx_tuple__27 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_verts,
                                 __pyx_n_s_as_string, __pyx_n_s_checksum);
  if (unlikely(!__pyx_tuple__27))
    __PYX_ERR(0, 67, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__27);
  __Pyx_GIVEREF(__pyx_tuple__27);
  __pyx_codeobj__28 = (PyObject *)__Pyx_PyCode_New(
      1, 0, 4, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__27, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_hash, 67, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__28))
    __PYX_ERR(0, 67, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":75
   *
   *     @classmethod
   *     def fromPolygons(cls, polygons, testGeom = False):             #
   * <<<<<<<<<<<<<< csg = CSG() csg.polygons = polygons
   */
  __pyx_tuple__29 = PyTuple_Pack(4, __pyx_n_s_cls, __pyx_n_s_polygons,
                                 __pyx_n_s_testGeom, __pyx_n_s_csg);
  if (unlikely(!__pyx_tuple__29))
    __PYX_ERR(0, 75, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__29);
  __Pyx_GIVEREF(__pyx_tuple__29);
  __pyx_codeobj__30 = (PyObject *)__Pyx_PyCode_New(
      3, 0, 4, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__29, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_fromPolygons, 75, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__30))
    __PYX_ERR(0, 75, __pyx_L1_error)
  __pyx_tuple__31 = PyTuple_Pack(1, ((PyObject *)Py_False));
  if (unlikely(!__pyx_tuple__31))
    __PYX_ERR(0, 75, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__31);
  __Pyx_GIVEREF(__pyx_tuple__31);

  /* "pyg4ometry/pycsg/core.pyx":80
   *         return csg
   *
   *     def clone(self):             # <<<<<<<<<<<<<<
   *         csg = CSG()
   *         csg.polygons = list([p.clone() for p in self.polygons])
   */
  __pyx_tuple__32 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_csg, __pyx_n_s_p);
  if (unlikely(!__pyx_tuple__32))
    __PYX_ERR(0, 80, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__32);
  __Pyx_GIVEREF(__pyx_tuple__32);
  __pyx_codeobj__33 = (PyObject *)__Pyx_PyCode_New(
      1, 0, 3, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__32, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_clone, 80, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__33))
    __PYX_ERR(0, 80, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":85
   *         return csg
   *
   *     def toPolygons(self):             # <<<<<<<<<<<<<<
   *         return self.polygons
   *
   */
  __pyx_tuple__34 = PyTuple_Pack(1, __pyx_n_s_self);
  if (unlikely(!__pyx_tuple__34))
    __PYX_ERR(0, 85, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__34);
  __Pyx_GIVEREF(__pyx_tuple__34);
  __pyx_codeobj__35 = (PyObject *)__Pyx_PyCode_New(
      1, 0, 1, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__34, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_toPolygons, 85, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__35))
    __PYX_ERR(0, 85, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":88
   *         return self.polygons
   *
   *     def isNull(self):             # <<<<<<<<<<<<<<
   *         return len(self.toPolygons()) == 0
   *
   */
  __pyx_tuple__36 = PyTuple_Pack(1, __pyx_n_s_self);
  if (unlikely(!__pyx_tuple__36))
    __PYX_ERR(0, 88, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__36);
  __Pyx_GIVEREF(__pyx_tuple__36);
  __pyx_codeobj__37 = (PyObject *)__Pyx_PyCode_New(
      1, 0, 1, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__36, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_isNull, 88, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__37))
    __PYX_ERR(0, 88, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":91
   *         return len(self.toPolygons()) == 0
   *
   *     def polygonCount(self):             # <<<<<<<<<<<<<<
   *         '''Return number of polygons in CSG solid'''
   *         return len(self.polygons)
   */
  __pyx_tuple__38 = PyTuple_Pack(1, __pyx_n_s_self);
  if (unlikely(!__pyx_tuple__38))
    __PYX_ERR(0, 91, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__38);
  __Pyx_GIVEREF(__pyx_tuple__38);
  __pyx_codeobj__39 = (PyObject *)__Pyx_PyCode_New(
      1, 0, 1, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__38, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_polygonCount, 91, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__39))
    __PYX_ERR(0, 91, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":95
   *         return len(self.polygons)
   *
   *     def vertexCount(self):             # <<<<<<<<<<<<<<
   *         '''Return number of vertices in CSG solid'''
   *         vCount = 0
   */
  __pyx_tuple__40 =
      PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_vCount, __pyx_n_s_p);
  if (unlikely(!__pyx_tuple__40))
    __PYX_ERR(0, 95, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__40);
  __Pyx_GIVEREF(__pyx_tuple__40);
  __pyx_codeobj__41 = (PyObject *)__Pyx_PyCode_New(
      1, 0, 3, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__40, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_vertexCount, 95, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__41))
    __PYX_ERR(0, 95, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":103
   *         return vCount
   *
   *     def refine(self):             # <<<<<<<<<<<<<<
   *         """
   *         Return a refined CSG. To each polygon, a middle point is added to
   * each edge and to the center
   */
  __pyx_tuple__42 = PyTuple_Pack(
      14, __pyx_n_s_self, __pyx_n_s_newCSG, __pyx_n_s_poly, __pyx_n_s_verts,
      __pyx_n_s_numVerts, __pyx_n_s_midPos, __pyx_n_s_midNormal,
      __pyx_n_s_midVert, __pyx_n_s_newVerts, __pyx_n_s_i, __pyx_n_s_vs,
      __pyx_n_s_newPoly, __pyx_n_s_v, __pyx_n_s_i);
  if (unlikely(!__pyx_tuple__42))
    __PYX_ERR(0, 103, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__42);
  __Pyx_GIVEREF(__pyx_tuple__42);
  __pyx_codeobj__43 = (PyObject *)__Pyx_PyCode_New(
      1, 0, 14, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__42, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_refine, 103, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__43))
    __PYX_ERR(0, 103, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":141
   *         return newCSG
   *
   *     def translate(self, disp):             # <<<<<<<<<<<<<<
   *         """
   *         Translate Geometry.
   */
  __pyx_tuple__44 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_disp, __pyx_n_s_d,
                                 __pyx_n_s_poly, __pyx_n_s_v);
  if (unlikely(!__pyx_tuple__44))
    __PYX_ERR(0, 141, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__44);
  __Pyx_GIVEREF(__pyx_tuple__44);
  __pyx_codeobj__45 = (PyObject *)__Pyx_PyCode_New(
      2, 0, 5, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__44, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_translate, 141, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__45))
    __PYX_ERR(0, 141, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":153
   *
   *
   *     def scale(self, scale):             # <<<<<<<<<<<<<<
   *         """
   *         Translate Geometry.
   */
  __pyx_tuple__46 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_scale,
                                 __pyx_n_s_d, __pyx_n_s_poly, __pyx_n_s_v);
  if (unlikely(!__pyx_tuple__46))
    __PYX_ERR(0, 153, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__46);
  __Pyx_GIVEREF(__pyx_tuple__46);
  __pyx_codeobj__47 = (PyObject *)__Pyx_PyCode_New(
      2, 0, 5, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__46, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_scale, 153, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__47))
    __PYX_ERR(0, 153, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":164
   *                 # no change to the normals
   *
   *     def rotate(self, axis, angleDeg):             # <<<<<<<<<<<<<<
   *         """
   *         Rotate geometry.
   */
  __pyx_tuple__48 = PyTuple_Pack(
      11, __pyx_n_s_self, __pyx_n_s_axis, __pyx_n_s_angleDeg, __pyx_n_s_ax,
      __pyx_n_s_cosAngle, __pyx_n_s_sinAngle, __pyx_n_s_newVector,
      __pyx_n_s_newVector, __pyx_n_s_poly, __pyx_n_s_vert, __pyx_n_s_normal);
  if (unlikely(!__pyx_tuple__48))
    __PYX_ERR(0, 164, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__48);
  __Pyx_GIVEREF(__pyx_tuple__48);
  __pyx_codeobj__49 = (PyObject *)__Pyx_PyCode_New(
      3, 0, 11, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__48, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_rotate, 164, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__49))
    __PYX_ERR(0, 164, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":194
   *                     vert.normal = newVector(vert.normal)
   *
   *     def toVerticesAndPolygons(self):             # <<<<<<<<<<<<<<
   *         """
   *         Return list of vertices, polygons (cells), and the total
   */
  __pyx_tuple__50 = PyTuple_Pack(
      15, __pyx_n_s_self, __pyx_n_s_offset, __pyx_n_s_verts, __pyx_n_s_polys,
      __pyx_n_s_vertexIndexMap, __pyx_n_s_count, __pyx_n_s_poly, __pyx_n_s_cell,
      __pyx_n_s_v, __pyx_n_s_p, __pyx_n_s_vKey, __pyx_n_s_index,
      __pyx_n_s_sortedVertexIndex, __pyx_n_s_i, __pyx_n_s_c);
  if (unlikely(!__pyx_tuple__50))
    __PYX_ERR(0, 194, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__50);
  __Pyx_GIVEREF(__pyx_tuple__50);
  __pyx_codeobj__51 = (PyObject *)__Pyx_PyCode_New(
      1, 0, 15, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__50, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_toVerticesAndPolygons, 194, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__51))
    __PYX_ERR(0, 194, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":235
   *         return verts, polys, count
   *
   *     def saveVTK(self, filename):             # <<<<<<<<<<<<<<
   *         """
   *         Save polygons in VTK file.
   */
  __pyx_tuple__52 = PyTuple_Pack(
      10, __pyx_n_s_self, __pyx_n_s_filename, __pyx_n_s_f, __pyx_n_s_verts,
      __pyx_n_s_cells, __pyx_n_s_count, __pyx_n_s_v, __pyx_n_s_numCells,
      __pyx_n_s_cell, __pyx_n_s_index);
  if (unlikely(!__pyx_tuple__52))
    __PYX_ERR(0, 235, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__52);
  __Pyx_GIVEREF(__pyx_tuple__52);
  __pyx_codeobj__53 = (PyObject *)__Pyx_PyCode_New(
      2, 0, 10, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__52, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_saveVTK, 235, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__53))
    __PYX_ERR(0, 235, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":258
   *                 f.write('\n')
   *
   *     def union(self, csg):             # <<<<<<<<<<<<<<
   *         """
   *         Return a new CSG solid representing space in either this solid or
   * in the
   */
  __pyx_tuple__54 =
      PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_csg, __pyx_n_s_a, __pyx_n_s_b);
  if (unlikely(!__pyx_tuple__54))
    __PYX_ERR(0, 258, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__54);
  __Pyx_GIVEREF(__pyx_tuple__54);
  __pyx_codeobj__55 = (PyObject *)__Pyx_PyCode_New(
      2, 0, 4, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__54, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_union, 258, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__55))
    __PYX_ERR(0, 258, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":284
   *         return CSG.fromPolygons(a.allPolygons())
   *
   *     def __add__(self, csg):             # <<<<<<<<<<<<<<
   *         return self.union(csg)
   *
   */
  __pyx_tuple__56 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_csg);
  if (unlikely(!__pyx_tuple__56))
    __PYX_ERR(0, 284, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__56);
  __Pyx_GIVEREF(__pyx_tuple__56);
  __pyx_codeobj__57 = (PyObject *)__Pyx_PyCode_New(
      2, 0, 2, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__56, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_add_2, 284, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__57))
    __PYX_ERR(0, 284, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":287
   *         return self.union(csg)
   *
   *     def subtract(self, csg):             # <<<<<<<<<<<<<<
   *         """
   *         Return a new CSG solid representing space in this solid but not in
   * the
   */
  __pyx_tuple__58 =
      PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_csg, __pyx_n_s_a, __pyx_n_s_b);
  if (unlikely(!__pyx_tuple__58))
    __PYX_ERR(0, 287, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__58);
  __Pyx_GIVEREF(__pyx_tuple__58);
  __pyx_codeobj__59 = (PyObject *)__Pyx_PyCode_New(
      2, 0, 4, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__58, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_subtract, 287, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__59))
    __PYX_ERR(0, 287, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":315
   *         return CSG.fromPolygons(a.allPolygons())
   *
   *     def __sub__(self, csg):             # <<<<<<<<<<<<<<
   *         return self.subtract(csg)
   *
   */
  __pyx_tuple__60 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_csg);
  if (unlikely(!__pyx_tuple__60))
    __PYX_ERR(0, 315, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__60);
  __Pyx_GIVEREF(__pyx_tuple__60);
  __pyx_codeobj__61 = (PyObject *)__Pyx_PyCode_New(
      2, 0, 2, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__60, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_sub, 315, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__61))
    __PYX_ERR(0, 315, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":318
   *         return self.subtract(csg)
   *
   *     def intersect(self, csg):             # <<<<<<<<<<<<<<
   *         """
   *         Return a new CSG solid representing space both this solid and in
   * the
   */
  __pyx_tuple__62 =
      PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_csg, __pyx_n_s_a, __pyx_n_s_b);
  if (unlikely(!__pyx_tuple__62))
    __PYX_ERR(0, 318, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__62);
  __Pyx_GIVEREF(__pyx_tuple__62);
  __pyx_codeobj__63 = (PyObject *)__Pyx_PyCode_New(
      2, 0, 4, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__62, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_intersect, 318, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__63))
    __PYX_ERR(0, 318, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":345
   *         return CSG.fromPolygons(a.allPolygons())
   *
   *     def coplanarIntersection(self, csg):             # <<<<<<<<<<<<<<
   *         # print 'pycsg.core.coplanarIntersection>'
   *
   */
  __pyx_tuple__64 = PyTuple_Pack(
      25, __pyx_n_s_self, __pyx_n_s_csg, __pyx_n_s_absp, __pyx_n_s_bbsp,
      __pyx_n_s_apolygons, __pyx_n_s_bpolygons, __pyx_n_s_polygons,
      __pyx_n_s_coplanarPolys, __pyx_n_s_coplanarPolys,
      __pyx_n_s_polyVertsInside, __pyx_n_s_polyVertsInside,
      __pyx_n_s_polyEdgeIntersection, __pyx_n_s_polyEdgeIntersection,
      __pyx_n_s_convexHull, __pyx_n_s_convexHull, __pyx_n_s_i, __pyx_n_s_apoly,
      __pyx_n_s_j, __pyx_n_s_bpoly, __pyx_n_s_copl, __pyx_n_s_aInsideB,
      __pyx_n_s_bInsideA, __pyx_n_s_aInterB, __pyx_n_s_points,
      __pyx_n_s_polygon);
  if (unlikely(!__pyx_tuple__64))
    __PYX_ERR(0, 345, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__64);
  __Pyx_GIVEREF(__pyx_tuple__64);
  __pyx_codeobj__65 = (PyObject *)__Pyx_PyCode_New(
      2, 0, 25, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__64, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_coplanarIntersection, 345, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__65))
    __PYX_ERR(0, 345, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":504
   *         return CSG.fromPolygons(polygons)
   *
   *     def coplanar(self, csg):             # <<<<<<<<<<<<<<
   *
   *         absp = BSPNode(self.clone().polygons)
   */
  __pyx_tuple__66 = PyTuple_Pack(
      27, __pyx_n_s_self, __pyx_n_s_csg, __pyx_n_s_absp, __pyx_n_s_bbsp,
      __pyx_n_s_apolygons, __pyx_n_s_bpolygons, __pyx_n_s_COPLANAR,
      __pyx_n_s_FRONT, __pyx_n_s_BACK, __pyx_n_s_a, __pyx_n_s_apoly,
      __pyx_n_s_aplane, __pyx_n_s_bpoly, __pyx_n_s_bplane,
      __pyx_n_s_polygonType, __pyx_n_s_i, __pyx_n_s_t, __pyx_n_s_loc,
      __pyx_n_s_aAdd, __pyx_n_s_ploc, __pyx_n_s_bv, __pyx_n_s_bvOnA,
      __pyx_n_s_bpOnA, __pyx_n_s_j, __pyx_n_s_av, __pyx_n_s_avunit,
      __pyx_n_s_anormal);
  if (unlikely(!__pyx_tuple__66))
    __PYX_ERR(0, 504, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__66);
  __Pyx_GIVEREF(__pyx_tuple__66);
  __pyx_codeobj__67 = (PyObject *)__Pyx_PyCode_New(
      2, 0, 27, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__66, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_coplanar, 504, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__67))
    __PYX_ERR(0, 504, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":606
   *         return CSG.fromPolygons(a)
   *
   *     def __mul__(self, csg):             # <<<<<<<<<<<<<<
   *         return self.intersect(csg)
   *
   */
  __pyx_tuple__68 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_csg);
  if (unlikely(!__pyx_tuple__68))
    __PYX_ERR(0, 606, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__68);
  __Pyx_GIVEREF(__pyx_tuple__68);
  __pyx_codeobj__69 = (PyObject *)__Pyx_PyCode_New(
      2, 0, 2, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__68, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_mul, 606, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__69))
    __PYX_ERR(0, 606, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":609
   *         return self.intersect(csg)
   *
   *     def inverse(self):             # <<<<<<<<<<<<<<
   *         """
   *         Return a new CSG solid with solid and empty space switched. This
   * solid is
   */
  __pyx_tuple__70 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_csg);
  if (unlikely(!__pyx_tuple__70))
    __PYX_ERR(0, 609, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__70);
  __Pyx_GIVEREF(__pyx_tuple__70);
  __pyx_codeobj__71 = (PyObject *)__Pyx_PyCode_New(
      1, 0, 2, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__70, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_inverse, 609, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__71))
    __PYX_ERR(0, 609, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":618
   *         return csg
   *
   *     def getNumberPolys(self):             # <<<<<<<<<<<<<<
   *         return len(self.polygons)
   *
   */
  __pyx_tuple__72 = PyTuple_Pack(1, __pyx_n_s_self);
  if (unlikely(!__pyx_tuple__72))
    __PYX_ERR(0, 618, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__72);
  __Pyx_GIVEREF(__pyx_tuple__72);
  __pyx_codeobj__73 = (PyObject *)__Pyx_PyCode_New(
      1, 0, 1, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__72, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_getNumberPolys, 618, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__73))
    __PYX_ERR(0, 618, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":622
   *
   *     @classmethod
   *     def cube(cls, center=[0,0,0], radius=[1,1,1]):             #
   * <<<<<<<<<<<<<<
   *         """
   *         Construct an axis-aligned solid cuboid. Optional parameters are
   * `center` and
   */
  __pyx_tuple__74 = PyTuple_Pack(8, __pyx_n_s_cls, __pyx_n_s_center,
                                 __pyx_n_s_radius, __pyx_n_s_c, __pyx_n_s_r,
                                 __pyx_n_s_polygons, __pyx_n_s_v, __pyx_n_s_i);
  if (unlikely(!__pyx_tuple__74))
    __PYX_ERR(0, 622, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__74);
  __Pyx_GIVEREF(__pyx_tuple__74);
  __pyx_codeobj__75 = (PyObject *)__Pyx_PyCode_New(
      3, 0, 8, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__74, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_cube, 622, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__75))
    __PYX_ERR(0, 622, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":660
   *
   *     @classmethod
   *     def sphere(cls, **kwargs):             # <<<<<<<<<<<<<<
   *         """ Returns a sphere.
   *
   */
  __pyx_tuple__76 = PyTuple_Pack(
      23, __pyx_n_s_cls, __pyx_n_s_kwargs, __pyx_n_s_center, __pyx_n_s_c,
      __pyx_n_s_r, __pyx_n_s_slices, __pyx_n_s_stacks, __pyx_n_s_polygons,
      __pyx_n_s_appendVertex, __pyx_n_s_appendVertex, __pyx_n_s_dTheta,
      __pyx_n_s_dPhi, __pyx_n_s_j0, __pyx_n_s_j1, __pyx_n_s_i0, __pyx_n_s_i1,
      __pyx_n_s_vertices, __pyx_n_s_j2, __pyx_n_s_i2, __pyx_n_s_verticesN,
      __pyx_n_s_verticesS, __pyx_n_s_verticesW, __pyx_n_s_verticesE);
  if (unlikely(!__pyx_tuple__76))
    __PYX_ERR(0, 660, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__76);
  __Pyx_GIVEREF(__pyx_tuple__76);
  __pyx_codeobj__77 = (PyObject *)__Pyx_PyCode_New(
      1, 0, 23, 0, CO_OPTIMIZED | CO_NEWLOCALS | CO_VARKEYWORDS,
      __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__76,
      __pyx_empty_tuple, __pyx_empty_tuple,
      __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx, __pyx_n_s_sphere, 660,
      __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__77))
    __PYX_ERR(0, 660, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":755
   *
   *     @classmethod
   *     def cylinder(cls, **kwargs):             # <<<<<<<<<<<<<<
   *         """ Returns a cylinder.
   *
   */
  __pyx_tuple__78 = PyTuple_Pack(
      21, __pyx_n_s_cls, __pyx_n_s_kwargs, __pyx_n_s_s, __pyx_n_s_e,
      __pyx_n_s_r, __pyx_n_s_slices, __pyx_n_s_ray, __pyx_n_s_axisZ,
      __pyx_n_s_isY, __pyx_n_s_axisX, __pyx_n_s_axisY, __pyx_n_s_start,
      __pyx_n_s_end, __pyx_n_s_polygons, __pyx_n_s_point, __pyx_n_s_point,
      __pyx_n_s_dt, __pyx_n_s_i, __pyx_n_s_t0, __pyx_n_s_i1, __pyx_n_s_t1);
  if (unlikely(!__pyx_tuple__78))
    __PYX_ERR(0, 755, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__78);
  __Pyx_GIVEREF(__pyx_tuple__78);
  __pyx_codeobj__79 = (PyObject *)__Pyx_PyCode_New(
      1, 0, 21, 0, CO_OPTIMIZED | CO_NEWLOCALS | CO_VARKEYWORDS,
      __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__78,
      __pyx_empty_tuple, __pyx_empty_tuple,
      __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx, __pyx_n_s_cylinder, 755,
      __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__79))
    __PYX_ERR(0, 755, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":812
   *
   *     @classmethod
   *     def cone(cls, **kwargs):             # <<<<<<<<<<<<<<
   *         """ Returns a cone.
   *
   */
  __pyx_tuple__80 = PyTuple_Pack(
      31, __pyx_n_s_cls, __pyx_n_s_kwargs, __pyx_n_s_s, __pyx_n_s_e,
      __pyx_n_s_r, __pyx_n_s_slices, __pyx_n_s_ray, __pyx_n_s_axisZ,
      __pyx_n_s_isY, __pyx_n_s_axisX, __pyx_n_s_axisY, __pyx_n_s_startNormal,
      __pyx_n_s_start, __pyx_n_s_polygons, __pyx_n_s_taperAngle,
      __pyx_n_s_sinTaperAngle, __pyx_n_s_cosTaperAngle, __pyx_n_s_point,
      __pyx_n_s_point, __pyx_n_s_dt, __pyx_n_s_i, __pyx_n_s_t0, __pyx_n_s_i1,
      __pyx_n_s_t1, __pyx_n_s_p0, __pyx_n_s_n0, __pyx_n_s_p1, __pyx_n_s_n1,
      __pyx_n_s_nAvg, __pyx_n_s_polyStart, __pyx_n_s_polySide);
  if (unlikely(!__pyx_tuple__80))
    __PYX_ERR(0, 812, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__80);
  __Pyx_GIVEREF(__pyx_tuple__80);
  __pyx_codeobj__81 = (PyObject *)__Pyx_PyCode_New(
      1, 0, 31, 0, CO_OPTIMIZED | CO_NEWLOCALS | CO_VARKEYWORDS,
      __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__80,
      __pyx_empty_tuple, __pyx_empty_tuple,
      __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx, __pyx_n_s_cone, 812,
      __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__81))
    __PYX_ERR(0, 812, __pyx_L1_error)

  /* "pyg4ometry/pycsg/core.pyx":876
   *         return CSG.fromPolygons(polygons)
   *
   * def do_intersect(first, second):             # <<<<<<<<<<<<<<
   *     return not first.intersect(second).isNull()
   */
  __pyx_tuple__82 = PyTuple_Pack(2, __pyx_n_s_first, __pyx_n_s_second);
  if (unlikely(!__pyx_tuple__82))
    __PYX_ERR(0, 876, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__82);
  __Pyx_GIVEREF(__pyx_tuple__82);
  __pyx_codeobj__83 = (PyObject *)__Pyx_PyCode_New(
      2, 0, 2, 0, CO_OPTIMIZED | CO_NEWLOCALS, __pyx_empty_bytes,
      __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__82, __pyx_empty_tuple,
      __pyx_empty_tuple, __pyx_kp_s_src_pyg4ometry_pycsg_core_pyx,
      __pyx_n_s_do_intersect, 876, __pyx_empty_bytes);
  if (unlikely(!__pyx_codeobj__83))
    __PYX_ERR(0, 876, __pyx_L1_error)
  __Pyx_RefNannyFinishContext();
  return 0;
__pyx_L1_error:;
  __Pyx_RefNannyFinishContext();
  return -1;
}

static CYTHON_SMALL_CODE int __Pyx_InitGlobals(void) {
  __pyx_umethod_PyDict_Type_get.type = (PyObject *)&PyDict_Type;
  __pyx_umethod_PyDict_Type_items.type = (PyObject *)&PyDict_Type;
  if (__Pyx_InitStrings(__pyx_string_tab) < 0)
    __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_float_0_ = PyFloat_FromDouble(0.);
  if (unlikely(!__pyx_float_0_))
    __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_float_1_ = PyFloat_FromDouble(1.);
  if (unlikely(!__pyx_float_1_))
    __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_float_0_0 = PyFloat_FromDouble(0.0);
  if (unlikely(!__pyx_float_0_0))
    __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_float_0_5 = PyFloat_FromDouble(0.5);
  if (unlikely(!__pyx_float_0_5))
    __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_float_1_0 = PyFloat_FromDouble(1.0);
  if (unlikely(!__pyx_float_1_0))
    __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_float_2_0 = PyFloat_FromDouble(2.0);
  if (unlikely(!__pyx_float_2_0))
    __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_float_180_ = PyFloat_FromDouble(180.);
  if (unlikely(!__pyx_float_180_))
    __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_float_1eneg_5 = PyFloat_FromDouble(1e-5);
  if (unlikely(!__pyx_float_1eneg_5))
    __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_float_1eneg_7 = PyFloat_FromDouble(1e-7);
  if (unlikely(!__pyx_float_1eneg_7))
    __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_float_1eneg_8 = PyFloat_FromDouble(1e-8);
  if (unlikely(!__pyx_float_1eneg_8))
    __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_float_neg_1_ = PyFloat_FromDouble(-1.);
  if (unlikely(!__pyx_float_neg_1_))
    __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_float_neg_1_0 = PyFloat_FromDouble(-1.0);
  if (unlikely(!__pyx_float_neg_1_0))
    __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_float_neg_1eneg_8 = PyFloat_FromDouble(-1e-8);
  if (unlikely(!__pyx_float_neg_1eneg_8))
    __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_0 = PyInt_FromLong(0);
  if (unlikely(!__pyx_int_0))
    __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_1 = PyInt_FromLong(1);
  if (unlikely(!__pyx_int_1))
    __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_2 = PyInt_FromLong(2);
  if (unlikely(!__pyx_int_2))
    __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_3 = PyInt_FromLong(3);
  if (unlikely(!__pyx_int_3))
    __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_4 = PyInt_FromLong(4);
  if (unlikely(!__pyx_int_4))
    __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_5 = PyInt_FromLong(5);
  if (unlikely(!__pyx_int_5))
    __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_6 = PyInt_FromLong(6);
  if (unlikely(!__pyx_int_6))
    __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_7 = PyInt_FromLong(7);
  if (unlikely(!__pyx_int_7))
    __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_8 = PyInt_FromLong(8);
  if (unlikely(!__pyx_int_8))
    __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_16 = PyInt_FromLong(16);
  if (unlikely(!__pyx_int_16))
    __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_neg_1 = PyInt_FromLong(-1);
  if (unlikely(!__pyx_int_neg_1))
    __PYX_ERR(0, 1, __pyx_L1_error)
  return 0;
__pyx_L1_error:;
  return -1;
}

static CYTHON_SMALL_CODE int __Pyx_modinit_global_init_code(void);     /*proto*/
static CYTHON_SMALL_CODE int __Pyx_modinit_variable_export_code(void); /*proto*/
static CYTHON_SMALL_CODE int __Pyx_modinit_function_export_code(void); /*proto*/
static CYTHON_SMALL_CODE int __Pyx_modinit_type_init_code(void);       /*proto*/
static CYTHON_SMALL_CODE int __Pyx_modinit_type_import_code(void);     /*proto*/
static CYTHON_SMALL_CODE int __Pyx_modinit_variable_import_code(void); /*proto*/
static CYTHON_SMALL_CODE int __Pyx_modinit_function_import_code(void); /*proto*/

static int __Pyx_modinit_global_init_code(void) {
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext(
      "__Pyx_modinit_global_init_code", 0);
  /*--- Global init code ---*/
  __Pyx_RefNannyFinishContext();
  return 0;
}

static int __Pyx_modinit_variable_export_code(void) {
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext(
      "__Pyx_modinit_variable_export_code", 0);
  /*--- Variable export code ---*/
  __Pyx_RefNannyFinishContext();
  return 0;
}

static int __Pyx_modinit_function_export_code(void) {
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext(
      "__Pyx_modinit_function_export_code", 0);
  /*--- Function export code ---*/
  __Pyx_RefNannyFinishContext();
  return 0;
}

static int __Pyx_modinit_type_init_code(void) {
  __Pyx_RefNannyDeclarations int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__Pyx_modinit_type_init_code", 0);
  /*--- Type init code ---*/
  if (PyType_Ready(
          &__pyx_type_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate) < 0)
    __PYX_ERR(0, 164, __pyx_L1_error)
#if PY_VERSION_HEX < 0x030800B1
  __pyx_type_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate.tp_print = 0;
#endif
  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) &&
      likely(!__pyx_type_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate
                  .tp_dictoffset &&
             __pyx_type_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate
                     .tp_getattro == PyObject_GenericGetAttr)) {
    __pyx_type_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate
        .tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
  }
  __pyx_ptype_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate =
      &__pyx_type_10pyg4ometry_5pycsg_4core___pyx_scope_struct__rotate;
  if (PyType_Ready(
          &__pyx_type_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere) <
      0)
    __PYX_ERR(0, 660, __pyx_L1_error)
#if PY_VERSION_HEX < 0x030800B1
  __pyx_type_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere.tp_print = 0;
#endif
  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) &&
      likely(!__pyx_type_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere
                  .tp_dictoffset &&
             __pyx_type_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere
                     .tp_getattro == PyObject_GenericGetAttr)) {
    __pyx_type_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere
        .tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
  }
  __pyx_ptype_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere =
      &__pyx_type_10pyg4ometry_5pycsg_4core___pyx_scope_struct_1_sphere;
  if (PyType_Ready(
          &__pyx_type_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder) <
      0)
    __PYX_ERR(0, 755, __pyx_L1_error)
#if PY_VERSION_HEX < 0x030800B1
  __pyx_type_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder.tp_print =
      0;
#endif
  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) &&
      likely(!__pyx_type_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder
                  .tp_dictoffset &&
             __pyx_type_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder
                     .tp_getattro == PyObject_GenericGetAttr)) {
    __pyx_type_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder
        .tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
  }
  __pyx_ptype_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder =
      &__pyx_type_10pyg4ometry_5pycsg_4core___pyx_scope_struct_2_cylinder;
  if (PyType_Ready(
          &__pyx_type_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone) < 0)
    __PYX_ERR(0, 812, __pyx_L1_error)
#if PY_VERSION_HEX < 0x030800B1
  __pyx_type_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone.tp_print = 0;
#endif
  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) &&
      likely(!__pyx_type_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone
                  .tp_dictoffset &&
             __pyx_type_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone
                     .tp_getattro == PyObject_GenericGetAttr)) {
    __pyx_type_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone.tp_getattro =
        __Pyx_PyObject_GenericGetAttrNoDict;
  }
  __pyx_ptype_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone =
      &__pyx_type_10pyg4ometry_5pycsg_4core___pyx_scope_struct_3_cone;
  __Pyx_RefNannyFinishContext();
  return 0;
__pyx_L1_error:;
  __Pyx_RefNannyFinishContext();
  return -1;
}

static int __Pyx_modinit_type_import_code(void) {
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext(
      "__Pyx_modinit_type_import_code", 0);
  /*--- Type import code ---*/
  __Pyx_RefNannyFinishContext();
  return 0;
}

static int __Pyx_modinit_variable_import_code(void) {
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext(
      "__Pyx_modinit_variable_import_code", 0);
  /*--- Variable import code ---*/
  __Pyx_RefNannyFinishContext();
  return 0;
}

static int __Pyx_modinit_function_import_code(void) {
  __Pyx_RefNannyDeclarations __Pyx_RefNannySetupContext(
      "__Pyx_modinit_function_import_code", 0);
  /*--- Function import code ---*/
  __Pyx_RefNannyFinishContext();
  return 0;
}

#ifndef CYTHON_NO_PYINIT_EXPORT
#define __Pyx_PyMODINIT_FUNC PyMODINIT_FUNC
#elif PY_MAJOR_VERSION < 3
#ifdef __cplusplus
#define __Pyx_PyMODINIT_FUNC extern "C" void
#else
#define __Pyx_PyMODINIT_FUNC void
#endif
#else
#ifdef __cplusplus
#define __Pyx_PyMODINIT_FUNC extern "C" PyObject *
#else
#define __Pyx_PyMODINIT_FUNC PyObject *
#endif
#endif

#if PY_MAJOR_VERSION < 3
__Pyx_PyMODINIT_FUNC initcore(void) CYTHON_SMALL_CODE; /*proto*/
__Pyx_PyMODINIT_FUNC initcore(void)
#else
__Pyx_PyMODINIT_FUNC PyInit_core(void) CYTHON_SMALL_CODE; /*proto*/
__Pyx_PyMODINIT_FUNC PyInit_core(void)
#if CYTHON_PEP489_MULTI_PHASE_INIT
{
  return PyModuleDef_Init(&__pyx_moduledef);
}
static CYTHON_SMALL_CODE int __Pyx_check_single_interpreter(void) {
#if PY_VERSION_HEX >= 0x030700A1
  static PY_INT64_T main_interpreter_id = -1;
  PY_INT64_T current_id = PyInterpreterState_GetID(PyThreadState_Get()->interp);
  if (main_interpreter_id == -1) {
    main_interpreter_id = current_id;
    return (unlikely(current_id == -1)) ? -1 : 0;
  } else if (unlikely(main_interpreter_id != current_id))
#else
  static PyInterpreterState *main_interpreter = NULL;
  PyInterpreterState *current_interpreter = PyThreadState_Get()->interp;
  if (!main_interpreter) {
    main_interpreter = current_interpreter;
  } else if (unlikely(main_interpreter != current_interpreter))
#endif
  {
    PyErr_SetString(PyExc_ImportError,
                    "Interpreter change detected - this module can only be "
                    "loaded into one interpreter per process.");
    return -1;
  }
  return 0;
}
static CYTHON_SMALL_CODE int __Pyx_copy_spec_to_module(PyObject *spec,
                                                       PyObject *moddict,
                                                       const char *from_name,
                                                       const char *to_name,
                                                       int allow_none) {
  PyObject *value = PyObject_GetAttrString(spec, from_name);
  int result = 0;
  if (likely(value)) {
    if (allow_none || value != Py_None) {
      result = PyDict_SetItemString(moddict, to_name, value);
    }
    Py_DECREF(value);
  } else if (PyErr_ExceptionMatches(PyExc_AttributeError)) {
    PyErr_Clear();
  } else {
    result = -1;
  }
  return result;
}
static CYTHON_SMALL_CODE PyObject *
__pyx_pymod_create(PyObject *spec, CYTHON_UNUSED PyModuleDef *def) {
  PyObject *module = NULL, *moddict, *modname;
  if (__Pyx_check_single_interpreter())
    return NULL;
  if (__pyx_m)
    return __Pyx_NewRef(__pyx_m);
  modname = PyObject_GetAttrString(spec, "name");
  if (unlikely(!modname))
    goto bad;
  module = PyModule_NewObject(modname);
  Py_DECREF(modname);
  if (unlikely(!module))
    goto bad;
  moddict = PyModule_GetDict(module);
  if (unlikely(!moddict))
    goto bad;
  if (unlikely(__Pyx_copy_spec_to_module(spec, moddict, "loader", "__loader__",
                                         1) < 0))
    goto bad;
  if (unlikely(__Pyx_copy_spec_to_module(spec, moddict, "origin", "__file__",
                                         1) < 0))
    goto bad;
  if (unlikely(__Pyx_copy_spec_to_module(spec, moddict, "parent", "__package__",
                                         1) < 0))
    goto bad;
  if (unlikely(__Pyx_copy_spec_to_module(spec, moddict,
                                         "submodule_search_locations",
                                         "__path__", 0) < 0))
    goto bad;
  return module;
bad:
  Py_XDECREF(module);
  return NULL;
}

static CYTHON_SMALL_CODE int
__pyx_pymod_exec_core(PyObject *__pyx_pyinit_module)
#endif
#endif
{
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannyDeclarations
#if CYTHON_PEP489_MULTI_PHASE_INIT
      if (__pyx_m) {
    if (__pyx_m == __pyx_pyinit_module)
      return 0;
    PyErr_SetString(PyExc_RuntimeError,
                    "Module 'core' has already been imported. "
                    "Re-initialisation is not supported.");
    return -1;
  }
#elif PY_MAJOR_VERSION >= 3
      if (__pyx_m) return __Pyx_NewRef(__pyx_m);
#endif
#if CYTHON_REFNANNY
  __Pyx_RefNanny = __Pyx_RefNannyImportAPI("refnanny");
  if (!__Pyx_RefNanny) {
    PyErr_Clear();
    __Pyx_RefNanny = __Pyx_RefNannyImportAPI("Cython.Runtime.refnanny");
    if (!__Pyx_RefNanny)
      Py_FatalError("failed to import 'refnanny' module");
  }
#endif
  __Pyx_RefNannySetupContext("__Pyx_PyMODINIT_FUNC PyInit_core(void)", 0);
  if (__Pyx_check_binary_version() < 0)
    __PYX_ERR(0, 1, __pyx_L1_error)
#ifdef __Pxy_PyFrame_Initialize_Offsets
  __Pxy_PyFrame_Initialize_Offsets();
#endif
  __pyx_empty_tuple = PyTuple_New(0);
  if (unlikely(!__pyx_empty_tuple))
    __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_empty_bytes = PyBytes_FromStringAndSize("", 0);
  if (unlikely(!__pyx_empty_bytes))
    __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_empty_unicode = PyUnicode_FromStringAndSize("", 0);
  if (unlikely(!__pyx_empty_unicode))
    __PYX_ERR(0, 1, __pyx_L1_error)
#ifdef __Pyx_CyFunction_USED
  if (__pyx_CyFunction_init() < 0)
    __PYX_ERR(0, 1, __pyx_L1_error)
#endif
#ifdef __Pyx_FusedFunction_USED
  if (__pyx_FusedFunction_init() < 0)
    __PYX_ERR(0, 1, __pyx_L1_error)
#endif
#ifdef __Pyx_Coroutine_USED
  if (__pyx_Coroutine_init() < 0)
    __PYX_ERR(0, 1, __pyx_L1_error)
#endif
#ifdef __Pyx_Generator_USED
  if (__pyx_Generator_init() < 0)
    __PYX_ERR(0, 1, __pyx_L1_error)
#endif
#ifdef __Pyx_AsyncGen_USED
  if (__pyx_AsyncGen_init() < 0)
    __PYX_ERR(0, 1, __pyx_L1_error)
#endif
#ifdef __Pyx_StopAsyncIteration_USED
  if (__pyx_StopAsyncIteration_init() < 0)
    __PYX_ERR(0, 1, __pyx_L1_error)
#endif
/*--- Library function declarations ---*/
/*--- Threads initialization code ---*/
#if defined(WITH_THREAD) && PY_VERSION_HEX < 0x030700F0 &&                     \
    defined(__PYX_FORCE_INIT_THREADS) && __PYX_FORCE_INIT_THREADS
  PyEval_InitThreads();
#endif
/*--- Module creation code ---*/
#if CYTHON_PEP489_MULTI_PHASE_INIT
  __pyx_m = __pyx_pyinit_module;
  Py_INCREF(__pyx_m);
#else
#if PY_MAJOR_VERSION < 3
  __pyx_m = Py_InitModule4("core", __pyx_methods, 0, 0, PYTHON_API_VERSION);
  Py_XINCREF(__pyx_m);
#else
  __pyx_m = PyModule_Create(&__pyx_moduledef);
#endif
  if (unlikely(!__pyx_m))
    __PYX_ERR(0, 1, __pyx_L1_error)
#endif
  __pyx_d = PyModule_GetDict(__pyx_m);
  if (unlikely(!__pyx_d))
    __PYX_ERR(0, 1, __pyx_L1_error)
  Py_INCREF(__pyx_d);
  __pyx_b = PyImport_AddModule(__Pyx_BUILTIN_MODULE_NAME);
  if (unlikely(!__pyx_b))
    __PYX_ERR(0, 1, __pyx_L1_error)
  Py_INCREF(__pyx_b);
  __pyx_cython_runtime = PyImport_AddModule((char *)"cython_runtime");
  if (unlikely(!__pyx_cython_runtime))
    __PYX_ERR(0, 1, __pyx_L1_error)
  Py_INCREF(__pyx_cython_runtime);
  if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0)
    __PYX_ERR(0, 1, __pyx_L1_error)
  /*--- Initialize various global constants etc. ---*/
  if (__Pyx_InitGlobals() < 0)
    __PYX_ERR(0, 1, __pyx_L1_error)
#if PY_MAJOR_VERSION < 3 && (__PYX_DEFAULT_STRING_ENCODING_IS_ASCII ||         \
                             __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT)
  if (__Pyx_init_sys_getdefaultencoding_params() < 0)
    __PYX_ERR(0, 1, __pyx_L1_error)
#endif
  if (__pyx_module_is_main_pyg4ometry__pycsg__core) {
    if (PyObject_SetAttr(__pyx_m, __pyx_n_s_name, __pyx_n_s_main) < 0)
      __PYX_ERR(0, 1, __pyx_L1_error)
  }
#if PY_MAJOR_VERSION >= 3
  {
    PyObject *modules = PyImport_GetModuleDict();
    if (unlikely(!modules))
      __PYX_ERR(0, 1, __pyx_L1_error)
    if (!PyDict_GetItemString(modules, "pyg4ometry.pycsg.core")) {
      if (unlikely(PyDict_SetItemString(modules, "pyg4ometry.pycsg.core",
                                        __pyx_m) < 0))
        __PYX_ERR(0, 1, __pyx_L1_error)
    }
  }
#endif
  /*--- Builtin init code ---*/
  if (__Pyx_InitCachedBuiltins() < 0)
    __PYX_ERR(0, 1, __pyx_L1_error)
  /*--- Constants init code ---*/
  if (__Pyx_InitCachedConstants() < 0)
    __PYX_ERR(0, 1, __pyx_L1_error)
  /*--- Global type/function init code ---*/
  (void)__Pyx_modinit_global_init_code();
  (void)__Pyx_modinit_variable_export_code();
  (void)__Pyx_modinit_function_export_code();
  if (unlikely(__Pyx_modinit_type_init_code() < 0))
    __PYX_ERR(0, 1, __pyx_L1_error)
  (void)__Pyx_modinit_type_import_code();
  (void)__Pyx_modinit_variable_import_code();
  (void)__Pyx_modinit_function_import_code();
/*--- Execution code ---*/
#if defined(__Pyx_Generator_USED) || defined(__Pyx_Coroutine_USED)
  if (__Pyx_patch_abc() < 0)
    __PYX_ERR(0, 1, __pyx_L1_error)
#endif

  /* "pyg4ometry/pycsg/core.pyx":3
   * # cython: language_level=3
   *
   * import operator             # <<<<<<<<<<<<<<
   * from .geom import *
   * import numpy as _np
   */
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_operator, 0, 0);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 3, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_operator, __pyx_t_1) < 0)
    __PYX_ERR(0, 3, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":4
   *
   * import operator
   * from .geom import *             # <<<<<<<<<<<<<<
   * import numpy as _np
   * from hashlib import md5 as _md5
   */
  __pyx_t_1 = PyList_New(1);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 4, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_n_s__23);
  __Pyx_GIVEREF(__pyx_n_s__23);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s__23);
  __pyx_t_2 = __Pyx_Import(__pyx_n_s_geom, __pyx_t_1, 1);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 4, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  if (__pyx_import_star(__pyx_t_2) < 0)
    __PYX_ERR(0, 4, __pyx_L1_error);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":5
   * import operator
   * from .geom import *
   * import numpy as _np             # <<<<<<<<<<<<<<
   * from hashlib import md5 as _md5
   * from functools import reduce
   */
  __pyx_t_2 = __Pyx_Import(__pyx_n_s_numpy, 0, 0);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 5, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_np, __pyx_t_2) < 0)
    __PYX_ERR(0, 5, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":6
   * from .geom import *
   * import numpy as _np
   * from hashlib import md5 as _md5             # <<<<<<<<<<<<<<
   * from functools import reduce
   *
   */
  __pyx_t_2 = PyList_New(1);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 6, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_n_s_md5_2);
  __Pyx_GIVEREF(__pyx_n_s_md5_2);
  PyList_SET_ITEM(__pyx_t_2, 0, __pyx_n_s_md5_2);
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_hashlib, __pyx_t_2, 0);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 6, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_ImportFrom(__pyx_t_1, __pyx_n_s_md5_2);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 6, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_md5, __pyx_t_2) < 0)
    __PYX_ERR(0, 6, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":7
   * import numpy as _np
   * from hashlib import md5 as _md5
   * from functools import reduce             # <<<<<<<<<<<<<<
   *
   * from .geom import Vertex as _Vertex
   */
  __pyx_t_1 = PyList_New(1);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 7, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_n_s_reduce);
  __Pyx_GIVEREF(__pyx_n_s_reduce);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s_reduce);
  __pyx_t_2 = __Pyx_Import(__pyx_n_s_functools, __pyx_t_1, 0);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 7, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_reduce);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 7, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_reduce, __pyx_t_1) < 0)
    __PYX_ERR(0, 7, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":9
   * from functools import reduce
   *
   * from .geom import Vertex as _Vertex             # <<<<<<<<<<<<<<
   * from .geom import Vector as _Vector
   *
   */
  __pyx_t_2 = PyList_New(1);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 9, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_n_s_Vertex);
  __Pyx_GIVEREF(__pyx_n_s_Vertex);
  PyList_SET_ITEM(__pyx_t_2, 0, __pyx_n_s_Vertex);
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_geom, __pyx_t_2, 1);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 9, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_ImportFrom(__pyx_t_1, __pyx_n_s_Vertex);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 9, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_Vertex_2, __pyx_t_2) < 0)
    __PYX_ERR(0, 9, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "pyg4ometry/pycsg/core.pyx":10
   *
   * from .geom import Vertex as _Vertex
   * from .geom import Vector as _Vector             # <<<<<<<<<<<<<<
   *
   * class CSG(object):
   */
  __pyx_t_1 = PyList_New(1);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 10, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_n_s_Vector);
  __Pyx_GIVEREF(__pyx_n_s_Vector);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s_Vector);
  __pyx_t_2 = __Pyx_Import(__pyx_n_s_geom, __pyx_t_1, 1);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 10, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_Vector);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 10, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_Vector_2, __pyx_t_1) < 0)
    __PYX_ERR(0, 10, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":12
   * from .geom import Vector as _Vector
   *
   * class CSG(object):             # <<<<<<<<<<<<<<
   *     """
   *     Constructive Solid Geometry (CSG) is a modeling technique that uses
   * Boolean
   */
  __pyx_t_2 = __Pyx_CalculateMetaclass(NULL, __pyx_tuple__24);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 12, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = __Pyx_Py3MetaclassPrepare(
      __pyx_t_2, __pyx_tuple__24, __pyx_n_s_CSG, __pyx_n_s_CSG,
      (PyObject *)NULL, __pyx_n_s_pyg4ometry_pycsg_core,
      __pyx_kp_s_Constructive_Solid_Geometry_CSG);
  if (unlikely(!__pyx_t_1))
    __PYX_ERR(0, 12, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);

  /* "pyg4ometry/pycsg/core.pyx":64
   *     Additions by Alex Pletzer (Pennsylvania State University)
   *     """
   *     def __init__(self):             # <<<<<<<<<<<<<<
   *         self.polygons = []
   *
   */
  __pyx_t_3 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_1__init__, 0,
      __pyx_n_s_CSG___init, NULL, __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
      ((PyObject *)__pyx_codeobj__26));
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 64, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_init, __pyx_t_3) < 0)
    __PYX_ERR(0, 64, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;

  /* "pyg4ometry/pycsg/core.pyx":67
   *         self.polygons = []
   *
   *     def __hash__(self):             # <<<<<<<<<<<<<<
   *         verts = _np.array(self.toVerticesAndPolygons()[0])
   *         as_string = _np.array2string(verts)
   */
  __pyx_t_3 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_3__hash__, 0,
      __pyx_n_s_CSG___hash, NULL, __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
      ((PyObject *)__pyx_codeobj__28));
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 67, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_hash, __pyx_t_3) < 0)
    __PYX_ERR(0, 67, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;

  /* "pyg4ometry/pycsg/core.pyx":75
   *
   *     @classmethod
   *     def fromPolygons(cls, polygons, testGeom = False):             #
   * <<<<<<<<<<<<<< csg = CSG() csg.polygons = polygons
   */
  __pyx_t_3 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_5fromPolygons,
      __Pyx_CYFUNCTION_CLASSMETHOD, __pyx_n_s_CSG_fromPolygons, NULL,
      __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
      ((PyObject *)__pyx_codeobj__30));
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 75, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__31);

  /* "pyg4ometry/pycsg/core.pyx":74
   *         return checksum
   *
   *     @classmethod             # <<<<<<<<<<<<<<
   *     def fromPolygons(cls, polygons, testGeom = False):
   *         csg = CSG()
   */
  __pyx_t_4 = __Pyx_Method_ClassMethod(__pyx_t_3);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 74, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_fromPolygons, __pyx_t_4) < 0)
    __PYX_ERR(0, 75, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;

  /* "pyg4ometry/pycsg/core.pyx":80
   *         return csg
   *
   *     def clone(self):             # <<<<<<<<<<<<<<
   *         csg = CSG()
   *         csg.polygons = list([p.clone() for p in self.polygons])
   */
  __pyx_t_4 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_7clone, 0, __pyx_n_s_CSG_clone,
      NULL, __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
      ((PyObject *)__pyx_codeobj__33));
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 80, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_clone, __pyx_t_4) < 0)
    __PYX_ERR(0, 80, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;

  /* "pyg4ometry/pycsg/core.pyx":85
   *         return csg
   *
   *     def toPolygons(self):             # <<<<<<<<<<<<<<
   *         return self.polygons
   *
   */
  __pyx_t_4 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_9toPolygons, 0,
      __pyx_n_s_CSG_toPolygons, NULL, __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
      ((PyObject *)__pyx_codeobj__35));
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 85, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_toPolygons, __pyx_t_4) < 0)
    __PYX_ERR(0, 85, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;

  /* "pyg4ometry/pycsg/core.pyx":88
   *         return self.polygons
   *
   *     def isNull(self):             # <<<<<<<<<<<<<<
   *         return len(self.toPolygons()) == 0
   *
   */
  __pyx_t_4 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_11isNull, 0,
      __pyx_n_s_CSG_isNull, NULL, __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
      ((PyObject *)__pyx_codeobj__37));
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 88, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_isNull, __pyx_t_4) < 0)
    __PYX_ERR(0, 88, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;

  /* "pyg4ometry/pycsg/core.pyx":91
   *         return len(self.toPolygons()) == 0
   *
   *     def polygonCount(self):             # <<<<<<<<<<<<<<
   *         '''Return number of polygons in CSG solid'''
   *         return len(self.polygons)
   */
  __pyx_t_4 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_13polygonCount, 0,
      __pyx_n_s_CSG_polygonCount, NULL, __pyx_n_s_pyg4ometry_pycsg_core,
      __pyx_d, ((PyObject *)__pyx_codeobj__39));
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 91, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_polygonCount, __pyx_t_4) < 0)
    __PYX_ERR(0, 91, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;

  /* "pyg4ometry/pycsg/core.pyx":95
   *         return len(self.polygons)
   *
   *     def vertexCount(self):             # <<<<<<<<<<<<<<
   *         '''Return number of vertices in CSG solid'''
   *         vCount = 0
   */
  __pyx_t_4 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_15vertexCount, 0,
      __pyx_n_s_CSG_vertexCount, NULL, __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
      ((PyObject *)__pyx_codeobj__41));
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 95, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_vertexCount, __pyx_t_4) < 0)
    __PYX_ERR(0, 95, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;

  /* "pyg4ometry/pycsg/core.pyx":103
   *         return vCount
   *
   *     def refine(self):             # <<<<<<<<<<<<<<
   *         """
   *         Return a refined CSG. To each polygon, a middle point is added to
   * each edge and to the center
   */
  __pyx_t_4 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_17refine, 0,
      __pyx_n_s_CSG_refine, NULL, __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
      ((PyObject *)__pyx_codeobj__43));
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 103, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_refine, __pyx_t_4) < 0)
    __PYX_ERR(0, 103, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;

  /* "pyg4ometry/pycsg/core.pyx":141
   *         return newCSG
   *
   *     def translate(self, disp):             # <<<<<<<<<<<<<<
   *         """
   *         Translate Geometry.
   */
  __pyx_t_4 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_19translate, 0,
      __pyx_n_s_CSG_translate, NULL, __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
      ((PyObject *)__pyx_codeobj__45));
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 141, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_translate, __pyx_t_4) < 0)
    __PYX_ERR(0, 141, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;

  /* "pyg4ometry/pycsg/core.pyx":153
   *
   *
   *     def scale(self, scale):             # <<<<<<<<<<<<<<
   *         """
   *         Translate Geometry.
   */
  __pyx_t_4 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_21scale, 0,
      __pyx_n_s_CSG_scale, NULL, __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
      ((PyObject *)__pyx_codeobj__47));
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 153, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_scale, __pyx_t_4) < 0)
    __PYX_ERR(0, 153, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;

  /* "pyg4ometry/pycsg/core.pyx":164
   *                 # no change to the normals
   *
   *     def rotate(self, axis, angleDeg):             # <<<<<<<<<<<<<<
   *         """
   *         Rotate geometry.
   */
  __pyx_t_4 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_23rotate, 0,
      __pyx_n_s_CSG_rotate, NULL, __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
      ((PyObject *)__pyx_codeobj__49));
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 164, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_rotate, __pyx_t_4) < 0)
    __PYX_ERR(0, 164, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;

  /* "pyg4ometry/pycsg/core.pyx":194
   *                     vert.normal = newVector(vert.normal)
   *
   *     def toVerticesAndPolygons(self):             # <<<<<<<<<<<<<<
   *         """
   *         Return list of vertices, polygons (cells), and the total
   */
  __pyx_t_4 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_25toVerticesAndPolygons, 0,
      __pyx_n_s_CSG_toVerticesAndPolygons, NULL,
      __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
      ((PyObject *)__pyx_codeobj__51));
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 194, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_toVerticesAndPolygons,
                           __pyx_t_4) < 0)
    __PYX_ERR(0, 194, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;

  /* "pyg4ometry/pycsg/core.pyx":235
   *         return verts, polys, count
   *
   *     def saveVTK(self, filename):             # <<<<<<<<<<<<<<
   *         """
   *         Save polygons in VTK file.
   */
  __pyx_t_4 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_27saveVTK, 0,
      __pyx_n_s_CSG_saveVTK, NULL, __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
      ((PyObject *)__pyx_codeobj__53));
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 235, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_saveVTK, __pyx_t_4) < 0)
    __PYX_ERR(0, 235, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;

  /* "pyg4ometry/pycsg/core.pyx":258
   *                 f.write('\n')
   *
   *     def union(self, csg):             # <<<<<<<<<<<<<<
   *         """
   *         Return a new CSG solid representing space in either this solid or
   * in the
   */
  __pyx_t_4 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_29union, 0,
      __pyx_n_s_CSG_union, NULL, __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
      ((PyObject *)__pyx_codeobj__55));
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 258, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_union, __pyx_t_4) < 0)
    __PYX_ERR(0, 258, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;

  /* "pyg4ometry/pycsg/core.pyx":284
   *         return CSG.fromPolygons(a.allPolygons())
   *
   *     def __add__(self, csg):             # <<<<<<<<<<<<<<
   *         return self.union(csg)
   *
   */
  __pyx_t_4 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_31__add__, 0,
      __pyx_n_s_CSG___add, NULL, __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
      ((PyObject *)__pyx_codeobj__57));
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 284, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_add_2, __pyx_t_4) < 0)
    __PYX_ERR(0, 284, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;

  /* "pyg4ometry/pycsg/core.pyx":287
   *         return self.union(csg)
   *
   *     def subtract(self, csg):             # <<<<<<<<<<<<<<
   *         """
   *         Return a new CSG solid representing space in this solid but not in
   * the
   */
  __pyx_t_4 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_33subtract, 0,
      __pyx_n_s_CSG_subtract, NULL, __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
      ((PyObject *)__pyx_codeobj__59));
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 287, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_subtract, __pyx_t_4) < 0)
    __PYX_ERR(0, 287, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;

  /* "pyg4ometry/pycsg/core.pyx":315
   *         return CSG.fromPolygons(a.allPolygons())
   *
   *     def __sub__(self, csg):             # <<<<<<<<<<<<<<
   *         return self.subtract(csg)
   *
   */
  __pyx_t_4 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_35__sub__, 0,
      __pyx_n_s_CSG___sub, NULL, __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
      ((PyObject *)__pyx_codeobj__61));
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 315, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_sub, __pyx_t_4) < 0)
    __PYX_ERR(0, 315, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;

  /* "pyg4ometry/pycsg/core.pyx":318
   *         return self.subtract(csg)
   *
   *     def intersect(self, csg):             # <<<<<<<<<<<<<<
   *         """
   *         Return a new CSG solid representing space both this solid and in
   * the
   */
  __pyx_t_4 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_37intersect, 0,
      __pyx_n_s_CSG_intersect, NULL, __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
      ((PyObject *)__pyx_codeobj__63));
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 318, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_intersect, __pyx_t_4) < 0)
    __PYX_ERR(0, 318, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;

  /* "pyg4ometry/pycsg/core.pyx":345
   *         return CSG.fromPolygons(a.allPolygons())
   *
   *     def coplanarIntersection(self, csg):             # <<<<<<<<<<<<<<
   *         # print 'pycsg.core.coplanarIntersection>'
   *
   */
  __pyx_t_4 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_39coplanarIntersection, 0,
      __pyx_n_s_CSG_coplanarIntersection, NULL, __pyx_n_s_pyg4ometry_pycsg_core,
      __pyx_d, ((PyObject *)__pyx_codeobj__65));
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 345, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_coplanarIntersection,
                           __pyx_t_4) < 0)
    __PYX_ERR(0, 345, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;

  /* "pyg4ometry/pycsg/core.pyx":504
   *         return CSG.fromPolygons(polygons)
   *
   *     def coplanar(self, csg):             # <<<<<<<<<<<<<<
   *
   *         absp = BSPNode(self.clone().polygons)
   */
  __pyx_t_4 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_41coplanar, 0,
      __pyx_n_s_CSG_coplanar, NULL, __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
      ((PyObject *)__pyx_codeobj__67));
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 504, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_coplanar, __pyx_t_4) < 0)
    __PYX_ERR(0, 504, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;

  /* "pyg4ometry/pycsg/core.pyx":606
   *         return CSG.fromPolygons(a)
   *
   *     def __mul__(self, csg):             # <<<<<<<<<<<<<<
   *         return self.intersect(csg)
   *
   */
  __pyx_t_4 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_43__mul__, 0,
      __pyx_n_s_CSG___mul, NULL, __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
      ((PyObject *)__pyx_codeobj__69));
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 606, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_mul, __pyx_t_4) < 0)
    __PYX_ERR(0, 606, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;

  /* "pyg4ometry/pycsg/core.pyx":609
   *         return self.intersect(csg)
   *
   *     def inverse(self):             # <<<<<<<<<<<<<<
   *         """
   *         Return a new CSG solid with solid and empty space switched. This
   * solid is
   */
  __pyx_t_4 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_45inverse, 0,
      __pyx_n_s_CSG_inverse, NULL, __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
      ((PyObject *)__pyx_codeobj__71));
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 609, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_inverse, __pyx_t_4) < 0)
    __PYX_ERR(0, 609, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;

  /* "pyg4ometry/pycsg/core.pyx":618
   *         return csg
   *
   *     def getNumberPolys(self):             # <<<<<<<<<<<<<<
   *         return len(self.polygons)
   *
   */
  __pyx_t_4 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_47getNumberPolys, 0,
      __pyx_n_s_CSG_getNumberPolys, NULL, __pyx_n_s_pyg4ometry_pycsg_core,
      __pyx_d, ((PyObject *)__pyx_codeobj__73));
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 618, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_getNumberPolys, __pyx_t_4) < 0)
    __PYX_ERR(0, 618, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;

  /* "pyg4ometry/pycsg/core.pyx":622
   *
   *     @classmethod
   *     def cube(cls, center=[0,0,0], radius=[1,1,1]):             #
   * <<<<<<<<<<<<<<
   *         """
   *         Construct an axis-aligned solid cuboid. Optional parameters are
   * `center` and
   */
  __pyx_t_4 =
      __Pyx_CyFunction_New(&__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_49cube,
                           __Pyx_CYFUNCTION_CLASSMETHOD, __pyx_n_s_CSG_cube,
                           NULL, __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
                           ((PyObject *)__pyx_codeobj__75));
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 622, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (!__Pyx_CyFunction_InitDefaults(__pyx_t_4, sizeof(__pyx_defaults), 2))
    __PYX_ERR(0, 622, __pyx_L1_error)
  __pyx_t_3 = PyList_New(3);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 622, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyList_SET_ITEM(__pyx_t_3, 0, __pyx_int_0);
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyList_SET_ITEM(__pyx_t_3, 1, __pyx_int_0);
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyList_SET_ITEM(__pyx_t_3, 2, __pyx_int_0);
  __Pyx_CyFunction_Defaults(__pyx_defaults, __pyx_t_4)->__pyx_arg_center =
      __pyx_t_3;
  __Pyx_GIVEREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyList_New(3);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 622, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_INCREF(__pyx_int_1);
  __Pyx_GIVEREF(__pyx_int_1);
  PyList_SET_ITEM(__pyx_t_3, 0, __pyx_int_1);
  __Pyx_INCREF(__pyx_int_1);
  __Pyx_GIVEREF(__pyx_int_1);
  PyList_SET_ITEM(__pyx_t_3, 1, __pyx_int_1);
  __Pyx_INCREF(__pyx_int_1);
  __Pyx_GIVEREF(__pyx_int_1);
  PyList_SET_ITEM(__pyx_t_3, 2, __pyx_int_1);
  __Pyx_CyFunction_Defaults(__pyx_defaults, __pyx_t_4)->__pyx_arg_radius =
      __pyx_t_3;
  __Pyx_GIVEREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __Pyx_CyFunction_SetDefaultsGetter(
      __pyx_t_4, __pyx_pf_10pyg4ometry_5pycsg_4core_2__defaults__);

  /* "pyg4ometry/pycsg/core.pyx":621
   *         return len(self.polygons)
   *
   *     @classmethod             # <<<<<<<<<<<<<<
   *     def cube(cls, center=[0,0,0], radius=[1,1,1]):
   *         """
   */
  __pyx_t_3 = __Pyx_Method_ClassMethod(__pyx_t_4);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 621, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_cube, __pyx_t_3) < 0)
    __PYX_ERR(0, 622, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;

  /* "pyg4ometry/pycsg/core.pyx":660
   *
   *     @classmethod
   *     def sphere(cls, **kwargs):             # <<<<<<<<<<<<<<
   *         """ Returns a sphere.
   *
   */
  __pyx_t_3 =
      __Pyx_CyFunction_New(&__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_51sphere,
                           __Pyx_CYFUNCTION_CLASSMETHOD, __pyx_n_s_CSG_sphere,
                           NULL, __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
                           ((PyObject *)__pyx_codeobj__77));
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 660, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);

  /* "pyg4ometry/pycsg/core.pyx":659
   *         return CSG.fromPolygons(polygons)
   *
   *     @classmethod             # <<<<<<<<<<<<<<
   *     def sphere(cls, **kwargs):
   *         """ Returns a sphere.
   */
  __pyx_t_4 = __Pyx_Method_ClassMethod(__pyx_t_3);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 659, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_sphere, __pyx_t_4) < 0)
    __PYX_ERR(0, 660, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;

  /* "pyg4ometry/pycsg/core.pyx":755
   *
   *     @classmethod
   *     def cylinder(cls, **kwargs):             # <<<<<<<<<<<<<<
   *         """ Returns a cylinder.
   *
   */
  __pyx_t_4 = __Pyx_CyFunction_New(
      &__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_53cylinder,
      __Pyx_CYFUNCTION_CLASSMETHOD, __pyx_n_s_CSG_cylinder, NULL,
      __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
      ((PyObject *)__pyx_codeobj__79));
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 755, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);

  /* "pyg4ometry/pycsg/core.pyx":754
   *         return CSG.fromPolygons(polygons)
   *
   *     @classmethod             # <<<<<<<<<<<<<<
   *     def cylinder(cls, **kwargs):
   *         """ Returns a cylinder.
   */
  __pyx_t_3 = __Pyx_Method_ClassMethod(__pyx_t_4);
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 754, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_cylinder, __pyx_t_3) < 0)
    __PYX_ERR(0, 755, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;

  /* "pyg4ometry/pycsg/core.pyx":812
   *
   *     @classmethod
   *     def cone(cls, **kwargs):             # <<<<<<<<<<<<<<
   *         """ Returns a cone.
   *
   */
  __pyx_t_3 =
      __Pyx_CyFunction_New(&__pyx_mdef_10pyg4ometry_5pycsg_4core_3CSG_55cone,
                           __Pyx_CYFUNCTION_CLASSMETHOD, __pyx_n_s_CSG_cone,
                           NULL, __pyx_n_s_pyg4ometry_pycsg_core, __pyx_d,
                           ((PyObject *)__pyx_codeobj__81));
  if (unlikely(!__pyx_t_3))
    __PYX_ERR(0, 812, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);

  /* "pyg4ometry/pycsg/core.pyx":811
   *         return CSG.fromPolygons(polygons)
   *
   *     @classmethod             # <<<<<<<<<<<<<<
   *     def cone(cls, **kwargs):
   *         """ Returns a cone.
   */
  __pyx_t_4 = __Pyx_Method_ClassMethod(__pyx_t_3);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 811, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3);
  __pyx_t_3 = 0;
  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_cone, __pyx_t_4) < 0)
    __PYX_ERR(0, 812, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;

  /* "pyg4ometry/pycsg/core.pyx":12
   * from .geom import Vector as _Vector
   *
   * class CSG(object):             # <<<<<<<<<<<<<<
   *     """
   *     Constructive Solid Geometry (CSG) is a modeling technique that uses
   * Boolean
   */
  __pyx_t_4 = __Pyx_Py3ClassCreate(__pyx_t_2, __pyx_n_s_CSG, __pyx_tuple__24,
                                   __pyx_t_1, NULL, 0, 0);
  if (unlikely(!__pyx_t_4))
    __PYX_ERR(0, 12, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_CSG, __pyx_t_4) < 0)
    __PYX_ERR(0, 12, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4);
  __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":876
   *         return CSG.fromPolygons(polygons)
   *
   * def do_intersect(first, second):             # <<<<<<<<<<<<<<
   *     return not first.intersect(second).isNull()
   */
  __pyx_t_2 =
      PyCFunction_NewEx(&__pyx_mdef_10pyg4ometry_5pycsg_4core_1do_intersect,
                        NULL, __pyx_n_s_pyg4ometry_pycsg_core);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 876, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_do_intersect, __pyx_t_2) < 0)
    __PYX_ERR(0, 876, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;

  /* "pyg4ometry/pycsg/core.pyx":1
   * # cython: language_level=3             # <<<<<<<<<<<<<<
   *
   * import operator
   */
  __pyx_t_2 = __Pyx_PyDict_NewPresized(0);
  if (unlikely(!__pyx_t_2))
    __PYX_ERR(0, 1, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_2) < 0)
    __PYX_ERR(0, 1, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2);
  __pyx_t_2 = 0;

  /*--- Wrapped vars code ---*/

  goto __pyx_L0;
__pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  if (__pyx_m) {
    if (__pyx_d) {
      __Pyx_AddTraceback("init pyg4ometry.pycsg.core", __pyx_clineno,
                         __pyx_lineno, __pyx_filename);
    }
    Py_CLEAR(__pyx_m);
  } else if (!PyErr_Occurred()) {
    PyErr_SetString(PyExc_ImportError, "init pyg4ometry.pycsg.core");
  }
__pyx_L0:;
  __Pyx_RefNannyFinishContext();
#if CYTHON_PEP489_MULTI_PHASE_INIT
  return (__pyx_m != NULL) ? 0 : -1;
#elif PY_MAJOR_VERSION >= 3
  return __pyx_m;
#else
  return;
#endif
}

/* --- Runtime support code --- */
/* Refnanny */
#if CYTHON_REFNANNY
static __Pyx_RefNannyAPIStruct *__Pyx_RefNannyImportAPI(const char *modname) {
  PyObject *m = NULL, *p = NULL;
  void *r = NULL;
  m = PyImport_ImportModule(modname);
  if (!m)
    goto end;
  p = PyObject_GetAttrString(m, "RefNannyAPI");
  if (!p)
    goto end;
  r = PyLong_AsVoidPtr(p);
end:
  Py_XDECREF(p);
  Py_XDECREF(m);
  return (__Pyx_RefNannyAPIStruct *)r;
}
#endif

/* PyObjectGetAttrStr */
#if CYTHON_USE_TYPE_SLOTS
static CYTHON_INLINE PyObject *__Pyx_PyObject_GetAttrStr(PyObject *obj,
                                                         PyObject *attr_name) {
  PyTypeObject *tp = Py_TYPE(obj);
  if (likely(tp->tp_getattro))
    return tp->tp_getattro(obj, attr_name);
#if PY_MAJOR_VERSION < 3
  if (likely(tp->tp_getattr))
    return tp->tp_getattr(obj, PyString_AS_STRING(attr_name));
#endif
  return PyObject_GetAttr(obj, attr_name);
}
#endif

/* GetBuiltinName */
static PyObject *__Pyx_GetBuiltinName(PyObject *name) {
  PyObject *result = __Pyx_PyObject_GetAttrStr(__pyx_b, name);
  if (unlikely(!result)) {
    PyErr_Format(PyExc_NameError,
#if PY_MAJOR_VERSION >= 3
                 "name '%U' is not defined", name);
#else
                 "name '%.200s' is not defined", PyString_AS_STRING(name));
#endif
  }
  return result;
}

/* PyObjectSetAttrStr */
#if CYTHON_USE_TYPE_SLOTS
static CYTHON_INLINE int
__Pyx_PyObject_SetAttrStr(PyObject *obj, PyObject *attr_name, PyObject *value) {
  PyTypeObject *tp = Py_TYPE(obj);
  if (likely(tp->tp_setattro))
    return tp->tp_setattro(obj, attr_name, value);
#if PY_MAJOR_VERSION < 3
  if (likely(tp->tp_setattr))
    return tp->tp_setattr(obj, PyString_AS_STRING(attr_name), value);
#endif
  return PyObject_SetAttr(obj, attr_name, value);
}
#endif

/* PyDictVersioning */
#if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_TYPE_SLOTS
static CYTHON_INLINE PY_UINT64_T __Pyx_get_tp_dict_version(PyObject *obj) {
  PyObject *dict = Py_TYPE(obj)->tp_dict;
  return likely(dict) ? __PYX_GET_DICT_VERSION(dict) : 0;
}
static CYTHON_INLINE PY_UINT64_T __Pyx_get_object_dict_version(PyObject *obj) {
  PyObject **dictptr = NULL;
  Py_ssize_t offset = Py_TYPE(obj)->tp_dictoffset;
  if (offset) {
#if CYTHON_COMPILING_IN_CPYTHON
    dictptr = (likely(offset > 0)) ? (PyObject **)((char *)obj + offset)
                                   : _PyObject_GetDictPtr(obj);
#else
    dictptr = _PyObject_GetDictPtr(obj);
#endif
  }
  return (dictptr && *dictptr) ? __PYX_GET_DICT_VERSION(*dictptr) : 0;
}
static CYTHON_INLINE int
__Pyx_object_dict_version_matches(PyObject *obj, PY_UINT64_T tp_dict_version,
                                  PY_UINT64_T obj_dict_version) {
  PyObject *dict = Py_TYPE(obj)->tp_dict;
  if (unlikely(!dict) ||
      unlikely(tp_dict_version != __PYX_GET_DICT_VERSION(dict)))
    return 0;
  return obj_dict_version == __Pyx_get_object_dict_version(obj);
}
#endif

/* GetModuleGlobalName */
#if CYTHON_USE_DICT_VERSIONS
static PyObject *__Pyx__GetModuleGlobalName(PyObject *name,
                                            PY_UINT64_T *dict_version,
                                            PyObject **dict_cached_value)
#else
static CYTHON_INLINE PyObject *__Pyx__GetModuleGlobalName(PyObject *name)
#endif
{
  PyObject *result;
#if !CYTHON_AVOID_BORROWED_REFS
#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x030500A1
  result =
      _PyDict_GetItem_KnownHash(__pyx_d, name, ((PyASCIIObject *)name)->hash);
  __PYX_UPDATE_DICT_CACHE(__pyx_d, result, *dict_cached_value, *dict_version)
  if (likely(result)) {
    return __Pyx_NewRef(result);
  } else if (unlikely(PyErr_Occurred())) {
    return NULL;
  }
#else
  result = PyDict_GetItem(__pyx_d, name);
  __PYX_UPDATE_DICT_CACHE(__pyx_d, result, *dict_cached_value, *dict_version)
  if (likely(result)) {
    return __Pyx_NewRef(result);
  }
#endif
#else
  result = PyObject_GetItem(__pyx_d, name);
  __PYX_UPDATE_DICT_CACHE(__pyx_d, result, *dict_cached_value, *dict_version)
  if (likely(result)) {
    return __Pyx_NewRef(result);
  }
  PyErr_Clear();
#endif
  return __Pyx_GetBuiltinName(name);
}

/* PyFunctionFastCall */
#if CYTHON_FAST_PYCALL
static PyObject *__Pyx_PyFunction_FastCallNoKw(PyCodeObject *co,
                                               PyObject **args, Py_ssize_t na,
                                               PyObject *globals) {
  PyFrameObject *f;
  PyThreadState *tstate = __Pyx_PyThreadState_Current;
  PyObject **fastlocals;
  Py_ssize_t i;
  PyObject *result;
  assert(globals != NULL);
  /* XXX Perhaps we should create a specialized
     PyFrame_New() that doesn't take locals, but does
     take builtins without sanity checking them.
     */
  assert(tstate != NULL);
  f = PyFrame_New(tstate, co, globals, NULL);
  if (f == NULL) {
    return NULL;
  }
  fastlocals = __Pyx_PyFrame_GetLocalsplus(f);
  for (i = 0; i < na; i++) {
    Py_INCREF(*args);
    fastlocals[i] = *args++;
  }
  result = PyEval_EvalFrameEx(f, 0);
  ++tstate->recursion_depth;
  Py_DECREF(f);
  --tstate->recursion_depth;
  return result;
}
#if 1 || PY_VERSION_HEX < 0x030600B1
static PyObject *__Pyx_PyFunction_FastCallDict(PyObject *func, PyObject **args,
                                               Py_ssize_t nargs,
                                               PyObject *kwargs) {
  PyCodeObject *co = (PyCodeObject *)PyFunction_GET_CODE(func);
  PyObject *globals = PyFunction_GET_GLOBALS(func);
  PyObject *argdefs = PyFunction_GET_DEFAULTS(func);
  PyObject *closure;
#if PY_MAJOR_VERSION >= 3
  PyObject *kwdefs;
#endif
  PyObject *kwtuple, **k;
  PyObject **d;
  Py_ssize_t nd;
  Py_ssize_t nk;
  PyObject *result;
  assert(kwargs == NULL || PyDict_Check(kwargs));
  nk = kwargs ? PyDict_Size(kwargs) : 0;
  if (Py_EnterRecursiveCall((char *)" while calling a Python object")) {
    return NULL;
  }
  if (
#if PY_MAJOR_VERSION >= 3
      co->co_kwonlyargcount == 0 &&
#endif
      likely(kwargs == NULL || nk == 0) &&
      co->co_flags == (CO_OPTIMIZED | CO_NEWLOCALS | CO_NOFREE)) {
    if (argdefs == NULL && co->co_argcount == nargs) {
      result = __Pyx_PyFunction_FastCallNoKw(co, args, nargs, globals);
      goto done;
    } else if (nargs == 0 && argdefs != NULL &&
               co->co_argcount == Py_SIZE(argdefs)) {
      /* function called with no arguments, but all parameters have
         a default value: use default values as arguments .*/
      args = &PyTuple_GET_ITEM(argdefs, 0);
      result =
          __Pyx_PyFunction_FastCallNoKw(co, args, Py_SIZE(argdefs), globals);
      goto done;
    }
  }
  if (kwargs != NULL) {
    Py_ssize_t pos, i;
    kwtuple = PyTuple_New(2 * nk);
    if (kwtuple == NULL) {
      result = NULL;
      goto done;
    }
    k = &PyTuple_GET_ITEM(kwtuple, 0);
    pos = i = 0;
    while (PyDict_Next(kwargs, &pos, &k[i], &k[i + 1])) {
      Py_INCREF(k[i]);
      Py_INCREF(k[i + 1]);
      i += 2;
    }
    nk = i / 2;
  } else {
    kwtuple = NULL;
    k = NULL;
  }
  closure = PyFunction_GET_CLOSURE(func);
#if PY_MAJOR_VERSION >= 3
  kwdefs = PyFunction_GET_KW_DEFAULTS(func);
#endif
  if (argdefs != NULL) {
    d = &PyTuple_GET_ITEM(argdefs, 0);
    nd = Py_SIZE(argdefs);
  } else {
    d = NULL;
    nd = 0;
  }
#if PY_MAJOR_VERSION >= 3
  result =
      PyEval_EvalCodeEx((PyObject *)co, globals, (PyObject *)NULL, args,
                        (int)nargs, k, (int)nk, d, (int)nd, kwdefs, closure);
#else
  result = PyEval_EvalCodeEx(co, globals, (PyObject *)NULL, args, (int)nargs, k,
                             (int)nk, d, (int)nd, closure);
#endif
  Py_XDECREF(kwtuple);
done:
  Py_LeaveRecursiveCall();
  return result;
}
#endif
#endif

/* PyObjectCall */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject *
__Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw) {
  PyObject *result;
  ternaryfunc call = Py_TYPE(func)->tp_call;
  if (unlikely(!call))
    return PyObject_Call(func, arg, kw);
  if (unlikely(Py_EnterRecursiveCall((char *)" while calling a Python object")))
    return NULL;
  result = (*call)(func, arg, kw);
  Py_LeaveRecursiveCall();
  if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
    PyErr_SetString(PyExc_SystemError,
                    "NULL result without error in PyObject_Call");
  }
  return result;
}
#endif

/* PyObjectCallMethO */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject *__Pyx_PyObject_CallMethO(PyObject *func,
                                                        PyObject *arg) {
  PyObject *self, *result;
  PyCFunction cfunc;
  cfunc = PyCFunction_GET_FUNCTION(func);
  self = PyCFunction_GET_SELF(func);
  if (unlikely(Py_EnterRecursiveCall((char *)" while calling a Python object")))
    return NULL;
  result = cfunc(self, arg);
  Py_LeaveRecursiveCall();
  if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
    PyErr_SetString(PyExc_SystemError,
                    "NULL result without error in PyObject_Call");
  }
  return result;
}
#endif

/* PyObjectCallNoArg */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject *__Pyx_PyObject_CallNoArg(PyObject *func) {
#if CYTHON_FAST_PYCALL
  if (PyFunction_Check(func)) {
    return __Pyx_PyFunction_FastCall(func, NULL, 0);
  }
#endif
#if defined(__Pyx_CyFunction_USED) && defined(NDEBUG)
  if (likely(PyCFunction_Check(func) || __Pyx_CyFunction_Check(func)))
#else
  if (likely(PyCFunction_Check(func)))
#endif
  {
    if (likely(PyCFunction_GET_FLAGS(func) & METH_NOARGS)) {
      return __Pyx_PyObject_CallMethO(func, NULL);
    }
  }
  return __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL);
}
#endif

/* PyCFunctionFastCall */
#if CYTHON_FAST_PYCCALL
static CYTHON_INLINE PyObject *__Pyx_PyCFunction_FastCall(PyObject *func_obj,
                                                          PyObject **args,
                                                          Py_ssize_t nargs) {
  PyCFunctionObject *func = (PyCFunctionObject *)func_obj;
  PyCFunction meth = PyCFunction_GET_FUNCTION(func);
  PyObject *self = PyCFunction_GET_SELF(func);
  int flags = PyCFunction_GET_FLAGS(func);
  assert(PyCFunction_Check(func));
  assert(METH_FASTCALL == (flags & ~(METH_CLASS | METH_STATIC | METH_COEXIST |
                                     METH_KEYWORDS | METH_STACKLESS)));
  assert(nargs >= 0);
  assert(nargs == 0 || args != NULL);
  /* _PyCFunction_FastCallDict() must not be called with an exception set,
     because it may clear it (directly or indirectly) and so the
     caller loses its exception */
  assert(!PyErr_Occurred());
  if ((PY_VERSION_HEX < 0x030700A0) || unlikely(flags & METH_KEYWORDS)) {
    return (*((__Pyx_PyCFunctionFastWithKeywords)(void *)meth))(self, args,
                                                                nargs, NULL);
  } else {
    return (*((__Pyx_PyCFunctionFast)(void *)meth))(self, args, nargs);
  }
}
#endif

/* PyObjectCallOneArg */
#if CYTHON_COMPILING_IN_CPYTHON
static PyObject *__Pyx__PyObject_CallOneArg(PyObject *func, PyObject *arg) {
  PyObject *result;
  PyObject *args = PyTuple_New(1);
  if (unlikely(!args))
    return NULL;
  Py_INCREF(arg);
  PyTuple_SET_ITEM(args, 0, arg);
  result = __Pyx_PyObject_Call(func, args, NULL);
  Py_DECREF(args);
  return result;
}
static CYTHON_INLINE PyObject *__Pyx_PyObject_CallOneArg(PyObject *func,
                                                         PyObject *arg) {
#if CYTHON_FAST_PYCALL
  if (PyFunction_Check(func)) {
    return __Pyx_PyFunction_FastCall(func, &arg, 1);
  }
#endif
  if (likely(PyCFunction_Check(func))) {
    if (likely(PyCFunction_GET_FLAGS(func) & METH_O)) {
      return __Pyx_PyObject_CallMethO(func, arg);
#if CYTHON_FAST_PYCCALL
    } else if (__Pyx_PyFastCFunction_Check(func)) {
      return __Pyx_PyCFunction_FastCall(func, &arg, 1);
#endif
    }
  }
  return __Pyx__PyObject_CallOneArg(func, arg);
}
#else
static CYTHON_INLINE PyObject *__Pyx_PyObject_CallOneArg(PyObject *func,
                                                         PyObject *arg) {
  PyObject *result;
  PyObject *args = PyTuple_Pack(1, arg);
  if (unlikely(!args))
    return NULL;
  result = __Pyx_PyObject_Call(func, args, NULL);
  Py_DECREF(args);
  return result;
}
#endif

/* GetItemInt */
static PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject *j) {
  PyObject *r;
  if (!j)
    return NULL;
  r = PyObject_GetItem(o, j);
  Py_DECREF(j);
  return r;
}
static CYTHON_INLINE PyObject *
__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i,
                           CYTHON_NCP_UNUSED int wraparound,
                           CYTHON_NCP_UNUSED int boundscheck) {
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
  Py_ssize_t wrapped_i = i;
  if (wraparound & unlikely(i < 0)) {
    wrapped_i += PyList_GET_SIZE(o);
  }
  if ((!boundscheck) ||
      likely(__Pyx_is_valid_index(wrapped_i, PyList_GET_SIZE(o)))) {
    PyObject *r = PyList_GET_ITEM(o, wrapped_i);
    Py_INCREF(r);
    return r;
  }
  return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
#else
  return PySequence_GetItem(o, i);
#endif
}
static CYTHON_INLINE PyObject *
__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i,
                            CYTHON_NCP_UNUSED int wraparound,
                            CYTHON_NCP_UNUSED int boundscheck) {
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
  Py_ssize_t wrapped_i = i;
  if (wraparound & unlikely(i < 0)) {
    wrapped_i += PyTuple_GET_SIZE(o);
  }
  if ((!boundscheck) ||
      likely(__Pyx_is_valid_index(wrapped_i, PyTuple_GET_SIZE(o)))) {
    PyObject *r = PyTuple_GET_ITEM(o, wrapped_i);
    Py_INCREF(r);
    return r;
  }
  return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
#else
  return PySequence_GetItem(o, i);
#endif
}
static CYTHON_INLINE PyObject *
__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i, int is_list,
                      CYTHON_NCP_UNUSED int wraparound,
                      CYTHON_NCP_UNUSED int boundscheck) {
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS &&                \
    CYTHON_USE_TYPE_SLOTS
  if (is_list || PyList_CheckExact(o)) {
    Py_ssize_t n =
        ((!wraparound) | likely(i >= 0)) ? i : i + PyList_GET_SIZE(o);
    if ((!boundscheck) ||
        (likely(__Pyx_is_valid_index(n, PyList_GET_SIZE(o))))) {
      PyObject *r = PyList_GET_ITEM(o, n);
      Py_INCREF(r);
      return r;
    }
  } else if (PyTuple_CheckExact(o)) {
    Py_ssize_t n =
        ((!wraparound) | likely(i >= 0)) ? i : i + PyTuple_GET_SIZE(o);
    if ((!boundscheck) ||
        likely(__Pyx_is_valid_index(n, PyTuple_GET_SIZE(o)))) {
      PyObject *r = PyTuple_GET_ITEM(o, n);
      Py_INCREF(r);
      return r;
    }
  } else {
    PySequenceMethods *m = Py_TYPE(o)->tp_as_sequence;
    if (likely(m && m->sq_item)) {
      if (wraparound && unlikely(i < 0) && likely(m->sq_length)) {
        Py_ssize_t l = m->sq_length(o);
        if (likely(l >= 0)) {
          i += l;
        } else {
          if (!PyErr_ExceptionMatches(PyExc_OverflowError))
            return NULL;
          PyErr_Clear();
        }
      }
      return m->sq_item(o, i);
    }
  }
#else
  if (is_list || PySequence_Check(o)) {
    return PySequence_GetItem(o, i);
  }
#endif
  return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
}

/* PyObjectCall2Args */
static CYTHON_UNUSED PyObject *
__Pyx_PyObject_Call2Args(PyObject *function, PyObject *arg1, PyObject *arg2) {
  PyObject *args, *result = NULL;
#if CYTHON_FAST_PYCALL
  if (PyFunction_Check(function)) {
    PyObject *args[2] = {arg1, arg2};
    return __Pyx_PyFunction_FastCall(function, args, 2);
  }
#endif
#if CYTHON_FAST_PYCCALL
  if (__Pyx_PyFastCFunction_Check(function)) {
    PyObject *args[2] = {arg1, arg2};
    return __Pyx_PyCFunction_FastCall(function, args, 2);
  }
#endif
  args = PyTuple_New(2);
  if (unlikely(!args))
    goto done;
  Py_INCREF(arg1);
  PyTuple_SET_ITEM(args, 0, arg1);
  Py_INCREF(arg2);
  PyTuple_SET_ITEM(args, 1, arg2);
  Py_INCREF(function);
  result = __Pyx_PyObject_Call(function, args, NULL);
  Py_DECREF(args);
  Py_DECREF(function);
done:
  return result;
}

/* RaiseArgTupleInvalid */
static void __Pyx_RaiseArgtupleInvalid(const char *func_name, int exact,
                                       Py_ssize_t num_min, Py_ssize_t num_max,
                                       Py_ssize_t num_found) {
  Py_ssize_t num_expected;
  const char *more_or_less;
  if (num_found < num_min) {
    num_expected = num_min;
    more_or_less = "at least";
  } else {
    num_expected = num_max;
    more_or_less = "at most";
  }
  if (exact) {
    more_or_less = "exactly";
  }
  PyErr_Format(PyExc_TypeError,
               "%.200s() takes %.8s %" CYTHON_FORMAT_SSIZE_T
               "d positional argument%.1s (%" CYTHON_FORMAT_SSIZE_T "d given)",
               func_name, more_or_less, num_expected,
               (num_expected == 1) ? "" : "s", num_found);
}

/* RaiseDoubleKeywords */
static void __Pyx_RaiseDoubleKeywordsError(const char *func_name,
                                           PyObject *kw_name) {
  PyErr_Format(PyExc_TypeError,
#if PY_MAJOR_VERSION >= 3
               "%s() got multiple values for keyword argument '%U'", func_name,
               kw_name);
#else
               "%s() got multiple values for keyword argument '%s'", func_name,
               PyString_AsString(kw_name));
#endif
}

/* ParseKeywords */
static int __Pyx_ParseOptionalKeywords(PyObject *kwds, PyObject **argnames[],
                                       PyObject *kwds2, PyObject *values[],
                                       Py_ssize_t num_pos_args,
                                       const char *function_name) {
  PyObject *key = 0, *value = 0;
  Py_ssize_t pos = 0;
  PyObject ***name;
  PyObject ***first_kw_arg = argnames + num_pos_args;
  while (PyDict_Next(kwds, &pos, &key, &value)) {
    name = first_kw_arg;
    while (*name && (**name != key))
      name++;
    if (*name) {
      values[name - argnames] = value;
      continue;
    }
    name = first_kw_arg;
#if PY_MAJOR_VERSION < 3
    if (likely(PyString_Check(key))) {
      while (*name) {
        if ((CYTHON_COMPILING_IN_PYPY ||
             PyString_GET_SIZE(**name) == PyString_GET_SIZE(key)) &&
            _PyString_Eq(**name, key)) {
          values[name - argnames] = value;
          break;
        }
        name++;
      }
      if (*name)
        continue;
      else {
        PyObject ***argname = argnames;
        while (argname != first_kw_arg) {
          if ((**argname == key) ||
              ((CYTHON_COMPILING_IN_PYPY ||
                PyString_GET_SIZE(**argname) == PyString_GET_SIZE(key)) &&
               _PyString_Eq(**argname, key))) {
            goto arg_passed_twice;
          }
          argname++;
        }
      }
    } else
#endif
        if (likely(PyUnicode_Check(key))) {
      while (*name) {
        int cmp = (**name == key) ? 0 :
#if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
                  (__Pyx_PyUnicode_GET_LENGTH(**name) !=
                   __Pyx_PyUnicode_GET_LENGTH(key))
                      ? 1
                      :
#endif
                      PyUnicode_Compare(**name, key);
        if (cmp < 0 && unlikely(PyErr_Occurred()))
          goto bad;
        if (cmp == 0) {
          values[name - argnames] = value;
          break;
        }
        name++;
      }
      if (*name)
        continue;
      else {
        PyObject ***argname = argnames;
        while (argname != first_kw_arg) {
          int cmp = (**argname == key) ? 0 :
#if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
                    (__Pyx_PyUnicode_GET_LENGTH(**argname) !=
                     __Pyx_PyUnicode_GET_LENGTH(key))
                        ? 1
                        :
#endif
                        PyUnicode_Compare(**argname, key);
          if (cmp < 0 && unlikely(PyErr_Occurred()))
            goto bad;
          if (cmp == 0)
            goto arg_passed_twice;
          argname++;
        }
      }
    } else
      goto invalid_keyword_type;
    if (kwds2) {
      if (unlikely(PyDict_SetItem(kwds2, key, value)))
        goto bad;
    } else {
      goto invalid_keyword;
    }
  }
  return 0;
arg_passed_twice:
  __Pyx_RaiseDoubleKeywordsError(function_name, key);
  goto bad;
invalid_keyword_type:
  PyErr_Format(PyExc_TypeError, "%.200s() keywords must be strings",
               function_name);
  goto bad;
invalid_keyword:
  PyErr_Format(PyExc_TypeError,
#if PY_MAJOR_VERSION < 3
               "%.200s() got an unexpected keyword argument '%.200s'",
               function_name, PyString_AsString(key));
#else
               "%s() got an unexpected keyword argument '%U'", function_name,
               key);
#endif
bad:
  return -1;
}

/* PyIntCompare */
static CYTHON_INLINE PyObject *__Pyx_PyInt_EqObjC(PyObject *op1, PyObject *op2,
                                                  CYTHON_UNUSED long intval,
                                                  CYTHON_UNUSED long inplace) {
  if (op1 == op2) {
    Py_RETURN_TRUE;
  }
#if PY_MAJOR_VERSION < 3
  if (likely(PyInt_CheckExact(op1))) {
    const long b = intval;
    long a = PyInt_AS_LONG(op1);
    if (a == b)
      Py_RETURN_TRUE;
    else
      Py_RETURN_FALSE;
  }
#endif
#if CYTHON_USE_PYLONG_INTERNALS
  if (likely(PyLong_CheckExact(op1))) {
    int unequal;
    unsigned long uintval;
    Py_ssize_t size = Py_SIZE(op1);
    const digit *digits = ((PyLongObject *)op1)->ob_digit;
    if (intval == 0) {
      if (size == 0)
        Py_RETURN_TRUE;
      else
        Py_RETURN_FALSE;
    } else if (intval < 0) {
      if (size >= 0)
        Py_RETURN_FALSE;
      intval = -intval;
      size = -size;
    } else {
      if (size <= 0)
        Py_RETURN_FALSE;
    }
    uintval = (unsigned long)intval;
#if PyLong_SHIFT * 4 < SIZEOF_LONG * 8
    if (uintval >> (PyLong_SHIFT * 4)) {
      unequal =
          (size != 5) ||
          (digits[0] != (uintval & (unsigned long)PyLong_MASK)) |
              (digits[1] !=
               ((uintval >> (1 * PyLong_SHIFT)) & (unsigned long)PyLong_MASK)) |
              (digits[2] !=
               ((uintval >> (2 * PyLong_SHIFT)) & (unsigned long)PyLong_MASK)) |
              (digits[3] !=
               ((uintval >> (3 * PyLong_SHIFT)) & (unsigned long)PyLong_MASK)) |
              (digits[4] !=
               ((uintval >> (4 * PyLong_SHIFT)) & (unsigned long)PyLong_MASK));
    } else
#endif
#if PyLong_SHIFT * 3 < SIZEOF_LONG * 8
        if (uintval >> (PyLong_SHIFT * 3)) {
      unequal =
          (size != 4) ||
          (digits[0] != (uintval & (unsigned long)PyLong_MASK)) |
              (digits[1] !=
               ((uintval >> (1 * PyLong_SHIFT)) & (unsigned long)PyLong_MASK)) |
              (digits[2] !=
               ((uintval >> (2 * PyLong_SHIFT)) & (unsigned long)PyLong_MASK)) |
              (digits[3] !=
               ((uintval >> (3 * PyLong_SHIFT)) & (unsigned long)PyLong_MASK));
    } else
#endif
#if PyLong_SHIFT * 2 < SIZEOF_LONG * 8
        if (uintval >> (PyLong_SHIFT * 2)) {
      unequal =
          (size != 3) || (digits[0] != (uintval & (unsigned long)PyLong_MASK)) |
                             (digits[1] != ((uintval >> (1 * PyLong_SHIFT)) &
                                            (unsigned long)PyLong_MASK)) |
                             (digits[2] != ((uintval >> (2 * PyLong_SHIFT)) &
                                            (unsigned long)PyLong_MASK));
    } else
#endif
#if PyLong_SHIFT * 1 < SIZEOF_LONG * 8
        if (uintval >> (PyLong_SHIFT * 1)) {
      unequal =
          (size != 2) || (digits[0] != (uintval & (unsigned long)PyLong_MASK)) |
                             (digits[1] != ((uintval >> (1 * PyLong_SHIFT)) &
                                            (unsigned long)PyLong_MASK));
    } else
#endif
      unequal = (size != 1) || (((unsigned long)digits[0]) !=
                                (uintval & (unsigned long)PyLong_MASK));
    if (unequal == 0)
      Py_RETURN_TRUE;
    else
      Py_RETURN_FALSE;
  }
#endif
  if (PyFloat_CheckExact(op1)) {
    const long b = intval;
    double a = PyFloat_AS_DOUBLE(op1);
    if ((double)a == (double)b)
      Py_RETURN_TRUE;
    else
      Py_RETURN_FALSE;
  }
  return (PyObject_RichCompare(op1, op2, Py_EQ));
}

/* ObjectGetItem */
#if CYTHON_USE_TYPE_SLOTS
static PyObject *__Pyx_PyObject_GetIndex(PyObject *obj, PyObject *index) {
  PyObject *runerr = NULL;
  Py_ssize_t key_value;
  PySequenceMethods *m = Py_TYPE(obj)->tp_as_sequence;
  if (unlikely(!(m && m->sq_item))) {
    PyErr_Format(PyExc_TypeError, "'%.200s' object is not subscriptable",
                 Py_TYPE(obj)->tp_name);
    return NULL;
  }
  key_value = __Pyx_PyIndex_AsSsize_t(index);
  if (likely(key_value != -1 || !(runerr = PyErr_Occurred()))) {
    return __Pyx_GetItemInt_Fast(obj, key_value, 0, 1, 1);
  }
  if (PyErr_GivenExceptionMatches(runerr, PyExc_OverflowError)) {
    PyErr_Clear();
    PyErr_Format(PyExc_IndexError,
                 "cannot fit '%.200s' into an index-sized integer",
                 Py_TYPE(index)->tp_name);
  }
  return NULL;
}
static PyObject *__Pyx_PyObject_GetItem(PyObject *obj, PyObject *key) {
  PyMappingMethods *m = Py_TYPE(obj)->tp_as_mapping;
  if (likely(m && m->mp_subscript)) {
    return m->mp_subscript(obj, key);
  }
  return __Pyx_PyObject_GetIndex(obj, key);
}
#endif

/* PyIntBinop */
#if !CYTHON_COMPILING_IN_PYPY
static PyObject *__Pyx_PyInt_AddObjC(PyObject *op1, PyObject *op2,
                                     CYTHON_UNUSED long intval, int inplace,
                                     int zerodivision_check) {
  (void)inplace;
  (void)zerodivision_check;
#if PY_MAJOR_VERSION < 3
  if (likely(PyInt_CheckExact(op1))) {
    const long b = intval;
    long x;
    long a = PyInt_AS_LONG(op1);
    x = (long)((unsigned long)a + b);
    if (likely((x ^ a) >= 0 || (x ^ b) >= 0))
      return PyInt_FromLong(x);
    return PyLong_Type.tp_as_number->nb_add(op1, op2);
  }
#endif
#if CYTHON_USE_PYLONG_INTERNALS
  if (likely(PyLong_CheckExact(op1))) {
    const long b = intval;
    long a, x;
#ifdef HAVE_LONG_LONG
    const PY_LONG_LONG llb = intval;
    PY_LONG_LONG lla, llx;
#endif
    const digit *digits = ((PyLongObject *)op1)->ob_digit;
    const Py_ssize_t size = Py_SIZE(op1);
    if (likely(__Pyx_sst_abs(size) <= 1)) {
      a = likely(size) ? digits[0] : 0;
      if (size == -1)
        a = -a;
    } else {
      switch (size) {
      case -2:
        if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
          a = -(long)(((((unsigned long)digits[1]) << PyLong_SHIFT) |
                       (unsigned long)digits[0]));
          break;
#ifdef HAVE_LONG_LONG
        } else if (8 * sizeof(PY_LONG_LONG) - 1 > 2 * PyLong_SHIFT) {
          lla = -(PY_LONG_LONG)((
              (((unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) |
              (unsigned PY_LONG_LONG)digits[0]));
          goto long_long;
#endif
        }
        CYTHON_FALLTHROUGH;
      case 2:
        if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
          a = (long)(((((unsigned long)digits[1]) << PyLong_SHIFT) |
                      (unsigned long)digits[0]));
          break;
#ifdef HAVE_LONG_LONG
        } else if (8 * sizeof(PY_LONG_LONG) - 1 > 2 * PyLong_SHIFT) {
          lla = (PY_LONG_LONG)((
              (((unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) |
              (unsigned PY_LONG_LONG)digits[0]));
          goto long_long;
#endif
        }
        CYTHON_FALLTHROUGH;
      case -3:
        if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
          a = -(long)(((((((unsigned long)digits[2]) << PyLong_SHIFT) |
                         (unsigned long)digits[1])
                        << PyLong_SHIFT) |
                       (unsigned long)digits[0]));
          break;
#ifdef HAVE_LONG_LONG
        } else if (8 * sizeof(PY_LONG_LONG) - 1 > 3 * PyLong_SHIFT) {
          lla = -(PY_LONG_LONG)((
              (((((unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) |
                (unsigned PY_LONG_LONG)digits[1])
               << PyLong_SHIFT) |
              (unsigned PY_LONG_LONG)digits[0]));
          goto long_long;
#endif
        }
        CYTHON_FALLTHROUGH;
      case 3:
        if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
          a = (long)(((((((unsigned long)digits[2]) << PyLong_SHIFT) |
                        (unsigned long)digits[1])
                       << PyLong_SHIFT) |
                      (unsigned long)digits[0]));
          break;
#ifdef HAVE_LONG_LONG
        } else if (8 * sizeof(PY_LONG_LONG) - 1 > 3 * PyLong_SHIFT) {
          lla = (PY_LONG_LONG)((
              (((((unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) |
                (unsigned PY_LONG_LONG)digits[1])
               << PyLong_SHIFT) |
              (unsigned PY_LONG_LONG)digits[0]));
          goto long_long;
#endif
        }
        CYTHON_FALLTHROUGH;
      case -4:
        if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
          a = -(long)(((((((((unsigned long)digits[3]) << PyLong_SHIFT) |
                           (unsigned long)digits[2])
                          << PyLong_SHIFT) |
                         (unsigned long)digits[1])
                        << PyLong_SHIFT) |
                       (unsigned long)digits[0]));
          break;
#ifdef HAVE_LONG_LONG
        } else if (8 * sizeof(PY_LONG_LONG) - 1 > 4 * PyLong_SHIFT) {
          lla = -(PY_LONG_LONG)((
              (((((((unsigned PY_LONG_LONG)digits[3]) << PyLong_SHIFT) |
                  (unsigned PY_LONG_LONG)digits[2])
                 << PyLong_SHIFT) |
                (unsigned PY_LONG_LONG)digits[1])
               << PyLong_SHIFT) |
              (unsigned PY_LONG_LONG)digits[0]));
          goto long_long;
#endif
        }
        CYTHON_FALLTHROUGH;
      case 4:
        if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
          a = (long)(((((((((unsigned long)digits[3]) << PyLong_SHIFT) |
                          (unsigned long)digits[2])
                         << PyLong_SHIFT) |
                        (unsigned long)digits[1])
                       << PyLong_SHIFT) |
                      (unsigned long)digits[0]));
          break;
#ifdef HAVE_LONG_LONG
        } else if (8 * sizeof(PY_LONG_LONG) - 1 > 4 * PyLong_SHIFT) {
          lla = (PY_LONG_LONG)((
              (((((((unsigned PY_LONG_LONG)digits[3]) << PyLong_SHIFT) |
                  (unsigned PY_LONG_LONG)digits[2])
                 << PyLong_SHIFT) |
                (unsigned PY_LONG_LONG)digits[1])
               << PyLong_SHIFT) |
              (unsigned PY_LONG_LONG)digits[0]));
          goto long_long;
#endif
        }
        CYTHON_FALLTHROUGH;
      default:
        return PyLong_Type.tp_as_number->nb_add(op1, op2);
      }
    }
    x = a + b;
    return PyLong_FromLong(x);
#ifdef HAVE_LONG_LONG
  long_long:
    llx = lla + llb;
    return PyLong_FromLongLong(llx);
#endif
  }
#endif
  if (PyFloat_CheckExact(op1)) {
    const long b = intval;
    double a = PyFloat_AS_DOUBLE(op1);
    double result;
    PyFPE_START_PROTECT("add", return NULL) result = ((double)a) + (double)b;
    PyFPE_END_PROTECT(result) return PyFloat_FromDouble(result);
  }
  return (inplace ? PyNumber_InPlaceAdd : PyNumber_Add)(op1, op2);
}
#endif

/* PyIntBinop */
#if !CYTHON_COMPILING_IN_PYPY
static PyObject *__Pyx_PyInt_SubtractObjC(PyObject *op1, PyObject *op2,
                                          CYTHON_UNUSED long intval,
                                          int inplace, int zerodivision_check) {
  (void)inplace;
  (void)zerodivision_check;
#if PY_MAJOR_VERSION < 3
  if (likely(PyInt_CheckExact(op1))) {
    const long b = intval;
    long x;
    long a = PyInt_AS_LONG(op1);
    x = (long)((unsigned long)a - b);
    if (likely((x ^ a) >= 0 || (x ^ ~b) >= 0))
      return PyInt_FromLong(x);
    return PyLong_Type.tp_as_number->nb_subtract(op1, op2);
  }
#endif
#if CYTHON_USE_PYLONG_INTERNALS
  if (likely(PyLong_CheckExact(op1))) {
    const long b = intval;
    long a, x;
#ifdef HAVE_LONG_LONG
    const PY_LONG_LONG llb = intval;
    PY_LONG_LONG lla, llx;
#endif
    const digit *digits = ((PyLongObject *)op1)->ob_digit;
    const Py_ssize_t size = Py_SIZE(op1);
    if (likely(__Pyx_sst_abs(size) <= 1)) {
      a = likely(size) ? digits[0] : 0;
      if (size == -1)
        a = -a;
    } else {
      switch (size) {
      case -2:
        if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
          a = -(long)(((((unsigned long)digits[1]) << PyLong_SHIFT) |
                       (unsigned long)digits[0]));
          break;
#ifdef HAVE_LONG_LONG
        } else if (8 * sizeof(PY_LONG_LONG) - 1 > 2 * PyLong_SHIFT) {
          lla = -(PY_LONG_LONG)((
              (((unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) |
              (unsigned PY_LONG_LONG)digits[0]));
          goto long_long;
#endif
        }
        CYTHON_FALLTHROUGH;
      case 2:
        if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
          a = (long)(((((unsigned long)digits[1]) << PyLong_SHIFT) |
                      (unsigned long)digits[0]));
          break;
#ifdef HAVE_LONG_LONG
        } else if (8 * sizeof(PY_LONG_LONG) - 1 > 2 * PyLong_SHIFT) {
          lla = (PY_LONG_LONG)((
              (((unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) |
              (unsigned PY_LONG_LONG)digits[0]));
          goto long_long;
#endif
        }
        CYTHON_FALLTHROUGH;
      case -3:
        if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
          a = -(long)(((((((unsigned long)digits[2]) << PyLong_SHIFT) |
                         (unsigned long)digits[1])
                        << PyLong_SHIFT) |
                       (unsigned long)digits[0]));
          break;
#ifdef HAVE_LONG_LONG
        } else if (8 * sizeof(PY_LONG_LONG) - 1 > 3 * PyLong_SHIFT) {
          lla = -(PY_LONG_LONG)((
              (((((unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) |
                (unsigned PY_LONG_LONG)digits[1])
               << PyLong_SHIFT) |
              (unsigned PY_LONG_LONG)digits[0]));
          goto long_long;
#endif
        }
        CYTHON_FALLTHROUGH;
      case 3:
        if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
          a = (long)(((((((unsigned long)digits[2]) << PyLong_SHIFT) |
                        (unsigned long)digits[1])
                       << PyLong_SHIFT) |
                      (unsigned long)digits[0]));
          break;
#ifdef HAVE_LONG_LONG
        } else if (8 * sizeof(PY_LONG_LONG) - 1 > 3 * PyLong_SHIFT) {
          lla = (PY_LONG_LONG)((
              (((((unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) |
                (unsigned PY_LONG_LONG)digits[1])
               << PyLong_SHIFT) |
              (unsigned PY_LONG_LONG)digits[0]));
          goto long_long;
#endif
        }
        CYTHON_FALLTHROUGH;
      case -4:
        if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
          a = -(long)(((((((((unsigned long)digits[3]) << PyLong_SHIFT) |
                           (unsigned long)digits[2])
                          << PyLong_SHIFT) |
                         (unsigned long)digits[1])
                        << PyLong_SHIFT) |
                       (unsigned long)digits[0]));
          break;
#ifdef HAVE_LONG_LONG
        } else if (8 * sizeof(PY_LONG_LONG) - 1 > 4 * PyLong_SHIFT) {
          lla = -(PY_LONG_LONG)((
              (((((((unsigned PY_LONG_LONG)digits[3]) << PyLong_SHIFT) |
                  (unsigned PY_LONG_LONG)digits[2])
                 << PyLong_SHIFT) |
                (unsigned PY_LONG_LONG)digits[1])
               << PyLong_SHIFT) |
              (unsigned PY_LONG_LONG)digits[0]));
          goto long_long;
#endif
        }
        CYTHON_FALLTHROUGH;
      case 4:
        if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
          a = (long)(((((((((unsigned long)digits[3]) << PyLong_SHIFT) |
                          (unsigned long)digits[2])
                         << PyLong_SHIFT) |
                        (unsigned long)digits[1])
                       << PyLong_SHIFT) |
                      (unsigned long)digits[0]));
          break;
#ifdef HAVE_LONG_LONG
        } else if (8 * sizeof(PY_LONG_LONG) - 1 > 4 * PyLong_SHIFT) {
          lla = (PY_LONG_LONG)((
              (((((((unsigned PY_LONG_LONG)digits[3]) << PyLong_SHIFT) |
                  (unsigned PY_LONG_LONG)digits[2])
                 << PyLong_SHIFT) |
                (unsigned PY_LONG_LONG)digits[1])
               << PyLong_SHIFT) |
              (unsigned PY_LONG_LONG)digits[0]));
          goto long_long;
#endif
        }
        CYTHON_FALLTHROUGH;
      default:
        return PyLong_Type.tp_as_number->nb_subtract(op1, op2);
      }
    }
    x = a - b;
    return PyLong_FromLong(x);
#ifdef HAVE_LONG_LONG
  long_long:
    llx = lla - llb;
    return PyLong_FromLongLong(llx);
#endif
  }
#endif
  if (PyFloat_CheckExact(op1)) {
    const long b = intval;
    double a = PyFloat_AS_DOUBLE(op1);
    double result;
    PyFPE_START_PROTECT("subtract", return NULL) result =
        ((double)a) - (double)b;
    PyFPE_END_PROTECT(result) return PyFloat_FromDouble(result);
  }
  return (inplace ? PyNumber_InPlaceSubtract : PyNumber_Subtract)(op1, op2);
}
#endif

/* PyObjectGetMethod */
static int __Pyx_PyObject_GetMethod(PyObject *obj, PyObject *name,
                                    PyObject **method) {
  PyObject *attr;
#if CYTHON_UNPACK_METHODS && CYTHON_COMPILING_IN_CPYTHON &&                    \
    CYTHON_USE_PYTYPE_LOOKUP
  PyTypeObject *tp = Py_TYPE(obj);
  PyObject *descr;
  descrgetfunc f = NULL;
  PyObject **dictptr, *dict;
  int meth_found = 0;
  assert(*method == NULL);
  if (unlikely(tp->tp_getattro != PyObject_GenericGetAttr)) {
    attr = __Pyx_PyObject_GetAttrStr(obj, name);
    goto try_unpack;
  }
  if (unlikely(tp->tp_dict == NULL) && unlikely(PyType_Ready(tp) < 0)) {
    return 0;
  }
  descr = _PyType_Lookup(tp, name);
  if (likely(descr != NULL)) {
    Py_INCREF(descr);
#if PY_MAJOR_VERSION >= 3
#ifdef __Pyx_CyFunction_USED
    if (likely(PyFunction_Check(descr) ||
               (Py_TYPE(descr) == &PyMethodDescr_Type) ||
               __Pyx_CyFunction_Check(descr)))
#else
    if (likely(PyFunction_Check(descr) ||
               (Py_TYPE(descr) == &PyMethodDescr_Type)))
#endif
#else
#ifdef __Pyx_CyFunction_USED
    if (likely(PyFunction_Check(descr) || __Pyx_CyFunction_Check(descr)))
#else
    if (likely(PyFunction_Check(descr)))
#endif
#endif
    {
      meth_found = 1;
    } else {
      f = Py_TYPE(descr)->tp_descr_get;
      if (f != NULL && PyDescr_IsData(descr)) {
        attr = f(descr, obj, (PyObject *)Py_TYPE(obj));
        Py_DECREF(descr);
        goto try_unpack;
      }
    }
  }
  dictptr = _PyObject_GetDictPtr(obj);
  if (dictptr != NULL && (dict = *dictptr) != NULL) {
    Py_INCREF(dict);
    attr = __Pyx_PyDict_GetItemStr(dict, name);
    if (attr != NULL) {
      Py_INCREF(attr);
      Py_DECREF(dict);
      Py_XDECREF(descr);
      goto try_unpack;
    }
    Py_DECREF(dict);
  }
  if (meth_found) {
    *method = descr;
    return 1;
  }
  if (f != NULL) {
    attr = f(descr, obj, (PyObject *)Py_TYPE(obj));
    Py_DECREF(descr);
    goto try_unpack;
  }
  if (descr != NULL) {
    *method = descr;
    return 0;
  }
  PyErr_Format(PyExc_AttributeError,
#if PY_MAJOR_VERSION >= 3
               "'%.50s' object has no attribute '%U'", tp->tp_name, name);
#else
               "'%.50s' object has no attribute '%.400s'", tp->tp_name,
               PyString_AS_STRING(name));
#endif
  return 0;
#else
  attr = __Pyx_PyObject_GetAttrStr(obj, name);
  goto try_unpack;
#endif
try_unpack:
#if CYTHON_UNPACK_METHODS
  if (likely(attr) && PyMethod_Check(attr) &&
      likely(PyMethod_GET_SELF(attr) == obj)) {
    PyObject *function = PyMethod_GET_FUNCTION(attr);
    Py_INCREF(function);
    Py_DECREF(attr);
    *method = function;
    return 1;
  }
#endif
  *method = attr;
  return 0;
}

/* PyObjectCallMethod1 */
static PyObject *__Pyx__PyObject_CallMethod1(PyObject *method, PyObject *arg) {
  PyObject *result = __Pyx_PyObject_CallOneArg(method, arg);
  Py_DECREF(method);
  return result;
}
static PyObject *__Pyx_PyObject_CallMethod1(PyObject *obj,
                                            PyObject *method_name,
                                            PyObject *arg) {
  PyObject *method = NULL, *result;
  int is_method = __Pyx_PyObject_GetMethod(obj, method_name, &method);
  if (likely(is_method)) {
    result = __Pyx_PyObject_Call2Args(method, obj, arg);
    Py_DECREF(method);
    return result;
  }
  if (unlikely(!method))
    return NULL;
  return __Pyx__PyObject_CallMethod1(method, arg);
}

/* append */
static CYTHON_INLINE int __Pyx_PyObject_Append(PyObject *L, PyObject *x) {
  if (likely(PyList_CheckExact(L))) {
    if (unlikely(__Pyx_PyList_Append(L, x) < 0))
      return -1;
  } else {
    PyObject *retval = __Pyx_PyObject_CallMethod1(L, __pyx_n_s_append, x);
    if (unlikely(!retval))
      return -1;
    Py_DECREF(retval);
  }
  return 0;
}

/* None */
static CYTHON_INLINE void __Pyx_RaiseClosureNameError(const char *varname) {
  PyErr_Format(
      PyExc_NameError,
      "free variable '%s' referenced before assignment in enclosing scope",
      varname);
}

/* PyFloatBinop */
#if !CYTHON_COMPILING_IN_PYPY
static PyObject *__Pyx_PyFloat_TrueDivideObjC(PyObject *op1, PyObject *op2,
                                              double floatval, int inplace,
                                              int zerodivision_check) {
  const double b = floatval;
  double a, result;
  (void)inplace;
  (void)zerodivision_check;
  if (likely(PyFloat_CheckExact(op1))) {
    a = PyFloat_AS_DOUBLE(op1);

  } else
#if PY_MAJOR_VERSION < 3
      if (likely(PyInt_CheckExact(op1))) {
    a = (double)PyInt_AS_LONG(op1);

  } else
#endif
      if (likely(PyLong_CheckExact(op1))) {
#if CYTHON_USE_PYLONG_INTERNALS
    const digit *digits = ((PyLongObject *)op1)->ob_digit;
    const Py_ssize_t size = Py_SIZE(op1);
    switch (size) {
    case 0:
      a = 0.0;
      break;
    case -1:
      a = -(double)digits[0];
      break;
    case 1:
      a = (double)digits[0];
      break;
    case -2:
    case 2:
      if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT &&
          ((8 * sizeof(unsigned long) < 53) || (1 * PyLong_SHIFT < 53))) {
        a = (double)(((((unsigned long)digits[1]) << PyLong_SHIFT) |
                      (unsigned long)digits[0]));
        if ((8 * sizeof(unsigned long) < 53) || (2 * PyLong_SHIFT < 53) ||
            (a < (double)((PY_LONG_LONG)1 << 53))) {
          if (size == -2)
            a = -a;
          break;
        }
      }
      CYTHON_FALLTHROUGH;
    case -3:
    case 3:
      if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT &&
          ((8 * sizeof(unsigned long) < 53) || (2 * PyLong_SHIFT < 53))) {
        a = (double)(((((((unsigned long)digits[2]) << PyLong_SHIFT) |
                        (unsigned long)digits[1])
                       << PyLong_SHIFT) |
                      (unsigned long)digits[0]));
        if ((8 * sizeof(unsigned long) < 53) || (3 * PyLong_SHIFT < 53) ||
            (a < (double)((PY_LONG_LONG)1 << 53))) {
          if (size == -3)
            a = -a;
          break;
        }
      }
      CYTHON_FALLTHROUGH;
    case -4:
    case 4:
      if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT &&
          ((8 * sizeof(unsigned long) < 53) || (3 * PyLong_SHIFT < 53))) {
        a = (double)(((((((((unsigned long)digits[3]) << PyLong_SHIFT) |
                          (unsigned long)digits[2])
                         << PyLong_SHIFT) |
                        (unsigned long)digits[1])
                       << PyLong_SHIFT) |
                      (unsigned long)digits[0]));
        if ((8 * sizeof(unsigned long) < 53) || (4 * PyLong_SHIFT < 53) ||
            (a < (double)((PY_LONG_LONG)1 << 53))) {
          if (size == -4)
            a = -a;
          break;
        }
      }
      CYTHON_FALLTHROUGH;
    default:
#else
    {
#endif
      a = PyLong_AsDouble(op1);
      if (unlikely(a == -1.0 && PyErr_Occurred()))
        return NULL;
    }
  } else {
    return (inplace ? PyNumber_InPlaceTrueDivide : PyNumber_TrueDivide)(op1,
                                                                        op2);
  }

  PyFPE_START_PROTECT("divide", return NULL) result = a / b;
  PyFPE_END_PROTECT(result) return PyFloat_FromDouble(result);
}
#endif

/* FetchCommonType */
static PyTypeObject *__Pyx_FetchCommonType(PyTypeObject *type) {
  PyObject *fake_module;
  PyTypeObject *cached_type = NULL;
  fake_module = PyImport_AddModule((char *)"_cython_" CYTHON_ABI);
  if (!fake_module)
    return NULL;
  Py_INCREF(fake_module);
  cached_type =
      (PyTypeObject *)PyObject_GetAttrString(fake_module, type->tp_name);
  if (cached_type) {
    if (!PyType_Check((PyObject *)cached_type)) {
      PyErr_Format(PyExc_TypeError,
                   "Shared Cython type %.200s is not a type object",
                   type->tp_name);
      goto bad;
    }
    if (cached_type->tp_basicsize != type->tp_basicsize) {
      PyErr_Format(
          PyExc_TypeError,
          "Shared Cython type %.200s has the wrong size, try recompiling",
          type->tp_name);
      goto bad;
    }
  } else {
    if (!PyErr_ExceptionMatches(PyExc_AttributeError))
      goto bad;
    PyErr_Clear();
    if (PyType_Ready(type) < 0)
      goto bad;
    if (PyObject_SetAttrString(fake_module, type->tp_name, (PyObject *)type) <
        0)
      goto bad;
    Py_INCREF(type);
    cached_type = type;
  }
done:
  Py_DECREF(fake_module);
  return cached_type;
bad:
  Py_XDECREF(cached_type);
  cached_type = NULL;
  goto done;
}

/* CythonFunctionShared */
#include <structmember.h>
static PyObject *__Pyx_CyFunction_get_doc(__pyx_CyFunctionObject *op,
                                          CYTHON_UNUSED void *closure) {
  if (unlikely(op->func_doc == NULL)) {
    if (op->func.m_ml->ml_doc) {
#if PY_MAJOR_VERSION >= 3
      op->func_doc = PyUnicode_FromString(op->func.m_ml->ml_doc);
#else
      op->func_doc = PyString_FromString(op->func.m_ml->ml_doc);
#endif
      if (unlikely(op->func_doc == NULL))
        return NULL;
    } else {
      Py_INCREF(Py_None);
      return Py_None;
    }
  }
  Py_INCREF(op->func_doc);
  return op->func_doc;
}
static int __Pyx_CyFunction_set_doc(__pyx_CyFunctionObject *op, PyObject *value,
                                    CYTHON_UNUSED void *context) {
  PyObject *tmp = op->func_doc;
  if (value == NULL) {
    value = Py_None;
  }
  Py_INCREF(value);
  op->func_doc = value;
  Py_XDECREF(tmp);
  return 0;
}
static PyObject *__Pyx_CyFunction_get_name(__pyx_CyFunctionObject *op,
                                           CYTHON_UNUSED void *context) {
  if (unlikely(op->func_name == NULL)) {
#if PY_MAJOR_VERSION >= 3
    op->func_name = PyUnicode_InternFromString(op->func.m_ml->ml_name);
#else
    op->func_name = PyString_InternFromString(op->func.m_ml->ml_name);
#endif
    if (unlikely(op->func_name == NULL))
      return NULL;
  }
  Py_INCREF(op->func_name);
  return op->func_name;
}
static int __Pyx_CyFunction_set_name(__pyx_CyFunctionObject *op,
                                     PyObject *value,
                                     CYTHON_UNUSED void *context) {
  PyObject *tmp;
#if PY_MAJOR_VERSION >= 3
  if (unlikely(value == NULL || !PyUnicode_Check(value)))
#else
  if (unlikely(value == NULL || !PyString_Check(value)))
#endif
  {
    PyErr_SetString(PyExc_TypeError, "__name__ must be set to a string object");
    return -1;
  }
  tmp = op->func_name;
  Py_INCREF(value);
  op->func_name = value;
  Py_XDECREF(tmp);
  return 0;
}
static PyObject *__Pyx_CyFunction_get_qualname(__pyx_CyFunctionObject *op,
                                               CYTHON_UNUSED void *context) {
  Py_INCREF(op->func_qualname);
  return op->func_qualname;
}
static int __Pyx_CyFunction_set_qualname(__pyx_CyFunctionObject *op,
                                         PyObject *value,
                                         CYTHON_UNUSED void *context) {
  PyObject *tmp;
#if PY_MAJOR_VERSION >= 3
  if (unlikely(value == NULL || !PyUnicode_Check(value)))
#else
  if (unlikely(value == NULL || !PyString_Check(value)))
#endif
  {
    PyErr_SetString(PyExc_TypeError,
                    "__qualname__ must be set to a string object");
    return -1;
  }
  tmp = op->func_qualname;
  Py_INCREF(value);
  op->func_qualname = value;
  Py_XDECREF(tmp);
  return 0;
}
static PyObject *__Pyx_CyFunction_get_self(__pyx_CyFunctionObject *m,
                                           CYTHON_UNUSED void *closure) {
  PyObject *self;
  self = m->func_closure;
  if (self == NULL)
    self = Py_None;
  Py_INCREF(self);
  return self;
}
static PyObject *__Pyx_CyFunction_get_dict(__pyx_CyFunctionObject *op,
                                           CYTHON_UNUSED void *context) {
  if (unlikely(op->func_dict == NULL)) {
    op->func_dict = PyDict_New();
    if (unlikely(op->func_dict == NULL))
      return NULL;
  }
  Py_INCREF(op->func_dict);
  return op->func_dict;
}
static int __Pyx_CyFunction_set_dict(__pyx_CyFunctionObject *op,
                                     PyObject *value,
                                     CYTHON_UNUSED void *context) {
  PyObject *tmp;
  if (unlikely(value == NULL)) {
    PyErr_SetString(PyExc_TypeError,
                    "function's dictionary may not be deleted");
    return -1;
  }
  if (unlikely(!PyDict_Check(value))) {
    PyErr_SetString(PyExc_TypeError,
                    "setting function's dictionary to a non-dict");
    return -1;
  }
  tmp = op->func_dict;
  Py_INCREF(value);
  op->func_dict = value;
  Py_XDECREF(tmp);
  return 0;
}
static PyObject *__Pyx_CyFunction_get_globals(__pyx_CyFunctionObject *op,
                                              CYTHON_UNUSED void *context) {
  Py_INCREF(op->func_globals);
  return op->func_globals;
}
static PyObject *
__Pyx_CyFunction_get_closure(CYTHON_UNUSED __pyx_CyFunctionObject *op,
                             CYTHON_UNUSED void *context) {
  Py_INCREF(Py_None);
  return Py_None;
}
static PyObject *__Pyx_CyFunction_get_code(__pyx_CyFunctionObject *op,
                                           CYTHON_UNUSED void *context) {
  PyObject *result = (op->func_code) ? op->func_code : Py_None;
  Py_INCREF(result);
  return result;
}
static int __Pyx_CyFunction_init_defaults(__pyx_CyFunctionObject *op) {
  int result = 0;
  PyObject *res = op->defaults_getter((PyObject *)op);
  if (unlikely(!res))
    return -1;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
  op->defaults_tuple = PyTuple_GET_ITEM(res, 0);
  Py_INCREF(op->defaults_tuple);
  op->defaults_kwdict = PyTuple_GET_ITEM(res, 1);
  Py_INCREF(op->defaults_kwdict);
#else
  op->defaults_tuple = PySequence_ITEM(res, 0);
  if (unlikely(!op->defaults_tuple))
    result = -1;
  else {
    op->defaults_kwdict = PySequence_ITEM(res, 1);
    if (unlikely(!op->defaults_kwdict))
      result = -1;
  }
#endif
  Py_DECREF(res);
  return result;
}
static int __Pyx_CyFunction_set_defaults(__pyx_CyFunctionObject *op,
                                         PyObject *value,
                                         CYTHON_UNUSED void *context) {
  PyObject *tmp;
  if (!value) {
    value = Py_None;
  } else if (value != Py_None && !PyTuple_Check(value)) {
    PyErr_SetString(PyExc_TypeError,
                    "__defaults__ must be set to a tuple object");
    return -1;
  }
  Py_INCREF(value);
  tmp = op->defaults_tuple;
  op->defaults_tuple = value;
  Py_XDECREF(tmp);
  return 0;
}
static PyObject *__Pyx_CyFunction_get_defaults(__pyx_CyFunctionObject *op,
                                               CYTHON_UNUSED void *context) {
  PyObject *result = op->defaults_tuple;
  if (unlikely(!result)) {
    if (op->defaults_getter) {
      if (__Pyx_CyFunction_init_defaults(op) < 0)
        return NULL;
      result = op->defaults_tuple;
    } else {
      result = Py_None;
    }
  }
  Py_INCREF(result);
  return result;
}
static int __Pyx_CyFunction_set_kwdefaults(__pyx_CyFunctionObject *op,
                                           PyObject *value,
                                           CYTHON_UNUSED void *context) {
  PyObject *tmp;
  if (!value) {
    value = Py_None;
  } else if (value != Py_None && !PyDict_Check(value)) {
    PyErr_SetString(PyExc_TypeError,
                    "__kwdefaults__ must be set to a dict object");
    return -1;
  }
  Py_INCREF(value);
  tmp = op->defaults_kwdict;
  op->defaults_kwdict = value;
  Py_XDECREF(tmp);
  return 0;
}
static PyObject *__Pyx_CyFunction_get_kwdefaults(__pyx_CyFunctionObject *op,
                                                 CYTHON_UNUSED void *context) {
  PyObject *result = op->defaults_kwdict;
  if (unlikely(!result)) {
    if (op->defaults_getter) {
      if (__Pyx_CyFunction_init_defaults(op) < 0)
        return NULL;
      result = op->defaults_kwdict;
    } else {
      result = Py_None;
    }
  }
  Py_INCREF(result);
  return result;
}
static int __Pyx_CyFunction_set_annotations(__pyx_CyFunctionObject *op,
                                            PyObject *value,
                                            CYTHON_UNUSED void *context) {
  PyObject *tmp;
  if (!value || value == Py_None) {
    value = NULL;
  } else if (!PyDict_Check(value)) {
    PyErr_SetString(PyExc_TypeError,
                    "__annotations__ must be set to a dict object");
    return -1;
  }
  Py_XINCREF(value);
  tmp = op->func_annotations;
  op->func_annotations = value;
  Py_XDECREF(tmp);
  return 0;
}
static PyObject *__Pyx_CyFunction_get_annotations(__pyx_CyFunctionObject *op,
                                                  CYTHON_UNUSED void *context) {
  PyObject *result = op->func_annotations;
  if (unlikely(!result)) {
    result = PyDict_New();
    if (unlikely(!result))
      return NULL;
    op->func_annotations = result;
  }
  Py_INCREF(result);
  return result;
}
static PyGetSetDef __pyx_CyFunction_getsets[] = {
    {(char *)"func_doc", (getter)__Pyx_CyFunction_get_doc,
     (setter)__Pyx_CyFunction_set_doc, 0, 0},
    {(char *)"__doc__", (getter)__Pyx_CyFunction_get_doc,
     (setter)__Pyx_CyFunction_set_doc, 0, 0},
    {(char *)"func_name", (getter)__Pyx_CyFunction_get_name,
     (setter)__Pyx_CyFunction_set_name, 0, 0},
    {(char *)"__name__", (getter)__Pyx_CyFunction_get_name,
     (setter)__Pyx_CyFunction_set_name, 0, 0},
    {(char *)"__qualname__", (getter)__Pyx_CyFunction_get_qualname,
     (setter)__Pyx_CyFunction_set_qualname, 0, 0},
    {(char *)"__self__", (getter)__Pyx_CyFunction_get_self, 0, 0, 0},
    {(char *)"func_dict", (getter)__Pyx_CyFunction_get_dict,
     (setter)__Pyx_CyFunction_set_dict, 0, 0},
    {(char *)"__dict__", (getter)__Pyx_CyFunction_get_dict,
     (setter)__Pyx_CyFunction_set_dict, 0, 0},
    {(char *)"func_globals", (getter)__Pyx_CyFunction_get_globals, 0, 0, 0},
    {(char *)"__globals__", (getter)__Pyx_CyFunction_get_globals, 0, 0, 0},
    {(char *)"func_closure", (getter)__Pyx_CyFunction_get_closure, 0, 0, 0},
    {(char *)"__closure__", (getter)__Pyx_CyFunction_get_closure, 0, 0, 0},
    {(char *)"func_code", (getter)__Pyx_CyFunction_get_code, 0, 0, 0},
    {(char *)"__code__", (getter)__Pyx_CyFunction_get_code, 0, 0, 0},
    {(char *)"func_defaults", (getter)__Pyx_CyFunction_get_defaults,
     (setter)__Pyx_CyFunction_set_defaults, 0, 0},
    {(char *)"__defaults__", (getter)__Pyx_CyFunction_get_defaults,
     (setter)__Pyx_CyFunction_set_defaults, 0, 0},
    {(char *)"__kwdefaults__", (getter)__Pyx_CyFunction_get_kwdefaults,
     (setter)__Pyx_CyFunction_set_kwdefaults, 0, 0},
    {(char *)"__annotations__", (getter)__Pyx_CyFunction_get_annotations,
     (setter)__Pyx_CyFunction_set_annotations, 0, 0},
    {0, 0, 0, 0, 0}};
static PyMemberDef __pyx_CyFunction_members[] = {
    {(char *)"__module__", T_OBJECT, offsetof(PyCFunctionObject, m_module),
     PY_WRITE_RESTRICTED, 0},
    {0, 0, 0, 0, 0}};
static PyObject *__Pyx_CyFunction_reduce(__pyx_CyFunctionObject *m,
                                         CYTHON_UNUSED PyObject *args) {
#if PY_MAJOR_VERSION >= 3
  Py_INCREF(m->func_qualname);
  return m->func_qualname;
#else
  return PyString_FromString(m->func.m_ml->ml_name);
#endif
}
static PyMethodDef __pyx_CyFunction_methods[] = {
    {"__reduce__", (PyCFunction)__Pyx_CyFunction_reduce, METH_VARARGS, 0},
    {0, 0, 0, 0}};
#if PY_VERSION_HEX < 0x030500A0
#define __Pyx_CyFunction_weakreflist(cyfunc) ((cyfunc)->func_weakreflist)
#else
#define __Pyx_CyFunction_weakreflist(cyfunc) ((cyfunc)->func.m_weakreflist)
#endif
static PyObject *__Pyx_CyFunction_Init(__pyx_CyFunctionObject *op,
                                       PyMethodDef *ml, int flags,
                                       PyObject *qualname, PyObject *closure,
                                       PyObject *module, PyObject *globals,
                                       PyObject *code) {
  if (unlikely(op == NULL))
    return NULL;
  op->flags = flags;
  __Pyx_CyFunction_weakreflist(op) = NULL;
  op->func.m_ml = ml;
  op->func.m_self = (PyObject *)op;
  Py_XINCREF(closure);
  op->func_closure = closure;
  Py_XINCREF(module);
  op->func.m_module = module;
  op->func_dict = NULL;
  op->func_name = NULL;
  Py_INCREF(qualname);
  op->func_qualname = qualname;
  op->func_doc = NULL;
  op->func_classobj = NULL;
  op->func_globals = globals;
  Py_INCREF(op->func_globals);
  Py_XINCREF(code);
  op->func_code = code;
  op->defaults_pyobjects = 0;
  op->defaults_size = 0;
  op->defaults = NULL;
  op->defaults_tuple = NULL;
  op->defaults_kwdict = NULL;
  op->defaults_getter = NULL;
  op->func_annotations = NULL;
  return (PyObject *)op;
}
static int __Pyx_CyFunction_clear(__pyx_CyFunctionObject *m) {
  Py_CLEAR(m->func_closure);
  Py_CLEAR(m->func.m_module);
  Py_CLEAR(m->func_dict);
  Py_CLEAR(m->func_name);
  Py_CLEAR(m->func_qualname);
  Py_CLEAR(m->func_doc);
  Py_CLEAR(m->func_globals);
  Py_CLEAR(m->func_code);
  Py_CLEAR(m->func_classobj);
  Py_CLEAR(m->defaults_tuple);
  Py_CLEAR(m->defaults_kwdict);
  Py_CLEAR(m->func_annotations);
  if (m->defaults) {
    PyObject **pydefaults = __Pyx_CyFunction_Defaults(PyObject *, m);
    int i;
    for (i = 0; i < m->defaults_pyobjects; i++)
      Py_XDECREF(pydefaults[i]);
    PyObject_Free(m->defaults);
    m->defaults = NULL;
  }
  return 0;
}
static void __Pyx__CyFunction_dealloc(__pyx_CyFunctionObject *m) {
  if (__Pyx_CyFunction_weakreflist(m) != NULL)
    PyObject_ClearWeakRefs((PyObject *)m);
  __Pyx_CyFunction_clear(m);
  PyObject_GC_Del(m);
}
static void __Pyx_CyFunction_dealloc(__pyx_CyFunctionObject *m) {
  PyObject_GC_UnTrack(m);
  __Pyx__CyFunction_dealloc(m);
}
static int __Pyx_CyFunction_traverse(__pyx_CyFunctionObject *m, visitproc visit,
                                     void *arg) {
  Py_VISIT(m->func_closure);
  Py_VISIT(m->func.m_module);
  Py_VISIT(m->func_dict);
  Py_VISIT(m->func_name);
  Py_VISIT(m->func_qualname);
  Py_VISIT(m->func_doc);
  Py_VISIT(m->func_globals);
  Py_VISIT(m->func_code);
  Py_VISIT(m->func_classobj);
  Py_VISIT(m->defaults_tuple);
  Py_VISIT(m->defaults_kwdict);
  if (m->defaults) {
    PyObject **pydefaults = __Pyx_CyFunction_Defaults(PyObject *, m);
    int i;
    for (i = 0; i < m->defaults_pyobjects; i++)
      Py_VISIT(pydefaults[i]);
  }
  return 0;
}
static PyObject *__Pyx_CyFunction_descr_get(PyObject *func, PyObject *obj,
                                            PyObject *type) {
#if PY_MAJOR_VERSION < 3
  __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *)func;
  if (m->flags & __Pyx_CYFUNCTION_STATICMETHOD) {
    Py_INCREF(func);
    return func;
  }
  if (m->flags & __Pyx_CYFUNCTION_CLASSMETHOD) {
    if (type == NULL)
      type = (PyObject *)(Py_TYPE(obj));
    return __Pyx_PyMethod_New(func, type, (PyObject *)(Py_TYPE(type)));
  }
  if (obj == Py_None)
    obj = NULL;
#endif
  return __Pyx_PyMethod_New(func, obj, type);
}
static PyObject *__Pyx_CyFunction_repr(__pyx_CyFunctionObject *op) {
#if PY_MAJOR_VERSION >= 3
  return PyUnicode_FromFormat("<cyfunction %U at %p>", op->func_qualname,
                              (void *)op);
#else
  return PyString_FromFormat("<cyfunction %s at %p>",
                             PyString_AsString(op->func_qualname), (void *)op);
#endif
}
static PyObject *__Pyx_CyFunction_CallMethod(PyObject *func, PyObject *self,
                                             PyObject *arg, PyObject *kw) {
  PyCFunctionObject *f = (PyCFunctionObject *)func;
  PyCFunction meth = f->m_ml->ml_meth;
  Py_ssize_t size;
  switch (f->m_ml->ml_flags &
          (METH_VARARGS | METH_KEYWORDS | METH_NOARGS | METH_O)) {
  case METH_VARARGS:
    if (likely(kw == NULL || PyDict_Size(kw) == 0))
      return (*meth)(self, arg);
    break;
  case METH_VARARGS | METH_KEYWORDS:
    return (*(PyCFunctionWithKeywords)(void *)meth)(self, arg, kw);
  case METH_NOARGS:
    if (likely(kw == NULL || PyDict_Size(kw) == 0)) {
      size = PyTuple_GET_SIZE(arg);
      if (likely(size == 0))
        return (*meth)(self, NULL);
      PyErr_Format(PyExc_TypeError,
                   "%.200s() takes no arguments (%" CYTHON_FORMAT_SSIZE_T
                   "d given)",
                   f->m_ml->ml_name, size);
      return NULL;
    }
    break;
  case METH_O:
    if (likely(kw == NULL || PyDict_Size(kw) == 0)) {
      size = PyTuple_GET_SIZE(arg);
      if (likely(size == 1)) {
        PyObject *result, *arg0;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        arg0 = PyTuple_GET_ITEM(arg, 0);
#else
        arg0 = PySequence_ITEM(arg, 0);
        if (unlikely(!arg0))
          return NULL;
#endif
        result = (*meth)(self, arg0);
#if !(CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS)
        Py_DECREF(arg0);
#endif
        return result;
      }
      PyErr_Format(
          PyExc_TypeError,
          "%.200s() takes exactly one argument (%" CYTHON_FORMAT_SSIZE_T
          "d given)",
          f->m_ml->ml_name, size);
      return NULL;
    }
    break;
  default:
    PyErr_SetString(PyExc_SystemError,
                    "Bad call flags in "
                    "__Pyx_CyFunction_Call. METH_OLDARGS is no "
                    "longer supported!");
    return NULL;
  }
  PyErr_Format(PyExc_TypeError, "%.200s() takes no keyword arguments",
               f->m_ml->ml_name);
  return NULL;
}
static CYTHON_INLINE PyObject *
__Pyx_CyFunction_Call(PyObject *func, PyObject *arg, PyObject *kw) {
  return __Pyx_CyFunction_CallMethod(func, ((PyCFunctionObject *)func)->m_self,
                                     arg, kw);
}
static PyObject *__Pyx_CyFunction_CallAsMethod(PyObject *func, PyObject *args,
                                               PyObject *kw) {
  PyObject *result;
  __pyx_CyFunctionObject *cyfunc = (__pyx_CyFunctionObject *)func;
  if ((cyfunc->flags & __Pyx_CYFUNCTION_CCLASS) &&
      !(cyfunc->flags & __Pyx_CYFUNCTION_STATICMETHOD)) {
    Py_ssize_t argc;
    PyObject *new_args;
    PyObject *self;
    argc = PyTuple_GET_SIZE(args);
    new_args = PyTuple_GetSlice(args, 1, argc);
    if (unlikely(!new_args))
      return NULL;
    self = PyTuple_GetItem(args, 0);
    if (unlikely(!self)) {
      Py_DECREF(new_args);
#if PY_MAJOR_VERSION > 2
      PyErr_Format(PyExc_TypeError, "unbound method %.200S() needs an argument",
                   cyfunc->func_qualname);
#else
      PyErr_SetString(PyExc_TypeError, "unbound method needs an argument");
#endif
      return NULL;
    }
    result = __Pyx_CyFunction_CallMethod(func, self, new_args, kw);
    Py_DECREF(new_args);
  } else {
    result = __Pyx_CyFunction_Call(func, args, kw);
  }
  return result;
}
static PyTypeObject __pyx_CyFunctionType_type = {
  PyVarObject_HEAD_INIT(0, 0) "cython_function_or_method",
  sizeof(__pyx_CyFunctionObject),
  0,
  (destructor)__Pyx_CyFunction_dealloc,
  0,
  0,
  0,
#if PY_MAJOR_VERSION < 3
  0,
#else
  0,
#endif
  (reprfunc)__Pyx_CyFunction_repr,
  0,
  0,
  0,
  0,
  __Pyx_CyFunction_CallAsMethod,
  0,
  0,
  0,
  0,
  Py_TPFLAGS_DEFAULT | Py_TPFLAGS_HAVE_GC,
  0,
  (traverseproc)__Pyx_CyFunction_traverse,
  (inquiry)__Pyx_CyFunction_clear,
  0,
#if PY_VERSION_HEX < 0x030500A0
  offsetof(__pyx_CyFunctionObject, func_weakreflist),
#else
  offsetof(PyCFunctionObject, m_weakreflist),
#endif
  0,
  0,
  __pyx_CyFunction_methods,
  __pyx_CyFunction_members,
  __pyx_CyFunction_getsets,
  0,
  0,
  __Pyx_CyFunction_descr_get,
  0,
  offsetof(__pyx_CyFunctionObject, func_dict),
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
#if PY_VERSION_HEX >= 0x030400a1
  0,
#endif
#if PY_VERSION_HEX >= 0x030800b1 &&                                            \
    (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
  0,
#endif
#if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
  0,
#endif
#if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000
  0,
#endif
};
static int __pyx_CyFunction_init(void) {
  __pyx_CyFunctionType = __Pyx_FetchCommonType(&__pyx_CyFunctionType_type);
  if (unlikely(__pyx_CyFunctionType == NULL)) {
    return -1;
  }
  return 0;
}
static CYTHON_INLINE void *
__Pyx_CyFunction_InitDefaults(PyObject *func, size_t size, int pyobjects) {
  __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *)func;
  m->defaults = PyObject_Malloc(size);
  if (unlikely(!m->defaults))
    return PyErr_NoMemory();
  memset(m->defaults, 0, size);
  m->defaults_pyobjects = pyobjects;
  m->defaults_size = size;
  return m->defaults;
}
static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsTuple(PyObject *func,
                                                            PyObject *tuple) {
  __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *)func;
  m->defaults_tuple = tuple;
  Py_INCREF(tuple);
}
static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsKwDict(PyObject *func,
                                                             PyObject *dict) {
  __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *)func;
  m->defaults_kwdict = dict;
  Py_INCREF(dict);
}
static CYTHON_INLINE void __Pyx_CyFunction_SetAnnotationsDict(PyObject *func,
                                                              PyObject *dict) {
  __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *)func;
  m->func_annotations = dict;
  Py_INCREF(dict);
}

/* CythonFunction */
static PyObject *__Pyx_CyFunction_New(PyMethodDef *ml, int flags,
                                      PyObject *qualname, PyObject *closure,
                                      PyObject *module, PyObject *globals,
                                      PyObject *code) {
  PyObject *op = __Pyx_CyFunction_Init(
      PyObject_GC_New(__pyx_CyFunctionObject, __pyx_CyFunctionType), ml, flags,
      qualname, closure, module, globals, code);
  if (likely(op)) {
    PyObject_GC_Track(op);
  }
  return op;
}

/* DictGetItem */
#if PY_MAJOR_VERSION >= 3 && !CYTHON_COMPILING_IN_PYPY
static PyObject *__Pyx_PyDict_GetItem(PyObject *d, PyObject *key) {
  PyObject *value;
  value = PyDict_GetItemWithError(d, key);
  if (unlikely(!value)) {
    if (!PyErr_Occurred()) {
      if (unlikely(PyTuple_Check(key))) {
        PyObject *args = PyTuple_Pack(1, key);
        if (likely(args)) {
          PyErr_SetObject(PyExc_KeyError, args);
          Py_DECREF(args);
        }
      } else {
        PyErr_SetObject(PyExc_KeyError, key);
      }
    }
    return NULL;
  }
  Py_INCREF(value);
  return value;
}
#endif

/* UnpackUnboundCMethod */
static int __Pyx_TryUnpackUnboundCMethod(__Pyx_CachedCFunction *target) {
  PyObject *method;
  method = __Pyx_PyObject_GetAttrStr(target->type, *target->method_name);
  if (unlikely(!method))
    return -1;
  target->method = method;
#if CYTHON_COMPILING_IN_CPYTHON
#if PY_MAJOR_VERSION >= 3
  if (likely(__Pyx_TypeCheck(method, &PyMethodDescr_Type)))
#endif
  {
    PyMethodDescrObject *descr = (PyMethodDescrObject *)method;
    target->func = descr->d_method->ml_meth;
    target->flag = descr->d_method->ml_flags &
                   ~(METH_CLASS | METH_STATIC | METH_COEXIST | METH_STACKLESS);
  }
#endif
  return 0;
}

/* CallUnboundCMethod0 */
static PyObject *__Pyx__CallUnboundCMethod0(__Pyx_CachedCFunction *cfunc,
                                            PyObject *self) {
  PyObject *args, *result = NULL;
  if (unlikely(!cfunc->method) &&
      unlikely(__Pyx_TryUnpackUnboundCMethod(cfunc) < 0))
    return NULL;
#if CYTHON_ASSUME_SAFE_MACROS
  args = PyTuple_New(1);
  if (unlikely(!args))
    goto bad;
  Py_INCREF(self);
  PyTuple_SET_ITEM(args, 0, self);
#else
  args = PyTuple_Pack(1, self);
  if (unlikely(!args))
    goto bad;
#endif
  result = __Pyx_PyObject_Call(cfunc->method, args, NULL);
  Py_DECREF(args);
bad:
  return result;
}

/* py_dict_items */
static CYTHON_INLINE PyObject *__Pyx_PyDict_Items(PyObject *d) {
  if (PY_MAJOR_VERSION >= 3)
    return __Pyx_CallUnboundCMethod0(&__pyx_umethod_PyDict_Type_items, d);
  else
    return PyDict_Items(d);
}

/* RaiseTooManyValuesToUnpack */
static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected) {
  PyErr_Format(PyExc_ValueError,
               "too many values to unpack (expected %" CYTHON_FORMAT_SSIZE_T
               "d)",
               expected);
}

/* RaiseNeedMoreValuesToUnpack */
static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index) {
  PyErr_Format(PyExc_ValueError,
               "need more than %" CYTHON_FORMAT_SSIZE_T "d value%.1s to unpack",
               index, (index == 1) ? "" : "s");
}

/* IterFinish */
static CYTHON_INLINE int __Pyx_IterFinish(void) {
#if CYTHON_FAST_THREAD_STATE
  PyThreadState *tstate = __Pyx_PyThreadState_Current;
  PyObject *exc_type = tstate->curexc_type;
  if (unlikely(exc_type)) {
    if (likely(
            __Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) {
      PyObject *exc_value, *exc_tb;
      exc_value = tstate->curexc_value;
      exc_tb = tstate->curexc_traceback;
      tstate->curexc_type = 0;
      tstate->curexc_value = 0;
      tstate->curexc_traceback = 0;
      Py_DECREF(exc_type);
      Py_XDECREF(exc_value);
      Py_XDECREF(exc_tb);
      return 0;
    } else {
      return -1;
    }
  }
  return 0;
#else
  if (unlikely(PyErr_Occurred())) {
    if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) {
      PyErr_Clear();
      return 0;
    } else {
      return -1;
    }
  }
  return 0;
#endif
}

/* UnpackItemEndCheck */
static int __Pyx_IternextUnpackEndCheck(PyObject *retval, Py_ssize_t expected) {
  if (unlikely(retval)) {
    Py_DECREF(retval);
    __Pyx_RaiseTooManyValuesError(expected);
    return -1;
  }
  return __Pyx_IterFinish();
}

/* pyobject_as_double */
static double __Pyx__PyObject_AsDouble(PyObject *obj) {
  PyObject *float_value;
#if !CYTHON_USE_TYPE_SLOTS
  float_value = PyNumber_Float(obj);
  if ((0))
    goto bad;
#else
  PyNumberMethods *nb = Py_TYPE(obj)->tp_as_number;
  if (likely(nb) && likely(nb->nb_float)) {
    float_value = nb->nb_float(obj);
    if (likely(float_value) && unlikely(!PyFloat_Check(float_value))) {
      PyErr_Format(PyExc_TypeError,
                   "__float__ returned non-float (type %.200s)",
                   Py_TYPE(float_value)->tp_name);
      Py_DECREF(float_value);
      goto bad;
    }
  } else if (PyUnicode_CheckExact(obj) || PyBytes_CheckExact(obj)) {
#if PY_MAJOR_VERSION >= 3
    float_value = PyFloat_FromString(obj);
#else
    float_value = PyFloat_FromString(obj, 0);
#endif
  } else {
    PyObject *args = PyTuple_New(1);
    if (unlikely(!args))
      goto bad;
    PyTuple_SET_ITEM(args, 0, obj);
    float_value = PyObject_Call((PyObject *)&PyFloat_Type, args, 0);
    PyTuple_SET_ITEM(args, 0, 0);
    Py_DECREF(args);
  }
#endif
  if (likely(float_value)) {
    double value = PyFloat_AS_DOUBLE(float_value);
    Py_DECREF(float_value);
    return value;
  }
bad:
  return (double)-1;
}

/* GetTopmostException */
#if CYTHON_USE_EXC_INFO_STACK
static _PyErr_StackItem *
__Pyx_PyErr_GetTopmostException(PyThreadState *tstate) {
  _PyErr_StackItem *exc_info = tstate->exc_info;
  while ((exc_info->exc_type == NULL || exc_info->exc_type == Py_None) &&
         exc_info->previous_item != NULL) {
    exc_info = exc_info->previous_item;
  }
  return exc_info;
}
#endif

/* SaveResetException */
#if CYTHON_FAST_THREAD_STATE
static CYTHON_INLINE void __Pyx__ExceptionSave(PyThreadState *tstate,
                                               PyObject **type,
                                               PyObject **value,
                                               PyObject **tb) {
#if CYTHON_USE_EXC_INFO_STACK
  _PyErr_StackItem *exc_info = __Pyx_PyErr_GetTopmostException(tstate);
  *type = exc_info->exc_type;
  *value = exc_info->exc_value;
  *tb = exc_info->exc_traceback;
#else
  *type = tstate->exc_type;
  *value = tstate->exc_value;
  *tb = tstate->exc_traceback;
#endif
  Py_XINCREF(*type);
  Py_XINCREF(*value);
  Py_XINCREF(*tb);
}
static CYTHON_INLINE void __Pyx__ExceptionReset(PyThreadState *tstate,
                                                PyObject *type, PyObject *value,
                                                PyObject *tb) {
  PyObject *tmp_type, *tmp_value, *tmp_tb;
#if CYTHON_USE_EXC_INFO_STACK
  _PyErr_StackItem *exc_info = tstate->exc_info;
  tmp_type = exc_info->exc_type;
  tmp_value = exc_info->exc_value;
  tmp_tb = exc_info->exc_traceback;
  exc_info->exc_type = type;
  exc_info->exc_value = value;
  exc_info->exc_traceback = tb;
#else
  tmp_type = tstate->exc_type;
  tmp_value = tstate->exc_value;
  tmp_tb = tstate->exc_traceback;
  tstate->exc_type = type;
  tstate->exc_value = value;
  tstate->exc_traceback = tb;
#endif
  Py_XDECREF(tmp_type);
  Py_XDECREF(tmp_value);
  Py_XDECREF(tmp_tb);
}
#endif

/* GetException */
#if CYTHON_FAST_THREAD_STATE
static int __Pyx__GetException(PyThreadState *tstate, PyObject **type,
                               PyObject **value, PyObject **tb)
#else
static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb)
#endif
{
  PyObject *local_type, *local_value, *local_tb;
#if CYTHON_FAST_THREAD_STATE
  PyObject *tmp_type, *tmp_value, *tmp_tb;
  local_type = tstate->curexc_type;
  local_value = tstate->curexc_value;
  local_tb = tstate->curexc_traceback;
  tstate->curexc_type = 0;
  tstate->curexc_value = 0;
  tstate->curexc_traceback = 0;
#else
  PyErr_Fetch(&local_type, &local_value, &local_tb);
#endif
  PyErr_NormalizeException(&local_type, &local_value, &local_tb);
#if CYTHON_FAST_THREAD_STATE
  if (unlikely(tstate->curexc_type))
#else
  if (unlikely(PyErr_Occurred()))
#endif
    goto bad;
#if PY_MAJOR_VERSION >= 3
  if (local_tb) {
    if (unlikely(PyException_SetTraceback(local_value, local_tb) < 0))
      goto bad;
  }
#endif
  Py_XINCREF(local_tb);
  Py_XINCREF(local_type);
  Py_XINCREF(local_value);
  *type = local_type;
  *value = local_value;
  *tb = local_tb;
#if CYTHON_FAST_THREAD_STATE
#if CYTHON_USE_EXC_INFO_STACK
  {
    _PyErr_StackItem *exc_info = tstate->exc_info;
    tmp_type = exc_info->exc_type;
    tmp_value = exc_info->exc_value;
    tmp_tb = exc_info->exc_traceback;
    exc_info->exc_type = local_type;
    exc_info->exc_value = local_value;
    exc_info->exc_traceback = local_tb;
  }
#else
  tmp_type = tstate->exc_type;
  tmp_value = tstate->exc_value;
  tmp_tb = tstate->exc_traceback;
  tstate->exc_type = local_type;
  tstate->exc_value = local_value;
  tstate->exc_traceback = local_tb;
#endif
  Py_XDECREF(tmp_type);
  Py_XDECREF(tmp_value);
  Py_XDECREF(tmp_tb);
#else
  PyErr_SetExcInfo(local_type, local_value, local_tb);
#endif
  return 0;
bad:
  *type = 0;
  *value = 0;
  *tb = 0;
  Py_XDECREF(local_type);
  Py_XDECREF(local_value);
  Py_XDECREF(local_tb);
  return -1;
}

/* PyErrFetchRestore */
#if CYTHON_FAST_THREAD_STATE
static CYTHON_INLINE void __Pyx_ErrRestoreInState(PyThreadState *tstate,
                                                  PyObject *type,
                                                  PyObject *value,
                                                  PyObject *tb) {
  PyObject *tmp_type, *tmp_value, *tmp_tb;
  tmp_type = tstate->curexc_type;
  tmp_value = tstate->curexc_value;
  tmp_tb = tstate->curexc_traceback;
  tstate->curexc_type = type;
  tstate->curexc_value = value;
  tstate->curexc_traceback = tb;
  Py_XDECREF(tmp_type);
  Py_XDECREF(tmp_value);
  Py_XDECREF(tmp_tb);
}
static CYTHON_INLINE void __Pyx_ErrFetchInState(PyThreadState *tstate,
                                                PyObject **type,
                                                PyObject **value,
                                                PyObject **tb) {
  *type = tstate->curexc_type;
  *value = tstate->curexc_value;
  *tb = tstate->curexc_traceback;
  tstate->curexc_type = 0;
  tstate->curexc_value = 0;
  tstate->curexc_traceback = 0;
}
#endif

/* py_abs */
#if CYTHON_USE_PYLONG_INTERNALS
static PyObject *__Pyx_PyLong_AbsNeg(PyObject *n) {
  if (likely(Py_SIZE(n) == -1)) {
    return PyLong_FromLong(((PyLongObject *)n)->ob_digit[0]);
  }
#if CYTHON_COMPILING_IN_CPYTHON
  {
    PyObject *copy = _PyLong_Copy((PyLongObject *)n);
    if (likely(copy)) {
      __Pyx_SET_SIZE(copy, -Py_SIZE(copy));
    }
    return copy;
  }
#else
  return PyNumber_Negative(n);
#endif
}
#endif

/* PyIntCompare */
static CYTHON_INLINE PyObject *__Pyx_PyInt_NeObjC(PyObject *op1, PyObject *op2,
                                                  CYTHON_UNUSED long intval,
                                                  CYTHON_UNUSED long inplace) {
  if (op1 == op2) {
    Py_RETURN_FALSE;
  }
#if PY_MAJOR_VERSION < 3
  if (likely(PyInt_CheckExact(op1))) {
    const long b = intval;
    long a = PyInt_AS_LONG(op1);
    if (a != b)
      Py_RETURN_TRUE;
    else
      Py_RETURN_FALSE;
  }
#endif
#if CYTHON_USE_PYLONG_INTERNALS
  if (likely(PyLong_CheckExact(op1))) {
    int unequal;
    unsigned long uintval;
    Py_ssize_t size = Py_SIZE(op1);
    const digit *digits = ((PyLongObject *)op1)->ob_digit;
    if (intval == 0) {
      if (size != 0)
        Py_RETURN_TRUE;
      else
        Py_RETURN_FALSE;
    } else if (intval < 0) {
      if (size >= 0)
        Py_RETURN_TRUE;
      intval = -intval;
      size = -size;
    } else {
      if (size <= 0)
        Py_RETURN_TRUE;
    }
    uintval = (unsigned long)intval;
#if PyLong_SHIFT * 4 < SIZEOF_LONG * 8
    if (uintval >> (PyLong_SHIFT * 4)) {
      unequal =
          (size != 5) ||
          (digits[0] != (uintval & (unsigned long)PyLong_MASK)) |
              (digits[1] !=
               ((uintval >> (1 * PyLong_SHIFT)) & (unsigned long)PyLong_MASK)) |
              (digits[2] !=
               ((uintval >> (2 * PyLong_SHIFT)) & (unsigned long)PyLong_MASK)) |
              (digits[3] !=
               ((uintval >> (3 * PyLong_SHIFT)) & (unsigned long)PyLong_MASK)) |
              (digits[4] !=
               ((uintval >> (4 * PyLong_SHIFT)) & (unsigned long)PyLong_MASK));
    } else
#endif
#if PyLong_SHIFT * 3 < SIZEOF_LONG * 8
        if (uintval >> (PyLong_SHIFT * 3)) {
      unequal =
          (size != 4) ||
          (digits[0] != (uintval & (unsigned long)PyLong_MASK)) |
              (digits[1] !=
               ((uintval >> (1 * PyLong_SHIFT)) & (unsigned long)PyLong_MASK)) |
              (digits[2] !=
               ((uintval >> (2 * PyLong_SHIFT)) & (unsigned long)PyLong_MASK)) |
              (digits[3] !=
               ((uintval >> (3 * PyLong_SHIFT)) & (unsigned long)PyLong_MASK));
    } else
#endif
#if PyLong_SHIFT * 2 < SIZEOF_LONG * 8
        if (uintval >> (PyLong_SHIFT * 2)) {
      unequal =
          (size != 3) || (digits[0] != (uintval & (unsigned long)PyLong_MASK)) |
                             (digits[1] != ((uintval >> (1 * PyLong_SHIFT)) &
                                            (unsigned long)PyLong_MASK)) |
                             (digits[2] != ((uintval >> (2 * PyLong_SHIFT)) &
                                            (unsigned long)PyLong_MASK));
    } else
#endif
#if PyLong_SHIFT * 1 < SIZEOF_LONG * 8
        if (uintval >> (PyLong_SHIFT * 1)) {
      unequal =
          (size != 2) || (digits[0] != (uintval & (unsigned long)PyLong_MASK)) |
                             (digits[1] != ((uintval >> (1 * PyLong_SHIFT)) &
                                            (unsigned long)PyLong_MASK));
    } else
#endif
      unequal = (size != 1) || (((unsigned long)digits[0]) !=
                                (uintval & (unsigned long)PyLong_MASK));
    if (unequal != 0)
      Py_RETURN_TRUE;
    else
      Py_RETURN_FALSE;
  }
#endif
  if (PyFloat_CheckExact(op1)) {
    const long b = intval;
    double a = PyFloat_AS_DOUBLE(op1);
    if ((double)a != (double)b)
      Py_RETURN_TRUE;
    else
      Py_RETURN_FALSE;
  }
  return (PyObject_RichCompare(op1, op2, Py_NE));
}

/* PyErrExceptionMatches */
#if CYTHON_FAST_THREAD_STATE
static int __Pyx_PyErr_ExceptionMatchesTuple(PyObject *exc_type,
                                             PyObject *tuple) {
  Py_ssize_t i, n;
  n = PyTuple_GET_SIZE(tuple);
#if PY_MAJOR_VERSION >= 3
  for (i = 0; i < n; i++) {
    if (exc_type == PyTuple_GET_ITEM(tuple, i))
      return 1;
  }
#endif
  for (i = 0; i < n; i++) {
    if (__Pyx_PyErr_GivenExceptionMatches(exc_type, PyTuple_GET_ITEM(tuple, i)))
      return 1;
  }
  return 0;
}
static CYTHON_INLINE int
__Pyx_PyErr_ExceptionMatchesInState(PyThreadState *tstate, PyObject *err) {
  PyObject *exc_type = tstate->curexc_type;
  if (exc_type == err)
    return 1;
  if (unlikely(!exc_type))
    return 0;
  if (unlikely(PyTuple_Check(err)))
    return __Pyx_PyErr_ExceptionMatchesTuple(exc_type, err);
  return __Pyx_PyErr_GivenExceptionMatches(exc_type, err);
}
#endif

/* PyIntBinop */
#if !CYTHON_COMPILING_IN_PYPY
static PyObject *__Pyx_PyInt_AndObjC(PyObject *op1, PyObject *op2,
                                     CYTHON_UNUSED long intval, int inplace,
                                     int zerodivision_check) {
  (void)inplace;
  (void)zerodivision_check;
#if PY_MAJOR_VERSION < 3
  if (likely(PyInt_CheckExact(op1))) {
    const long b = intval;
    long a = PyInt_AS_LONG(op1);
    return PyInt_FromLong(a & b);
  }
#endif
#if CYTHON_USE_PYLONG_INTERNALS
  if (likely(PyLong_CheckExact(op1))) {
    const long b = intval;
    long a, x;
#ifdef HAVE_LONG_LONG
    const PY_LONG_LONG llb = intval;
    PY_LONG_LONG lla, llx;
#endif
    const digit *digits = ((PyLongObject *)op1)->ob_digit;
    const Py_ssize_t size = Py_SIZE(op1);
    if (likely(__Pyx_sst_abs(size) <= 1)) {
      a = likely(size) ? digits[0] : 0;
      if (size == -1)
        a = -a;
    } else {
      switch (size) {
      case -2:
        if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
          a = -(long)(((((unsigned long)digits[1]) << PyLong_SHIFT) |
                       (unsigned long)digits[0]));
          break;
#ifdef HAVE_LONG_LONG
        } else if (8 * sizeof(PY_LONG_LONG) - 1 > 2 * PyLong_SHIFT) {
          lla = -(PY_LONG_LONG)((
              (((unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) |
              (unsigned PY_LONG_LONG)digits[0]));
          goto long_long;
#endif
        }
        CYTHON_FALLTHROUGH;
      case 2:
        if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
          a = (long)(((((unsigned long)digits[1]) << PyLong_SHIFT) |
                      (unsigned long)digits[0]));
          break;
#ifdef HAVE_LONG_LONG
        } else if (8 * sizeof(PY_LONG_LONG) - 1 > 2 * PyLong_SHIFT) {
          lla = (PY_LONG_LONG)((
              (((unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) |
              (unsigned PY_LONG_LONG)digits[0]));
          goto long_long;
#endif
        }
        CYTHON_FALLTHROUGH;
      case -3:
        if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
          a = -(long)(((((((unsigned long)digits[2]) << PyLong_SHIFT) |
                         (unsigned long)digits[1])
                        << PyLong_SHIFT) |
                       (unsigned long)digits[0]));
          break;
#ifdef HAVE_LONG_LONG
        } else if (8 * sizeof(PY_LONG_LONG) - 1 > 3 * PyLong_SHIFT) {
          lla = -(PY_LONG_LONG)((
              (((((unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) |
                (unsigned PY_LONG_LONG)digits[1])
               << PyLong_SHIFT) |
              (unsigned PY_LONG_LONG)digits[0]));
          goto long_long;
#endif
        }
        CYTHON_FALLTHROUGH;
      case 3:
        if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
          a = (long)(((((((unsigned long)digits[2]) << PyLong_SHIFT) |
                        (unsigned long)digits[1])
                       << PyLong_SHIFT) |
                      (unsigned long)digits[0]));
          break;
#ifdef HAVE_LONG_LONG
        } else if (8 * sizeof(PY_LONG_LONG) - 1 > 3 * PyLong_SHIFT) {
          lla = (PY_LONG_LONG)((
              (((((unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) |
                (unsigned PY_LONG_LONG)digits[1])
               << PyLong_SHIFT) |
              (unsigned PY_LONG_LONG)digits[0]));
          goto long_long;
#endif
        }
        CYTHON_FALLTHROUGH;
      case -4:
        if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
          a = -(long)(((((((((unsigned long)digits[3]) << PyLong_SHIFT) |
                           (unsigned long)digits[2])
                          << PyLong_SHIFT) |
                         (unsigned long)digits[1])
                        << PyLong_SHIFT) |
                       (unsigned long)digits[0]));
          break;
#ifdef HAVE_LONG_LONG
        } else if (8 * sizeof(PY_LONG_LONG) - 1 > 4 * PyLong_SHIFT) {
          lla = -(PY_LONG_LONG)((
              (((((((unsigned PY_LONG_LONG)digits[3]) << PyLong_SHIFT) |
                  (unsigned PY_LONG_LONG)digits[2])
                 << PyLong_SHIFT) |
                (unsigned PY_LONG_LONG)digits[1])
               << PyLong_SHIFT) |
              (unsigned PY_LONG_LONG)digits[0]));
          goto long_long;
#endif
        }
        CYTHON_FALLTHROUGH;
      case 4:
        if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
          a = (long)(((((((((unsigned long)digits[3]) << PyLong_SHIFT) |
                          (unsigned long)digits[2])
                         << PyLong_SHIFT) |
                        (unsigned long)digits[1])
                       << PyLong_SHIFT) |
                      (unsigned long)digits[0]));
          break;
#ifdef HAVE_LONG_LONG
        } else if (8 * sizeof(PY_LONG_LONG) - 1 > 4 * PyLong_SHIFT) {
          lla = (PY_LONG_LONG)((
              (((((((unsigned PY_LONG_LONG)digits[3]) << PyLong_SHIFT) |
                  (unsigned PY_LONG_LONG)digits[2])
                 << PyLong_SHIFT) |
                (unsigned PY_LONG_LONG)digits[1])
               << PyLong_SHIFT) |
              (unsigned PY_LONG_LONG)digits[0]));
          goto long_long;
#endif
        }
        CYTHON_FALLTHROUGH;
      default:
        return PyLong_Type.tp_as_number->nb_and(op1, op2);
      }
    }
    x = a & b;
    return PyLong_FromLong(x);
#ifdef HAVE_LONG_LONG
  long_long:
    llx = lla & llb;
    return PyLong_FromLongLong(llx);
#endif
  }
#endif
  return (inplace ? PyNumber_InPlaceAnd : PyNumber_And)(op1, op2);
}
#endif

/* CallUnboundCMethod1 */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject *
__Pyx_CallUnboundCMethod1(__Pyx_CachedCFunction *cfunc, PyObject *self,
                          PyObject *arg) {
  if (likely(cfunc->func)) {
    int flag = cfunc->flag;
    if (flag == METH_O) {
      return (*(cfunc->func))(self, arg);
    } else if (PY_VERSION_HEX >= 0x030600B1 && flag == METH_FASTCALL) {
#if PY_VERSION_HEX >= 0x030700A0
      return (*(__Pyx_PyCFunctionFast)(void *)(PyCFunction)cfunc->func)(
          self, &arg, 1);
#else
      return (
          *(__Pyx_PyCFunctionFastWithKeywords)(void *)(PyCFunction)cfunc->func)(
          self, &arg, 1, NULL);
#endif
    } else if (PY_VERSION_HEX >= 0x030700A0 &&
               flag == (METH_FASTCALL | METH_KEYWORDS)) {
      return (
          *(__Pyx_PyCFunctionFastWithKeywords)(void *)(PyCFunction)cfunc->func)(
          self, &arg, 1, NULL);
    }
  }
  return __Pyx__CallUnboundCMethod1(cfunc, self, arg);
}
#endif
static PyObject *__Pyx__CallUnboundCMethod1(__Pyx_CachedCFunction *cfunc,
                                            PyObject *self, PyObject *arg) {
  PyObject *args, *result = NULL;
  if (unlikely(!cfunc->func && !cfunc->method) &&
      unlikely(__Pyx_TryUnpackUnboundCMethod(cfunc) < 0))
    return NULL;
#if CYTHON_COMPILING_IN_CPYTHON
  if (cfunc->func && (cfunc->flag & METH_VARARGS)) {
    args = PyTuple_New(1);
    if (unlikely(!args))
      goto bad;
    Py_INCREF(arg);
    PyTuple_SET_ITEM(args, 0, arg);
    if (cfunc->flag & METH_KEYWORDS)
      result = (*(PyCFunctionWithKeywords)(void *)(PyCFunction)cfunc->func)(
          self, args, NULL);
    else
      result = (*cfunc->func)(self, args);
  } else {
    args = PyTuple_New(2);
    if (unlikely(!args))
      goto bad;
    Py_INCREF(self);
    PyTuple_SET_ITEM(args, 0, self);
    Py_INCREF(arg);
    PyTuple_SET_ITEM(args, 1, arg);
    result = __Pyx_PyObject_Call(cfunc->method, args, NULL);
  }
#else
  args = PyTuple_Pack(2, self, arg);
  if (unlikely(!args))
    goto bad;
  result = __Pyx_PyObject_Call(cfunc->method, args, NULL);
#endif
bad:
  Py_XDECREF(args);
  return result;
}

/* CallUnboundCMethod2 */
#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x030600B1
static CYTHON_INLINE PyObject *
__Pyx_CallUnboundCMethod2(__Pyx_CachedCFunction *cfunc, PyObject *self,
                          PyObject *arg1, PyObject *arg2) {
  if (likely(cfunc->func)) {
    PyObject *args[2] = {arg1, arg2};
    if (cfunc->flag == METH_FASTCALL) {
#if PY_VERSION_HEX >= 0x030700A0
      return (*(__Pyx_PyCFunctionFast)(void *)(PyCFunction)cfunc->func)(
          self, args, 2);
#else
      return (
          *(__Pyx_PyCFunctionFastWithKeywords)(void *)(PyCFunction)cfunc->func)(
          self, args, 2, NULL);
#endif
    }
#if PY_VERSION_HEX >= 0x030700A0
    if (cfunc->flag == (METH_FASTCALL | METH_KEYWORDS))
      return (
          *(__Pyx_PyCFunctionFastWithKeywords)(void *)(PyCFunction)cfunc->func)(
          self, args, 2, NULL);
#endif
  }
  return __Pyx__CallUnboundCMethod2(cfunc, self, arg1, arg2);
}
#endif
static PyObject *__Pyx__CallUnboundCMethod2(__Pyx_CachedCFunction *cfunc,
                                            PyObject *self, PyObject *arg1,
                                            PyObject *arg2) {
  PyObject *args, *result = NULL;
  if (unlikely(!cfunc->func && !cfunc->method) &&
      unlikely(__Pyx_TryUnpackUnboundCMethod(cfunc) < 0))
    return NULL;
#if CYTHON_COMPILING_IN_CPYTHON
  if (cfunc->func && (cfunc->flag & METH_VARARGS)) {
    args = PyTuple_New(2);
    if (unlikely(!args))
      goto bad;
    Py_INCREF(arg1);
    PyTuple_SET_ITEM(args, 0, arg1);
    Py_INCREF(arg2);
    PyTuple_SET_ITEM(args, 1, arg2);
    if (cfunc->flag & METH_KEYWORDS)
      result = (*(PyCFunctionWithKeywords)(void *)(PyCFunction)cfunc->func)(
          self, args, NULL);
    else
      result = (*cfunc->func)(self, args);
  } else {
    args = PyTuple_New(3);
    if (unlikely(!args))
      goto bad;
    Py_INCREF(self);
    PyTuple_SET_ITEM(args, 0, self);
    Py_INCREF(arg1);
    PyTuple_SET_ITEM(args, 1, arg1);
    Py_INCREF(arg2);
    PyTuple_SET_ITEM(args, 2, arg2);
    result = __Pyx_PyObject_Call(cfunc->method, args, NULL);
  }
#else
  args = PyTuple_Pack(3, self, arg1, arg2);
  if (unlikely(!args))
    goto bad;
  result = __Pyx_PyObject_Call(cfunc->method, args, NULL);
#endif
bad:
  Py_XDECREF(args);
  return result;
}

/* dict_getitem_default */
static PyObject *__Pyx_PyDict_GetItemDefault(PyObject *d, PyObject *key,
                                             PyObject *default_value) {
  PyObject *value;
#if PY_MAJOR_VERSION >= 3 && !CYTHON_COMPILING_IN_PYPY
  value = PyDict_GetItemWithError(d, key);
  if (unlikely(!value)) {
    if (unlikely(PyErr_Occurred()))
      return NULL;
    value = default_value;
  }
  Py_INCREF(value);
  if ((1))
    ;
#else
  if (PyString_CheckExact(key) || PyUnicode_CheckExact(key) ||
      PyInt_CheckExact(key)) {
    value = PyDict_GetItem(d, key);
    if (unlikely(!value)) {
      value = default_value;
    }
    Py_INCREF(value);
  }
#endif
  else {
    if (default_value == Py_None)
      value = __Pyx_CallUnboundCMethod1(&__pyx_umethod_PyDict_Type_get, d, key);
    else
      value = __Pyx_CallUnboundCMethod2(&__pyx_umethod_PyDict_Type_get, d, key,
                                        default_value);
  }
  return value;
}

/* PyFloatBinop */
#if !CYTHON_COMPILING_IN_PYPY
static PyObject *__Pyx_PyFloat_AddObjC(PyObject *op1, PyObject *op2,
                                       double floatval, int inplace,
                                       int zerodivision_check) {
  const double b = floatval;
  double a, result;
  (void)inplace;
  (void)zerodivision_check;
  if (likely(PyFloat_CheckExact(op1))) {
    a = PyFloat_AS_DOUBLE(op1);

  } else
#if PY_MAJOR_VERSION < 3
      if (likely(PyInt_CheckExact(op1))) {
    a = (double)PyInt_AS_LONG(op1);

  } else
#endif
      if (likely(PyLong_CheckExact(op1))) {
#if CYTHON_USE_PYLONG_INTERNALS
    const digit *digits = ((PyLongObject *)op1)->ob_digit;
    const Py_ssize_t size = Py_SIZE(op1);
    switch (size) {
    case 0:
      a = 0.0;
      break;
    case -1:
      a = -(double)digits[0];
      break;
    case 1:
      a = (double)digits[0];
      break;
    case -2:
    case 2:
      if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT &&
          ((8 * sizeof(unsigned long) < 53) || (1 * PyLong_SHIFT < 53))) {
        a = (double)(((((unsigned long)digits[1]) << PyLong_SHIFT) |
                      (unsigned long)digits[0]));
        if ((8 * sizeof(unsigned long) < 53) || (2 * PyLong_SHIFT < 53) ||
            (a < (double)((PY_LONG_LONG)1 << 53))) {
          if (size == -2)
            a = -a;
          break;
        }
      }
      CYTHON_FALLTHROUGH;
    case -3:
    case 3:
      if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT &&
          ((8 * sizeof(unsigned long) < 53) || (2 * PyLong_SHIFT < 53))) {
        a = (double)(((((((unsigned long)digits[2]) << PyLong_SHIFT) |
                        (unsigned long)digits[1])
                       << PyLong_SHIFT) |
                      (unsigned long)digits[0]));
        if ((8 * sizeof(unsigned long) < 53) || (3 * PyLong_SHIFT < 53) ||
            (a < (double)((PY_LONG_LONG)1 << 53))) {
          if (size == -3)
            a = -a;
          break;
        }
      }
      CYTHON_FALLTHROUGH;
    case -4:
    case 4:
      if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT &&
          ((8 * sizeof(unsigned long) < 53) || (3 * PyLong_SHIFT < 53))) {
        a = (double)(((((((((unsigned long)digits[3]) << PyLong_SHIFT) |
                          (unsigned long)digits[2])
                         << PyLong_SHIFT) |
                        (unsigned long)digits[1])
                       << PyLong_SHIFT) |
                      (unsigned long)digits[0]));
        if ((8 * sizeof(unsigned long) < 53) || (4 * PyLong_SHIFT < 53) ||
            (a < (double)((PY_LONG_LONG)1 << 53))) {
          if (size == -4)
            a = -a;
          break;
        }
      }
      CYTHON_FALLTHROUGH;
    default:
#else
    {
#endif
      a = PyLong_AsDouble(op1);
      if (unlikely(a == -1.0 && PyErr_Occurred()))
        return NULL;
    }
  } else {
    return (inplace ? PyNumber_InPlaceAdd : PyNumber_Add)(op1, op2);
  }

  PyFPE_START_PROTECT("add", return NULL) result = a + b;
  PyFPE_END_PROTECT(result) return PyFloat_FromDouble(result);
}
#endif

/* PyFloatBinop */
#if !CYTHON_COMPILING_IN_PYPY
static PyObject *__Pyx_PyFloat_SubtractCObj(PyObject *op1, PyObject *op2,
                                            double floatval, int inplace,
                                            int zerodivision_check) {
  const double a = floatval;
  double b, result;
  (void)inplace;
  (void)zerodivision_check;
  if (likely(PyFloat_CheckExact(op2))) {
    b = PyFloat_AS_DOUBLE(op2);

  } else
#if PY_MAJOR_VERSION < 3
      if (likely(PyInt_CheckExact(op2))) {
    b = (double)PyInt_AS_LONG(op2);

  } else
#endif
      if (likely(PyLong_CheckExact(op2))) {
#if CYTHON_USE_PYLONG_INTERNALS
    const digit *digits = ((PyLongObject *)op2)->ob_digit;
    const Py_ssize_t size = Py_SIZE(op2);
    switch (size) {
    case 0:
      b = 0.0;
      break;
    case -1:
      b = -(double)digits[0];
      break;
    case 1:
      b = (double)digits[0];
      break;
    case -2:
    case 2:
      if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT &&
          ((8 * sizeof(unsigned long) < 53) || (1 * PyLong_SHIFT < 53))) {
        b = (double)(((((unsigned long)digits[1]) << PyLong_SHIFT) |
                      (unsigned long)digits[0]));
        if ((8 * sizeof(unsigned long) < 53) || (2 * PyLong_SHIFT < 53) ||
            (b < (double)((PY_LONG_LONG)1 << 53))) {
          if (size == -2)
            b = -b;
          break;
        }
      }
      CYTHON_FALLTHROUGH;
    case -3:
    case 3:
      if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT &&
          ((8 * sizeof(unsigned long) < 53) || (2 * PyLong_SHIFT < 53))) {
        b = (double)(((((((unsigned long)digits[2]) << PyLong_SHIFT) |
                        (unsigned long)digits[1])
                       << PyLong_SHIFT) |
                      (unsigned long)digits[0]));
        if ((8 * sizeof(unsigned long) < 53) || (3 * PyLong_SHIFT < 53) ||
            (b < (double)((PY_LONG_LONG)1 << 53))) {
          if (size == -3)
            b = -b;
          break;
        }
      }
      CYTHON_FALLTHROUGH;
    case -4:
    case 4:
      if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT &&
          ((8 * sizeof(unsigned long) < 53) || (3 * PyLong_SHIFT < 53))) {
        b = (double)(((((((((unsigned long)digits[3]) << PyLong_SHIFT) |
                          (unsigned long)digits[2])
                         << PyLong_SHIFT) |
                        (unsigned long)digits[1])
                       << PyLong_SHIFT) |
                      (unsigned long)digits[0]));
        if ((8 * sizeof(unsigned long) < 53) || (4 * PyLong_SHIFT < 53) ||
            (b < (double)((PY_LONG_LONG)1 << 53))) {
          if (size == -4)
            b = -b;
          break;
        }
      }
      CYTHON_FALLTHROUGH;
    default:
#else
    {
#endif
      b = PyLong_AsDouble(op2);
      if (unlikely(b == -1.0 && PyErr_Occurred()))
        return NULL;
    }
  } else {
    return (inplace ? PyNumber_InPlaceSubtract : PyNumber_Subtract)(op1, op2);
  }

  PyFPE_START_PROTECT("subtract", return NULL) result = a - b;
  PyFPE_END_PROTECT(result) return PyFloat_FromDouble(result);
}
#endif

/* PyObject_GenericGetAttrNoDict */
#if CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP &&                       \
    PY_VERSION_HEX < 0x03070000
static PyObject *__Pyx_RaiseGenericGetAttributeError(PyTypeObject *tp,
                                                     PyObject *attr_name) {
  PyErr_Format(PyExc_AttributeError,
#if PY_MAJOR_VERSION >= 3
               "'%.50s' object has no attribute '%U'", tp->tp_name, attr_name);
#else
               "'%.50s' object has no attribute '%.400s'", tp->tp_name,
               PyString_AS_STRING(attr_name));
#endif
  return NULL;
}
static CYTHON_INLINE PyObject *
__Pyx_PyObject_GenericGetAttrNoDict(PyObject *obj, PyObject *attr_name) {
  PyObject *descr;
  PyTypeObject *tp = Py_TYPE(obj);
  if (unlikely(!PyString_Check(attr_name))) {
    return PyObject_GenericGetAttr(obj, attr_name);
  }
  assert(!tp->tp_dictoffset);
  descr = _PyType_Lookup(tp, attr_name);
  if (unlikely(!descr)) {
    return __Pyx_RaiseGenericGetAttributeError(tp, attr_name);
  }
  Py_INCREF(descr);
#if PY_MAJOR_VERSION < 3
  if (likely(PyType_HasFeature(Py_TYPE(descr), Py_TPFLAGS_HAVE_CLASS)))
#endif
  {
    descrgetfunc f = Py_TYPE(descr)->tp_descr_get;
    if (unlikely(f)) {
      PyObject *res = f(descr, obj, (PyObject *)tp);
      Py_DECREF(descr);
      return res;
    }
  }
  return descr;
}
#endif

/* Import */
static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level) {
  PyObject *empty_list = 0;
  PyObject *module = 0;
  PyObject *global_dict = 0;
  PyObject *empty_dict = 0;
  PyObject *list;
#if PY_MAJOR_VERSION < 3
  PyObject *py_import;
  py_import = __Pyx_PyObject_GetAttrStr(__pyx_b, __pyx_n_s_import);
  if (!py_import)
    goto bad;
#endif
  if (from_list)
    list = from_list;
  else {
    empty_list = PyList_New(0);
    if (!empty_list)
      goto bad;
    list = empty_list;
  }
  global_dict = PyModule_GetDict(__pyx_m);
  if (!global_dict)
    goto bad;
  empty_dict = PyDict_New();
  if (!empty_dict)
    goto bad;
  {
#if PY_MAJOR_VERSION >= 3
    if (level == -1) {
      if ((1) && (strchr(__Pyx_MODULE_NAME, '.'))) {
        module = PyImport_ImportModuleLevelObject(name, global_dict, empty_dict,
                                                  list, 1);
        if (!module) {
          if (!PyErr_ExceptionMatches(PyExc_ImportError))
            goto bad;
          PyErr_Clear();
        }
      }
      level = 0;
    }
#endif
    if (!module) {
#if PY_MAJOR_VERSION < 3
      PyObject *py_level = PyInt_FromLong(level);
      if (!py_level)
        goto bad;
      module =
          PyObject_CallFunctionObjArgs(py_import, name, global_dict, empty_dict,
                                       list, py_level, (PyObject *)NULL);
      Py_DECREF(py_level);
#else
      module = PyImport_ImportModuleLevelObject(name, global_dict, empty_dict,
                                                list, level);
#endif
    }
  }
bad:
#if PY_MAJOR_VERSION < 3
  Py_XDECREF(py_import);
#endif
  Py_XDECREF(empty_list);
  Py_XDECREF(empty_dict);
  return module;
}

/* ImportFrom */
static PyObject *__Pyx_ImportFrom(PyObject *module, PyObject *name) {
  PyObject *value = __Pyx_PyObject_GetAttrStr(module, name);
  if (unlikely(!value) && PyErr_ExceptionMatches(PyExc_AttributeError)) {
    PyErr_Format(PyExc_ImportError,
#if PY_MAJOR_VERSION < 3
                 "cannot import name %.230s", PyString_AS_STRING(name));
#else
                 "cannot import name %S", name);
#endif
  }
  return value;
}

/* CalculateMetaclass */
static PyObject *__Pyx_CalculateMetaclass(PyTypeObject *metaclass,
                                          PyObject *bases) {
  Py_ssize_t i, nbases = PyTuple_GET_SIZE(bases);
  for (i = 0; i < nbases; i++) {
    PyTypeObject *tmptype;
    PyObject *tmp = PyTuple_GET_ITEM(bases, i);
    tmptype = Py_TYPE(tmp);
#if PY_MAJOR_VERSION < 3
    if (tmptype == &PyClass_Type)
      continue;
#endif
    if (!metaclass) {
      metaclass = tmptype;
      continue;
    }
    if (PyType_IsSubtype(metaclass, tmptype))
      continue;
    if (PyType_IsSubtype(tmptype, metaclass)) {
      metaclass = tmptype;
      continue;
    }
    PyErr_SetString(PyExc_TypeError, "metaclass conflict: "
                                     "the metaclass of a derived class "
                                     "must be a (non-strict) subclass "
                                     "of the metaclasses of all its bases");
    return NULL;
  }
  if (!metaclass) {
#if PY_MAJOR_VERSION < 3
    metaclass = &PyClass_Type;
#else
    metaclass = &PyType_Type;
#endif
  }
  Py_INCREF((PyObject *)metaclass);
  return (PyObject *)metaclass;
}

/* ClassMethod */
static PyObject *__Pyx_Method_ClassMethod(PyObject *method) {
#if CYTHON_COMPILING_IN_PYPY && PYPY_VERSION_NUM <= 0x05080000
  if (PyObject_TypeCheck(method, &PyWrapperDescr_Type)) {
    return PyClassMethod_New(method);
  }
#else
#if CYTHON_COMPILING_IN_PYSTON || CYTHON_COMPILING_IN_PYPY
  if (PyMethodDescr_Check(method))
#else
#if PY_MAJOR_VERSION == 2
  static PyTypeObject *methoddescr_type = NULL;
  if (methoddescr_type == NULL) {
    PyObject *meth = PyObject_GetAttrString((PyObject *)&PyList_Type, "append");
    if (!meth)
      return NULL;
    methoddescr_type = Py_TYPE(meth);
    Py_DECREF(meth);
  }
#else
  PyTypeObject *methoddescr_type = &PyMethodDescr_Type;
#endif
  if (__Pyx_TypeCheck(method, methoddescr_type))
#endif
  {
    PyMethodDescrObject *descr = (PyMethodDescrObject *)method;
#if PY_VERSION_HEX < 0x03020000
    PyTypeObject *d_type = descr->d_type;
#else
    PyTypeObject *d_type = descr->d_common.d_type;
#endif
    return PyDescr_NewClassMethod(d_type, descr->d_method);
  }
#endif
  else if (PyMethod_Check(method)) {
    return PyClassMethod_New(PyMethod_GET_FUNCTION(method));
  } else {
    return PyClassMethod_New(method);
  }
}

/* Py3ClassCreate */
static PyObject *__Pyx_Py3MetaclassPrepare(PyObject *metaclass, PyObject *bases,
                                           PyObject *name, PyObject *qualname,
                                           PyObject *mkw, PyObject *modname,
                                           PyObject *doc) {
  PyObject *ns;
  if (metaclass) {
    PyObject *prep = __Pyx_PyObject_GetAttrStr(metaclass, __pyx_n_s_prepare);
    if (prep) {
      PyObject *pargs = PyTuple_Pack(2, name, bases);
      if (unlikely(!pargs)) {
        Py_DECREF(prep);
        return NULL;
      }
      ns = PyObject_Call(prep, pargs, mkw);
      Py_DECREF(prep);
      Py_DECREF(pargs);
    } else {
      if (unlikely(!PyErr_ExceptionMatches(PyExc_AttributeError)))
        return NULL;
      PyErr_Clear();
      ns = PyDict_New();
    }
  } else {
    ns = PyDict_New();
  }
  if (unlikely(!ns))
    return NULL;
  if (unlikely(PyObject_SetItem(ns, __pyx_n_s_module, modname) < 0))
    goto bad;
  if (unlikely(PyObject_SetItem(ns, __pyx_n_s_qualname, qualname) < 0))
    goto bad;
  if (unlikely(doc && PyObject_SetItem(ns, __pyx_n_s_doc, doc) < 0))
    goto bad;
  return ns;
bad:
  Py_DECREF(ns);
  return NULL;
}
static PyObject *__Pyx_Py3ClassCreate(PyObject *metaclass, PyObject *name,
                                      PyObject *bases, PyObject *dict,
                                      PyObject *mkw, int calculate_metaclass,
                                      int allow_py2_metaclass) {
  PyObject *result, *margs;
  PyObject *owned_metaclass = NULL;
  if (allow_py2_metaclass) {
    owned_metaclass = PyObject_GetItem(dict, __pyx_n_s_metaclass);
    if (owned_metaclass) {
      metaclass = owned_metaclass;
    } else if (likely(PyErr_ExceptionMatches(PyExc_KeyError))) {
      PyErr_Clear();
    } else {
      return NULL;
    }
  }
  if (calculate_metaclass && (!metaclass || PyType_Check(metaclass))) {
    metaclass = __Pyx_CalculateMetaclass((PyTypeObject *)metaclass, bases);
    Py_XDECREF(owned_metaclass);
    if (unlikely(!metaclass))
      return NULL;
    owned_metaclass = metaclass;
  }
  margs = PyTuple_Pack(3, name, bases, dict);
  if (unlikely(!margs)) {
    result = NULL;
  } else {
    result = PyObject_Call(metaclass, margs, mkw);
    Py_DECREF(margs);
  }
  Py_XDECREF(owned_metaclass);
  return result;
}

/* CLineInTraceback */
#ifndef CYTHON_CLINE_IN_TRACEBACK
static int __Pyx_CLineForTraceback(CYTHON_UNUSED PyThreadState *tstate,
                                   int c_line) {
  PyObject *use_cline;
  PyObject *ptype, *pvalue, *ptraceback;
#if CYTHON_COMPILING_IN_CPYTHON
  PyObject **cython_runtime_dict;
#endif
  if (unlikely(!__pyx_cython_runtime)) {
    return c_line;
  }
  __Pyx_ErrFetchInState(tstate, &ptype, &pvalue, &ptraceback);
#if CYTHON_COMPILING_IN_CPYTHON
  cython_runtime_dict = _PyObject_GetDictPtr(__pyx_cython_runtime);
  if (likely(cython_runtime_dict)) {
    __PYX_PY_DICT_LOOKUP_IF_MODIFIED(
        use_cline, *cython_runtime_dict,
        __Pyx_PyDict_GetItemStr(*cython_runtime_dict,
                                __pyx_n_s_cline_in_traceback))
  } else
#endif
  {
    PyObject *use_cline_obj = __Pyx_PyObject_GetAttrStr(
        __pyx_cython_runtime, __pyx_n_s_cline_in_traceback);
    if (use_cline_obj) {
      use_cline = PyObject_Not(use_cline_obj) ? Py_False : Py_True;
      Py_DECREF(use_cline_obj);
    } else {
      PyErr_Clear();
      use_cline = NULL;
    }
  }
  if (!use_cline) {
    c_line = 0;
    (void)PyObject_SetAttr(__pyx_cython_runtime, __pyx_n_s_cline_in_traceback,
                           Py_False);
  } else if (use_cline == Py_False ||
             (use_cline != Py_True && PyObject_Not(use_cline) != 0)) {
    c_line = 0;
  }
  __Pyx_ErrRestoreInState(tstate, ptype, pvalue, ptraceback);
  return c_line;
}
#endif

/* CodeObjectCache */
static int __pyx_bisect_code_objects(__Pyx_CodeObjectCacheEntry *entries,
                                     int count, int code_line) {
  int start = 0, mid = 0, end = count - 1;
  if (end >= 0 && code_line > entries[end].code_line) {
    return count;
  }
  while (start < end) {
    mid = start + (end - start) / 2;
    if (code_line < entries[mid].code_line) {
      end = mid;
    } else if (code_line > entries[mid].code_line) {
      start = mid + 1;
    } else {
      return mid;
    }
  }
  if (code_line <= entries[mid].code_line) {
    return mid;
  } else {
    return mid + 1;
  }
}
static PyCodeObject *__pyx_find_code_object(int code_line) {
  PyCodeObject *code_object;
  int pos;
  if (unlikely(!code_line) || unlikely(!__pyx_code_cache.entries)) {
    return NULL;
  }
  pos = __pyx_bisect_code_objects(__pyx_code_cache.entries,
                                  __pyx_code_cache.count, code_line);
  if (unlikely(pos >= __pyx_code_cache.count) ||
      unlikely(__pyx_code_cache.entries[pos].code_line != code_line)) {
    return NULL;
  }
  code_object = __pyx_code_cache.entries[pos].code_object;
  Py_INCREF(code_object);
  return code_object;
}
static void __pyx_insert_code_object(int code_line, PyCodeObject *code_object) {
  int pos, i;
  __Pyx_CodeObjectCacheEntry *entries = __pyx_code_cache.entries;
  if (unlikely(!code_line)) {
    return;
  }
  if (unlikely(!entries)) {
    entries = (__Pyx_CodeObjectCacheEntry *)PyMem_Malloc(
        64 * sizeof(__Pyx_CodeObjectCacheEntry));
    if (likely(entries)) {
      __pyx_code_cache.entries = entries;
      __pyx_code_cache.max_count = 64;
      __pyx_code_cache.count = 1;
      entries[0].code_line = code_line;
      entries[0].code_object = code_object;
      Py_INCREF(code_object);
    }
    return;
  }
  pos = __pyx_bisect_code_objects(__pyx_code_cache.entries,
                                  __pyx_code_cache.count, code_line);
  if ((pos < __pyx_code_cache.count) &&
      unlikely(__pyx_code_cache.entries[pos].code_line == code_line)) {
    PyCodeObject *tmp = entries[pos].code_object;
    entries[pos].code_object = code_object;
    Py_DECREF(tmp);
    return;
  }
  if (__pyx_code_cache.count == __pyx_code_cache.max_count) {
    int new_max = __pyx_code_cache.max_count + 64;
    entries = (__Pyx_CodeObjectCacheEntry *)PyMem_Realloc(
        __pyx_code_cache.entries,
        ((size_t)new_max) * sizeof(__Pyx_CodeObjectCacheEntry));
    if (unlikely(!entries)) {
      return;
    }
    __pyx_code_cache.entries = entries;
    __pyx_code_cache.max_count = new_max;
  }
  for (i = __pyx_code_cache.count; i > pos; i--) {
    entries[i] = entries[i - 1];
  }
  entries[pos].code_line = code_line;
  entries[pos].code_object = code_object;
  __pyx_code_cache.count++;
  Py_INCREF(code_object);
}

/* AddTraceback */
#include "compile.h"
#include "frameobject.h"
#include "traceback.h"
#if PY_VERSION_HEX >= 0x030b00a6
#ifndef Py_BUILD_CORE
#define Py_BUILD_CORE 1
#endif
#include "internal/pycore_frame.h"
#endif
static PyCodeObject *__Pyx_CreateCodeObjectForTraceback(const char *funcname,
                                                        int c_line, int py_line,
                                                        const char *filename) {
  PyCodeObject *py_code = NULL;
  PyObject *py_funcname = NULL;
#if PY_MAJOR_VERSION < 3
  PyObject *py_srcfile = NULL;
  py_srcfile = PyString_FromString(filename);
  if (!py_srcfile)
    goto bad;
#endif
  if (c_line) {
#if PY_MAJOR_VERSION < 3
    py_funcname =
        PyString_FromFormat("%s (%s:%d)", funcname, __pyx_cfilenm, c_line);
    if (!py_funcname)
      goto bad;
#else
    py_funcname =
        PyUnicode_FromFormat("%s (%s:%d)", funcname, __pyx_cfilenm, c_line);
    if (!py_funcname)
      goto bad;
    funcname = PyUnicode_AsUTF8(py_funcname);
    if (!funcname)
      goto bad;
#endif
  } else {
#if PY_MAJOR_VERSION < 3
    py_funcname = PyString_FromString(funcname);
    if (!py_funcname)
      goto bad;
#endif
  }
#if PY_MAJOR_VERSION < 3
  py_code =
      __Pyx_PyCode_New(0, 0, 0, 0, 0, __pyx_empty_bytes, /*PyObject *code,*/
                       __pyx_empty_tuple,                /*PyObject *consts,*/
                       __pyx_empty_tuple,                /*PyObject *names,*/
                       __pyx_empty_tuple,                /*PyObject *varnames,*/
                       __pyx_empty_tuple,                /*PyObject *freevars,*/
                       __pyx_empty_tuple,                /*PyObject *cellvars,*/
                       py_srcfile,                       /*PyObject *filename,*/
                       py_funcname,                      /*PyObject *name,*/
                       py_line, __pyx_empty_bytes        /*PyObject *lnotab*/
      );
  Py_DECREF(py_srcfile);
#else
  py_code = PyCode_NewEmpty(filename, funcname, py_line);
#endif
  Py_XDECREF(py_funcname); // XDECREF since it's only set on Py3 if cline
  return py_code;
bad:
  Py_XDECREF(py_funcname);
#if PY_MAJOR_VERSION < 3
  Py_XDECREF(py_srcfile);
#endif
  return NULL;
}
static void __Pyx_AddTraceback(const char *funcname, int c_line, int py_line,
                               const char *filename) {
  PyCodeObject *py_code = 0;
  PyFrameObject *py_frame = 0;
  PyThreadState *tstate = __Pyx_PyThreadState_Current;
  PyObject *ptype, *pvalue, *ptraceback;
  if (c_line) {
    c_line = __Pyx_CLineForTraceback(tstate, c_line);
  }
  py_code = __pyx_find_code_object(c_line ? -c_line : py_line);
  if (!py_code) {
    __Pyx_ErrFetchInState(tstate, &ptype, &pvalue, &ptraceback);
    py_code =
        __Pyx_CreateCodeObjectForTraceback(funcname, c_line, py_line, filename);
    if (!py_code) {
      /* If the code object creation fails, then we should clear the
         fetched exception references and propagate the new exception */
      Py_XDECREF(ptype);
      Py_XDECREF(pvalue);
      Py_XDECREF(ptraceback);
      goto bad;
    }
    __Pyx_ErrRestoreInState(tstate, ptype, pvalue, ptraceback);
    __pyx_insert_code_object(c_line ? -c_line : py_line, py_code);
  }
  py_frame = PyFrame_New(tstate,  /*PyThreadState *tstate,*/
                         py_code, /*PyCodeObject *code,*/
                         __pyx_d, /*PyObject *globals,*/
                         0        /*PyObject *locals*/
  );
  if (!py_frame)
    goto bad;
  __Pyx_PyFrame_SetLineNumber(py_frame, py_line);
  PyTraceBack_Here(py_frame);
bad:
  Py_XDECREF(py_code);
  Py_XDECREF(py_frame);
}

/* CIntToPy */
static CYTHON_INLINE PyObject *__Pyx_PyInt_From_long(long value) {
#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
#pragma GCC diagnostic push
#pragma GCC diagnostic ignored "-Wconversion"
#endif
  const long neg_one = (long)-1, const_zero = (long)0;
#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
#pragma GCC diagnostic pop
#endif
  const int is_unsigned = neg_one > const_zero;
  if (is_unsigned) {
    if (sizeof(long) < sizeof(long)) {
      return PyInt_FromLong((long)value);
    } else if (sizeof(long) <= sizeof(unsigned long)) {
      return PyLong_FromUnsignedLong((unsigned long)value);
#ifdef HAVE_LONG_LONG
    } else if (sizeof(long) <= sizeof(unsigned PY_LONG_LONG)) {
      return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG)value);
#endif
    }
  } else {
    if (sizeof(long) <= sizeof(long)) {
      return PyInt_FromLong((long)value);
#ifdef HAVE_LONG_LONG
    } else if (sizeof(long) <= sizeof(PY_LONG_LONG)) {
      return PyLong_FromLongLong((PY_LONG_LONG)value);
#endif
    }
  }
  {
    int one = 1;
    int little = (int)*(unsigned char *)&one;
    unsigned char *bytes = (unsigned char *)&value;
    return _PyLong_FromByteArray(bytes, sizeof(long), little, !is_unsigned);
  }
}

/* CIntFromPyVerify */
#define __PYX_VERIFY_RETURN_INT(target_type, func_type, func_value)            \
  __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 0)
#define __PYX_VERIFY_RETURN_INT_EXC(target_type, func_type, func_value)        \
  __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 1)
#define __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, exc)      \
  {                                                                            \
    func_type value = func_value;                                              \
    if (sizeof(target_type) < sizeof(func_type)) {                             \
      if (unlikely(value != (func_type)(target_type)value)) {                  \
        func_type zero = 0;                                                    \
        if (exc && unlikely(value == (func_type)-1 && PyErr_Occurred()))       \
          return (target_type)-1;                                              \
        if (is_unsigned && unlikely(value < zero))                             \
          goto raise_neg_overflow;                                             \
        else                                                                   \
          goto raise_overflow;                                                 \
      }                                                                        \
    }                                                                          \
    return (target_type)value;                                                 \
  }

/* CIntFromPy */
static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *x) {
#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
#pragma GCC diagnostic push
#pragma GCC diagnostic ignored "-Wconversion"
#endif
  const long neg_one = (long)-1, const_zero = (long)0;
#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
#pragma GCC diagnostic pop
#endif
  const int is_unsigned = neg_one > const_zero;
#if PY_MAJOR_VERSION < 3
  if (likely(PyInt_Check(x))) {
    if (sizeof(long) < sizeof(long)) {
      __PYX_VERIFY_RETURN_INT(long, long, PyInt_AS_LONG(x))
    } else {
      long val = PyInt_AS_LONG(x);
      if (is_unsigned && unlikely(val < 0)) {
        goto raise_neg_overflow;
      }
      return (long)val;
    }
  } else
#endif
      if (likely(PyLong_Check(x))) {
    if (is_unsigned) {
#if CYTHON_USE_PYLONG_INTERNALS
      const digit *digits = ((PyLongObject *)x)->ob_digit;
      switch (Py_SIZE(x)) {
      case 0:
        return (long)0;
      case 1:
        __PYX_VERIFY_RETURN_INT(long, digit, digits[0])
      case 2:
        if (8 * sizeof(long) > 1 * PyLong_SHIFT) {
          if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT) {
            __PYX_VERIFY_RETURN_INT(
                long, unsigned long,
                (((((unsigned long)digits[1]) << PyLong_SHIFT) |
                  (unsigned long)digits[0])))
          } else if (8 * sizeof(long) >= 2 * PyLong_SHIFT) {
            return (
                long)(((((long)digits[1]) << PyLong_SHIFT) | (long)digits[0]));
          }
        }
        break;
      case 3:
        if (8 * sizeof(long) > 2 * PyLong_SHIFT) {
          if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT) {
            __PYX_VERIFY_RETURN_INT(
                long, unsigned long,
                (((((((unsigned long)digits[2]) << PyLong_SHIFT) |
                    (unsigned long)digits[1])
                   << PyLong_SHIFT) |
                  (unsigned long)digits[0])))
          } else if (8 * sizeof(long) >= 3 * PyLong_SHIFT) {
            return (
                long)(((((((long)digits[2]) << PyLong_SHIFT) | (long)digits[1])
                        << PyLong_SHIFT) |
                       (long)digits[0]));
          }
        }
        break;
      case 4:
        if (8 * sizeof(long) > 3 * PyLong_SHIFT) {
          if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT) {
            __PYX_VERIFY_RETURN_INT(
                long, unsigned long,
                (((((((((unsigned long)digits[3]) << PyLong_SHIFT) |
                      (unsigned long)digits[2])
                     << PyLong_SHIFT) |
                    (unsigned long)digits[1])
                   << PyLong_SHIFT) |
                  (unsigned long)digits[0])))
          } else if (8 * sizeof(long) >= 4 * PyLong_SHIFT) {
            return (long)((
                (((((((long)digits[3]) << PyLong_SHIFT) | (long)digits[2])
                   << PyLong_SHIFT) |
                  (long)digits[1])
                 << PyLong_SHIFT) |
                (long)digits[0]));
          }
        }
        break;
      }
#endif
#if CYTHON_COMPILING_IN_CPYTHON
      if (unlikely(Py_SIZE(x) < 0)) {
        goto raise_neg_overflow;
      }
#else
      {
        int result = PyObject_RichCompareBool(x, Py_False, Py_LT);
        if (unlikely(result < 0))
          return (long)-1;
        if (unlikely(result == 1))
          goto raise_neg_overflow;
      }
#endif
      if (sizeof(long) <= sizeof(unsigned long)) {
        __PYX_VERIFY_RETURN_INT_EXC(long, unsigned long,
                                    PyLong_AsUnsignedLong(x))
#ifdef HAVE_LONG_LONG
      } else if (sizeof(long) <= sizeof(unsigned PY_LONG_LONG)) {
        __PYX_VERIFY_RETURN_INT_EXC(long, unsigned PY_LONG_LONG,
                                    PyLong_AsUnsignedLongLong(x))
#endif
      }
    } else {
#if CYTHON_USE_PYLONG_INTERNALS
      const digit *digits = ((PyLongObject *)x)->ob_digit;
      switch (Py_SIZE(x)) {
      case 0:
        return (long)0;
      case -1:
        __PYX_VERIFY_RETURN_INT(long, sdigit, (sdigit)(-(sdigit)digits[0]))
      case 1:
        __PYX_VERIFY_RETURN_INT(long, digit, +digits[0])
      case -2:
        if (8 * sizeof(long) - 1 > 1 * PyLong_SHIFT) {
          if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT) {
            __PYX_VERIFY_RETURN_INT(
                long, long,
                -(long)(((((unsigned long)digits[1]) << PyLong_SHIFT) |
                         (unsigned long)digits[0])))
          } else if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
            return (long)(((long)-1) * (((((long)digits[1]) << PyLong_SHIFT) |
                                         (long)digits[0])));
          }
        }
        break;
      case 2:
        if (8 * sizeof(long) > 1 * PyLong_SHIFT) {
          if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT) {
            __PYX_VERIFY_RETURN_INT(
                long, unsigned long,
                (((((unsigned long)digits[1]) << PyLong_SHIFT) |
                  (unsigned long)digits[0])))
          } else if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
            return (long)((
                ((((long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
          }
        }
        break;
      case -3:
        if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
          if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT) {
            __PYX_VERIFY_RETURN_INT(
                long, long,
                -(long)(((((((unsigned long)digits[2]) << PyLong_SHIFT) |
                           (unsigned long)digits[1])
                          << PyLong_SHIFT) |
                         (unsigned long)digits[0])))
          } else if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
            return (
                long)(((long)-1) *
                      (((((((long)digits[2]) << PyLong_SHIFT) | (long)digits[1])
                         << PyLong_SHIFT) |
                        (long)digits[0])));
          }
        }
        break;
      case 3:
        if (8 * sizeof(long) > 2 * PyLong_SHIFT) {
          if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT) {
            __PYX_VERIFY_RETURN_INT(
                long, unsigned long,
                (((((((unsigned long)digits[2]) << PyLong_SHIFT) |
                    (unsigned long)digits[1])
                   << PyLong_SHIFT) |
                  (unsigned long)digits[0])))
          } else if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
            return (
                long)((((((((long)digits[2]) << PyLong_SHIFT) | (long)digits[1])
                         << PyLong_SHIFT) |
                        (long)digits[0])));
          }
        }
        break;
      case -4:
        if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
          if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT) {
            __PYX_VERIFY_RETURN_INT(
                long, long,
                -(long)(((((((((unsigned long)digits[3]) << PyLong_SHIFT) |
                             (unsigned long)digits[2])
                            << PyLong_SHIFT) |
                           (unsigned long)digits[1])
                          << PyLong_SHIFT) |
                         (unsigned long)digits[0])))
          } else if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
            return (long)(((long)-1) *
                          (((((((((long)digits[3]) << PyLong_SHIFT) |
                                (long)digits[2])
                               << PyLong_SHIFT) |
                              (long)digits[1])
                             << PyLong_SHIFT) |
                            (long)digits[0])));
          }
        }
        break;
      case 4:
        if (8 * sizeof(long) > 3 * PyLong_SHIFT) {
          if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT) {
            __PYX_VERIFY_RETURN_INT(
                long, unsigned long,
                (((((((((unsigned long)digits[3]) << PyLong_SHIFT) |
                      (unsigned long)digits[2])
                     << PyLong_SHIFT) |
                    (unsigned long)digits[1])
                   << PyLong_SHIFT) |
                  (unsigned long)digits[0])))
          } else if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
            return (long)((
                ((((((((long)digits[3]) << PyLong_SHIFT) | (long)digits[2])
                    << PyLong_SHIFT) |
                   (long)digits[1])
                  << PyLong_SHIFT) |
                 (long)digits[0])));
          }
        }
        break;
      }
#endif
      if (sizeof(long) <= sizeof(long)) {
        __PYX_VERIFY_RETURN_INT_EXC(long, long, PyLong_AsLong(x))
#ifdef HAVE_LONG_LONG
      } else if (sizeof(long) <= sizeof(PY_LONG_LONG)) {
        __PYX_VERIFY_RETURN_INT_EXC(long, PY_LONG_LONG, PyLong_AsLongLong(x))
#endif
      }
    }
    {
#if CYTHON_COMPILING_IN_PYPY && !defined(_PyLong_AsByteArray)
      PyErr_SetString(PyExc_RuntimeError,
                      "_PyLong_AsByteArray() not available in PyPy, cannot "
                      "convert large numbers");
#else
      long val;
      PyObject *v = __Pyx_PyNumber_IntOrLong(x);
#if PY_MAJOR_VERSION < 3
      if (likely(v) && !PyLong_Check(v)) {
        PyObject *tmp = v;
        v = PyNumber_Long(tmp);
        Py_DECREF(tmp);
      }
#endif
      if (likely(v)) {
        int one = 1;
        int is_little = (int)*(unsigned char *)&one;
        unsigned char *bytes = (unsigned char *)&val;
        int ret = _PyLong_AsByteArray((PyLongObject *)v, bytes, sizeof(val),
                                      is_little, !is_unsigned);
        Py_DECREF(v);
        if (likely(!ret))
          return val;
      }
#endif
      return (long)-1;
    }
  } else {
    long val;
    PyObject *tmp = __Pyx_PyNumber_IntOrLong(x);
    if (!tmp)
      return (long)-1;
    val = __Pyx_PyInt_As_long(tmp);
    Py_DECREF(tmp);
    return val;
  }
raise_overflow:
  PyErr_SetString(PyExc_OverflowError, "value too large to convert to long");
  return (long)-1;
raise_neg_overflow:
  PyErr_SetString(PyExc_OverflowError, "can't convert negative value to long");
  return (long)-1;
}

/* CIntFromPy */
static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *x) {
#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
#pragma GCC diagnostic push
#pragma GCC diagnostic ignored "-Wconversion"
#endif
  const int neg_one = (int)-1, const_zero = (int)0;
#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
#pragma GCC diagnostic pop
#endif
  const int is_unsigned = neg_one > const_zero;
#if PY_MAJOR_VERSION < 3
  if (likely(PyInt_Check(x))) {
    if (sizeof(int) < sizeof(long)) {
      __PYX_VERIFY_RETURN_INT(int, long, PyInt_AS_LONG(x))
    } else {
      long val = PyInt_AS_LONG(x);
      if (is_unsigned && unlikely(val < 0)) {
        goto raise_neg_overflow;
      }
      return (int)val;
    }
  } else
#endif
      if (likely(PyLong_Check(x))) {
    if (is_unsigned) {
#if CYTHON_USE_PYLONG_INTERNALS
      const digit *digits = ((PyLongObject *)x)->ob_digit;
      switch (Py_SIZE(x)) {
      case 0:
        return (int)0;
      case 1:
        __PYX_VERIFY_RETURN_INT(int, digit, digits[0])
      case 2:
        if (8 * sizeof(int) > 1 * PyLong_SHIFT) {
          if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT) {
            __PYX_VERIFY_RETURN_INT(
                int, unsigned long,
                (((((unsigned long)digits[1]) << PyLong_SHIFT) |
                  (unsigned long)digits[0])))
          } else if (8 * sizeof(int) >= 2 * PyLong_SHIFT) {
            return (int)(((((int)digits[1]) << PyLong_SHIFT) | (int)digits[0]));
          }
        }
        break;
      case 3:
        if (8 * sizeof(int) > 2 * PyLong_SHIFT) {
          if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT) {
            __PYX_VERIFY_RETURN_INT(
                int, unsigned long,
                (((((((unsigned long)digits[2]) << PyLong_SHIFT) |
                    (unsigned long)digits[1])
                   << PyLong_SHIFT) |
                  (unsigned long)digits[0])))
          } else if (8 * sizeof(int) >= 3 * PyLong_SHIFT) {
            return (int)(((((((int)digits[2]) << PyLong_SHIFT) | (int)digits[1])
                           << PyLong_SHIFT) |
                          (int)digits[0]));
          }
        }
        break;
      case 4:
        if (8 * sizeof(int) > 3 * PyLong_SHIFT) {
          if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT) {
            __PYX_VERIFY_RETURN_INT(
                int, unsigned long,
                (((((((((unsigned long)digits[3]) << PyLong_SHIFT) |
                      (unsigned long)digits[2])
                     << PyLong_SHIFT) |
                    (unsigned long)digits[1])
                   << PyLong_SHIFT) |
                  (unsigned long)digits[0])))
          } else if (8 * sizeof(int) >= 4 * PyLong_SHIFT) {
            return (
                int)(((((((((int)digits[3]) << PyLong_SHIFT) | (int)digits[2])
                         << PyLong_SHIFT) |
                        (int)digits[1])
                       << PyLong_SHIFT) |
                      (int)digits[0]));
          }
        }
        break;
      }
#endif
#if CYTHON_COMPILING_IN_CPYTHON
      if (unlikely(Py_SIZE(x) < 0)) {
        goto raise_neg_overflow;
      }
#else
      {
        int result = PyObject_RichCompareBool(x, Py_False, Py_LT);
        if (unlikely(result < 0))
          return (int)-1;
        if (unlikely(result == 1))
          goto raise_neg_overflow;
      }
#endif
      if (sizeof(int) <= sizeof(unsigned long)) {
        __PYX_VERIFY_RETURN_INT_EXC(int, unsigned long,
                                    PyLong_AsUnsignedLong(x))
#ifdef HAVE_LONG_LONG
      } else if (sizeof(int) <= sizeof(unsigned PY_LONG_LONG)) {
        __PYX_VERIFY_RETURN_INT_EXC(int, unsigned PY_LONG_LONG,
                                    PyLong_AsUnsignedLongLong(x))
#endif
      }
    } else {
#if CYTHON_USE_PYLONG_INTERNALS
      const digit *digits = ((PyLongObject *)x)->ob_digit;
      switch (Py_SIZE(x)) {
      case 0:
        return (int)0;
      case -1:
        __PYX_VERIFY_RETURN_INT(int, sdigit, (sdigit)(-(sdigit)digits[0]))
      case 1:
        __PYX_VERIFY_RETURN_INT(int, digit, +digits[0])
      case -2:
        if (8 * sizeof(int) - 1 > 1 * PyLong_SHIFT) {
          if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT) {
            __PYX_VERIFY_RETURN_INT(
                int, long,
                -(long)(((((unsigned long)digits[1]) << PyLong_SHIFT) |
                         (unsigned long)digits[0])))
          } else if (8 * sizeof(int) - 1 > 2 * PyLong_SHIFT) {
            return (int)(((int)-1) * (((((int)digits[1]) << PyLong_SHIFT) |
                                       (int)digits[0])));
          }
        }
        break;
      case 2:
        if (8 * sizeof(int) > 1 * PyLong_SHIFT) {
          if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT) {
            __PYX_VERIFY_RETURN_INT(
                int, unsigned long,
                (((((unsigned long)digits[1]) << PyLong_SHIFT) |
                  (unsigned long)digits[0])))
          } else if (8 * sizeof(int) - 1 > 2 * PyLong_SHIFT) {
            return (
                int)((((((int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
          }
        }
        break;
      case -3:
        if (8 * sizeof(int) - 1 > 2 * PyLong_SHIFT) {
          if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT) {
            __PYX_VERIFY_RETURN_INT(
                int, long,
                -(long)(((((((unsigned long)digits[2]) << PyLong_SHIFT) |
                           (unsigned long)digits[1])
                          << PyLong_SHIFT) |
                         (unsigned long)digits[0])))
          } else if (8 * sizeof(int) - 1 > 3 * PyLong_SHIFT) {
            return (
                int)(((int)-1) *
                     (((((((int)digits[2]) << PyLong_SHIFT) | (int)digits[1])
                        << PyLong_SHIFT) |
                       (int)digits[0])));
          }
        }
        break;
      case 3:
        if (8 * sizeof(int) > 2 * PyLong_SHIFT) {
          if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT) {
            __PYX_VERIFY_RETURN_INT(
                int, unsigned long,
                (((((((unsigned long)digits[2]) << PyLong_SHIFT) |
                    (unsigned long)digits[1])
                   << PyLong_SHIFT) |
                  (unsigned long)digits[0])))
          } else if (8 * sizeof(int) - 1 > 3 * PyLong_SHIFT) {
            return (
                int)((((((((int)digits[2]) << PyLong_SHIFT) | (int)digits[1])
                        << PyLong_SHIFT) |
                       (int)digits[0])));
          }
        }
        break;
      case -4:
        if (8 * sizeof(int) - 1 > 3 * PyLong_SHIFT) {
          if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT) {
            __PYX_VERIFY_RETURN_INT(
                int, long,
                -(long)(((((((((unsigned long)digits[3]) << PyLong_SHIFT) |
                             (unsigned long)digits[2])
                            << PyLong_SHIFT) |
                           (unsigned long)digits[1])
                          << PyLong_SHIFT) |
                         (unsigned long)digits[0])))
          } else if (8 * sizeof(int) - 1 > 4 * PyLong_SHIFT) {
            return (
                int)(((int)-1) *
                     (((((((((int)digits[3]) << PyLong_SHIFT) | (int)digits[2])
                          << PyLong_SHIFT) |
                         (int)digits[1])
                        << PyLong_SHIFT) |
                       (int)digits[0])));
          }
        }
        break;
      case 4:
        if (8 * sizeof(int) > 3 * PyLong_SHIFT) {
          if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT) {
            __PYX_VERIFY_RETURN_INT(
                int, unsigned long,
                (((((((((unsigned long)digits[3]) << PyLong_SHIFT) |
                      (unsigned long)digits[2])
                     << PyLong_SHIFT) |
                    (unsigned long)digits[1])
                   << PyLong_SHIFT) |
                  (unsigned long)digits[0])))
          } else if (8 * sizeof(int) - 1 > 4 * PyLong_SHIFT) {
            return (
                int)((((((((((int)digits[3]) << PyLong_SHIFT) | (int)digits[2])
                          << PyLong_SHIFT) |
                         (int)digits[1])
                        << PyLong_SHIFT) |
                       (int)digits[0])));
          }
        }
        break;
      }
#endif
      if (sizeof(int) <= sizeof(long)) {
        __PYX_VERIFY_RETURN_INT_EXC(int, long, PyLong_AsLong(x))
#ifdef HAVE_LONG_LONG
      } else if (sizeof(int) <= sizeof(PY_LONG_LONG)) {
        __PYX_VERIFY_RETURN_INT_EXC(int, PY_LONG_LONG, PyLong_AsLongLong(x))
#endif
      }
    }
    {
#if CYTHON_COMPILING_IN_PYPY && !defined(_PyLong_AsByteArray)
      PyErr_SetString(PyExc_RuntimeError,
                      "_PyLong_AsByteArray() not available in PyPy, cannot "
                      "convert large numbers");
#else
      int val;
      PyObject *v = __Pyx_PyNumber_IntOrLong(x);
#if PY_MAJOR_VERSION < 3
      if (likely(v) && !PyLong_Check(v)) {
        PyObject *tmp = v;
        v = PyNumber_Long(tmp);
        Py_DECREF(tmp);
      }
#endif
      if (likely(v)) {
        int one = 1;
        int is_little = (int)*(unsigned char *)&one;
        unsigned char *bytes = (unsigned char *)&val;
        int ret = _PyLong_AsByteArray((PyLongObject *)v, bytes, sizeof(val),
                                      is_little, !is_unsigned);
        Py_DECREF(v);
        if (likely(!ret))
          return val;
      }
#endif
      return (int)-1;
    }
  } else {
    int val;
    PyObject *tmp = __Pyx_PyNumber_IntOrLong(x);
    if (!tmp)
      return (int)-1;
    val = __Pyx_PyInt_As_int(tmp);
    Py_DECREF(tmp);
    return val;
  }
raise_overflow:
  PyErr_SetString(PyExc_OverflowError, "value too large to convert to int");
  return (int)-1;
raise_neg_overflow:
  PyErr_SetString(PyExc_OverflowError, "can't convert negative value to int");
  return (int)-1;
}

/* FastTypeChecks */
#if CYTHON_COMPILING_IN_CPYTHON
static int __Pyx_InBases(PyTypeObject *a, PyTypeObject *b) {
  while (a) {
    a = a->tp_base;
    if (a == b)
      return 1;
  }
  return b == &PyBaseObject_Type;
}
static CYTHON_INLINE int __Pyx_IsSubtype(PyTypeObject *a, PyTypeObject *b) {
  PyObject *mro;
  if (a == b)
    return 1;
  mro = a->tp_mro;
  if (likely(mro)) {
    Py_ssize_t i, n;
    n = PyTuple_GET_SIZE(mro);
    for (i = 0; i < n; i++) {
      if (PyTuple_GET_ITEM(mro, i) == (PyObject *)b)
        return 1;
    }
    return 0;
  }
  return __Pyx_InBases(a, b);
}
#if PY_MAJOR_VERSION == 2
static int __Pyx_inner_PyErr_GivenExceptionMatches2(PyObject *err,
                                                    PyObject *exc_type1,
                                                    PyObject *exc_type2) {
  PyObject *exception, *value, *tb;
  int res;
  __Pyx_PyThreadState_declare __Pyx_PyThreadState_assign __Pyx_ErrFetch(
      &exception, &value, &tb);
  res = exc_type1 ? PyObject_IsSubclass(err, exc_type1) : 0;
  if (unlikely(res == -1)) {
    PyErr_WriteUnraisable(err);
    res = 0;
  }
  if (!res) {
    res = PyObject_IsSubclass(err, exc_type2);
    if (unlikely(res == -1)) {
      PyErr_WriteUnraisable(err);
      res = 0;
    }
  }
  __Pyx_ErrRestore(exception, value, tb);
  return res;
}
#else
static CYTHON_INLINE int
__Pyx_inner_PyErr_GivenExceptionMatches2(PyObject *err, PyObject *exc_type1,
                                         PyObject *exc_type2) {
  int res = exc_type1 ? __Pyx_IsSubtype((PyTypeObject *)err,
                                        (PyTypeObject *)exc_type1)
                      : 0;
  if (!res) {
    res = __Pyx_IsSubtype((PyTypeObject *)err, (PyTypeObject *)exc_type2);
  }
  return res;
}
#endif
static int __Pyx_PyErr_GivenExceptionMatchesTuple(PyObject *exc_type,
                                                  PyObject *tuple) {
  Py_ssize_t i, n;
  assert(PyExceptionClass_Check(exc_type));
  n = PyTuple_GET_SIZE(tuple);
#if PY_MAJOR_VERSION >= 3
  for (i = 0; i < n; i++) {
    if (exc_type == PyTuple_GET_ITEM(tuple, i))
      return 1;
  }
#endif
  for (i = 0; i < n; i++) {
    PyObject *t = PyTuple_GET_ITEM(tuple, i);
#if PY_MAJOR_VERSION < 3
    if (likely(exc_type == t))
      return 1;
#endif
    if (likely(PyExceptionClass_Check(t))) {
      if (__Pyx_inner_PyErr_GivenExceptionMatches2(exc_type, NULL, t))
        return 1;
    } else {
    }
  }
  return 0;
}
static CYTHON_INLINE int __Pyx_PyErr_GivenExceptionMatches(PyObject *err,
                                                           PyObject *exc_type) {
  if (likely(err == exc_type))
    return 1;
  if (likely(PyExceptionClass_Check(err))) {
    if (likely(PyExceptionClass_Check(exc_type))) {
      return __Pyx_inner_PyErr_GivenExceptionMatches2(err, NULL, exc_type);
    } else if (likely(PyTuple_Check(exc_type))) {
      return __Pyx_PyErr_GivenExceptionMatchesTuple(err, exc_type);
    } else {
    }
  }
  return PyErr_GivenExceptionMatches(err, exc_type);
}
static CYTHON_INLINE int
__Pyx_PyErr_GivenExceptionMatches2(PyObject *err, PyObject *exc_type1,
                                   PyObject *exc_type2) {
  assert(PyExceptionClass_Check(exc_type1));
  assert(PyExceptionClass_Check(exc_type2));
  if (likely(err == exc_type1 || err == exc_type2))
    return 1;
  if (likely(PyExceptionClass_Check(err))) {
    return __Pyx_inner_PyErr_GivenExceptionMatches2(err, exc_type1, exc_type2);
  }
  return (PyErr_GivenExceptionMatches(err, exc_type1) ||
          PyErr_GivenExceptionMatches(err, exc_type2));
}
#endif

/* CStringEquals */
static CYTHON_INLINE int __Pyx_StrEq(const char *s1, const char *s2) {
  while (*s1 != '\0' && *s1 == *s2) {
    s1++;
    s2++;
  }
  return *s1 == *s2;
}

/* CheckBinaryVersion */
static int __Pyx_check_binary_version(void) {
  char ctversion[5];
  int same = 1, i, found_dot;
  const char *rt_from_call = Py_GetVersion();
  PyOS_snprintf(ctversion, 5, "%d.%d", PY_MAJOR_VERSION, PY_MINOR_VERSION);
  found_dot = 0;
  for (i = 0; i < 4; i++) {
    if (!ctversion[i]) {
      same = (rt_from_call[i] < '0' || rt_from_call[i] > '9');
      break;
    }
    if (rt_from_call[i] != ctversion[i]) {
      same = 0;
      break;
    }
  }
  if (!same) {
    char rtversion[5] = {'\0'};
    char message[200];
    for (i = 0; i < 4; ++i) {
      if (rt_from_call[i] == '.') {
        if (found_dot)
          break;
        found_dot = 1;
      } else if (rt_from_call[i] < '0' || rt_from_call[i] > '9') {
        break;
      }
      rtversion[i] = rt_from_call[i];
    }
    PyOS_snprintf(message, sizeof(message),
                  "compiletime version %s of module '%.100s' "
                  "does not match runtime version %s",
                  ctversion, __Pyx_MODULE_NAME, rtversion);
    return PyErr_WarnEx(NULL, message, 1);
  }
  return 0;
}

/* InitStrings */
static int __Pyx_InitStrings(__Pyx_StringTabEntry *t) {
  while (t->p) {
#if PY_MAJOR_VERSION < 3
    if (t->is_unicode) {
      *t->p = PyUnicode_DecodeUTF8(t->s, t->n - 1, NULL);
    } else if (t->intern) {
      *t->p = PyString_InternFromString(t->s);
    } else {
      *t->p = PyString_FromStringAndSize(t->s, t->n - 1);
    }
#else
    if (t->is_unicode | t->is_str) {
      if (t->intern) {
        *t->p = PyUnicode_InternFromString(t->s);
      } else if (t->encoding) {
        *t->p = PyUnicode_Decode(t->s, t->n - 1, t->encoding, NULL);
      } else {
        *t->p = PyUnicode_FromStringAndSize(t->s, t->n - 1);
      }
    } else {
      *t->p = PyBytes_FromStringAndSize(t->s, t->n - 1);
    }
#endif
    if (!*t->p)
      return -1;
    if (PyObject_Hash(*t->p) == -1)
      return -1;
    ++t;
  }
  return 0;
}

static CYTHON_INLINE PyObject *__Pyx_PyUnicode_FromString(const char *c_str) {
  return __Pyx_PyUnicode_FromStringAndSize(c_str, (Py_ssize_t)strlen(c_str));
}
static CYTHON_INLINE const char *__Pyx_PyObject_AsString(PyObject *o) {
  Py_ssize_t ignore;
  return __Pyx_PyObject_AsStringAndSize(o, &ignore);
}
#if __PYX_DEFAULT_STRING_ENCODING_IS_ASCII ||                                  \
    __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT
#if !CYTHON_PEP393_ENABLED
static const char *__Pyx_PyUnicode_AsStringAndSize(PyObject *o,
                                                   Py_ssize_t *length) {
  char *defenc_c;
  PyObject *defenc = _PyUnicode_AsDefaultEncodedString(o, NULL);
  if (!defenc)
    return NULL;
  defenc_c = PyBytes_AS_STRING(defenc);
#if __PYX_DEFAULT_STRING_ENCODING_IS_ASCII
  {
    char *end = defenc_c + PyBytes_GET_SIZE(defenc);
    char *c;
    for (c = defenc_c; c < end; c++) {
      if ((unsigned char)(*c) >= 128) {
        PyUnicode_AsASCIIString(o);
        return NULL;
      }
    }
  }
#endif
  *length = PyBytes_GET_SIZE(defenc);
  return defenc_c;
}
#else
static CYTHON_INLINE const char *
__Pyx_PyUnicode_AsStringAndSize(PyObject *o, Py_ssize_t *length) {
  if (unlikely(__Pyx_PyUnicode_READY(o) == -1))
    return NULL;
#if __PYX_DEFAULT_STRING_ENCODING_IS_ASCII
  if (likely(PyUnicode_IS_ASCII(o))) {
    *length = PyUnicode_GET_LENGTH(o);
    return PyUnicode_AsUTF8(o);
  } else {
    PyUnicode_AsASCIIString(o);
    return NULL;
  }
#else
  return PyUnicode_AsUTF8AndSize(o, length);
#endif
}
#endif
#endif
static CYTHON_INLINE const char *
__Pyx_PyObject_AsStringAndSize(PyObject *o, Py_ssize_t *length) {
#if __PYX_DEFAULT_STRING_ENCODING_IS_ASCII ||                                  \
    __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT
  if (
#if PY_MAJOR_VERSION < 3 && __PYX_DEFAULT_STRING_ENCODING_IS_ASCII
      __Pyx_sys_getdefaultencoding_not_ascii &&
#endif
      PyUnicode_Check(o)) {
    return __Pyx_PyUnicode_AsStringAndSize(o, length);
  } else
#endif
#if (!CYTHON_COMPILING_IN_PYPY) ||                                             \
    (defined(PyByteArray_AS_STRING) && defined(PyByteArray_GET_SIZE))
      if (PyByteArray_Check(o)) {
    *length = PyByteArray_GET_SIZE(o);
    return PyByteArray_AS_STRING(o);
  } else
#endif
  {
    char *result;
    int r = PyBytes_AsStringAndSize(o, &result, length);
    if (unlikely(r < 0)) {
      return NULL;
    } else {
      return result;
    }
  }
}
static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject *x) {
  int is_true = x == Py_True;
  if (is_true | (x == Py_False) | (x == Py_None))
    return is_true;
  else
    return PyObject_IsTrue(x);
}
static CYTHON_INLINE int __Pyx_PyObject_IsTrueAndDecref(PyObject *x) {
  int retval;
  if (unlikely(!x))
    return -1;
  retval = __Pyx_PyObject_IsTrue(x);
  Py_DECREF(x);
  return retval;
}
static PyObject *
__Pyx_PyNumber_IntOrLongWrongResultType(PyObject *result,
                                        const char *type_name) {
#if PY_MAJOR_VERSION >= 3
  if (PyLong_Check(result)) {
    if (PyErr_WarnFormat(
            PyExc_DeprecationWarning, 1,
            "__int__ returned non-int (type %.200s).  "
            "The ability to return an instance of a strict subclass of int "
            "is deprecated, and may be removed in a future version of Python.",
            Py_TYPE(result)->tp_name)) {
      Py_DECREF(result);
      return NULL;
    }
    return result;
  }
#endif
  PyErr_Format(PyExc_TypeError, "__%.4s__ returned non-%.4s (type %.200s)",
               type_name, type_name, Py_TYPE(result)->tp_name);
  Py_DECREF(result);
  return NULL;
}
static CYTHON_INLINE PyObject *__Pyx_PyNumber_IntOrLong(PyObject *x) {
#if CYTHON_USE_TYPE_SLOTS
  PyNumberMethods *m;
#endif
  const char *name = NULL;
  PyObject *res = NULL;
#if PY_MAJOR_VERSION < 3
  if (likely(PyInt_Check(x) || PyLong_Check(x)))
#else
  if (likely(PyLong_Check(x)))
#endif
    return __Pyx_NewRef(x);
#if CYTHON_USE_TYPE_SLOTS
  m = Py_TYPE(x)->tp_as_number;
#if PY_MAJOR_VERSION < 3
  if (m && m->nb_int) {
    name = "int";
    res = m->nb_int(x);
  } else if (m && m->nb_long) {
    name = "long";
    res = m->nb_long(x);
  }
#else
  if (likely(m && m->nb_int)) {
    name = "int";
    res = m->nb_int(x);
  }
#endif
#else
  if (!PyBytes_CheckExact(x) && !PyUnicode_CheckExact(x)) {
    res = PyNumber_Int(x);
  }
#endif
  if (likely(res)) {
#if PY_MAJOR_VERSION < 3
    if (unlikely(!PyInt_Check(res) && !PyLong_Check(res))) {
#else
    if (unlikely(!PyLong_CheckExact(res))) {
#endif
      return __Pyx_PyNumber_IntOrLongWrongResultType(res, name);
    }
  } else if (!PyErr_Occurred()) {
    PyErr_SetString(PyExc_TypeError, "an integer is required");
  }
  return res;
}
static CYTHON_INLINE Py_ssize_t __Pyx_PyIndex_AsSsize_t(PyObject *b) {
  Py_ssize_t ival;
  PyObject *x;
#if PY_MAJOR_VERSION < 3
  if (likely(PyInt_CheckExact(b))) {
    if (sizeof(Py_ssize_t) >= sizeof(long))
      return PyInt_AS_LONG(b);
    else
      return PyInt_AsSsize_t(b);
  }
#endif
  if (likely(PyLong_CheckExact(b))) {
#if CYTHON_USE_PYLONG_INTERNALS
    const digit *digits = ((PyLongObject *)b)->ob_digit;
    const Py_ssize_t size = Py_SIZE(b);
    if (likely(__Pyx_sst_abs(size) <= 1)) {
      ival = likely(size) ? digits[0] : 0;
      if (size == -1)
        ival = -ival;
      return ival;
    } else {
      switch (size) {
      case 2:
        if (8 * sizeof(Py_ssize_t) > 2 * PyLong_SHIFT) {
          return (Py_ssize_t)(((((size_t)digits[1]) << PyLong_SHIFT) |
                               (size_t)digits[0]));
        }
        break;
      case -2:
        if (8 * sizeof(Py_ssize_t) > 2 * PyLong_SHIFT) {
          return -(Py_ssize_t)(((((size_t)digits[1]) << PyLong_SHIFT) |
                                (size_t)digits[0]));
        }
        break;
      case 3:
        if (8 * sizeof(Py_ssize_t) > 3 * PyLong_SHIFT) {
          return (Py_ssize_t)((
              (((((size_t)digits[2]) << PyLong_SHIFT) | (size_t)digits[1])
               << PyLong_SHIFT) |
              (size_t)digits[0]));
        }
        break;
      case -3:
        if (8 * sizeof(Py_ssize_t) > 3 * PyLong_SHIFT) {
          return -(Py_ssize_t)((
              (((((size_t)digits[2]) << PyLong_SHIFT) | (size_t)digits[1])
               << PyLong_SHIFT) |
              (size_t)digits[0]));
        }
        break;
      case 4:
        if (8 * sizeof(Py_ssize_t) > 4 * PyLong_SHIFT) {
          return (Py_ssize_t)((
              (((((((size_t)digits[3]) << PyLong_SHIFT) | (size_t)digits[2])
                 << PyLong_SHIFT) |
                (size_t)digits[1])
               << PyLong_SHIFT) |
              (size_t)digits[0]));
        }
        break;
      case -4:
        if (8 * sizeof(Py_ssize_t) > 4 * PyLong_SHIFT) {
          return -(Py_ssize_t)((
              (((((((size_t)digits[3]) << PyLong_SHIFT) | (size_t)digits[2])
                 << PyLong_SHIFT) |
                (size_t)digits[1])
               << PyLong_SHIFT) |
              (size_t)digits[0]));
        }
        break;
      }
    }
#endif
    return PyLong_AsSsize_t(b);
  }
  x = PyNumber_Index(b);
  if (!x)
    return -1;
  ival = PyInt_AsSsize_t(x);
  Py_DECREF(x);
  return ival;
}
static CYTHON_INLINE Py_hash_t __Pyx_PyIndex_AsHash_t(PyObject *o) {
  if (sizeof(Py_hash_t) == sizeof(Py_ssize_t)) {
    return (Py_hash_t)__Pyx_PyIndex_AsSsize_t(o);
#if PY_MAJOR_VERSION < 3
  } else if (likely(PyInt_CheckExact(o))) {
    return PyInt_AS_LONG(o);
#endif
  } else {
    Py_ssize_t ival;
    PyObject *x;
    x = PyNumber_Index(o);
    if (!x)
      return -1;
    ival = PyInt_AsLong(x);
    Py_DECREF(x);
    return ival;
  }
}
static CYTHON_INLINE PyObject *__Pyx_PyBool_FromLong(long b) {
  return b ? __Pyx_NewRef(Py_True) : __Pyx_NewRef(Py_False);
}
static CYTHON_INLINE PyObject *__Pyx_PyInt_FromSize_t(size_t ival) {
  return PyInt_FromSize_t(ival);
}

#endif /* Py_PYTHON_H */
